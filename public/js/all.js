/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmory imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmory exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		Object.defineProperty(exports, name, {
/******/ 			configurable: false,
/******/ 			enumerable: true,
/******/ 			get: getter
/******/ 		});
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 51);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

"use strict";
eval("/* \r\n * To change this license header, choose License Headers in Project Properties.\r\n * To change this template file, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\n\r\n\r\n'use strict';\r\n// angular.js main app initialization\r\nvar app = angular.module('besafe', ['besafe.constants', 'ngCookies', 'ngMaterial', 'ngAnimate', 'ngAria']);\r\napp.config(function () {\r\n    /*$interpolateProvider.startSymbol('{{');\r\n     $interpolateProvider.endSymbol('}}');*/\r\n}).run([\"$http\", '$rootScope', '$cookies', 'Users', 'Modals', '$location', '$anchorScroll', function ($http, $rootScope, $cookies, Users, Modals, $location, $anchorScroll) {\r\n//    $http.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';\r\n//    $http.defaults.headers.common['X-XSRF-TOKEN'] = Laravel.csrfToken;\r\n        console.log(\"Searching for user\");\r\n        angular.element(document).ready(function () {\r\n            var screenWidth = window.innerWidth;\r\n            console.log(\"Screen width: \", screenWidth);\r\n            var url = window.location.href;\r\n            if (screenWidth < 450) {\r\n                setTimeout(function () {\r\n                    var old = $location.hash();\r\n                    $location.hash('mobile-anchor');\r\n                    $anchorScroll();\r\n                    $location.hash(old);\r\n                }, 1500);\r\n            }\r\n\r\n        });\r\n        handleCartCookie();\r\n        Users.getUser().then(function (data) {\r\n            console.log(\"user loaded\", data);\r\n            $rootScope.user = data.user;\r\n            $rootScope.hasSavedCard = data.savedCard;\r\n            if (data.merchants > 0) {\r\n                $rootScope.hasMerchants = true;\r\n            } else {\r\n                $rootScope.hasMerchants = false;\r\n            }\r\n            console.log(\"Has saved card\", $rootScope.hasSavedCard);\r\n            $rootScope.$broadcast('user_loaded');\r\n        },\r\n                function (data) {\r\n\r\n                });\r\n        getCart();\r\n        var shipping = $cookies.get(\"shippingAddress\");\r\n        if (shipping && shipping.length > 0) {\r\n            $rootScope.shippingAddress = JSON.parse(shipping);\r\n        }\r\n        var results = Modals.getAllUrlParams(null);\r\n        console.log(\"Checking params\", results);\r\n        if (results) {\r\n            if (results.merchant_id && results.merchant_id.length > 0) {\r\n                $rootScope.merchant_id = results.merchant_id;\r\n            }\r\n            if (results.lat && results.lat.length > 0) {\r\n                console.log(\"saving lat\");\r\n                $rootScope.lat = results.lat;\r\n            }\r\n        }\r\n\r\n        $http.defaults.headers.common['Accept'] = \"application/json\";\r\n        function handleCartCookie() {\r\n            var uuid = $cookies.get(\"cart-uuid\");\r\n            if (uuid && uuid.length > 0) {\r\n                console.log(\"Cart cookie found\");\r\n            } else {\r\n                var uuid$1 = generateUUID();\r\n                console.log(\"setting cart cookie\");\r\n                $cookies.put(\"cart-uuid\", uuid$1, {path: \"/\"});\r\n            }\r\n            $http.defaults.headers.common['X-device-id'] = uuid;\r\n        }\r\n        function generateUUID() { // Public Domain/MIT\r\n            var d = new Date().getTime();//Timestamp\r\n            var d2 = (performance && performance.now && (performance.now() * 1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\r\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = Math.random() * 16;//random number between 0 and 16\r\n                if (d > 0) {//Use timestamp until depleted\r\n                    r = (d + r) % 16 | 0;\r\n                    d = Math.floor(d / 16);\r\n                } else {//Use microseconds since page-load if supported\r\n                    r = (d2 + r) % 16 | 0;\r\n                    d2 = Math.floor(d2 / 16);\r\n                }\r\n                return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n            });\r\n        }\r\n        function getCart() {\r\n            console.log(\"Get cart\");\r\n            $rootScope.$broadcast('updateHeadCart');\r\n        }\r\n        $rootScope.changeShippingHeader = function () {\r\n            console.log(\"changeShippingHeader\");\r\n            $rootScope.$broadcast('updateShippingAddress');\r\n        }\r\n\r\n\r\n\r\n\r\n    }]); //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2FwcF8xLmpzPzliNGIiXSwic291cmNlc0NvbnRlbnQiOlsiLyogXHJcbiAqIFRvIGNoYW5nZSB0aGlzIGxpY2Vuc2UgaGVhZGVyLCBjaG9vc2UgTGljZW5zZSBIZWFkZXJzIGluIFByb2plY3QgUHJvcGVydGllcy5cclxuICogVG8gY2hhbmdlIHRoaXMgdGVtcGxhdGUgZmlsZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxhdGVzXHJcbiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9yLlxyXG4gKi9cclxuXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcbi8vIGFuZ3VsYXIuanMgbWFpbiBhcHAgaW5pdGlhbGl6YXRpb25cclxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnLCBbJ2Jlc2FmZS5jb25zdGFudHMnLCAnbmdDb29raWVzJywgJ25nTWF0ZXJpYWwnLCAnbmdBbmltYXRlJywgJ25nQXJpYSddKTtcclxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoKSB7XHJcbiAgICAvKiRpbnRlcnBvbGF0ZVByb3ZpZGVyLnN0YXJ0U3ltYm9sKCd7eycpO1xyXG4gICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLmVuZFN5bWJvbCgnfX0nKTsqL1xyXG59KS5ydW4oW1wiJGh0dHBcIiwgJyRyb290U2NvcGUnLCAnJGNvb2tpZXMnLCAnVXNlcnMnLCAnTW9kYWxzJywgJyRsb2NhdGlvbicsICckYW5jaG9yU2Nyb2xsJywgZnVuY3Rpb24gKCRodHRwLCAkcm9vdFNjb3BlLCAkY29va2llcywgVXNlcnMsIE1vZGFscywgJGxvY2F0aW9uLCAkYW5jaG9yU2Nyb2xsKSB7XHJcbi8vICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLVJlcXVlc3RlZC1XaXRoJ10gPSAnWE1MSHR0cFJlcXVlc3QnO1xyXG4vLyAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1YU1JGLVRPS0VOJ10gPSBMYXJhdmVsLmNzcmZUb2tlbjtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlNlYXJjaGluZyBmb3IgdXNlclwiKTtcclxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IHNjcmVlbldpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2NyZWVuIHdpZHRoOiBcIiwgc2NyZWVuV2lkdGgpO1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgIGlmIChzY3JlZW5XaWR0aCA8IDQ1MCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZCA9ICRsb2NhdGlvbi5oYXNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2goJ21vYmlsZS1hbmNob3InKTtcclxuICAgICAgICAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2gob2xkKTtcclxuICAgICAgICAgICAgICAgIH0sIDE1MDApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGhhbmRsZUNhcnRDb29raWUoKTtcclxuICAgICAgICBVc2Vycy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIgbG9hZGVkXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBkYXRhLnVzZXI7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuaGFzU2F2ZWRDYXJkID0gZGF0YS5zYXZlZENhcmQ7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLm1lcmNoYW50cyA+IDApIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaGFzTWVyY2hhbnRzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaGFzTWVyY2hhbnRzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJIYXMgc2F2ZWQgY2FyZFwiLCAkcm9vdFNjb3BlLmhhc1NhdmVkQ2FyZCk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXNlcl9sb2FkZWQnKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICBnZXRDYXJ0KCk7XHJcbiAgICAgICAgbGV0IHNoaXBwaW5nID0gJGNvb2tpZXMuZ2V0KFwic2hpcHBpbmdBZGRyZXNzXCIpO1xyXG4gICAgICAgIGlmIChzaGlwcGluZyAmJiBzaGlwcGluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzID0gSlNPTi5wYXJzZShzaGlwcGluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCByZXN1bHRzID0gTW9kYWxzLmdldEFsbFVybFBhcmFtcyhudWxsKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNraW5nIHBhcmFtc1wiLCByZXN1bHRzKTtcclxuICAgICAgICBpZiAocmVzdWx0cykge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0cy5tZXJjaGFudF9pZCAmJiByZXN1bHRzLm1lcmNoYW50X2lkLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUubWVyY2hhbnRfaWQgPSByZXN1bHRzLm1lcmNoYW50X2lkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRzLmxhdCAmJiByZXN1bHRzLmxhdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNhdmluZyBsYXRcIik7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmxhdCA9IHJlc3VsdHMubGF0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnQWNjZXB0J10gPSBcImFwcGxpY2F0aW9uL2pzb25cIjtcclxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVDYXJ0Q29va2llKCkge1xyXG4gICAgICAgICAgICBsZXQgdXVpZCA9ICRjb29raWVzLmdldChcImNhcnQtdXVpZFwiKTtcclxuICAgICAgICAgICAgaWYgKHV1aWQgJiYgdXVpZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhcnQgY29va2llIGZvdW5kXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IHV1aWQgPSBnZW5lcmF0ZVVVSUQoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2V0dGluZyBjYXJ0IGNvb2tpZVwiKTtcclxuICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImNhcnQtdXVpZFwiLCB1dWlkLCB7cGF0aDogXCIvXCJ9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1kZXZpY2UtaWQnXSA9IHV1aWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCgpIHsgLy8gUHVibGljIERvbWFpbi9NSVRcclxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsvL1RpbWVzdGFtcFxyXG4gICAgICAgICAgICB2YXIgZDIgPSAocGVyZm9ybWFuY2UgJiYgcGVyZm9ybWFuY2Uubm93ICYmIChwZXJmb3JtYW5jZS5ub3coKSAqIDEwMDApKSB8fCAwOy8vVGltZSBpbiBtaWNyb3NlY29uZHMgc2luY2UgcGFnZS1sb2FkIG9yIDAgaWYgdW5zdXBwb3J0ZWRcclxuICAgICAgICAgICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSAqIDE2Oy8vcmFuZG9tIG51bWJlciBiZXR3ZWVuIDAgYW5kIDE2XHJcbiAgICAgICAgICAgICAgICBpZiAoZCA+IDApIHsvL1VzZSB0aW1lc3RhbXAgdW50aWwgZGVwbGV0ZWRcclxuICAgICAgICAgICAgICAgICAgICByID0gKGQgKyByKSAlIDE2IHwgMDtcclxuICAgICAgICAgICAgICAgICAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsvL1VzZSBtaWNyb3NlY29uZHMgc2luY2UgcGFnZS1sb2FkIGlmIHN1cHBvcnRlZFxyXG4gICAgICAgICAgICAgICAgICAgIHIgPSAoZDIgKyByKSAlIDE2IHwgMDtcclxuICAgICAgICAgICAgICAgICAgICBkMiA9IE1hdGguZmxvb3IoZDIgLyAxNik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGMgPT09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCkpLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldENhcnQoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGNhcnRcIik7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlSGVhZENhcnQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJHJvb3RTY29wZS5jaGFuZ2VTaGlwcGluZ0hlYWRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjaGFuZ2VTaGlwcGluZ0hlYWRlclwiKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVTaGlwcGluZ0FkZHJlc3MnKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgfV0pOyBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9hcHBfMS5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFPQTs7QUFFQTtBQUNBOzs7QUFHQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 1 */
/***/ function(module, exports) {

eval("angular.module( 'besafe.constants', [] )\n.constant('API', {\n\taddress: 'http://lonchis.com.co/api',\n        website: 'http://lonchis.com.co',\n        avatar:'http://lonchis.com.co/avatars/avatar.jpg'\n})\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnN0YW50cy5qcz9iYTk3Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCAnYmVzYWZlLmNvbnN0YW50cycsIFtdIClcbi5jb25zdGFudCgnQVBJJywge1xuXHRhZGRyZXNzOiAnaHR0cDovL2xvbmNoaXMuY29tLmNvL2FwaScsXG4gICAgICAgIHdlYnNpdGU6ICdodHRwOi8vbG9uY2hpcy5jb20uY28nLFxuICAgICAgICBhdmF0YXI6J2h0dHA6Ly9sb25jaGlzLmNvbS5jby9hdmF0YXJzL2F2YXRhci5qcGcnXG59KVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29uc3RhbnRzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 2 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('PersonalTokensCtrl',['$scope', 'Passport', '$rootScope', function ($scope, Passport, $rootScope) {\n            $scope.data = {};\n            $scope.data.scopes = [];\n            $scope.personalAccessTokens;\n            $scope.showForm = false;\n            $scope.showToken = false;\n            angular.element(document).ready(function () {\n                $scope.getPersonalAccessTokens();\n            });\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                if (isvalid) {\n                    $scope.data.scopes = [\"\"];\n                    Passport.createPersonalAccessToken($.param($scope.data)).then(function (data) {\n                        $scope.token = data.accessToken;\n                        $scope.personalAccessTokens.push(data.token);\n                        $rootScope.$broadcast('getTokens');\n                        $scope.data = {};\n                        $scope.data.scopes = [];\n                        $scope.submitted = false;\n                        $scope.showToken = true;\n                        $scope.showForm = false;\n                    },\n                            function (data) {\n\n                            });\n                }\n            }\n            $scope.getPersonalAccessTokens = function () {\n                Passport.getPersonalAccessTokens().then(function (data) {\n                    $scope.personalAccessTokens = data;\n\n                },\n                        function (data) {\n\n                        });\n                Passport.getScopes().then(function (data) {\n                    $scope.scopes = data;\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deletePersonalToken = function (id) {\n                Passport.deletePersonalAccessTokens(id).then(function () {\n                    for (item in $scope.personalAccessTokens) {\n                        if ($scope.personalAccessTokens[item].id == id) {\n                            $scope.personalAccessTokens.splice(item, 1);\n                        }\n                    }\n                },\n                        function (data) {\n                        });\n            }\n            $scope.clean = function () {\n                $scope.data = {};\n            }\n            $scope.newPersonalAccessToken = function () {\n                $scope.showForm = true;\n                $scope.showToken = false;\n            }\n\n        }]).controller('OauthClientsCtrl',['$scope', 'Passport', 'Users', function ($scope, Passport, Users) {\n    $scope.data = {};\n    $scope.oauthClients;\n    $scope.showForm = false;\n\n    angular.element(document).ready(function () {\n        $scope.getOauthClients();\n    });\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            if ($scope.data.id) {\n                Passport.updateOauthClient($.param($scope.data), $scope.data.id).then(function (data) {\n                    $scope.updateOauthClient(data);\n                    $scope.showForm = false;\n\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            } else {\n                Passport.createOauthClient($.param($scope.data)).then(function (data) {\n                    $scope.oauthClients.push(data);\n                    $scope.showForm = false;\n\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }\n    }\n    $scope.updateOauthClient = function (oauthClient) {\n        for (item in $scope.oauthClients) {\n            if ($scope.oauthClients[item].id == oauthClient.id) {\n                $scope.oauthClients.splice(item, 1);\n                $scope.oauthClients.push(oauthClient);\n            }\n        }\n    }\n    $scope.getOauthClients = function () {\n        Passport.getOauthClients().then(function (data) {\n            $scope.oauthClients = data;\n\n        },\n                function (data) {\n\n                });\n    }\n    $scope.newOauthClient = function () {\n        $scope.showForm = true;\n    }\n    $scope.editOauthClient = function (id) {\n        $scope.showForm = true;\n        $scope.data.id = angular.element(document.querySelector('tr#oauthClient-' + id + ' span.id')).html();\n        $scope.data.name = angular.element(document.querySelector('tr#oauthClient-' + id + ' span.name')).html();\n        $scope.data.redirect = angular.element(document.querySelector('tr#oauthClient-' + id + ' span.redirect')).html();\n    }\n    $scope.deleteOauthClient = function (id) {\n        Passport.deleteOauthClient(id).then(function (data) {\n            for (item in $scope.oauthClients) {\n                if ($scope.oauthClients[item].id == id) {\n                    console.log(\"deleting oauthClient\", $scope.oauthClients[item]);\n                    $scope.oauthClients.splice(item, 1);\n                }\n            }\n        },\n                function (data) {\n                });\n    }\n    $scope.clean = function () {\n        $scope.data = {};\n    }\n\n}]).controller('TokensCtrl',['$scope', 'Passport', '$rootScope', function ($scope, Passport, $rootScope) {\n            $scope.tokens;\n            angular.element(document).ready(function () {\n                $scope.getTokens();\n            });\n            $rootScope.$on('getTokens', function (event, args) {\n                $scope.getTokens();\n            });\n            $scope.getTokens = function () {\n                Passport.getTokens().then(function (data) {\n                    $scope.tokens = data;\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteToken = function (id) {\n                Passport.deleteTokens(id).then(function () {\n                    for (item in $scope.tokens) {\n                        if ($scope.tokens[item].id == id) {\n                            $scope.tokens.splice(item, 1);\n                        }\n                    }\n                },\n                        function (data) {\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FjY2Vzc2N0cmwuanM/NDdjNSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignUGVyc29uYWxUb2tlbnNDdHJsJyxbJyRzY29wZScsICdQYXNzcG9ydCcsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgUGFzc3BvcnQsICRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5zY29wZXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5wZXJzb25hbEFjY2Vzc1Rva2VucztcbiAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLnNob3dUb2tlbiA9IGZhbHNlO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFBlcnNvbmFsQWNjZXNzVG9rZW5zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zY29wZXMgPSBbXCJcIl07XG4gICAgICAgICAgICAgICAgICAgIFBhc3Nwb3J0LmNyZWF0ZVBlcnNvbmFsQWNjZXNzVG9rZW4oJC5wYXJhbSgkc2NvcGUuZGF0YSkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50b2tlbiA9IGRhdGEuYWNjZXNzVG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyc29uYWxBY2Nlc3NUb2tlbnMucHVzaChkYXRhLnRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZ2V0VG9rZW5zJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc2NvcGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1Rva2VuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0UGVyc29uYWxBY2Nlc3NUb2tlbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZ2V0UGVyc29uYWxBY2Nlc3NUb2tlbnMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wZXJzb25hbEFjY2Vzc1Rva2VucyA9IGRhdGE7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZ2V0U2NvcGVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2NvcGVzID0gZGF0YTtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5kZWxldGVQZXJzb25hbFRva2VuID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZGVsZXRlUGVyc29uYWxBY2Nlc3NUb2tlbnMoaWQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLnBlcnNvbmFsQWNjZXNzVG9rZW5zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnBlcnNvbmFsQWNjZXNzVG9rZW5zW2l0ZW1dLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcnNvbmFsQWNjZXNzVG9rZW5zLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5uZXdQZXJzb25hbEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dUb2tlbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKS5jb250cm9sbGVyKCdPYXV0aENsaWVudHNDdHJsJyxbJyRzY29wZScsICdQYXNzcG9ydCcsICdVc2VycycsIGZ1bmN0aW9uICgkc2NvcGUsIFBhc3Nwb3J0LCBVc2Vycykge1xuICAgICRzY29wZS5kYXRhID0ge307XG4gICAgJHNjb3BlLm9hdXRoQ2xpZW50cztcbiAgICAkc2NvcGUuc2hvd0Zvcm0gPSBmYWxzZTtcblxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZ2V0T2F1dGhDbGllbnRzKCk7XG4gICAgfSk7XG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS5pZCkge1xuICAgICAgICAgICAgICAgIFBhc3Nwb3J0LnVwZGF0ZU9hdXRoQ2xpZW50KCQucGFyYW0oJHNjb3BlLmRhdGEpLCAkc2NvcGUuZGF0YS5pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlT2F1dGhDbGllbnQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFBhc3Nwb3J0LmNyZWF0ZU9hdXRoQ2xpZW50KCQucGFyYW0oJHNjb3BlLmRhdGEpKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vYXV0aENsaWVudHMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dGb3JtID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS51cGRhdGVPYXV0aENsaWVudCA9IGZ1bmN0aW9uIChvYXV0aENsaWVudCkge1xuICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLm9hdXRoQ2xpZW50cykge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5vYXV0aENsaWVudHNbaXRlbV0uaWQgPT0gb2F1dGhDbGllbnQuaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2F1dGhDbGllbnRzLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2F1dGhDbGllbnRzLnB1c2gob2F1dGhDbGllbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5nZXRPYXV0aENsaWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFBhc3Nwb3J0LmdldE9hdXRoQ2xpZW50cygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5vYXV0aENsaWVudHMgPSBkYXRhO1xuXG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICAkc2NvcGUubmV3T2F1dGhDbGllbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5zaG93Rm9ybSA9IHRydWU7XG4gICAgfVxuICAgICRzY29wZS5lZGl0T2F1dGhDbGllbnQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgJHNjb3BlLnNob3dGb3JtID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmRhdGEuaWQgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndHIjb2F1dGhDbGllbnQtJyArIGlkICsgJyBzcGFuLmlkJykpLmh0bWwoKTtcbiAgICAgICAgJHNjb3BlLmRhdGEubmFtZSA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0ciNvYXV0aENsaWVudC0nICsgaWQgKyAnIHNwYW4ubmFtZScpKS5odG1sKCk7XG4gICAgICAgICRzY29wZS5kYXRhLnJlZGlyZWN0ID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RyI29hdXRoQ2xpZW50LScgKyBpZCArICcgc3Bhbi5yZWRpcmVjdCcpKS5odG1sKCk7XG4gICAgfVxuICAgICRzY29wZS5kZWxldGVPYXV0aENsaWVudCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICBQYXNzcG9ydC5kZWxldGVPYXV0aENsaWVudChpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS5vYXV0aENsaWVudHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm9hdXRoQ2xpZW50c1tpdGVtXS5pZCA9PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGV0aW5nIG9hdXRoQ2xpZW50XCIsICRzY29wZS5vYXV0aENsaWVudHNbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2F1dGhDbGllbnRzLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgIH1cblxufV0pLmNvbnRyb2xsZXIoJ1Rva2Vuc0N0cmwnLFsnJHNjb3BlJywgJ1Bhc3Nwb3J0JywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCBQYXNzcG9ydCwgJHJvb3RTY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLnRva2VucztcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRUb2tlbnMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2dldFRva2VucycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRUb2tlbnMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmdldFRva2VucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBQYXNzcG9ydC5nZXRUb2tlbnMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b2tlbnMgPSBkYXRhO1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZVRva2VuID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZGVsZXRlVG9rZW5zKGlkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS50b2tlbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudG9rZW5zW2l0ZW1dLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRva2Vucy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FjY2Vzc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 3 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AddressesCtrl', ['$scope', '$rootScope', 'LocationService', 'Addresses', '$mdDialog', 'Modals', '$cookies',\n            function ($scope, $rootScope, LocationService, Addresses, $mdDialog, Modals, $cookies) {\n                $scope.data = {};\n                $scope.addresses;\n                $scope.regionVisible = false;\n                $scope.editAddress = false;\n                angular.element(document).ready(function () {\n                    $scope.getAddresses();\n                    var where = \"\";\n                    var checkAddress = $cookies.get(\"creating_address\");\n                    if (checkAddress) {\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        console.log(\"creat\", $cookies.get(\"creating_address\"));\n                        console.log(\"Loading address from cookie\", $rootScope.shippingAddress);\n                        $scope.editAddress = true;\n                        $scope.data = $rootScope.shippingAddress;\n                        $scope.data.address_id = $rootScope.shippingAddress.id;\n                        if ($scope.data.name && $scope.data.name.length > 0) {\n\n                        } else {\n                            $scope.data.name = $rootScope.user.name;\n                        }\n                        if ($scope.data.phone && $scope.data.phone.length > 0) {\n\n                        } else {\n                            $scope.data.phone = $rootScope.user.cellphone;\n                        }\n\n                        $scope.selectPlace($scope.data.country_id, $scope.data.region_id);\n                    }\n                    LocationService.getCountries(where).then(function (data) {\n                        $scope.countries = data.data;\n                    },\n                            function (data) {\n\n                            });\n                });\n                $scope.save = function (isvalid) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        var existing = false;\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        if ($scope.data.address_id) {\n                            existing = true;\n                        }\n                        Addresses.saveAddress($scope.data).then(function (data) {\n                            if (data.status == \"success\") {\n                                Modals.showToast(\"Actualizacion exitosa\", $(\"#myaccountContent\"));\n                                if (existing) {\n                                    $scope.updateAddress(data.address);\n                                } else {\n                                    $scope.addresses.push(data.address);\n                                }\n\n                                $scope.data = {};\n                                $scope.editAddress = false;\n                                //$scope.data = data.user;\n                            } else {\n                                Modals.showToast(\"Hubo un error porfavor comunicate con soporte\", $(\"#myaccountContent\"));\n                            }\n\n                            $scope.submitted = false;\n\n                        },\n                                function (data) {\n\n                                });\n                    }\n                }\n                $scope.getAddresses = function () {\n                    Addresses.getAddresses().then(function (data) {\n                        $scope.addresses = data.addresses;\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.newAddress = function () {\n                    $mdDialog.show(Modals.getLocationPrompt()).then(function (answer) {\n                        if (answer == \"map\") {\n                            $cookies.put(\"locationRefferrer\", window.location.href, {path: \"/\"});\n                            $cookies.put(\"creating_address\", true, {path: \"/\"});\n                            window.location.href = \"/location\";\n                        } else if (answer == 'address') {\n                            showAdvanced();\n                        }\n\n                    }, function () {\n\n                    });\n                };\n                $scope.deleteAddress = function (address) {\n                    $cookies.remove(\"shippingAddress\", {path: \"/\"});\n                    Addresses.deleteAddress(address.id).then(function (data) {\n                        for (item in $scope.addresses) {\n                            console.log(\"a\", $scope.addresses[item].id);\n                            console.log(\"b\", address.id);\n                            console.log(\"c\", $scope.addresses[item].id == address.id);\n                            if ($scope.addresses[item].id == address.id) {\n                                console.log(\"deleting address\", $scope.addresses[item]);\n                                $scope.addresses.splice(item, 1);\n                            }\n                        }\n                    },\n                            function (data) {\n                            });\n                }\n                $scope.clean = function () {\n                    $scope.data = {};\n                    $scope.regionVisible = false;\n                    $scope.cityVisible = false;\n                }\n                $scope.updateAddress = function (address) {\n                    for (item in $scope.addresses) {\n                        if ($scope.addresses[item].id == address.id) {\n                            $scope.addresses.splice(item, 1);\n                            $scope.addresses.push(address);\n                        }\n                    }\n                }\n                $scope.selectCountry = function () {\n                    for (item in $scope.countries) {\n                        if ($scope.countries[item].id == $scope.data.country_id) {\n                            $scope.data.country = $scope.countries[item].country_iso;\n                        }\n                    }\n                    LocationService.getRegionsCountry($scope.data.country_id).then(function (data) {\n                        $scope.regions = data.data;\n                        $scope.regionVisible = true;\n                        $scope.cityVisible = false;\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.selectRegion = function () {\n                    for (item in $scope.regions) {\n                        if ($scope.countries[item].id == $scope.data.region_id) {\n                            $scope.data.region = $scope.countries[item].name;\n                        }\n                    }\n                    LocationService.getCitiesRegion($scope.data.region_id).then(function (data) {\n                        $scope.cities = data.data;\n                        $scope.cityVisible = true;\n                        console.log(\"Setting cities\", $scope.cities);\n                    },\n                            function (data) {\n                            });\n                }\n                $scope.selectPlace = function (country_id, region_id, city_id) {\n                    //$scope.$apply(function () {\n                    $scope.data.country_id = country_id;\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\n                        $scope.regions = data.data;\n                        $scope.regionVisible = true;\n                        $scope.cityVisible = false;\n                        console.log(\"Setting region\", $scope.data.region_id);\n                        $scope.data.region_id = region_id;\n                        LocationService.getCitiesRegion(region_id).then(function (data) {\n                            $scope.cities = data.data;\n                            $scope.cityVisible = true;\n                            console.log(\"Setting city_id\", $scope.data.city_id);\n                            console.log(\"Setting cities\", $scope.cities);\n                            $scope.data.city_id = city_id;\n                        },\n                                function (data) {\n                                });\n                    },\n                            function (data) {\n                            });\n                    //});\n                }\n                $scope.editAddressObj = function (address) {\n                    $scope.editAddress = true;\n                    if (address.lat) {\n                        $cookies.put(\"shippingAddress\", JSON.stringify(address), {path: \"/\"});\n                        $cookies.put(\"locationRefferrer\", window.location.href, {path: \"/\"});\n                        $cookies.put(\"creating_address\", true, {path: \"/\"});\n                        window.location.href = \"/location\";\n                    } else {\n                        for (item in $scope.addresses) {\n                            if ($scope.addresses[item].id == address.id) {\n                                $scope.data = $scope.addresses[item];\n                                $scope.data.address_id = address.id;\n                                $scope.selectPlace($scope.data.country_id, $scope.data.region_id);\n                            }\n                        }\n                    }\n                }\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkZHJlc3NjdHJsLmpzPzY3YzMiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0FkZHJlc3Nlc0N0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0xvY2F0aW9uU2VydmljZScsICdBZGRyZXNzZXMnLCAnJG1kRGlhbG9nJywgJ01vZGFscycsICckY29va2llcycsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBMb2NhdGlvblNlcnZpY2UsIEFkZHJlc3NlcywgJG1kRGlhbG9nLCBNb2RhbHMsICRjb29raWVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc2VzO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRBZGRyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoZWNrQWRkcmVzcyA9ICRjb29raWVzLmdldChcImNyZWF0aW5nX2FkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja0FkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnJlbW92ZShcImNyZWF0aW5nX2FkZHJlc3NcIiwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0XCIsICRjb29raWVzLmdldChcImNyZWF0aW5nX2FkZHJlc3NcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2FkaW5nIGFkZHJlc3MgZnJvbSBjb29raWVcIiwgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRBZGRyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5hZGRyZXNzX2lkID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGEubmFtZSAmJiAkc2NvcGUuZGF0YS5uYW1lLmxlbmd0aCA+IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5uYW1lID0gJHJvb3RTY29wZS51c2VyLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGEucGhvbmUgJiYgJHNjb3BlLmRhdGEucGhvbmUubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnBob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFBsYWNlKCRzY29wZS5kYXRhLmNvdW50cnlfaWQsICRzY29wZS5kYXRhLnJlZ2lvbl9pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENvdW50cmllcyh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cmllcyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGlzdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucmVtb3ZlKFwiY3JlYXRpbmdfYWRkcmVzc1wiLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnJlbW92ZShcImNyZWF0aW5nX2FkZHJlc3NcIiwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkY29va2llcy5yZW1vdmUoXCJjcmVhdGluZ19hZGRyZXNzXCIsIHtwYXRoOiBcIi9cIn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5kYXRhLmFkZHJlc3NfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBBZGRyZXNzZXMuc2F2ZUFkZHJlc3MoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkFjdHVhbGl6YWNpb24gZXhpdG9zYVwiLCAkKFwiI215YWNjb3VudENvbnRlbnRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVBZGRyZXNzKGRhdGEuYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc2VzLnB1c2goZGF0YS5hZGRyZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5kYXRhID0gZGF0YS51c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yIHBvcmZhdm9yIGNvbXVuaWNhdGUgY29uIHNvcG9ydGVcIiwgJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEFkZHJlc3NlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgQWRkcmVzc2VzLmdldEFkZHJlc3NlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBkYXRhLmFkZHJlc3NlcztcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5ld0FkZHJlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRMb2NhdGlvblByb21wdCgpKS50aGVuKGZ1bmN0aW9uIChhbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbnN3ZXIgPT0gXCJtYXBcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImxvY2F0aW9uUmVmZmVycmVyXCIsIHdpbmRvdy5sb2NhdGlvbi5ocmVmLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJjcmVhdGluZ19hZGRyZXNzXCIsIHRydWUsIHtwYXRoOiBcIi9cIn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9jYXRpb25cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5zd2VyID09ICdhZGRyZXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBZHZhbmNlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxldGVBZGRyZXNzID0gZnVuY3Rpb24gKGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucmVtb3ZlKFwic2hpcHBpbmdBZGRyZXNzXCIsIHtwYXRoOiBcIi9cIn0pO1xuICAgICAgICAgICAgICAgICAgICBBZGRyZXNzZXMuZGVsZXRlQWRkcmVzcyhhZGRyZXNzLmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmFkZHJlc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYVwiLCAkc2NvcGUuYWRkcmVzc2VzW2l0ZW1dLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImJcIiwgYWRkcmVzcy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjXCIsICRzY29wZS5hZGRyZXNzZXNbaXRlbV0uaWQgPT0gYWRkcmVzcy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hZGRyZXNzZXNbaXRlbV0uaWQgPT0gYWRkcmVzcy5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGV0aW5nIGFkZHJlc3NcIiwgJHNjb3BlLmFkZHJlc3Nlc1tpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuYWRkcmVzc2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFkZHJlc3Nlc1tpdGVtXS5pZCA9PSBhZGRyZXNzLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3Nlcy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3Nlcy5wdXNoKGFkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RDb3VudHJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmNvdW50cmllcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jb3VudHJpZXNbaXRlbV0uaWQgPT0gJHNjb3BlLmRhdGEuY291bnRyeV9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSAkc2NvcGUuY291bnRyaWVzW2l0ZW1dLmNvdW50cnlfaXNvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRSZWdpb25zQ291bnRyeSgkc2NvcGUuZGF0YS5jb3VudHJ5X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UmVnaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLnJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY291bnRyaWVzW2l0ZW1dLmlkID09ICRzY29wZS5kYXRhLnJlZ2lvbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnJlZ2lvbiA9ICRzY29wZS5jb3VudHJpZXNbaXRlbV0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKCRzY29wZS5kYXRhLnJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNldHRpbmcgY2l0aWVzXCIsICRzY29wZS5jaXRpZXMpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RQbGFjZSA9IGZ1bmN0aW9uIChjb3VudHJ5X2lkLCByZWdpb25faWQsIGNpdHlfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuY291bnRyeV9pZCA9IGNvdW50cnlfaWQ7XG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRSZWdpb25zQ291bnRyeShjb3VudHJ5X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIHJlZ2lvblwiLCAkc2NvcGUuZGF0YS5yZWdpb25faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVnaW9uX2lkID0gcmVnaW9uX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENpdGllc1JlZ2lvbihyZWdpb25faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIGNpdHlfaWRcIiwgJHNjb3BlLmRhdGEuY2l0eV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIGNpdGllc1wiLCAkc2NvcGUuY2l0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jaXR5X2lkID0gY2l0eV9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzc09iaiA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhZGRyZXNzLmxhdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwic2hpcHBpbmdBZGRyZXNzXCIsIEpTT04uc3RyaW5naWZ5KGFkZHJlc3MpLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImxvY2F0aW9uUmVmZmVycmVyXCIsIHdpbmRvdy5sb2NhdGlvbi5ocmVmLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImNyZWF0aW5nX2FkZHJlc3NcIiwgdHJ1ZSwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2xvY2F0aW9uXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmFkZHJlc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWRkcmVzc2VzW2l0ZW1dLmlkID09IGFkZHJlc3MuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSAkc2NvcGUuYWRkcmVzc2VzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5hZGRyZXNzX2lkID0gYWRkcmVzcy5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFBsYWNlKCRzY29wZS5kYXRhLmNvdW50cnlfaWQsICRzY29wZS5kYXRhLnJlZ2lvbl9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYWRkcmVzc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 4 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AdminCategoriesCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page;\n                ProductImport.getCategories(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateCategoryItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteCategoryItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLWNhdGVnb3JpZXNjdHJsLmpzP2NlYjEiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0FkbWluQ2F0ZWdvcmllc0N0cmwnLFsnJHNjb3BlJywgJ1Byb2R1Y3RJbXBvcnQnLCBmdW5jdGlvbiAoJHNjb3BlLCBQcm9kdWN0SW1wb3J0KSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJvcmRlcl9ieT1pZCxkZXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZTtcbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmdldENhdGVnb3JpZXModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbXNcIixkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LnVwZGF0ZUNhdGVnb3J5SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmRlbGV0ZUNhdGVnb3J5SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYWRtaW4vc3RvcmUvYWRtaW4tc3RvcmUtY2F0ZWdvcmllc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 5 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AdminMerchantsCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page;\n                ProductImport.getMerchants(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateMerchantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteMerchantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLW1lcmNoYW50c2N0cmwuanM/MTVmYyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignQWRtaW5NZXJjaGFudHNDdHJsJyxbJyRzY29wZScsICdQcm9kdWN0SW1wb3J0JywgZnVuY3Rpb24gKCRzY29wZSwgUHJvZHVjdEltcG9ydCkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gdHJ1ZSxcbiAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRzY29wZS5idWlsZEl0ZW1EYXRhID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAvL2l0ZW0uYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoaXRlbS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwib3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XG4gICAgICAgICAgICAgICAgUHJvZHVjdEltcG9ydC5nZXRNZXJjaGFudHModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbXNcIixkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LnVwZGF0ZU1lcmNoYW50SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmRlbGV0ZU1lcmNoYW50SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYWRtaW4vc3RvcmUvYWRtaW4tc3RvcmUtbWVyY2hhbnRzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 6 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AdminProductsCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&includes=productVariants,categories&page=\" + $scope.page;\n                ProductImport.getProducts(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateProductItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteProductItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLXByb2R1Y3RzY3RybC5qcz81YTU0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdBZG1pblByb2R1Y3RzQ3RybCcsWyckc2NvcGUnLCAnUHJvZHVjdEltcG9ydCcsIGZ1bmN0aW9uICgkc2NvcGUsIFByb2R1Y3RJbXBvcnQpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRJdGVtRGF0YSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgLy9pdGVtLmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGl0ZW0uYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIm9yZGVyX2J5PWlkLGRlc2MmaW5jbHVkZXM9cHJvZHVjdFZhcmlhbnRzLGNhdGVnb3JpZXMmcGFnZT1cIiArICRzY29wZS5wYWdlO1xuICAgICAgICAgICAgICAgIFByb2R1Y3RJbXBvcnQuZ2V0UHJvZHVjdHModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbXNcIixkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LnVwZGF0ZVByb2R1Y3RJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5kZWxldGVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICAgICAgICAgIFByb2R1Y3RJbXBvcnQuZGVsZXRlUHJvZHVjdEl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLXByb2R1Y3RzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 7 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .controller('AdminVariantsCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&includes=product.merchants&page=\" + $scope.page;\n                ProductImport.getVariants(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateVariantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteVariantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLXZhcmlhbnRzY3RybC5qcz9hMjBkIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuY29udHJvbGxlcignQWRtaW5WYXJpYW50c0N0cmwnLFsnJHNjb3BlJywgJ1Byb2R1Y3RJbXBvcnQnLCBmdW5jdGlvbiAoJHNjb3BlLCBQcm9kdWN0SW1wb3J0KSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJvcmRlcl9ieT1pZCxkZXNjJmluY2x1ZGVzPXByb2R1Y3QubWVyY2hhbnRzJnBhZ2U9XCIgKyAkc2NvcGUucGFnZTtcbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmdldFZhcmlhbnRzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW1zQ29udCA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGl0ZW1zQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNDb250W2l0ZW1dID0gJHNjb3BlLmJ1aWxkSXRlbURhdGEoaXRlbXNDb250W2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSAkc2NvcGUuaXRlbXMuY29uY2F0KGl0ZW1zQ29udCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgUHJvZHVjdEltcG9ydC51cGRhdGVWYXJpYW50SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmRlbGV0ZVZhcmlhbnRJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9hZG1pbi9zdG9yZS9hZG1pbi1zdG9yZS12YXJpYW50c2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 8 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('BookingCtrl', ['$scope', '$rootScope', 'getParams', 'Booking', 'Modals', 'Cart','$mdDialog', function ($scope, $rootScope, getParams, Booking, Modals, Cart,$mdDialog) {\r\n                $scope.availableDays = [];\r\n                $scope.availableDates = [];\r\n                $scope.selectedSpots = [];\r\n                $scope.questions = [];\r\n                $scope.meetingType;\r\n                $scope.variant;\r\n                $scope.availabilities = [];\r\n                $scope.appointmentOptions = [];\r\n                $scope.months = [];\r\n                $scope.newVisit = true;\r\n                $scope.dateSelected = false;\r\n                $scope.virtualMeeting = 'physical';\r\n                $scope.timeSelected = false;\r\n                $scope.availabilitiesDate = [];\r\n                $scope.weekday = [];\r\n                $scope.weekday2 = [];\r\n                $scope.typeObj;\r\n                $scope.bookingObj = null;\r\n                $scope.requiresAuth;\r\n                $scope.dayName;\r\n                $scope.atributesCont;\r\n                $scope.product_variant_id = null;\r\n                $scope.item_id = null;\r\n                $scope.quantity = null;\r\n                $scope.location = null;\r\n                $scope.objectId;\r\n                $scope.objectName;\r\n                $scope.objectDescription;\r\n                $scope.objectIcon;\r\n                $scope.startDate;\r\n                $scope.endDate;\r\n                $scope.startDateS;\r\n                $scope.expectedPrice;\r\n                $scope.activeBooking;\r\n                $scope.amount = \"1\";\r\n                $scope.submitted = false;\r\n                $scope.constructor = function () {\r\n\r\n                    $scope.atributesCont = {};\r\n                    $scope.weekday = new Array(7);\r\n                    $scope.weekday[0] = \"sunday\";\r\n                    $scope.weekday[1] = \"monday\";\r\n                    $scope.weekday[2] = \"tuesday\";\r\n                    $scope.weekday[3] = \"wednesday\";\r\n                    $scope.weekday[4] = \"thursday\";\r\n                    $scope.weekday[5] = \"friday\";\r\n                    $scope.weekday[6] = \"saturday\";\r\n                    $scope.weekday2 = new Array(7);\r\n                    $scope.weekday2[0] = \"Domingo\";\r\n                    $scope.weekday2[1] = \"Lunes\";\r\n                    $scope.weekday2[2] = \"Martes\";\r\n                    $scope.weekday2[3] = \"Miercoles\";\r\n                    $scope.weekday2[4] = \"Jueves\";\r\n                    $scope.weekday2[5] = \"Viernes\";\r\n                    $scope.weekday2[6] = \"Sabado\";\r\n                    $scope.questions = []\r\n\r\n                    console.log(\"Get availableDates\", $scope.availableDates);\r\n                }\r\n                $scope.ngOnInit = function () {\r\n                    $scope.loadData();\r\n                }\r\n                $scope.cancel = function () {\r\n                    $mdDialog.cancel();\r\n                };\r\n                $scope.keytab = function (event, maxlength) {\r\n                    var nextInput = event.srcElement.nextElementSibling; // get the sibling element\r\n                    console.log('nextInput', nextInput);\r\n                    var target = event.target || event.srcElement;\r\n                    console.log('target', target);\r\n                    console.log('targetvalue', target.value);\r\n                    console.log('targettype', target.nodeType);\r\n                    if (target.value.length < maxlength) {\r\n                        return;\r\n                    }\r\n                    if (nextInput == null)  // check the maxLength from here\r\n                        return;\r\n                    else\r\n                        nextInput.focus();   // focus if not null\r\n                }\r\n                $scope.onError = function () {\r\n                    console.log(\"IMG ERROR\");\r\n                    $scope.objectIcon = \"/assets/avatar/Bentley.png\";\r\n                }\r\n                $scope.loadData = function () {\r\n                    var paramsArrived = getParams;\r\n                    console.log(\"Params arrived: \", paramsArrived);\r\n                    if (paramsArrived) {\r\n                        $scope.typeObj = paramsArrived.type;\r\n                        $scope.objectId = paramsArrived.objectId;\r\n                        $scope.objectName = paramsArrived.objectName;\r\n                        $scope.objectDescription = paramsArrived.objectDescription;\r\n                        $scope.objectIcon = paramsArrived.objectIcon;\r\n                        if (paramsArrived.expectedPrice) {\r\n                            $scope.expectedPrice = paramsArrived.expectedPrice;\r\n                        }\r\n                        if (paramsArrived.questions) {\r\n                            $scope.questions = paramsArrived.questions;\r\n                        }\r\n                        if (paramsArrived.variant) {\r\n                            $scope.variant = paramsArrived.variant;\r\n                        }\r\n                        if (paramsArrived.location) {\r\n                            $scope.location = paramsArrived.location;\r\n                            if($scope.location == \"zoom\"){\r\n                                $scope.virtualMeeting = \"virtual\";\r\n                            }\r\n                        }\r\n                        if (paramsArrived.product_variant_id) {\r\n                            $scope.product_variant_id = paramsArrived.product_variant_id;\r\n                        }\r\n                        if (paramsArrived.item_id) {\r\n                            $scope.item_id = paramsArrived.item_id;\r\n                        }\r\n                        if (paramsArrived.quantity) {\r\n                            $scope.quantity = paramsArrived.quantity;\r\n                        }\r\n                        if (paramsArrived.booking) {\r\n                            $scope.bookingObj = paramsArrived.booking;\r\n                            $scope.dateSelected = true;\r\n                            $scope.timeSelected = true;\r\n                            var container = {date: $scope.bookingObj.starts_at, status: 'active'};\r\n                            $scope.selectDate(container);\r\n                            $scope.expectedPrice = $scope.bookingObj.price;\r\n                            $scope.atributesCont = $scope.bookingObj.options;\r\n                            if ($scope.atributesCont) {\r\n                                if ($scope.atributesCont.questions) {\r\n                                    $scope.questions = $scope.atributesCont.questions;\r\n                                }\r\n                            }\r\n                            console.log(\"Date\", $scope.bookingObj.starts_at.toISOString());\r\n                            $scope.startDateS = $scope.bookingObj.starts_at.toISOString();\r\n                            $scope.selectStart();\r\n                        }\r\n                        if (paramsArrived.availabilities) {\r\n                            $scope.dateSelected = false;\r\n                            $scope.availabilities = paramsArrived.availabilities;\r\n                            console.log(\"Availabilities\", $scope.availabilities);\r\n                            $scope.getAvailableDates($scope.availabilities);\r\n                            $scope.getDates();\r\n                            console.log(\"Get availableDays\", $scope.availableDays);\r\n                        } else {\r\n                            $scope.getItems();\r\n                        }\r\n                        console.log(\"expectedPrice\", $scope.expectedPrice);\r\n                    } else {\r\n                        $scope.getItems();\r\n                    }\r\n\r\n                    console.log(\"Get availableDays\", $scope.dateSelected);\r\n                }\r\n                $scope.setOrder = function (item) {\r\n                    var dateBase = new Date(\"1970-01-01 00:00:00\");\r\n                    var date = new Date(\"1970-01-01 \" + item.from);\r\n                    var orderAdd = (date.getTime() - dateBase.getTime()) / 1000000;\r\n                    console.log(\"Date: \", orderAdd);\r\n                    if (item.range == 'sunday') {\r\n                        item.order = 0;\r\n                    }\r\n                    if (item.range == 'monday') {\r\n                        item.order = 100;\r\n                    }\r\n                    if (item.range == 'tuesday') {\r\n                        item.order = 200;\r\n                    }\r\n                    if (item.range == 'wednesday') {\r\n                        item.order = 300;\r\n                    }\r\n                    if (item.range == 'thursday') {\r\n                        item.order = 400;\r\n                    }\r\n                    if (item.range == 'friday') {\r\n                        item.order = 500;\r\n                    }\r\n                    if (item.range == 'saturday') {\r\n                        item.order = 600;\r\n                    }\r\n                    item.order += orderAdd;\r\n                    return item;\r\n                }\r\n\r\n                $scope.getItems = function () {\r\n                    var availabilities = [];\r\n                    //        Modals.showLoader();\r\n                    var where = {\"type\": \"Merchant\", \"object_id\": $scope.objectId};\r\n                    Booking.getAvailabilitiesObject(where).then(function (data) {\r\n                        //            Modals.hideLoader();\r\n                        console.log(\"after getItems\", data);\r\n                        var results = data.data;\r\n                        for (var one in results) {\r\n                            results[one] = $scope.setOrder(results[one]);\r\n                            availabilities.push(results[one]);\r\n                        }\r\n                        availabilities.sort(function (a, b) { return (a.order > b.order) ? 1 : -1; });\r\n                        $scope.availabilities = availabilities;\r\n                        console.log(\"Availabilities\", $scope.availabilities);\r\n                        $scope.getAvailableDates($scope.availabilities);\r\n                        $scope.getDates();\r\n                        console.log(\"in get items\", $scope.bookingObj);\r\n                        if ($scope.bookingObj) {\r\n                            var container = {date: $scope.bookingObj.starts_at, status: 'active'};\r\n                            $scope.selectDate(container);\r\n                        }\r\n                        console.log(\"Get availableDays\", $scope.availableDays);\r\n                        console.log(JSON.stringify(data));\r\n                    }, function (data) {\r\n                        //            Modals.hideLoader();\r\n                        // Unable to log in\r\n                        Modals.showToast('BOOKING.ERROR_GET_AVAILABILITIES');\r\n                    });\r\n                }\r\n                $scope.goBack = function () {\r\n                    console.log(\"goBack\", $scope.dateSelected)\r\n                    if ($scope.dateSelected) {\r\n                        $scope.dateSelected = false;\r\n                    } else {\r\n                        $scope.navCtrl.back();\r\n                    }\r\n\r\n                }\r\n                $scope.addBookingToCart = function (booking) {\r\n                    if ($rootScope.items) {\r\n                        var items = $rootScope.items;\r\n                        for (var i in items) {\r\n                            var attrs = items[i].attributes;\r\n                            if (attrs.type == \"Booking\") {\r\n                                if (attrs.id == booking.id) {\r\n                                    Modals.showToast(\"Carrito actualizado\");\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    $scope.addBookingToCartServer(booking);\r\n                }\r\n                $scope.addBookingToCartServer = function (booking) {\r\n                    var extras = {\r\n                        \"type\": \"Booking\",\r\n                        \"id\": booking.id,\r\n                        \"name\": \"Reserva con: \" + booking.bookable.name,\r\n                        \"from\":booking.starts_at\r\n                    }\r\n                    var item = {\r\n                        \"name\": \"Reserva con: \" + booking.bookable.name,\r\n                        \"price\": booking.price,\r\n                        \"quantity\": booking.quantity,\r\n                        \"tax\": 0,\r\n                        \"merchant_id\": $scope.objectId,\r\n                        \"cost\": 0,\r\n                        \"extras\": extras\r\n                    };\r\n                    console.log(\"addBookingToCartServer\",item);\r\n                    if ($scope.product_variant_id) {\r\n                        var container = {\r\n                            product_variant_id: $scope.product_variant_id,\r\n                            quantity: $scope.quantity,\r\n                            item_id: null,\r\n                            merchant_id: $scope.objectId,\r\n                            \"extras\": extras\r\n                        };\r\n                        Cart.postToServer(container).then(function (data) {\r\n                            if(data.status == \"success\"){\r\n                                $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                                $rootScope.cartMessage = \"Carrito actualizado\";\r\n                            } else {\r\n                                $rootScope.cartMessage = data.message;\r\n                            }\r\n                        }, function (data) {\r\n                            console.log(\"Error addCustomCartItem\");\r\n                        });\r\n                    } else if ($scope.item_id) {\r\n                        var container$1 = {\r\n                            quantity: $scope.quantity,\r\n                            item_id: $scope.item_id,\r\n                            merchant_id: $scope.objectId,\r\n                            \"extras\": extras\r\n                        };\r\n                        Cart.updateCartItem(container$1).then(function (data) {\r\n                            if(data.status == \"success\"){\r\n                                $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                                $rootScope.cartMessage = \"Carrito actualizado\";\r\n                            } else {\r\n                                $rootScope.cartMessage = data.message;\r\n                            }\r\n                        }, function (data) {\r\n                            console.log(\"Error addCustomCartItem\");\r\n                        });\r\n                    } else {\r\n                        Cart.addCustomCartItem(item).then(function (data) {\r\n                            if(data.status == \"success\"){\r\n                                $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                                $rootScope.cartMessage = \"Carrito actualizado\";\r\n                            } else {\r\n                                $rootScope.cartMessage = data.message;\r\n                            }\r\n                        }, function (data) {\r\n                            console.log(\"Error addCustomCartItem\");\r\n                        });\r\n                    }\r\n                }\r\n                $scope.selectRadio = function (event) {\r\n                    $scope.virtualMeeting = event.detail.value;\r\n                    console.log(\"Virtual meeting radio \", event);\r\n                    console.log(\"Virtual meeting radio \", $scope.virtualMeeting);\r\n                }\r\n                $scope.createBooking = function () {\r\n                    if ($scope.submitted) {\r\n                        return true;\r\n                    }\r\n                    $scope.submitted = true;\r\n                    //Modals.showLoader();\r\n                    var startDate = new Date($scope.startDate.getTime() - $scope.startDate.getTimezoneOffset() * 60000);\r\n                    var strDate = startDate.toISOString();\r\n                    var endDate = new Date($scope.endDate.getTime() - $scope.endDate.getTimezoneOffset() * 60000);\r\n                    var ndDate = endDate.toISOString();\r\n                    var virtual = false;\r\n                    console.log(\"Virtual meeting\", $scope.virtualMeeting);\r\n                    if ($scope.virtualMeeting == 'virtual') {\r\n                        virtual = true;\r\n                        $scope.atributesCont.virtual_provider = \"zoom\";\r\n                        $scope.atributesCont.virtual_meeting = true;\r\n                    }\r\n                    var data = {\r\n                        \"type\": $scope.typeObj,\r\n                        \"object_id\": $scope.objectId,\r\n                        \"from\": strDate,\r\n                        \"to\": ndDate,\r\n                        \"attributes\": $scope.atributesCont,\r\n                        \"virtual_meeting\": virtual\r\n                    };\r\n                    console.log(\"Start\", $scope.startDate);\r\n                    console.log(\"data\", data);\r\n                    Booking.addBookingObject(data).then(function (resp) {\r\n                        Modals.hideLoader();\r\n                        console.log(\"addBookingObject\", resp);\r\n                        $scope.submitted = false;\r\n                        //$scope.presentAlertConfirm(data);\r\n                        if (resp.status == \"success\") {\r\n                            if (resp.requires_auth) {\r\n                                $scope.presentAlertConfirm($scope.requiresAuth);\r\n                            } else {\r\n                                $scope.addBookingToCart(resp.booking);\r\n                            }\r\n                        } else {\r\n                            $scope.showAlertTranslation(\"BOOKING.\" + resp.message);\r\n                        }\r\n                    }, function (data) {\r\n                        $scope.submitted = false;\r\n                        console.log(\"Error addBookingObject\");\r\n                        Modals.hideLoader();\r\n                    });\r\n                }\r\n                $scope.saveOrCreateBooking = function () {\r\n                    $scope.atributesCont.questions = $scope.questions;\r\n                    if ($scope.bookingObj) {\r\n                        $scope.editBooking()\r\n                    } else {\r\n                        $scope.createBooking();\r\n                    }\r\n                }\r\n                $scope.editBooking = function () {\r\n                    //        if ($scope.submitted) {\r\n                    //            return true;\r\n                    //        }\r\n                    //        $scope.submitted = true; \r\n                    Modals.showLoader();\r\n                    console.log(\"offset\", $scope.startDate.getTimezoneOffset() * 60000);\r\n                    var startDate = new Date($scope.startDate.getTime() - $scope.startDate.getTimezoneOffset() * 60000);\r\n                    var strDate = startDate.toISOString();\r\n                    var endDate = new Date($scope.endDate.getTime() - $scope.endDate.getTimezoneOffset() * 60000);\r\n                    var ndDate = endDate.toISOString();\r\n                    var virtual = false;\r\n                    console.log(\"Virtual meeting\", $scope.virtualMeeting);\r\n                    if ($scope.virtualMeeting == 'virtual') {\r\n                        virtual = true;\r\n                        $scope.atributesCont.virtual_provider = \"zoom\";\r\n                        $scope.atributesCont.virtual_meeting = true;\r\n                    }\r\n                    var data = {\r\n                        \"booking_id\": $scope.bookingObj.id,\r\n                        \"type\": $scope.typeObj,\r\n                        \"object_id\": $scope.objectId,\r\n                        \"from\": strDate,\r\n                        \"to\": ndDate,\r\n                        \"attributes\": $scope.atributesCont\r\n                    };\r\n                    console.log(\"Start\", $scope.startDate);\r\n                    console.log(\"data\", data);\r\n                    Booking.editBookingObject(data).then(function (resp) {\r\n                        Modals.hideLoader();\r\n                        console.log(\"editBookingObject\", resp);\r\n                        $scope.submitted = false;\r\n                        //$scope.presentAlertConfirm(data);\r\n                        if (resp.status == \"success\") {\r\n                            var container = $scope.params.getParams();\r\n                            container.booking = new Booking(resp.booking);\r\n                            $scope.params.setParams(container);\r\n                            $scope.navCtrl.back();\r\n                        } else {\r\n                            $scope.showAlertTranslation(\"BOOKING.\" + resp.message);\r\n                        }\r\n                    }, function (data) {\r\n                        console.log(\"Error editBookingObject\");\r\n                        Modals.hideLoader();\r\n                    });\r\n                }\r\n\r\n                $scope.showAlertTranslation = function (alert) {\r\n                    Modals.showToast(alert);\r\n                }\r\n\r\n                $scope.presentAlertConfirm = function (message) {\r\n                    console.log(\"Present alert\", message);\r\n//        let button = {\r\n//            text: 'Ok',\r\n//            handler: () => {\r\n//                console.log('Confirm Okay');\r\n//                if (message == $scope.requiresAuth) {\r\n//                    $scope.navCtrl.back();\r\n//                }\r\n//            }\r\n//        }\r\n//        const alert = await $scope.alertsCtrl.create({\r\n//            message: message,\r\n//            buttons: [\r\n//                button\r\n//            ]\r\n//        });\r\n//        await alert.present();\r\n                }\r\n\r\n                $scope.getAvailableDates = function (availabilities) {\r\n                    for (var item in availabilities) {\r\n                        var container = availabilities[item];\r\n                        if (!$scope.checkAvailableDays(container.range)) {\r\n                            $scope.availableDays.push(container.range);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $scope.checkAvailableDays = function (day) {\r\n                    for (var item in $scope.availableDays) {\r\n                        if ($scope.availableDays[item] == day) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                    return false;\r\n                }\r\n\r\n                $scope.getDates = function () {\r\n                    console.log(\"Get dates\");\r\n                    var myDate = new Date();\r\n                    if($scope.variant &&$scope.variant.is_shippable){\r\n                        myDate.setDate(myDate.getDate() + 1);\r\n                    }\r\n                    var month = myDate.getMonth();\r\n                    var monthcont = {month: month, days: [], title: Booking.getMonthName(month)};\r\n                    for (var i = 0; i < 61; i++) {\r\n                        var day = myDate.getDay();\r\n                        var container = {date: new Date(myDate.getTime()), status: \"closed\"};\r\n                        if ($scope.checkAvailableDays($scope.weekday[day])) {\r\n                            container.status = \"active\"\r\n                        }\r\n\r\n                        if (myDate.getMonth() != monthcont.month) {\r\n                            $scope.months.push(monthcont);\r\n                            var month$1 = myDate.getMonth();\r\n                            monthcont = {month: month$1, days: [], title: Booking.getMonthName(month$1)};\r\n                        }\r\n                        monthcont.days.push(container);\r\n                        $scope.availableDates.push(container);\r\n                        myDate.setDate(myDate.getDate() + 1);\r\n                    }\r\n                    console.log(\"Get dates months\", $scope.months);\r\n                }\r\n                $scope.returnDates = function () {\r\n                    $scope.dateSelected = false;\r\n                }\r\n                $scope.selectStart = function () {\r\n                    $scope.startDate = new Date($scope.startDateS);\r\n                    $scope.endDate = new Date($scope.startDate.getTime() + (parseInt($scope.amount) * 50) * 60000);\r\n                    $scope.timeSelected = true;\r\n                }\r\n                $scope.filterAvailabilities = function (day) {\r\n                    $scope.availabilitiesDate = [];\r\n                    for (var item in $scope.availabilities) {\r\n                        if ($scope.availabilities[item].range == $scope.weekday[day]) {\r\n                            $scope.availabilitiesDate.push(($scope.availabilities[item]));\r\n                        }\r\n                    }\r\n                }\r\n                $scope.selectSlot = function (item) {\r\n                    $scope.startDate = item.start;\r\n                    $scope.endDate = $scope.addMinutes(item.end, -5);\r\n                    $scope.timeSelected = true;\r\n                }\r\n                $scope.getBookingsDay = function (selectedDate) {\r\n                    var strDate = selectedDate.getFullYear() + \"-\" + (selectedDate.getMonth() + 1) + \"-\" + selectedDate.getDate();\r\n                    var params = {\r\n                        \"from\": strDate,\r\n                        \"query\": \"day\",\r\n                        \"type\": $scope.typeObj,\r\n                        \"object_id\": $scope.objectId,\r\n                    };\r\n                    Booking.getBookingsObject(params).then(function (data) {\r\n                        console.log(\"getBookingsObject\", data);\r\n                        var results = data.data;\r\n                        for (var i in results) {\r\n                            var bookitem = new Booking(results[i]);\r\n                            $scope.selectedSpots.push(bookitem);\r\n                        }\r\n                        $scope.buildSlots();\r\n                    }, function (data) {\r\n                        console.log(\"Error getBookingsObject\");\r\n                    });\r\n                }\r\n\r\n                $scope.selectDate = function (item) {\r\n                    if (item.status == 'active') {\r\n                        var selectedDate = item.date;\r\n                        var day = selectedDate.getDay();\r\n                        $scope.dateSelected = true;\r\n                        $scope.timeSelected = false;\r\n                        console.log(\"select date\", selectedDate);\r\n//                        Modals.showLoader();\r\n                        $scope.dayName = $scope.weekday2[day];\r\n                        $scope.startDate = selectedDate;\r\n                        $scope.startDateS = selectedDate.toISOString();\r\n                        Modals.showToast('Buscando horarios disponibles');\r\n                        $scope.filterAvailabilities(day);\r\n                        $scope.getBookingsDay(selectedDate);\r\n                        console.log(\"Availabilities\", $scope.availabilitiesDate);\r\n                    } else {\r\n                        Modals.showToast('BOOKING.NOT_AVAILABLE');\r\n                    }\r\n\r\n                }\r\n                $scope.addMinutes = function (date, minutes) {\r\n                    return new Date(date.getTime() + minutes * 60000);\r\n                }\r\n                $scope.buildSlots = function () {\r\n                    $scope.appointmentOptions = [];\r\n                    var appointmentLength = 30;\r\n                    if($scope.variant &&$scope.variant.is_shippable){\r\n                        appointmentLength = 60;\r\n                    }\r\n                    var current = new Date();\r\n                    current = $scope.addMinutes(current, appointmentLength)\r\n                    for (var item in $scope.availabilitiesDate) {\r\n                        var container = $scope.availabilitiesDate[item];\r\n                        var open = true;\r\n                        console.log(\"Building date \" + $scope.startDate.getFullYear() + \"/\" + ($scope.startDate.getMonth() + 1) + \"/\" + $scope.startDate.getDate() + \" \" + container.from.replace(\" \", \":00 \"))\r\n                        var start = new Date($scope.startDate.getFullYear() + \"/\" + ($scope.startDate.getMonth() + 1) + \"/\" + $scope.startDate.getDate() + \" \" + container.from.replace(\" \", \":00 \"));\r\n                        var end = new Date($scope.startDate.getFullYear() + \"/\" + ($scope.startDate.getMonth() + 1) + \"/\" + $scope.startDate.getDate() + \" \" + container.to.replace(\" \", \":00 \"));\r\n                        while (open) {\r\n                            var endApp = $scope.addMinutes(start, appointmentLength);\r\n                            if (endApp <= end) {\r\n                                var containerSlot = {start: start, end: endApp};\r\n                                if (start > current) {\r\n                                    if (!$scope.checkFilledDate(containerSlot)) {\r\n                                        $scope.appointmentOptions.push(containerSlot);\r\n                                    }\r\n                                }\r\n                                start = $scope.addMinutes(start, appointmentLength)\r\n                            } else {\r\n                                open = false;\r\n                            }\r\n                        }\r\n                    }\r\n                    if ($scope.bookingObj) {\r\n                        console.log(\"Loaded booking obj\", $scope.bookingObj);\r\n                        var container$1 = {start: $scope.bookingObj.starts_at, end: $scope.bookingObj.ends_at}\r\n                        $scope.selectSlot(container$1);\r\n                    }\r\n                }\r\n                $scope.checkFilledDate = function (container) {\r\n                    for (var item in $scope.selectedSpots) {\r\n                        var checking = $scope.selectedSpots[item];\r\n                        console.log(\"Test\")\r\n                        console.log(\"comparing: \", container.start.getTime(), \" \", container.end.getTime())\r\n                        console.log(\"comparing: \", checking.starts_at.getTime(), \" \", checking.ends_at.getTime())\r\n                        console.log(\"difference: \", container.start.getTime() - checking.starts_at.getTime(), \" \", container.end.getTime() - checking.ends_at.getTime())\r\n                        if ((container.start.getTime() == checking.starts_at.getTime()) ||\r\n                                (container.start.getTime() > checking.starts_at.getTime() && container.start.getTime() < checking.ends_at.getTime()) ||\r\n                                (container.start.getTime() < checking.starts_at.getTime() && container.end.getTime() > checking.starts_at.getTime())) {\r\n                            console.log(\"True\");\r\n                            return true;\r\n                        }\r\n                    }\r\n                    return false;\r\n\r\n                }\r\n                $scope.changeDate = function () {\r\n                    $scope.dateSelected = false;\r\n                    $scope.timeSelected = false;\r\n                }\r\n                $scope.changeTime = function () {\r\n                    $scope.timeSelected = false;\r\n                }\r\n                $scope.constructor();\r\n                $scope.ngOnInit();\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2Jvb2tpbmdjdHJsLmpzP2QwMDYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXHJcblxyXG4gICAgICAgIC5jb250cm9sbGVyKCdCb29raW5nQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnZ2V0UGFyYW1zJywgJ0Jvb2tpbmcnLCAnTW9kYWxzJywgJ0NhcnQnLCckbWREaWFsb2cnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBnZXRQYXJhbXMsIEJvb2tpbmcsIE1vZGFscywgQ2FydCwkbWREaWFsb2cpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFibGVEYXlzID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmxlRGF0ZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFNwb3RzID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucXVlc3Rpb25zID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVldGluZ1R5cGU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudmFyaWFudDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFiaWxpdGllcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFwcG9pbnRtZW50T3B0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5ld1Zpc2l0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRlU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS52aXJ0dWFsTWVldGluZyA9ICdwaHlzaWNhbCc7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudGltZVNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmlsaXRpZXNEYXRlID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkyID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudHlwZU9iajtcclxuICAgICAgICAgICAgICAgICRzY29wZS5ib29raW5nT2JqID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXF1aXJlc0F1dGg7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF5TmFtZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RfdmFyaWFudF9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbV9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucXVhbnRpdHkgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvY2F0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3RJZDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3ROYW1lO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9iamVjdERlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9iamVjdEljb247XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnREYXRlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmVuZERhdGU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnREYXRlUztcclxuICAgICAgICAgICAgICAgICRzY29wZS5leHBlY3RlZFByaWNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZUJvb2tpbmc7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW1vdW50ID0gXCIxXCI7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29uc3RydWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkgPSBuZXcgQXJyYXkoNyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXlbMF0gPSBcInN1bmRheVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5WzFdID0gXCJtb25kYXlcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheVsyXSA9IFwidHVlc2RheVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5WzNdID0gXCJ3ZWRuZXNkYXlcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheVs0XSA9IFwidGh1cnNkYXlcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheVs1XSA9IFwiZnJpZGF5XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXlbNl0gPSBcInNhdHVyZGF5XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkyID0gbmV3IEFycmF5KDcpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5MlswXSA9IFwiRG9taW5nb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5MlsxXSA9IFwiTHVuZXNcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbMl0gPSBcIk1hcnRlc1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5MlszXSA9IFwiTWllcmNvbGVzXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkyWzRdID0gXCJKdWV2ZXNcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbNV0gPSBcIlZpZXJuZXNcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbNl0gPSBcIlNhYmFkb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbnMgPSBbXVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBhdmFpbGFibGVEYXRlc1wiLCAkc2NvcGUuYXZhaWxhYmxlRGF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5nT25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmtleXRhYiA9IGZ1bmN0aW9uIChldmVudCwgbWF4bGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRJbnB1dCA9IGV2ZW50LnNyY0VsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nOyAvLyBnZXQgdGhlIHNpYmxpbmcgZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCduZXh0SW5wdXQnLCBuZXh0SW5wdXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQgfHwgZXZlbnQuc3JjRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndGFyZ2V0JywgdGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndGFyZ2V0dmFsdWUnLCB0YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXR0eXBlJywgdGFyZ2V0Lm5vZGVUeXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LnZhbHVlLmxlbmd0aCA8IG1heGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0SW5wdXQgPT0gbnVsbCkgIC8vIGNoZWNrIHRoZSBtYXhMZW5ndGggZnJvbSBoZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRJbnB1dC5mb2N1cygpOyAgIC8vIGZvY3VzIGlmIG5vdCBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub25FcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIklNRyBFUlJPUlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0SWNvbiA9IFwiL2Fzc2V0cy9hdmF0YXIvQmVudGxleS5wbmdcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zQXJyaXZlZCA9IGdldFBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBhcmFtcyBhcnJpdmVkOiBcIiwgcGFyYW1zQXJyaXZlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnR5cGVPYmogPSBwYXJhbXNBcnJpdmVkLnR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3RJZCA9IHBhcmFtc0Fycml2ZWQub2JqZWN0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3ROYW1lID0gcGFyYW1zQXJyaXZlZC5vYmplY3ROYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0RGVzY3JpcHRpb24gPSBwYXJhbXNBcnJpdmVkLm9iamVjdERlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0SWNvbiA9IHBhcmFtc0Fycml2ZWQub2JqZWN0SWNvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQuZXhwZWN0ZWRQcmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmV4cGVjdGVkUHJpY2UgPSBwYXJhbXNBcnJpdmVkLmV4cGVjdGVkUHJpY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQucXVlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlc3Rpb25zID0gcGFyYW1zQXJyaXZlZC5xdWVzdGlvbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQudmFyaWFudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZhcmlhbnQgPSBwYXJhbXNBcnJpdmVkLnZhcmlhbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQubG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2NhdGlvbiA9IHBhcmFtc0Fycml2ZWQubG9jYXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUubG9jYXRpb24gPT0gXCJ6b29tXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS52aXJ0dWFsTWVldGluZyA9IFwidmlydHVhbFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLnByb2R1Y3RfdmFyaWFudF9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RfdmFyaWFudF9pZCA9IHBhcmFtc0Fycml2ZWQucHJvZHVjdF92YXJpYW50X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLml0ZW1faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtX2lkID0gcGFyYW1zQXJyaXZlZC5pdGVtX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLnF1YW50aXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVhbnRpdHkgPSBwYXJhbXNBcnJpdmVkLnF1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLmJvb2tpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ib29raW5nT2JqID0gcGFyYW1zQXJyaXZlZC5ib29raW5nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGltZVNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7ZGF0ZTogJHNjb3BlLmJvb2tpbmdPYmouc3RhcnRzX2F0LCBzdGF0dXM6ICdhY3RpdmUnfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3REYXRlKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhwZWN0ZWRQcmljZSA9ICRzY29wZS5ib29raW5nT2JqLnByaWNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmF0cmlidXRlc0NvbnQgPSAkc2NvcGUuYm9va2luZ09iai5vcHRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hdHJpYnV0ZXNDb250KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hdHJpYnV0ZXNDb250LnF1ZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlc3Rpb25zID0gJHNjb3BlLmF0cmlidXRlc0NvbnQucXVlc3Rpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZVwiLCAkc2NvcGUuYm9va2luZ09iai5zdGFydHNfYXQudG9JU09TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnREYXRlUyA9ICRzY29wZS5ib29raW5nT2JqLnN0YXJ0c19hdC50b0lTT1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFN0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQuYXZhaWxhYmlsaXRpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRlU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFiaWxpdGllcyA9IHBhcmFtc0Fycml2ZWQuYXZhaWxhYmlsaXRpZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkF2YWlsYWJpbGl0aWVzXCIsICRzY29wZS5hdmFpbGFiaWxpdGllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QXZhaWxhYmxlRGF0ZXMoJHNjb3BlLmF2YWlsYWJpbGl0aWVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXREYXRlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgYXZhaWxhYmxlRGF5c1wiLCAkc2NvcGUuYXZhaWxhYmxlRGF5cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImV4cGVjdGVkUHJpY2VcIiwgJHNjb3BlLmV4cGVjdGVkUHJpY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgYXZhaWxhYmxlRGF5c1wiLCAkc2NvcGUuZGF0ZVNlbGVjdGVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZXRPcmRlciA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVCYXNlID0gbmV3IERhdGUoXCIxOTcwLTAxLTAxIDAwOjAwOjAwXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoXCIxOTcwLTAxLTAxIFwiICsgaXRlbS5mcm9tKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgb3JkZXJBZGQgPSAoZGF0ZS5nZXRUaW1lKCkgLSBkYXRlQmFzZS5nZXRUaW1lKCkpIC8gMTAwMDAwMDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGU6IFwiLCBvcmRlckFkZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmFuZ2UgPT0gJ3N1bmRheScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5vcmRlciA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJhbmdlID09ICdtb25kYXknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub3JkZXIgPSAxMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJhbmdlID09ICd0dWVzZGF5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9yZGVyID0gMjAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5yYW5nZSA9PSAnd2VkbmVzZGF5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9yZGVyID0gMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5yYW5nZSA9PSAndGh1cnNkYXknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub3JkZXIgPSA0MDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJhbmdlID09ICdmcmlkYXknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub3JkZXIgPSA1MDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJhbmdlID09ICdzYXR1cmRheScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5vcmRlciA9IDYwMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vcmRlciArPSBvcmRlckFkZDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGF2YWlsYWJpbGl0aWVzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHdoZXJlID0ge1widHlwZVwiOiBcIk1lcmNoYW50XCIsIFwib2JqZWN0X2lkXCI6ICRzY29wZS5vYmplY3RJZH07XHJcbiAgICAgICAgICAgICAgICAgICAgQm9va2luZy5nZXRBdmFpbGFiaWxpdGllc09iamVjdCh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWZ0ZXIgZ2V0SXRlbXNcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBvbmUgaW4gcmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1tvbmVdID0gJHNjb3BlLnNldE9yZGVyKHJlc3VsdHNbb25lXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFiaWxpdGllcy5wdXNoKHJlc3VsdHNbb25lXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmlsaXRpZXMuc29ydCgoYSwgYikgPT4gKGEub3JkZXIgPiBiLm9yZGVyKSA/IDEgOiAtMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFiaWxpdGllcyA9IGF2YWlsYWJpbGl0aWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkF2YWlsYWJpbGl0aWVzXCIsICRzY29wZS5hdmFpbGFiaWxpdGllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBdmFpbGFibGVEYXRlcygkc2NvcGUuYXZhaWxhYmlsaXRpZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RGF0ZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbiBnZXQgaXRlbXNcIiwgJHNjb3BlLmJvb2tpbmdPYmopO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmJvb2tpbmdPYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7ZGF0ZTogJHNjb3BlLmJvb2tpbmdPYmouc3RhcnRzX2F0LCBzdGF0dXM6ICdhY3RpdmUnfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3REYXRlKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgYXZhaWxhYmxlRGF5c1wiLCAkc2NvcGUuYXZhaWxhYmxlRGF5cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVuYWJsZSB0byBsb2cgaW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdCgnQk9PS0lORy5FUlJPUl9HRVRfQVZBSUxBQklMSVRJRVMnKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5nb0JhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJnb0JhY2tcIiwgJHNjb3BlLmRhdGVTZWxlY3RlZClcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGVTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZVNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5hdkN0cmwuYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQm9va2luZ1RvQ2FydCA9IGZ1bmN0aW9uIChib29raW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW1zID0gJHJvb3RTY29wZS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiBpdGVtcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJzID0gaXRlbXNbaV0uYXR0cmlidXRlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRycy50eXBlID09IFwiQm9va2luZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLmlkID09IGJvb2tpbmcuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkNhcnJpdG8gYWN0dWFsaXphZG9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZEJvb2tpbmdUb0NhcnRTZXJ2ZXIoYm9va2luZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQm9va2luZ1RvQ2FydFNlcnZlciA9IGZ1bmN0aW9uIChib29raW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGV4dHJhcyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiQm9va2luZ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IGJvb2tpbmcuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlJlc2VydmEgY29uOiBcIiArIGJvb2tpbmcuYm9va2FibGUubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcm9tXCI6Ym9va2luZy5zdGFydHNfYXRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlJlc2VydmEgY29uOiBcIiArIGJvb2tpbmcuYm9va2FibGUubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmljZVwiOiBib29raW5nLnByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IGJvb2tpbmcucXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGF4XCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVyY2hhbnRfaWRcIjogJHNjb3BlLm9iamVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvc3RcIjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogZXh0cmFzXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFkZEJvb2tpbmdUb0NhcnRTZXJ2ZXJcIixpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnByb2R1Y3RfdmFyaWFudF9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF92YXJpYW50X2lkOiAkc2NvcGUucHJvZHVjdF92YXJpYW50X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6ICRzY29wZS5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogJHNjb3BlLm9iamVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogZXh0cmFzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQucG9zdFRvU2VydmVyKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNhcnRNZXNzYWdlID0gXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY2FydE1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGFkZEN1c3RvbUNhcnRJdGVtXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5pdGVtX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogJHNjb3BlLnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogJHNjb3BlLml0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogJHNjb3BlLm9iamVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogZXh0cmFzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQudXBkYXRlQ2FydEl0ZW0oY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY2FydE1lc3NhZ2UgPSBcIkNhcnJpdG8gYWN0dWFsaXphZG9cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jYXJ0TWVzc2FnZSA9IGRhdGEubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgYWRkQ3VzdG9tQ2FydEl0ZW1cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuYWRkQ3VzdG9tQ2FydEl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNhcnRNZXNzYWdlID0gXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY2FydE1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGFkZEN1c3RvbUNhcnRJdGVtXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UmFkaW8gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudmlydHVhbE1lZXRpbmcgPSBldmVudC5kZXRhaWwudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJWaXJ0dWFsIG1lZXRpbmcgcmFkaW8gXCIsIGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlZpcnR1YWwgbWVldGluZyByYWRpbyBcIiwgJHNjb3BlLnZpcnR1YWxNZWV0aW5nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVCb29raW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3VibWl0dGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvL01vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5zdGFydERhdGUuZ2V0VGltZSgpIC0gJHNjb3BlLnN0YXJ0RGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdHJEYXRlID0gc3RhcnREYXRlLnRvSVNPU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZERhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuZW5kRGF0ZS5nZXRUaW1lKCkgLSAkc2NvcGUuZW5kRGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuZERhdGUgPSBlbmREYXRlLnRvSVNPU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZpcnR1YWwgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlZpcnR1YWwgbWVldGluZ1wiLCAkc2NvcGUudmlydHVhbE1lZXRpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudmlydHVhbE1lZXRpbmcgPT0gJ3ZpcnR1YWwnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpcnR1YWwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXRyaWJ1dGVzQ29udC52aXJ0dWFsX3Byb3ZpZGVyID0gXCJ6b29tXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250LnZpcnR1YWxfbWVldGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnR5cGVPYmosXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0X2lkXCI6ICRzY29wZS5vYmplY3RJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcm9tXCI6IHN0ckRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9cIjogbmREYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImF0dHJpYnV0ZXNcIjogJHNjb3BlLmF0cmlidXRlc0NvbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmlydHVhbF9tZWV0aW5nXCI6IHZpcnR1YWxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRcIiwgJHNjb3BlLnN0YXJ0RGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkYXRhXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIEJvb2tpbmcuYWRkQm9va2luZ09iamVjdChkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWRkQm9va2luZ09iamVjdFwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5wcmVzZW50QWxlcnRDb25maXJtKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnJlcXVpcmVzX2F1dGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJlc2VudEFsZXJ0Q29uZmlybSgkc2NvcGUucmVxdWlyZXNBdXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZEJvb2tpbmdUb0NhcnQocmVzcC5ib29raW5nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWxlcnRUcmFuc2xhdGlvbihcIkJPT0tJTkcuXCIgKyByZXNwLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGFkZEJvb2tpbmdPYmplY3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZU9yQ3JlYXRlQm9va2luZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXRyaWJ1dGVzQ29udC5xdWVzdGlvbnMgPSAkc2NvcGUucXVlc3Rpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYm9va2luZ09iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdEJvb2tpbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVCb29raW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRCb29raW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICBpZiAoJHNjb3BlLnN1Ym1pdHRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7IFxyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJvZmZzZXRcIiwgJHNjb3BlLnN0YXJ0RGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydERhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuc3RhcnREYXRlLmdldFRpbWUoKSAtICRzY29wZS5zdGFydERhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyRGF0ZSA9IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBlbmREYXRlID0gbmV3IERhdGUoJHNjb3BlLmVuZERhdGUuZ2V0VGltZSgpIC0gJHNjb3BlLmVuZERhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbmREYXRlID0gZW5kRGF0ZS50b0lTT1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB2aXJ0dWFsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJWaXJ0dWFsIG1lZXRpbmdcIiwgJHNjb3BlLnZpcnR1YWxNZWV0aW5nKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnZpcnR1YWxNZWV0aW5nID09ICd2aXJ0dWFsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmF0cmlidXRlc0NvbnQudmlydHVhbF9wcm92aWRlciA9IFwiem9vbVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXRyaWJ1dGVzQ29udC52aXJ0dWFsX21lZXRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJib29raW5nX2lkXCI6ICRzY29wZS5ib29raW5nT2JqLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnR5cGVPYmosXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0X2lkXCI6ICRzY29wZS5vYmplY3RJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcm9tXCI6IHN0ckRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9cIjogbmREYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImF0dHJpYnV0ZXNcIjogJHNjb3BlLmF0cmlidXRlc0NvbnRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRcIiwgJHNjb3BlLnN0YXJ0RGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkYXRhXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIEJvb2tpbmcuZWRpdEJvb2tpbmdPYmplY3QoZGF0YSkudGhlbihmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVkaXRCb29raW5nT2JqZWN0XCIsIHJlc3ApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLnByZXNlbnRBbGVydENvbmZpcm0oZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9ICRzY29wZS5wYXJhbXMuZ2V0UGFyYW1zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYm9va2luZyA9IG5ldyBCb29raW5nKHJlc3AuYm9va2luZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLnNldFBhcmFtcyhjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5hdkN0cmwuYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBbGVydFRyYW5zbGF0aW9uKFwiQk9PS0lORy5cIiArIHJlc3AubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGVkaXRCb29raW5nT2JqZWN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWxlcnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uIChhbGVydCkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoYWxlcnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5wcmVzZW50QWxlcnRDb25maXJtID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlByZXNlbnQgYWxlcnRcIiwgbWVzc2FnZSk7XHJcbi8vICAgICAgICBsZXQgYnV0dG9uID0ge1xyXG4vLyAgICAgICAgICAgIHRleHQ6ICdPaycsXHJcbi8vICAgICAgICAgICAgaGFuZGxlcjogKCkgPT4ge1xyXG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ29uZmlybSBPa2F5Jyk7XHJcbi8vICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlID09ICRzY29wZS5yZXF1aXJlc0F1dGgpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICRzY29wZS5uYXZDdHJsLmJhY2soKTtcclxuLy8gICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgIH1cclxuLy8gICAgICAgIH1cclxuLy8gICAgICAgIGNvbnN0IGFsZXJ0ID0gYXdhaXQgJHNjb3BlLmFsZXJ0c0N0cmwuY3JlYXRlKHtcclxuLy8gICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxyXG4vLyAgICAgICAgICAgIGJ1dHRvbnM6IFtcclxuLy8gICAgICAgICAgICAgICAgYnV0dG9uXHJcbi8vICAgICAgICAgICAgXVxyXG4vLyAgICAgICAgfSk7XHJcbi8vICAgICAgICBhd2FpdCBhbGVydC5wcmVzZW50KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEF2YWlsYWJsZURhdGVzID0gZnVuY3Rpb24gKGF2YWlsYWJpbGl0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiBhdmFpbGFiaWxpdGllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gYXZhaWxhYmlsaXRpZXNbaXRlbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLmNoZWNrQXZhaWxhYmxlRGF5cyhjb250YWluZXIucmFuZ2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmxlRGF5cy5wdXNoKGNvbnRhaW5lci5yYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrQXZhaWxhYmxlRGF5cyA9IGZ1bmN0aW9uIChkYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRzY29wZS5hdmFpbGFibGVEYXlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXZhaWxhYmxlRGF5c1tpdGVtXSA9PSBkYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RGF0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgZGF0ZXNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG15RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLnZhcmlhbnQgJiYkc2NvcGUudmFyaWFudC5pc19zaGlwcGFibGUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBteURhdGUuc2V0RGF0ZShteURhdGUuZ2V0RGF0ZSgpICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBtb250aCA9IG15RGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBtb250aGNvbnQgPSB7bW9udGg6IG1vbnRoLCBkYXlzOiBbXSwgdGl0bGU6IEJvb2tpbmcuZ2V0TW9udGhOYW1lKG1vbnRoKX07XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2MTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXkgPSBteURhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7ZGF0ZTogbmV3IERhdGUobXlEYXRlLmdldFRpbWUoKSksIHN0YXR1czogXCJjbG9zZWRcIn07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2hlY2tBdmFpbGFibGVEYXlzKCRzY29wZS53ZWVrZGF5W2RheV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc3RhdHVzID0gXCJhY3RpdmVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXlEYXRlLmdldE1vbnRoKCkgIT0gbW9udGhjb250Lm1vbnRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2gobW9udGhjb250KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtb250aCA9IG15RGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGhjb250ID0ge21vbnRoOiBtb250aCwgZGF5czogW10sIHRpdGxlOiBCb29raW5nLmdldE1vbnRoTmFtZShtb250aCl9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoY29udC5kYXlzLnB1c2goY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmF2YWlsYWJsZURhdGVzLnB1c2goY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXlEYXRlLnNldERhdGUobXlEYXRlLmdldERhdGUoKSArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlcyBtb250aHNcIiwgJHNjb3BlLm1vbnRocyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmV0dXJuRGF0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuc3RhcnREYXRlUyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVuZERhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuc3RhcnREYXRlLmdldFRpbWUoKSArIChwYXJzZUludCgkc2NvcGUuYW1vdW50KSAqIDUwKSAqIDYwMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGltZVNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJBdmFpbGFiaWxpdGllcyA9IGZ1bmN0aW9uIChkYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmlsaXRpZXNEYXRlID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuYXZhaWxhYmlsaXRpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hdmFpbGFiaWxpdGllc1tpdGVtXS5yYW5nZSA9PSAkc2NvcGUud2Vla2RheVtkYXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmlsaXRpZXNEYXRlLnB1c2goKCRzY29wZS5hdmFpbGFiaWxpdGllc1tpdGVtXSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFNsb3QgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGUgPSBpdGVtLnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lbmREYXRlID0gJHNjb3BlLmFkZE1pbnV0ZXMoaXRlbS5lbmQsIC01KTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGltZVNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRCb29raW5nc0RheSA9IGZ1bmN0aW9uIChzZWxlY3RlZERhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyRGF0ZSA9IHNlbGVjdGVkRGF0ZS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyAoc2VsZWN0ZWREYXRlLmdldE1vbnRoKCkgKyAxKSArIFwiLVwiICsgc2VsZWN0ZWREYXRlLmdldERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyb21cIjogc3RyRGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJxdWVyeVwiOiBcImRheVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnR5cGVPYmosXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0X2lkXCI6ICRzY29wZS5vYmplY3RJZCxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIEJvb2tpbmcuZ2V0Qm9va2luZ3NPYmplY3QocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0Qm9va2luZ3NPYmplY3RcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIHJlc3VsdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBib29raXRlbSA9IG5ldyBCb29raW5nKHJlc3VsdHNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkU3BvdHMucHVzaChib29raXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkU2xvdHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGdldEJvb2tpbmdzT2JqZWN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3REYXRlID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5zdGF0dXMgPT0gJ2FjdGl2ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkRGF0ZSA9IGl0ZW0uZGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRheSA9IHNlbGVjdGVkRGF0ZS5nZXREYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50aW1lU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzZWxlY3QgZGF0ZVwiLCBzZWxlY3RlZERhdGUpO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXlOYW1lID0gJHNjb3BlLndlZWtkYXkyW2RheV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGUgPSBzZWxlY3RlZERhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGVTID0gc2VsZWN0ZWREYXRlLnRvSVNPU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoJ0J1c2NhbmRvIGhvcmFyaW9zIGRpc3BvbmlibGVzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJBdmFpbGFiaWxpdGllcyhkYXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Qm9va2luZ3NEYXkoc2VsZWN0ZWREYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBdmFpbGFiaWxpdGllc1wiLCAkc2NvcGUuYXZhaWxhYmlsaXRpZXNEYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KCdCT09LSU5HLk5PVF9BVkFJTEFCTEUnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZE1pbnV0ZXMgPSBmdW5jdGlvbiAoZGF0ZSwgbWludXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSArIG1pbnV0ZXMgKiA2MDAwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRTbG90cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwb2ludG1lbnRPcHRpb25zID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFwcG9pbnRtZW50TGVuZ3RoID0gMzA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLnZhcmlhbnQgJiYkc2NvcGUudmFyaWFudC5pc19zaGlwcGFibGUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBvaW50bWVudExlbmd0aCA9IDYwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9ICRzY29wZS5hZGRNaW51dGVzKGN1cnJlbnQsIGFwcG9pbnRtZW50TGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gJHNjb3BlLmF2YWlsYWJpbGl0aWVzRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gJHNjb3BlLmF2YWlsYWJpbGl0aWVzRGF0ZVtpdGVtXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9wZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJ1aWxkaW5nIGRhdGUgXCIgKyAkc2NvcGUuc3RhcnREYXRlLmdldEZ1bGxZZWFyKCkgKyBcIi9cIiArICgkc2NvcGUuc3RhcnREYXRlLmdldE1vbnRoKCkgKyAxKSArIFwiL1wiICsgJHNjb3BlLnN0YXJ0RGF0ZS5nZXREYXRlKCkgKyBcIiBcIiArIGNvbnRhaW5lci5mcm9tLnJlcGxhY2UoXCIgXCIsIFwiOjAwIFwiKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0ID0gbmV3IERhdGUoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRGdWxsWWVhcigpICsgXCIvXCIgKyAoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRNb250aCgpICsgMSkgKyBcIi9cIiArICRzY29wZS5zdGFydERhdGUuZ2V0RGF0ZSgpICsgXCIgXCIgKyBjb250YWluZXIuZnJvbS5yZXBsYWNlKFwiIFwiLCBcIjowMCBcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kID0gbmV3IERhdGUoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRGdWxsWWVhcigpICsgXCIvXCIgKyAoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRNb250aCgpICsgMSkgKyBcIi9cIiArICRzY29wZS5zdGFydERhdGUuZ2V0RGF0ZSgpICsgXCIgXCIgKyBjb250YWluZXIudG8ucmVwbGFjZShcIiBcIiwgXCI6MDAgXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG9wZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRBcHAgPSAkc2NvcGUuYWRkTWludXRlcyhzdGFydCwgYXBwb2ludG1lbnRMZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZEFwcCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyU2xvdCA9IHtzdGFydDogc3RhcnQsIGVuZDogZW5kQXBwfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPiBjdXJyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLmNoZWNrRmlsbGVkRGF0ZShjb250YWluZXJTbG90KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwcG9pbnRtZW50T3B0aW9ucy5wdXNoKGNvbnRhaW5lclNsb3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gJHNjb3BlLmFkZE1pbnV0ZXMoc3RhcnQsIGFwcG9pbnRtZW50TGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5ib29raW5nT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGVkIGJvb2tpbmcgb2JqXCIsICRzY29wZS5ib29raW5nT2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtzdGFydDogJHNjb3BlLmJvb2tpbmdPYmouc3RhcnRzX2F0LCBlbmQ6ICRzY29wZS5ib29raW5nT2JqLmVuZHNfYXR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RTbG90KGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrRmlsbGVkRGF0ZSA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRzY29wZS5zZWxlY3RlZFNwb3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaGVja2luZyA9ICRzY29wZS5zZWxlY3RlZFNwb3RzW2l0ZW1dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRlc3RcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb21wYXJpbmc6IFwiLCBjb250YWluZXIuc3RhcnQuZ2V0VGltZSgpLCBcIiBcIiwgY29udGFpbmVyLmVuZC5nZXRUaW1lKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY29tcGFyaW5nOiBcIiwgY2hlY2tpbmcuc3RhcnRzX2F0LmdldFRpbWUoKSwgXCIgXCIsIGNoZWNraW5nLmVuZHNfYXQuZ2V0VGltZSgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpZmZlcmVuY2U6IFwiLCBjb250YWluZXIuc3RhcnQuZ2V0VGltZSgpIC0gY2hlY2tpbmcuc3RhcnRzX2F0LmdldFRpbWUoKSwgXCIgXCIsIGNvbnRhaW5lci5lbmQuZ2V0VGltZSgpIC0gY2hlY2tpbmcuZW5kc19hdC5nZXRUaW1lKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY29udGFpbmVyLnN0YXJ0LmdldFRpbWUoKSA9PSBjaGVja2luZy5zdGFydHNfYXQuZ2V0VGltZSgpKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjb250YWluZXIuc3RhcnQuZ2V0VGltZSgpID4gY2hlY2tpbmcuc3RhcnRzX2F0LmdldFRpbWUoKSAmJiBjb250YWluZXIuc3RhcnQuZ2V0VGltZSgpIDwgY2hlY2tpbmcuZW5kc19hdC5nZXRUaW1lKCkpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvbnRhaW5lci5zdGFydC5nZXRUaW1lKCkgPCBjaGVja2luZy5zdGFydHNfYXQuZ2V0VGltZSgpICYmIGNvbnRhaW5lci5lbmQuZ2V0VGltZSgpID4gY2hlY2tpbmcuc3RhcnRzX2F0LmdldFRpbWUoKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHJ1ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlRGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZVNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRpbWVTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZVRpbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRpbWVTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnN0cnVjdG9yKCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubmdPbkluaXQoKTtcclxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYm9va2luZ2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 9 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n        .controller('CartCtrl', ['$scope', 'Cart', '$rootScope', function ($scope, Cart, $rootScope) {\r\n                $scope.subtotal = 0;\r\n                $scope.total = 0\r\n                angular.element(document).ready(function () {\r\n                    setTimeout(function () {\r\n                        var url = window.location.href;\r\n                        if(!url.includes(\"checkout\")){\r\n                            $scope.getCart();\r\n                        }\r\n                    }, 300);\r\n                });\r\n                $scope.clean = function () {\r\n                    angular.forEach(angular.element(\".item-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $rootScope.$on('updateHeadCart', function () {\r\n                    console.log(\"Get cart\");\r\n                    $scope.getCart();\r\n                });\r\n                $rootScope.$on('loadHeadCart', function (event, args) {\r\n                    console.log(\"Loading cart\", args);\r\n                    $scope.loadCart(args);\r\n                });\r\n                $scope.getCart = function () {\r\n                    Cart.getCart().then(function (data) {\r\n                        console.log(\"Get Cart\", data);\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $scope.loadCart(data);\r\n                            $rootScope.$broadcast('loadCartVariants', data);\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.loadCart = function (data) {\r\n                    $rootScope.items = data.items;\r\n                    $scope.totalItems = data.totalItems;\r\n                    $scope.subtotal = data.subtotal;\r\n                    $scope.total = data.total;\r\n                }\r\n                $scope.updateCartItem = function (product_variant_id) {\r\n                    var quantity = angular.element(document.querySelector('input[name=quantity-' + product_variant_id + ']')).val();\r\n                    console.log(\"da qty: \" + quantity);\r\n                    var container = {\r\n                        quantity: quantity,\r\n                        product_variant_id: $scope.product_variant_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        }\r\n                        $scope.getCart();\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.clearCart = function () {\r\n                    Cart.clearCart().then(function (data) {\r\n                        $scope.getCart();\r\n                        $rootScope.$broadcast('clearCart');\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.deleteCartItem = function (item_id) {\r\n                    var container = {\r\n                        quantity: 0,\r\n                        item_id: item_id,\r\n                        \"extras\": []\r\n                    };\r\n\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        console.log(\"delete\", data);\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $scope.loadCart(data.cart);\r\n                            $rootScope.$broadcast('deleteItem', item_id);\r\n                        }\r\n                        //$scope.getCart();\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2NhcnRjdHJsLmpzPzk3YjYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NhcnRDdHJsJywgWyckc2NvcGUnLCAnQ2FydCcsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgQ2FydCwgJHJvb3RTY29wZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1YnRvdGFsID0gMDtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDBcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCF1cmwuaW5jbHVkZXMoXCJjaGVja291dFwiKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhbmd1bGFyLmVsZW1lbnQoXCIuaXRlbS1hdHRyaWJ1dGVzXCIpLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGFuZ3VsYXIuZWxlbWVudCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGEuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHggaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IHggKyBcIjogXCIgKyBvYmpbeF0gKyBcIiA8YnIvPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuaHRtbChodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCd1cGRhdGVIZWFkQ2FydCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBjYXJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdsb2FkSGVhZENhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvYWRpbmcgY2FydFwiLCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZENhcnQoYXJncyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIENhcnQuZ2V0Q2FydCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgQ2FydFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdlcnJvcicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZENhcnQoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRDYXJ0VmFyaWFudHMnLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRDYXJ0ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zID0gZGF0YS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWxJdGVtcyA9IGRhdGEudG90YWxJdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VidG90YWwgPSBkYXRhLnN1YnRvdGFsO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGRhdGEudG90YWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQ2FydEl0ZW0gPSBmdW5jdGlvbiAocHJvZHVjdF92YXJpYW50X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHF1YW50aXR5ID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9cXVhbnRpdHktJyArIHByb2R1Y3RfdmFyaWFudF9pZCArICddJykpLnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGEgcXR5OiBcIiArIHF1YW50aXR5KTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfdmFyaWFudF9pZDogJHNjb3BlLnByb2R1Y3RfdmFyaWFudF9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogW11cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIENhcnQudXBkYXRlQ2FydEl0ZW0oY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnZXJyb3InKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJDYXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIENhcnQuY2xlYXJDYXJ0KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2NsZWFyQ2FydCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUNhcnRJdGVtID0gZnVuY3Rpb24gKGl0ZW1faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogaXRlbV9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogW11cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGV0ZVwiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdlcnJvcicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZENhcnQoZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZGVsZXRlSXRlbScsIGl0ZW1faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmdldENhcnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2NhcnRjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 10 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('CheckoutCartCtrl', ['$scope', '$rootScope', 'Cart', 'Orders', 'Modals', '$q', function ($scope, $rootScope, Cart, Orders, Modals, $q) {\r\n                $scope.data = {};\r\n                $scope.coupon = \"\";\r\n                $scope.accept = false;\r\n                $scope.acceptError = false;\r\n                $rootScope.isDigital = false;\r\n                $rootScope.bookingSet = true;\r\n                angular.element(document).ready(function () {\r\n                    setTimeout(function () {\r\n                        $scope.getCart(true);\r\n                    }, 300);\r\n                });\r\n                $scope.cleanJson = function () {\r\n                    angular.forEach(angular.element(\".item-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $scope.getCart = function (init) {\r\n                    Cart.getCheckoutCart().then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $scope.loadCart(data, init)\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.AcceptTerms = function () {\r\n                    if ($scope.accept) {\r\n                        $scope.acceptError = false;\r\n                    }\r\n                }\r\n                $scope.getOrder = function (init) {\r\n                    var def = $q.defer();\r\n                    Orders.getOrder().then(function (data) {\r\n                        $rootScope.isDigital = true;\r\n                        $rootScope.activeOrder = data.data;\r\n                        def.resolve(\"Done\")\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                    return def.promise;\r\n                }\r\n                $scope.updateCartItem = function (item_id) {\r\n                    var quantity = angular.element(document.querySelector('input[name=check-quantity-' + item_id + ']')).val();\r\n                    var container = {\r\n                        quantity: quantity,\r\n                        item_id: item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        }\r\n                        $scope.getCart(false);\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.clearCart = function () {\r\n                    Cart.clearCart().then(function (data) {\r\n                        $scope.getCart();\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.loadCart = function (data, init) {\r\n                    if (data.items.length > 0) {\r\n                        var items = data.items;\r\n                        var shippable = false;\r\n                        for (var i in items) {\r\n                            var item = items[i];\r\n                            console.log(\"Item: \", item.attributes);\r\n                            if (item.attributes.is_shippable) {\r\n                                shippable = true;\r\n                            }\r\n                        }\r\n                        $rootScope.items = data.items;\r\n                        $scope.totalItems = data.totalItems;\r\n                        $scope.subtotal = data.subtotal;\r\n                        $scope.shipping = data.shipping;\r\n                        $scope.tax = data.tax;\r\n                        $scope.sale = data.sale;\r\n                        $scope.coupon = data.coupon;\r\n                        $scope.discount = data.sale + data.coupon;\r\n                        $scope.total = data.total;\r\n                        console.log(\"Broadcasting shippable: \", shippable);\r\n                        if (init) {\r\n                            if (shippable) {\r\n                                $rootScope.$broadcast('Shippable');\r\n                            } else {\r\n\r\n                                $scope.getOrder().then(function (data) {\r\n                                    $rootScope.$broadcast('NotShippable');\r\n                                },\r\n                                        function (data) {\r\n\r\n                                        });\r\n\r\n                            }\r\n                        }\r\n                    } else {\r\n                        window.location.href = '/';\r\n                    }\r\n                }\r\n                $scope.prepareOrder = function () {\r\n                    console.log(\"Accept\", $scope.accept);\r\n                    if ($scope.accept) {\r\n                        $rootScope.$broadcast('prepareOrder');\r\n                    } else {\r\n                        $scope.acceptError = true;\r\n                    }\r\n                }\r\n                $scope.deleteCartItem = function (item_id) {\r\n                    var container = {\r\n                        quantity: 0,\r\n                        item_id: item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        }\r\n                        $scope.getCart();\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.setCoupon = function () {\r\n                    //setTimeout(function(){ Modals.hideLoader(); }, 2000);\r\n                    if ($scope.coupon && $scope.coupon.length > 0) {\r\n                        Modals.showLoader();\r\n                        Orders.setCoupon($scope.coupon).then(function (resp) {\r\n                            Modals.hideLoader();\r\n                            if (resp) {\r\n                                if (resp.status == \"success\") {\r\n                                    $scope.getCart(false);\r\n                                    $scope.coupon = \"\";\r\n                                    Modals.showToast('Cupon agregado exitosamente', $(\"#final-submit\"));\r\n                                } else {\r\n                                    Modals.showToast('No puedes usar ese cupon', $(\"#final-submit\"));\r\n                                }\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    } else {\r\n                        Modals.showToast('Ingresa un cupon', $(\"#final-submit\"));\r\n                    }\r\n                }\r\n                $rootScope.$on('updateCheckoutCart', function (event, args) {\r\n                    $scope.getCart(false);\r\n\r\n                });\r\n                $rootScope.$on('updateLoadedCart', function (event, args) {\r\n                    console.log(\"updateLoadedCart\", args);\r\n                    $scope.loadCart(args);\r\n                });\r\n            }])\r\n        .controller('CheckoutShippingCtrl', ['$scope', '$rootScope', 'LocationService', 'Users', '$q',\r\n            'Cart', '$cookies', 'Orders', 'Modals', 'Billing', '$location', '$anchorScroll',\r\n            function ($scope, $rootScope, LocationService, Users, $q, Cart, $cookies, Orders, Modals, Billing, $location, $anchorScroll) {\r\n                $scope.data = {};\r\n                $scope.addressSet = {};\r\n                $scope.shipping = [];\r\n                $scope.regionVisible = false;\r\n                $scope.addressesFetched = false;\r\n                $scope.cityVisible = false;\r\n                $scope.addAddress = false;\r\n                $scope.visible = false;\r\n                $rootScope.shippingAddressSet = true;\r\n                $rootScope.shippingCondition = true;\r\n                $rootScope.shippingConditionSet = false;\r\n                $rootScope.billingAddressSet = false;\r\n                $rootScope.paymentMethodSet = false;\r\n\r\n                $rootScope.$on('Shippable', function (event, args) {\r\n                    $rootScope.shippingAddressSet = false;\r\n                    $rootScope.shippingCondition = false;\r\n                    $rootScope.billingAddressSet = false;\r\n                    $rootScope.paymentMethodSet = false;\r\n                    $scope.visible = true;\r\n                    var strAddress = $cookies.get(\"shippingAddress\");\r\n                    var address = null;\r\n                    if (strAddress && strAddress.length > 0) {\r\n                        address = JSON.parse(strAddress);\r\n                    }\r\n                    console.log(\"Shipping address: \", address);\r\n                    console.log(\"$rootScope.user: \", $rootScope.user);\r\n                    if (address) {\r\n                        if (!address.name) {\r\n                            $scope.addAddress = true;\r\n                            $scope.data = address;\r\n\r\n                            if ($rootScope.user) {\r\n                                $scope.data.name = $rootScope.user.name;\r\n                                $scope.data.phone = $rootScope.user.cellphone;\r\n                            }\r\n                            $scope.selectPlace($scope.data.country_id, $scope.data.region_id, $scope.data.city_id);\r\n                        }\r\n                        if (address.id) {\r\n                            $scope.selectAddress(address);\r\n                        }\r\n                    } else {\r\n                        $scope.getAddresses().then(function (data) {\r\n                            if ($rootScope.addresses.length == 0) {\r\n                                $scope.newAddress();\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                });\r\n                $scope.countries = [{name: \"Colombia\", id: 1}, {name: \"Colombia2\", id: 2}]\r\n\r\n                angular.element(document).ready(function () {\r\n\r\n                });\r\n                $scope.newAddress = function () {\r\n                    var url = window.location.href;\r\n                    $cookies.put(\"shippingAddress\", \"\", {path: \"/\"});\r\n                    $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\r\n                    window.location.href = \"/location\";\r\n                }\r\n                $rootScope.$on('prepareOrder', function (event, args) {\r\n                    $scope.prepareOrder();\r\n                });\r\n                $rootScope.$on('buildOrder', function (event, args) {\r\n                    $scope.buildOrder($rootScope.activeOrder);\r\n                });\r\n                $rootScope.$on('NotShippable', function (event, args) {\r\n                    $scope.visible = false;\r\n                });\r\n                $rootScope.$on('getAddresses', function (event, args) {\r\n                    $scope.getAddresses();\r\n                });\r\n                $scope.cleanJson = function () {\r\n                    angular.forEach(angular.element(\".item-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $scope.save = function (isvalid) {\r\n                    $scope.submitted = true;\r\n                    if (isvalid) {\r\n                        Modals.showLoader();\r\n                        Users.saveAddress($scope.data).then(function (data) {\r\n                            Modals.hideLoader();\r\n                            if (data.status == \"success\") {\r\n                                $scope.selectAddress(data.address);\r\n                                $scope.data = {};\r\n                                $scope.submitted = false;\r\n                                $scope.hideAddressForm();\r\n                            } else {\r\n\r\n                            }\r\n\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    }\r\n                }\r\n                $scope.getAddresses = function () {\r\n                    var def = $q.defer();\r\n                    Users.getAddresses().then(function (data) {\r\n                        $rootScope.addresses = data.addresses;\r\n                        def.resolve(\"done\");\r\n                    },\r\n                            function (data) {\r\n                                def.resolve(\"error\");\r\n                            });\r\n                    return def.promise;\r\n                }\r\n                $scope.clean = function () {\r\n                    $scope.data = {};\r\n                    $scope.regionVisible = false;\r\n                    $scope.cityVisible = false;\r\n                }\r\n                $scope.selectCountry = function (country_id) {\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectRegion = function (region_id) {\r\n                    LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                        $scope.cities = data.data;\r\n                        $scope.cityVisible = true;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectPlace = function (country_id, region_id, city_id) {\r\n                    //$scope.$apply(function () {\r\n                    $scope.data.country_id = country_id;\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n                        console.log(\"Setting region\", $scope.data.region_id);\r\n                        $scope.data.region_id = region_id;\r\n                        LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                            $scope.cities = data.data;\r\n                            $scope.cityVisible = true;\r\n                            console.log(\"Setting city_id\", $scope.data.city_id);\r\n                            console.log(\"Setting cities\", $scope.cities);\r\n                            $scope.data.city_id = city_id;\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                    //});\r\n                }\r\n\r\n                $scope.selectAddress = function (address) {\r\n                    $scope.addressSet = address;\r\n                    var data = {address_id: address.id};\r\n                    Modals.showLoader();\r\n                    Orders.setShippingAddress(data).then(function (data) {\r\n                        console.log(\"Set shipping address\", data);\r\n                        if (data.status == \"success\") {\r\n                            $rootScope.shippingAddressSet = true;\r\n                            $rootScope.shippingAddress = address;\r\n                            $cookies.put(\"shippingAddress\", JSON.stringify($rootScope.shippingAddress), {path: \"/\"});\r\n                            var order = data.order;\r\n                            var attributes = JSON.parse(order.attributes);\r\n                            order.attributes = attributes;\r\n                            $rootScope.activeOrder = order;\r\n                            var providers = attributes.providers;\r\n                            for (var i in providers) {\r\n                                console.log(\"Providers: \", providers[i]);\r\n                            }\r\n                            console.log(\"Setting discounts\", $rootScope.shippingAddressSet);\r\n                            $scope.buildOrder(order);\r\n                        } else {\r\n                            Modals.hideLoader();\r\n                            Modals.showToast(\"Fuera de cobertura para esta orden\", $(\"#checkout-shipping\"));\r\n                        }\r\n\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.scrollTo = function (id) {\r\n                    setTimeout(function () {\r\n                        var old = $location.hash();\r\n                        $location.hash(id);\r\n                        $anchorScroll();\r\n                        $location.hash(old);\r\n                    }, 500);\r\n                }\r\n                $scope.buildOrder = function (order) {\r\n                    Orders.setDiscounts(order.id, \"Booking\").then(function (data) {\r\n                        console.log(\"Discounts set\", data);\r\n                        var dataS = {\"payers\": [$rootScope.user.id], \"platform\": \"Booking\"};\r\n                        Orders.checkOrder(order.id, dataS).then(function (resp) {\r\n                            console.log(\"Check Order Result\", resp);\r\n                            Modals.hideLoader();\r\n                            var order = resp.order;\r\n                            if (resp.status == \"success\") {\r\n                                if ($rootScope.isDigital) {\r\n                                    //$scope.prepareOrder();\r\n                                } else {\r\n                                    Modals.showToast(\"Direccion guardada\", $(\"#checkout-shipping\"));\r\n                                    $rootScope.$broadcast('updateCheckoutCart');\r\n                                    $scope.scrollTo(\"checkout-shipping-methods\");\r\n                                    console.log(\"Finished scrolling2222\");\r\n                                }\r\n\r\n                            } else {\r\n                                $scope.handleCheckError(resp, order);\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.addCartItem = function (product_variant, extras) {\r\n                    Cart.addCartItem(product_variant, extras).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $rootScope.$broadcast('updateCheckoutCart');\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.setShippingCondition = function (item) {\r\n                    Modals.showLoader();\r\n                    console.log(\"Set Shipping\", item);\r\n                    var container = {\"provider\": item.class, \"provider_id\": item.id};\r\n                    Orders.setPlatformShippingCondition($rootScope.activeOrder.id, container).then(function (data) {\r\n                        Modals.hideLoader();\r\n                        console.log(\"setPlatformShippingPrice Result\", data);\r\n                        if (data.status == \"success\") {\r\n                            $rootScope.$broadcast('updateLoadedCart', data.cart);\r\n                            $rootScope.activeOrder = data.order;\r\n                            for (var i = 0; i < $scope.shipping.length; i++) {\r\n                                $scope.shipping[i].selected = false;\r\n                            }\r\n                            $rootScope.shippingConditionSet = true;\r\n                            item.price = data.cart.shipping;\r\n                            item.selected = true;\r\n                            Modals.showToast(\"Envio agregado exitosamente\", $(\"#checkout-shipping\"));\r\n                        } else {\r\n                            Modals.showToast(\"Hubo un error con ese metodo de envio\", $(\"#checkout-shipping\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                                Modals.showToast(\"Hubo un error con ese metodo de envio\", $(\"#checkout-shipping\"));\r\n                            });\r\n                }\r\n                $scope.handleCheckError = function (resp, order) {\r\n                    if (resp.type == \"credits\") {\r\n                        var missing = parseInt(resp.required_credits);\r\n                        console.log(\"Required credits\", missing);\r\n                        console.log(\"creditItem\", resp.creditItem);\r\n                        Modals.showToast(\"Hemos agregado un item obligatorio\", $(\"#checkout-shipping\"));\r\n                        console.log(\"creditItemMerchant\", resp.creditItemMerchant);\r\n                        var container = {\r\n                            order_id: order.id,\r\n                            product_variant_id: resp.creditItem.id,\r\n                            quantity: missing,\r\n                            item_id: null,\r\n                            merchant_id: resp.creditItemMerchant\r\n                        };\r\n                        $scope.addCartItem(container, []);\r\n                    } else if (resp.type == \"buyers\") {\r\n                        //\r\n                    } else if (resp.type == \"shipping\") {\r\n                        //this.api.toast('CHECKOUT_PREPARE.REQUIRES_SHIPPING');\r\n                        $scope.scrollTo(\"checkout-shipping-methods\");\r\n                        Modals.showToast(\"Debes seleccionar proveedor de envio\", $(\"#checkout-shipping-methods\"));\r\n                        if ($scope.shipping.length == 0) {\r\n                            $scope.expectedProviders = 0;\r\n                            var attributes = JSON.parse(order.attributes);\r\n                            if (attributes.providers) {\r\n                                for (var item in attributes.providers) {\r\n                                    $scope.expectedProviders++;\r\n                                    $scope.getPlatformShippingPrice(resp.order.id, attributes.providers[item]);\r\n                                }\r\n                            }\r\n                        }\r\n                    } else if (resp.type == \"delivery\") {\r\n                        /*this.api.toast('CHECKOUT_PREPARE.REQUIRES_DELIVERY');\r\n                         this.api.dismissLoader();\r\n                         let endDate = new Date();\r\n                         if (this.currentItems.length == 0) {\r\n                         this.getCart();\r\n                         }\r\n                         endDate.setDate(endDate.getDate() + 1);\r\n                         //this.delivery = endDate.toISOString();\r\n                         console.log(\"delivery\", this.delivery);\r\n                         this.requiresDelivery = true;*/\r\n                    }\r\n                }\r\n                $scope.getPlatformShippingPrice = function (order_id, platform) {\r\n                    var description = platform.desc;\r\n                    delete platform.desc;\r\n                    Orders.getPlatformShippingPrice(order_id, platform).then(function (data) {\r\n                        console.log(\"getPlatformShippingPrice Result\", data);\r\n                        $scope.expectedProviders--;\r\n                        if (data.status == \"success\") {\r\n                            var name = platform.provider;\r\n                            if (platform.provider == \"MerchantShipping\") {\r\n                                name = \"Domicilio del Establecimiento\"\r\n                            }\r\n                            var container = {platform: name, class: platform.provider, price: data.price, desc: description, id: platform.provider_id, selected: false};\r\n                            var add = true;\r\n                            for (var i = 0; i < $scope.shipping.length; i++) {\r\n                                var cont = $scope.shipping[i];\r\n                                if (cont.platform == container.platform) {\r\n                                    if (cont.price <= container.price) {\r\n                                        console.log(\"Not adding\", container)\r\n                                        add = false;\r\n                                    } else {\r\n                                        console.log(\"Removing\", cont)\r\n                                        $scope.shipping.splice(i, 1);\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (add) {\r\n                                $scope.shipping.push(container);\r\n                            }\r\n                            if ($scope.expectedProviders == 0 && !$rootScope.shippingConditionSet) {\r\n                                $scope.setShippingCondition($scope.shipping[0]);\r\n                                console.log(\"Auto select\", $scope.shipping)\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                                $scope.expectedProviders--;\r\n                            });\r\n                }\r\n                $scope.showAddressForm = function () {\r\n                    $cookies.put(\"locationRefferrer\", window.location.href, {path: \"/\"});\r\n                    window.location.href = \"/location\";\r\n                }\r\n                $scope.hideAddressForm = function () {\r\n                    $scope.addAddress = false;\r\n                }\r\n                $scope.changeAddress = function () {\r\n                    console.log(\"Change address\")\r\n                    $rootScope.shippingAddressSet = false;\r\n                    $rootScope.shippingConditionSet = false;\r\n                    $scope.addAddress = false;\r\n                    if ($rootScope.addresses && $rootScope.addresses.length > 0) {\r\n\r\n                    } else {\r\n                        $scope.getAddresses().then(function (data) {\r\n                            if ($rootScope.addresses.length == 0) {\r\n                                $scope.newAddress();\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                        ;\r\n                    }\r\n                }\r\n                $scope.changeShipping = function () {\r\n                    $rootScope.shippingConditionSet = false;\r\n                }\r\n                $scope.prepareOrder = function () {\r\n                    Modals.showLoader();\r\n                    $scope.showPayment = false;\r\n                    $scope.shippingError = false;\r\n                    var payers = [$rootScope.user.id];\r\n                    var recurring_type = \"limit\";\r\n                    var recurring_value = 3;\r\n                    var container = {\r\n                        \"order_id\": $rootScope.activeOrder.id,\r\n                        \"payers\": payers,\r\n                        \"delivery_date\": null,\r\n                        \"split_order\": false,\r\n                        \"platform\": \"Booking\",\r\n                        \"recurring\": false,\r\n                        \"recurring_type\": recurring_type,\r\n                        \"recurring_value\": recurring_value,\r\n                        \"merchant_id\": $rootScope.activeOrder.merchant_id\r\n                    };\r\n                    Orders.prepareOrder(container, \"Booking\").then(function (resp) {\r\n                        Modals.hideLoader();\r\n                        if (resp) {\r\n                            if (resp.status == \"success\") {\r\n                                Modals.showToast(\"Selecciona mtodo de envo\", $(\"#checkout-cart\"));\r\n                                console.log(\"orderProvider\", resp);\r\n                                $rootScope.activePayment = resp.payment;\r\n                                $rootScope.activeOrder = resp.order;\r\n                                if ($rootScope.activePayment.total == $rootScope.activePayment.transaction_cost) {\r\n                                    var container = {\r\n                                        \"payment_id\": $rootScope.activePayment.id\r\n                                    }\r\n                                    Modals.showLoader();\r\n                                    Billing.completePaidOrder(container).then(function (resp) {\r\n                                        Modals.hideLoader();\r\n                                        if (resp.status == \"success\") {\r\n                                            resp.transaction = {};\r\n                                            resp.transaction.reference_sale = \"Pago Interno\";\r\n                                            resp.transaction.payment_method = \"Pago Interno\";\r\n                                            resp.transaction.description = \"Pago Interno\";\r\n                                            resp.transaction.transaction_id = resp.payment.id;\r\n                                            resp.transaction.transaction_state = \"APPROVED\";\r\n                                            $rootScope.$broadcast('transactionResponse', resp);\r\n                                        } else {\r\n                                            $scope.showPayment = true;\r\n                                            //this.scrollToTop();\r\n                                        }\r\n                                    }, function (err) {\r\n                                        $scope.showPayment = true;\r\n                                        //this.scrollToTop();\r\n                                        console.log(\"completePaidOrderError\", err);\r\n                                    });\r\n                                } else {\r\n                                    $rootScope.$broadcast('activatePayment');\r\n                                }\r\n                            } else {\r\n                                $scope.handleCheckError(resp);\r\n                            }\r\n\r\n                        }\r\n                    }, function (err) {\r\n                        Modals.hideLoader();\r\n                        console.log(\"getCartError\", err);\r\n                        Modals.showToast(\"Hubo un error porfavor comunicate mas tarde\", $(\"#checkout-cart\"));\r\n                    });\r\n                }\r\n            }])\r\n        .controller('CheckoutBillingCtrl', ['$scope', '$rootScope', 'LocationService', 'Users', 'Billing', '$location', '$anchorScroll', 'Modals', '$mdDialog', 'Cart',\r\n            function ($scope, $rootScope, LocationService, Users, Billing, $location, $anchorScroll, Modals, $mdDialog, Cart) {\r\n                $scope.data = {};\r\n                $scope.data2 = {};\r\n                $scope.data3 = {};\r\n                $scope.data4 = {};\r\n                $scope.transaction = {};\r\n                $scope.banks = [];\r\n                $rootScope.paymentActive = false;\r\n                $scope.creditCardVisible = false;\r\n                $scope.creditPayerVisible = false;\r\n                $scope.creditBuyerVisible = false;\r\n                $scope.credito = false;\r\n                $scope.showResult = false;\r\n                $scope.resultHeader = \"\";\r\n                $scope.resultBody = \"\";\r\n                $scope.cash = false;\r\n                $scope.debito = false;\r\n                angular.element(document).ready(function () {\r\n                    var d = new Date();\r\n                    $scope.years = [];\r\n                    $scope.months = [];\r\n                    var year = d.getFullYear()\r\n                    for (i = 0; i < 12; i++) {\r\n                        if (i < 9) {\r\n                            $scope.months.push(\"0\" + (i + 1));\r\n                        } else {\r\n                            $scope.months.push(i + 1);\r\n                        }\r\n\r\n                    }\r\n                    for (i = 0; i < 13; i++) {\r\n                        $scope.years.push(year + i);\r\n                    }\r\n                });\r\n                $scope.scrollTo = function (id) {\r\n                    setTimeout(function () {\r\n                        var old = $location.hash();\r\n                        $location.hash(id);\r\n                        $anchorScroll();\r\n                        $location.hash(old);\r\n                    }, 500);\r\n                }\r\n                $rootScope.$on('activatePayment', function (event, args) {\r\n                    $rootScope.paymentActive = true;\r\n                    $scope.scrollTo(\"checkout-payment\");\r\n                    // call $anchorScroll()\r\n                });\r\n                $rootScope.$on('transactionResponse', function (event, args) {\r\n                    console.log(\"updateLoadedCart\", args);\r\n                    $scope.transactionResponse(args);\r\n                });\r\n                $scope.keytab = function (event, maxlength) {\r\n                    console.log(\"Event\", event)\r\n                    var target = event.target || event.srcElement;\r\n                    var nextInput = target.nextElementSibling; // get the sibling element\r\n                    console.log('nextInput', nextInput);\r\n\r\n                    console.log('target', target);\r\n                    console.log('targetvalue', target.value);\r\n                    console.log('targettype', target.nodeType);\r\n                    if (target.value.length < maxlength) {\r\n                        return;\r\n                    }\r\n                    if (nextInput == null)  // check the maxLength from here\r\n                        return;\r\n                    else\r\n                        nextInput.focus();   // focus if not null\r\n                }\r\n                $scope.creditTab = function (event) {\r\n                    var target = event.target || event.srcElement;\r\n                    var value = target.value;\r\n                    var branch = (/^(?:5[1-5][0-9]{2}|222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}$/.test(value)) ? \"MASTERCARD\"\r\n                            : (/^(4[0-9]{12}(?:[0-9]{3})?$)|(^606374[0-9]{10}$)/.test(value)) ? \"VISA\"\r\n                            : (/^3[47][0-9]{13}$/.test(value)) ? 'AMEX'\r\n                            : (/^[35](?:0[0-5]|[68][0-9])[0-9]{11}$|^30[0-5]{11}$|^3095[0-9]{10}$|^36[0-9]{12}$|^3[89][0-9]{12}$/.test(value)) ? 'DINERS'\r\n                            : (/^6(?:011|5[0-9]{2}|4[4-9][0-9])[0-9]{12}$/.test(value)) ? 'DISCOVER'\r\n                            : (/^589562[0-9]{10}$/.test(value)) ? 'NARANJA'\r\n                            : (/^603488[0-9]{10}$|^2799[0-9]{9}$/.test(value)) ? 'SHOPPING'\r\n                            : (/^604(([23][0-9]{2})|(400))[0-9]{10}$|^589657[0-9]{10}$/.test(value)) ? 'CABAL'\r\n                            : (/^603493[0-9]{10}$/.test(value)) ? 'ARGENCARD'\r\n                            : (/^590712[0-9]{10}$/.test(value)) ? 'CODENSA'\r\n                            : (/^627180[0-9]{10}$/.test(value)) ? 'CMR'\r\n                            : \"\";\r\n\r\n                    console.log(\"Credit branch\", branch);\r\n                    $scope.data2.cc_branch = branch;\r\n                }\r\n                $scope.transactionResponse = function (data) {\r\n                    Modals.hideLoader();\r\n                    console.log(\"Response payu\", data)\r\n                    Cart.clearCart();\r\n                    $scope.scrollTo(\"checkout-payment\");\r\n                    if (data.message != \"error\") {\r\n                        $scope.showResult = true;\r\n                        $scope.transaction = data.transaction;\r\n                        if (data.transaction.transaction_state == \"APPROVED\") {\r\n                            $scope.resultHeader = \"Pago aprobado\";\r\n                            $scope.resultBody = \"Tu pago ha sido completado, revisa tu correo para recibir tu compra\";\r\n                        } else if (data.transaction.transaction_state == \"PENDING\") {\r\n                            $scope.resultHeader = \"Pago pendiente\";\r\n                            $scope.resultBody = \"Tu transaccion esta siendo verificada, cuando complete la verificacion recibiras un correo con el resultado\";\r\n                        } else {\r\n                            $scope.resultHeader = \"Pago negado\";\r\n                            $scope.resultBody = \"Tu transaccion ha sido negada. Porfavor intenta otro metodo u otra tarjeta. En Mi cuenta > Mis Pagos puedes reintentar el pago\";\r\n                        }\r\n                    } else {\r\n                        Modals.showToast(\"Hubo un error. Porfavor verifica tus datos\", $(\"#checkout-payment\"));\r\n                    }\r\n                }\r\n                $scope.payCreditCard = function (isvalid) {\r\n                    $scope.data2.buyer_address = $scope.data2.payer_address;\r\n                    $scope.data2.buyer_postal = $scope.data2.payer_postal;\r\n                    $scope.data2.buyer_city = $scope.data2.payer_city;\r\n                    $scope.data2.buyer_state = $scope.data2.payer_state;\r\n                    $scope.data2.buyer_country = $scope.data2.payer_country;\r\n                    $scope.data2.buyer_phone = $scope.data2.payer_phone;\r\n                    $scope.submitted2 = true;\r\n                    if (isvalid) {\r\n                        $scope.data2.platform = \"Booking\";\r\n                        $scope.data2.email = true;\r\n                        $scope.data2.payment_id = $rootScope.activePayment.id;\r\n                        Modals.showLoader();\r\n                        Billing.payCreditCard($scope.data2, \"PayU\").then(function (data) {\r\n                            $scope.transactionResponse(data);\r\n                            //$scope.data2 = {};\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    }\r\n                }\r\n                $scope.quickPay = function () {\r\n                    var container = {\r\n                        quick: true,\r\n                        payment_id: $rootScope.activePayment.id,\r\n                        platform: \"Booking\"\r\n                    };\r\n                    Modals.showLoader();\r\n                    Billing.payCreditCard(container, \"PayU\").then(function (data) {\r\n                        $scope.transactionResponse(data);\r\n                        //$scope.data2 = {};\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectOption = function (option) {\r\n                    $scope.data4.payment_method = option;\r\n                    $scope.scrollTo(\"cash-form\")\r\n                }\r\n                $scope.populatePayer = function () {\r\n                    if ($scope.data2.payer_name) {\r\n                        if ($scope.data2.payer_name.length == 0) {\r\n                            $scope.data2.payer_name = $scope.data2.cc_name;\r\n                        }\r\n                    } else {\r\n                        $scope.data2.payer_name = $scope.data2.cc_name;\r\n                    }\r\n                }\r\n                $scope.payDebitCard = function (isvalid) {\r\n                    $scope.submitted3 = true;\r\n                    if (isvalid) {\r\n                        $scope.data3.platform = \"Booking\";\r\n                        $scope.data3.email = true;\r\n                        $scope.data3.payment_id = $rootScope.activePayment.id;\r\n                        Modals.showLoader();\r\n                        Billing.payDebit($scope.data3, \"PayU\").then(function (data) {\r\n                            if (data.code == \"SUCCESS\") {\r\n                                if (data.transactionResponse.state == \"PENDING\") {\r\n                                    //this.showPrompt();\r\n                                    Cart.clearCart().then(function (resp) {\r\n                                        window.location.href = data.transactionResponse.extraParameters.BANK_URL;\r\n                                    },\r\n                                            function (data) {\r\n                                                Modals.hideLoader();\r\n                                            });\r\n                                } else {\r\n                                    Modals.hideLoader();\r\n                                    Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                                }\r\n                            } else {\r\n                                Modals.hideLoader();\r\n                                Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                    Modals.hideLoader();\r\n                                });\r\n                    }\r\n                }\r\n                $scope.payCash = function (isvalid) {\r\n                    $scope.submitted4 = true;\r\n                    if (isvalid) {\r\n                        Modals.showLoader();\r\n                        $scope.data4.platform = \"Booking\";\r\n                        $scope.data4.email = true;\r\n                        $scope.data4.payment_id = $rootScope.activePayment.id;\r\n                        Billing.payCash($scope.data4, \"PayU\").then(function (data) {\r\n                            Modals.hideLoader();\r\n                            console.log(\"after payCash\");\r\n                            console.log(JSON.stringify(data));\r\n                            if (data.code == \"SUCCESS\") {\r\n                                Cart.clearCart().then(function (resp) {\r\n                                    if (data.transactionResponse.extraParameters.URL_PAYMENT_RECEIPT_HTML) {\r\n                                        window.location.href = data.transactionResponse.extraParameters.URL_PAYMENT_RECEIPT_HTML;\r\n                                    } else {\r\n                                        Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                                    }\r\n                                },\r\n                                        function (data) {\r\n                                        });\r\n                            } else {\r\n                                Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                }\r\n\r\n                $scope.clean = function () {\r\n                    $scope.data = {};\r\n                    $scope.regionVisible = false;\r\n                    $scope.cityVisible = false;\r\n                }\r\n                $scope.clean2 = function () {\r\n                    $scope.data2 = {};\r\n                }\r\n                $scope.fill = function () {\r\n                    $scope.data2.cc_branch = \"VISA\";\r\n                    $scope.data2.cc_name = \"APPROVED\";\r\n                    $scope.data2.cc_number = \"4111111111111111\";\r\n                    $scope.data2.cc_security_code = \"123\";\r\n                    $scope.data2.cc_expiration_month = \"09\";\r\n                    $scope.data2.cc_expiration_year = \"2017\";\r\n                    $scope.data2.payer_email = \"harredon01@gmail.com\";\r\n                    $scope.data2.payer_id = \"321321321\";\r\n\r\n                }\r\n                $scope.fill2 = function () {\r\n                    $scope.data3.user_type = \"N\";\r\n                    $scope.data3.pse_reference2 = \"CC\";\r\n                    $scope.data3.pse_reference3 = \"1020716535\";\r\n                    $scope.data3.payer_email = \"harredon01@gmail.com\";\r\n\r\n                }\r\n                $scope.fill3 = function () {\r\n                    $scope.data4.payer_email = \"harredon01@gmail.com\";\r\n\r\n                }\r\n                $scope.selectCountry = function (country_id) {\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectRegion = function (region_id) {\r\n                    LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                        $scope.cities = data.data;\r\n                        $scope.cityVisible = true;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectPlace = function (country_id, region_id, city_id) {\r\n                    $scope.data.country_id = country_id;\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n                        $scope.data.region_id = region_id;\r\n                        LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                            $scope.cities = data.data;\r\n                            $scope.cityVisible = true;\r\n                            $scope.data.city_id = city_id;\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n                $scope.showAddressForm = function () {\r\n                    $scope.addAddress = true;\r\n                    $scope.data.type = \"billing\";\r\n                }\r\n                $scope.hideAddressForm = function () {\r\n                    $scope.addAddress = false;\r\n                }\r\n                $scope.useUserDebit = function () {\r\n                    $scope.data3.user_type = \"N\";\r\n                    $scope.data3.doc_type = \"N\";\r\n                    $scope.data3.payer_name = $rootScope.user.name;\r\n                    $scope.data3.payer_id = $rootScope.user.docNum;\r\n                    $scope.data3.payer_phone = $rootScope.user.cellphone;\r\n                    $scope.data3.payer_email = $rootScope.user.email;\r\n                }\r\n                $scope.useUserCredit = function () {\r\n                    $scope.data2.cc_name = $rootScope.user.name;\r\n                    $scope.data2.payer_name = $rootScope.user.name;\r\n                    $scope.data2.payer_id = $rootScope.user.docNum;\r\n                    $scope.data2.payer_phone = $rootScope.user.cellphone;\r\n                    $scope.data2.payer_email = $rootScope.user.email;\r\n                    $scope.addAddress = false;\r\n                }\r\n                $scope.useUserCash = function () {\r\n                    $scope.data4.payer_email = $rootScope.user.email;\r\n                    $scope.data4.payer_id = $rootScope.user.docNum;\r\n                }\r\n                $scope.fetchAddressForUse = function (typeFetch, typeUse) {\r\n                    if (typeFetch == 'shipping') {\r\n                        $scope.setAddressInfields(typeUse, $rootScope.shippingAddress);\r\n                    } else if (typeFetch == 'other') {\r\n                        $mdDialog.show(Modals.getAddressesPopup()).then(function (address) {\r\n                            console.log(\"Got address\", address);\r\n                            $scope.setAddressInfields(typeUse, address);\r\n                        }, function () {\r\n                            console.log(\"Got nothing\");\r\n                        });\r\n                    }\r\n                }\r\n                $scope.setAddressInfields = function (type, address) {\r\n                    if (!address.phone) {\r\n                        address.phone = $rootScope.user.cellphone;\r\n                    }\r\n                    if (type == \"payer\") {\r\n                        $scope.data2.payer_address = address.address;\r\n                        $scope.data2.payer_postal = address.postal;\r\n                        $scope.data2.payer_city = address.cityName;\r\n                        $scope.data2.payer_state = address.regionName;\r\n                        $scope.data2.payer_country = address.countryCode;\r\n                        $scope.data2.payer_phone = address.phone;\r\n                    } else if (type == \"buyer\") {\r\n                        $scope.data2.buyer_address = address.address;\r\n                        $scope.data2.buyer_postal = address.postal;\r\n                        $scope.data2.buyer_city = address.cityName;\r\n                        $scope.data2.buyer_state = address.regionName;\r\n                        $scope.data2.buyer_country = address.countryCode;\r\n                        $scope.data2.buyer_phone = address.phone;\r\n                    }\r\n                }\r\n\r\n                $scope.showMethod = function (method) {\r\n                    $scope.credito = false;\r\n                    $scope.cash = false;\r\n                    $scope.debito = false;\r\n                    if (method == \"PSE\") {\r\n                        $scope.debito = true;\r\n                        Billing.getBanks().then(function (data) {\r\n                            $scope.banks = data.banks;\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                    if (method == \"CC\") {\r\n                        $scope.data2.buyer_country = \"CO\";\r\n                        $scope.data2.payer_country = \"CO\";\r\n                        if ($rootScope.addresses && $rootScope.addresses.length > 0) {\r\n                        } else {\r\n                            $rootScope.$broadcast('getAddresses');\r\n                        }\r\n                        $scope.credito = true;\r\n                    }\r\n                    if (method == \"BALOTO\") {\r\n                        $scope.cash = true;\r\n                    }\r\n                }\r\n            }])\r\n\r\n        .controller('CheckoutBookCtrl', ['$scope', '$rootScope', 'Cart', function ($scope, $rootScope, Cart) {\r\n                $scope.appointments = [];\r\n                $scope.visibleBooking = false;\r\n                $scope.loadPendingItems = function () {\r\n                    console.log(\"loadPendingItems\", $rootScope.items)\r\n                    var pending = false;\r\n                    for (var item in $rootScope.items) {\r\n                        var container = $rootScope.items[item];\r\n                        console.log(\"item\", container);\r\n                        if (container.attributes.type == \"Booking\") {\r\n                            if (!container.attributes.id) {\r\n                                container.pending = true;\r\n                                pending = true;\r\n                            } else {\r\n                                container.pending = false;\r\n                            }\r\n                            $scope.appointments.push(container);\r\n\r\n                            $scope.visibleBooking = true;\r\n                        }\r\n                    }\r\n                    if (pending) {\r\n                        $rootScope.bookingSet = false;\r\n                    } else {\r\n                        $rootScope.bookingSet = true;\r\n                    }\r\n                }\r\n                $scope.programItem = function (item) {\r\n                    var params = {\r\n                        \"availabilities\": null,\r\n                        \"type\": \"Merchant\",\r\n                        \"objectId\": item.attributes.merchant_id,\r\n                        \"objectName\": item.name,\r\n                        \"objectDescription\": item.null,\r\n                        \"objectIcon\": null,\r\n                        \"expectedPrice\": item.price,\r\n                        \"questions\": item.attributes.questions,\r\n                        \"item_id\": item.id,\r\n                        \"quantity\": item.quantity,\r\n                        \"purpose\": \"external_book\",\r\n                        \"alert\": \"#checkout-booking\"\r\n                    }\r\n                    console.log(\"Sending paramsparamsparams\", params);\r\n                    Cart.showBooking(params).then(function (result) {\r\n                        console.log(\"Got result\", result);\r\n                        if (result && result == \"Carrito actualizado\") {\r\n                            item.pending = false;\r\n                            var missing = false;\r\n                            for (var i = 0; i < $scope.appointments.length; i++) {\r\n                                if ($scope.appointments[i].pending) {\r\n                                    missing = true;\r\n                                }\r\n                            }\r\n                            if (!missing) {\r\n                                $rootScope.bookingSet = true;\r\n                                $rootScope.$broadcast('buildOrder');\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                $rootScope.$on('Shippable', function (event, args) {\r\n                    console.log(\"Booking shippable\");\r\n                    $scope.loadPendingItems()\r\n                });\r\n                $rootScope.$on('NotShippable', function (event, args) {\r\n                    $scope.loadPendingItems();\r\n                    if ($scope.appointments.length == 0) {\r\n                        $rootScope.$broadcast('buildOrder');\r\n                    }\r\n                });\r\n            }]).controller('CheckoutGatewaysCtrl', function () {\r\n\r\n})\r\n        //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9jaGVja291dGN0cmwuanM/YTYwNiJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcclxuXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NoZWNrb3V0Q2FydEN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NhcnQnLCAnT3JkZXJzJywgJ01vZGFscycsICckcScsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIENhcnQsIE9yZGVycywgTW9kYWxzLCAkcSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3Vwb24gPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjY2VwdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjY2VwdEVycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzRGlnaXRhbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5ib29raW5nU2V0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW5Kc29uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhbmd1bGFyLmVsZW1lbnQoXCIuaXRlbS1hdHRyaWJ1dGVzXCIpLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGFuZ3VsYXIuZWxlbWVudCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGEuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHggaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IHggKyBcIjogXCIgKyBvYmpbeF0gKyBcIiA8YnIvPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuaHRtbChodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0ID0gZnVuY3Rpb24gKGluaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LmdldENoZWNrb3V0Q2FydCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdlcnJvcicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZENhcnQoZGF0YSwgaW5pdClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLkFjY2VwdFRlcm1zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWNjZXB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hY2NlcHRFcnJvciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRPcmRlciA9IGZ1bmN0aW9uIChpbml0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgT3JkZXJzLmdldE9yZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzRGlnaXRhbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT3JkZXIgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKFwiRG9uZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVDYXJ0SXRlbSA9IGZ1bmN0aW9uIChpdGVtX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHF1YW50aXR5ID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9Y2hlY2stcXVhbnRpdHktJyArIGl0ZW1faWQgKyAnXScpKS52YWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IGl0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ2Vycm9yJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jbGVhckNhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5jbGVhckNhcnQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkQ2FydCA9IGZ1bmN0aW9uIChkYXRhLCBpbml0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuaXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXMgPSBkYXRhLml0ZW1zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2hpcHBhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpdGVtID0gaXRlbXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW06IFwiLCBpdGVtLmF0dHJpYnV0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uYXR0cmlidXRlcy5pc19zaGlwcGFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGlwcGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXMgPSBkYXRhLml0ZW1zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWxJdGVtcyA9IGRhdGEudG90YWxJdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1YnRvdGFsID0gZGF0YS5zdWJ0b3RhbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNoaXBwaW5nID0gZGF0YS5zaGlwcGluZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRheCA9IGRhdGEudGF4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2FsZSA9IGRhdGEuc2FsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdXBvbiA9IGRhdGEuY291cG9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGlzY291bnQgPSBkYXRhLnNhbGUgKyBkYXRhLmNvdXBvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gZGF0YS50b3RhbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJCcm9hZGNhc3Rpbmcgc2hpcHBhYmxlOiBcIiwgc2hpcHBhYmxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlwcGFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ1NoaXBwYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldE9yZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ05vdFNoaXBwYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy8nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5wcmVwYXJlT3JkZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBY2NlcHRcIiwgJHNjb3BlLmFjY2VwdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY2NlcHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdwcmVwYXJlT3JkZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWNjZXB0RXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5kZWxldGVDYXJ0SXRlbSA9IGZ1bmN0aW9uIChpdGVtX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IGl0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ2Vycm9yJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNldENvdXBvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3NldFRpbWVvdXQoZnVuY3Rpb24oKXsgTW9kYWxzLmhpZGVMb2FkZXIoKTsgfSwgMjAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jb3Vwb24gJiYgJHNjb3BlLmNvdXBvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9yZGVycy5zZXRDb3Vwb24oJHNjb3BlLmNvdXBvbikudGhlbihmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdXBvbiA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoJ0N1cG9uIGFncmVnYWRvIGV4aXRvc2FtZW50ZScsICQoXCIjZmluYWwtc3VibWl0XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KCdObyBwdWVkZXMgdXNhciBlc2UgY3Vwb24nLCAkKFwiI2ZpbmFsLXN1Ym1pdFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdCgnSW5ncmVzYSB1biBjdXBvbicsICQoXCIjZmluYWwtc3VibWl0XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigndXBkYXRlQ2hlY2tvdXRDYXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ3VwZGF0ZUxvYWRlZENhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZUxvYWRlZENhcnRcIiwgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRDYXJ0KGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja291dFNoaXBwaW5nQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnTG9jYXRpb25TZXJ2aWNlJywgJ1VzZXJzJywgJyRxJyxcclxuICAgICAgICAgICAgJ0NhcnQnLCAnJGNvb2tpZXMnLCAnT3JkZXJzJywgJ01vZGFscycsICdCaWxsaW5nJywgJyRsb2NhdGlvbicsICckYW5jaG9yU2Nyb2xsJyxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgTG9jYXRpb25TZXJ2aWNlLCBVc2VycywgJHEsIENhcnQsICRjb29raWVzLCBPcmRlcnMsIE1vZGFscywgQmlsbGluZywgJGxvY2F0aW9uLCAkYW5jaG9yU2Nyb2xsKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NTZXQgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zaGlwcGluZyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXNGZXRjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3NTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0NvbmRpdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQ29uZGl0aW9uU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmJpbGxpbmdBZGRyZXNzU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBheW1lbnRNZXRob2RTZXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignU2hpcHBhYmxlJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3NTZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQ29uZGl0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5iaWxsaW5nQWRkcmVzc1NldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucGF5bWVudE1ldGhvZFNldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyQWRkcmVzcyA9ICRjb29raWVzLmdldChcInNoaXBwaW5nQWRkcmVzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYWRkcmVzcyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ckFkZHJlc3MgJiYgc3RyQWRkcmVzcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgPSBKU09OLnBhcnNlKHN0ckFkZHJlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNoaXBwaW5nIGFkZHJlc3M6IFwiLCBhZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIiRyb290U2NvcGUudXNlcjogXCIsICRyb290U2NvcGUudXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHJlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZGRyZXNzLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0gYWRkcmVzcztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEubmFtZSA9ICRyb290U2NvcGUudXNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnBob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RQbGFjZSgkc2NvcGUuZGF0YS5jb3VudHJ5X2lkLCAkc2NvcGUuZGF0YS5yZWdpb25faWQsICRzY29wZS5kYXRhLmNpdHlfaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRyZXNzLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0QWRkcmVzcyhhZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5hZGRyZXNzZXMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV3QWRkcmVzcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyaWVzID0gW3tuYW1lOiBcIkNvbG9tYmlhXCIsIGlkOiAxfSwge25hbWU6IFwiQ29sb21iaWEyXCIsIGlkOiAyfV1cclxuXHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5uZXdBZGRyZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJzaGlwcGluZ0FkZHJlc3NcIiwgXCJcIiwge3BhdGg6IFwiL1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgdXJsLCB7cGF0aDogXCIvXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2xvY2F0aW9uXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigncHJlcGFyZU9yZGVyJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByZXBhcmVPcmRlcigpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignYnVpbGRPcmRlcicsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5idWlsZE9yZGVyKCRyb290U2NvcGUuYWN0aXZlT3JkZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignTm90U2hpcHBhYmxlJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2dldEFkZHJlc3NlcycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuSnNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goYW5ndWxhci5lbGVtZW50KFwiLml0ZW0tYXR0cmlidXRlc1wiKSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBhbmd1bGFyLmVsZW1lbnQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShhLmh0bWwoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh4IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSB4ICsgXCI6IFwiICsgb2JqW3hdICsgXCIgPGJyLz5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVXNlcnMuc2F2ZUFkZHJlc3MoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0QWRkcmVzcyhkYXRhLmFkZHJlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlQWRkcmVzc0Zvcm0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIFVzZXJzLmdldEFkZHJlc3NlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hZGRyZXNzZXMgPSBkYXRhLmFkZHJlc3NlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoXCJkb25lXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKFwiZXJyb3JcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdENvdW50cnkgPSBmdW5jdGlvbiAoY291bnRyeV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRSZWdpb25zQ291bnRyeShjb3VudHJ5X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25zID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RSZWdpb24gPSBmdW5jdGlvbiAocmVnaW9uX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENpdGllc1JlZ2lvbihyZWdpb25faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UGxhY2UgPSBmdW5jdGlvbiAoY291bnRyeV9pZCwgcmVnaW9uX2lkLCBjaXR5X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jb3VudHJ5X2lkID0gY291bnRyeV9pZDtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0UmVnaW9uc0NvdW50cnkoY291bnRyeV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIHJlZ2lvblwiLCAkc2NvcGUuZGF0YS5yZWdpb25faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5yZWdpb25faWQgPSByZWdpb25faWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRDaXRpZXNSZWdpb24ocmVnaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBjaXR5X2lkXCIsICRzY29wZS5kYXRhLmNpdHlfaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIGNpdGllc1wiLCAkc2NvcGUuY2l0aWVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNpdHlfaWQgPSBjaXR5X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAvL30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RBZGRyZXNzID0gZnVuY3Rpb24gKGFkZHJlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc1NldCA9IGFkZHJlc3M7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB7YWRkcmVzc19pZDogYWRkcmVzcy5pZH07XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBPcmRlcnMuc2V0U2hpcHBpbmdBZGRyZXNzKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXQgc2hpcHBpbmcgYWRkcmVzc1wiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzc1NldCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyA9IGFkZHJlc3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJzaGlwcGluZ0FkZHJlc3NcIiwgSlNPTi5zdHJpbmdpZnkoJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpLCB7cGF0aDogXCIvXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcmRlciA9IGRhdGEub3JkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXR0cmlidXRlcyA9IEpTT04ucGFyc2Uob3JkZXIuYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT3JkZXIgPSBvcmRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwcm92aWRlcnMgPSBhdHRyaWJ1dGVzLnByb3ZpZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gcHJvdmlkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJQcm92aWRlcnM6IFwiLCBwcm92aWRlcnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIGRpc2NvdW50c1wiLCAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzc1NldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRPcmRlcihvcmRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkZ1ZXJhIGRlIGNvYmVydHVyYSBwYXJhIGVzdGEgb3JkZW5cIiwgJChcIiNjaGVja291dC1zaGlwcGluZ1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zY3JvbGxUbyA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2xkID0gJGxvY2F0aW9uLmhhc2goKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2goaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5oYXNoKG9sZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZE9yZGVyID0gZnVuY3Rpb24gKG9yZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgT3JkZXJzLnNldERpc2NvdW50cyhvcmRlci5pZCwgXCJCb29raW5nXCIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEaXNjb3VudHMgc2V0XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YVMgPSB7XCJwYXllcnNcIjogWyRyb290U2NvcGUudXNlci5pZF0sIFwicGxhdGZvcm1cIjogXCJCb29raW5nXCJ9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBPcmRlcnMuY2hlY2tPcmRlcihvcmRlci5pZCwgZGF0YVMpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2sgT3JkZXIgUmVzdWx0XCIsIHJlc3ApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcmRlciA9IHJlc3Aub3JkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0RpZ2l0YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUucHJlcGFyZU9yZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkRpcmVjY2lvbiBndWFyZGFkYVwiLCAkKFwiI2NoZWNrb3V0LXNoaXBwaW5nXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVDaGVja291dENhcnQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtc2hpcHBpbmctbWV0aG9kc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGaW5pc2hlZCBzY3JvbGxpbmcyMjIyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oYW5kbGVDaGVja0Vycm9yKHJlc3AsIG9yZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQ2FydEl0ZW0gPSBmdW5jdGlvbiAocHJvZHVjdF92YXJpYW50LCBleHRyYXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LmFkZENhcnRJdGVtKHByb2R1Y3RfdmFyaWFudCwgZXh0cmFzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcImVycm9yXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUNoZWNrb3V0Q2FydCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2V0U2hpcHBpbmdDb25kaXRpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXQgU2hpcHBpbmdcIiwgaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcInByb3ZpZGVyXCI6IGl0ZW0uY2xhc3MsIFwicHJvdmlkZXJfaWRcIjogaXRlbS5pZH07XHJcbiAgICAgICAgICAgICAgICAgICAgT3JkZXJzLnNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb24oJHJvb3RTY29wZS5hY3RpdmVPcmRlci5pZCwgY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2V0UGxhdGZvcm1TaGlwcGluZ1ByaWNlIFJlc3VsdFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUxvYWRlZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPcmRlciA9IGRhdGEub3JkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICRzY29wZS5zaGlwcGluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaGlwcGluZ1tpXS5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0NvbmRpdGlvblNldCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnByaWNlID0gZGF0YS5jYXJ0LnNoaXBwaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiRW52aW8gYWdyZWdhZG8gZXhpdG9zYW1lbnRlXCIsICQoXCIjY2hlY2tvdXQtc2hpcHBpbmdcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gZXJyb3IgY29uIGVzZSBtZXRvZG8gZGUgZW52aW9cIiwgJChcIiNjaGVja291dC1zaGlwcGluZ1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciBjb24gZXNlIG1ldG9kbyBkZSBlbnZpb1wiLCAkKFwiI2NoZWNrb3V0LXNoaXBwaW5nXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhhbmRsZUNoZWNrRXJyb3IgPSBmdW5jdGlvbiAocmVzcCwgb3JkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC50eXBlID09IFwiY3JlZGl0c1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtaXNzaW5nID0gcGFyc2VJbnQocmVzcC5yZXF1aXJlZF9jcmVkaXRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXF1aXJlZCBjcmVkaXRzXCIsIG1pc3NpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNyZWRpdEl0ZW1cIiwgcmVzcC5jcmVkaXRJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkhlbW9zIGFncmVnYWRvIHVuIGl0ZW0gb2JsaWdhdG9yaW9cIiwgJChcIiNjaGVja291dC1zaGlwcGluZ1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlZGl0SXRlbU1lcmNoYW50XCIsIHJlc3AuY3JlZGl0SXRlbU1lcmNoYW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyX2lkOiBvcmRlci5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfdmFyaWFudF9pZDogcmVzcC5jcmVkaXRJdGVtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IG1pc3NpbmcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyY2hhbnRfaWQ6IHJlc3AuY3JlZGl0SXRlbU1lcmNoYW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRDYXJ0SXRlbShjb250YWluZXIsIFtdKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3AudHlwZSA9PSBcImJ1eWVyc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwLnR5cGUgPT0gXCJzaGlwcGluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5hcGkudG9hc3QoJ0NIRUNLT1VUX1BSRVBBUkUuUkVRVUlSRVNfU0hJUFBJTkcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtc2hpcHBpbmctbWV0aG9kc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkRlYmVzIHNlbGVjY2lvbmFyIHByb3ZlZWRvciBkZSBlbnZpb1wiLCAkKFwiI2NoZWNrb3V0LXNoaXBwaW5nLW1ldGhvZHNcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnNoaXBwaW5nLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhwZWN0ZWRQcm92aWRlcnMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKG9yZGVyLmF0dHJpYnV0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMucHJvdmlkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiBhdHRyaWJ1dGVzLnByb3ZpZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhwZWN0ZWRQcm92aWRlcnMrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFBsYXRmb3JtU2hpcHBpbmdQcmljZShyZXNwLm9yZGVyLmlkLCBhdHRyaWJ1dGVzLnByb3ZpZGVyc1tpdGVtXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwLnR5cGUgPT0gXCJkZWxpdmVyeVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qdGhpcy5hcGkudG9hc3QoJ0NIRUNLT1VUX1BSRVBBUkUuUkVRVUlSRVNfREVMSVZFUlknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpLmRpc21pc3NMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmREYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRJdGVtcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBlbmREYXRlLnNldERhdGUoZW5kRGF0ZS5nZXREYXRlKCkgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5kZWxpdmVyeSA9IGVuZERhdGUudG9JU09TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGVsaXZlcnlcIiwgdGhpcy5kZWxpdmVyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcXVpcmVzRGVsaXZlcnkgPSB0cnVlOyovXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFBsYXRmb3JtU2hpcHBpbmdQcmljZSA9IGZ1bmN0aW9uIChvcmRlcl9pZCwgcGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSBwbGF0Zm9ybS5kZXNjO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwbGF0Zm9ybS5kZXNjO1xyXG4gICAgICAgICAgICAgICAgICAgIE9yZGVycy5nZXRQbGF0Zm9ybVNoaXBwaW5nUHJpY2Uob3JkZXJfaWQsIHBsYXRmb3JtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0UGxhdGZvcm1TaGlwcGluZ1ByaWNlIFJlc3VsdFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmV4cGVjdGVkUHJvdmlkZXJzLS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBwbGF0Zm9ybS5wcm92aWRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF0Zm9ybS5wcm92aWRlciA9PSBcIk1lcmNoYW50U2hpcHBpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBcIkRvbWljaWxpbyBkZWwgRXN0YWJsZWNpbWllbnRvXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7cGxhdGZvcm06IG5hbWUsIGNsYXNzOiBwbGF0Zm9ybS5wcm92aWRlciwgcHJpY2U6IGRhdGEucHJpY2UsIGRlc2M6IGRlc2NyaXB0aW9uLCBpZDogcGxhdGZvcm0ucHJvdmlkZXJfaWQsIHNlbGVjdGVkOiBmYWxzZX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWRkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJHNjb3BlLnNoaXBwaW5nLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnQgPSAkc2NvcGUuc2hpcHBpbmdbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnQucGxhdGZvcm0gPT0gY29udGFpbmVyLnBsYXRmb3JtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250LnByaWNlIDw9IGNvbnRhaW5lci5wcmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3QgYWRkaW5nXCIsIGNvbnRhaW5lcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmluZ1wiLCBjb250KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNoaXBwaW5nLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hpcHBpbmcucHVzaChjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5leHBlY3RlZFByb3ZpZGVycyA9PSAwICYmICEkcm9vdFNjb3BlLnNoaXBwaW5nQ29uZGl0aW9uU2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldFNoaXBwaW5nQ29uZGl0aW9uKCRzY29wZS5zaGlwcGluZ1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBdXRvIHNlbGVjdFwiLCAkc2NvcGUuc2hpcHBpbmcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmV4cGVjdGVkUHJvdmlkZXJzLS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWRkcmVzc0Zvcm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgd2luZG93LmxvY2F0aW9uLmhyZWYsIHtwYXRoOiBcIi9cIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9jYXRpb25cIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5oaWRlQWRkcmVzc0Zvcm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZEFkZHJlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VBZGRyZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hhbmdlIGFkZHJlc3NcIilcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzc1NldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdDb25kaXRpb25TZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQWRkcmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmFkZHJlc3NlcyAmJiAkcm9vdFNjb3BlLmFkZHJlc3Nlcy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5hZGRyZXNzZXMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV3QWRkcmVzcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlU2hpcHBpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0NvbmRpdGlvblNldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByZXBhcmVPcmRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93UGF5bWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaGlwcGluZ0Vycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBheWVycyA9IFskcm9vdFNjb3BlLnVzZXIuaWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCByZWN1cnJpbmdfdHlwZSA9IFwibGltaXRcIjtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVjdXJyaW5nX3ZhbHVlID0gMztcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9yZGVyX2lkXCI6ICRyb290U2NvcGUuYWN0aXZlT3JkZXIuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicGF5ZXJzXCI6IHBheWVycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJkZWxpdmVyeV9kYXRlXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3BsaXRfb3JkZXJcIjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicGxhdGZvcm1cIjogXCJCb29raW5nXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjdXJyaW5nXCI6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY3VycmluZ190eXBlXCI6IHJlY3VycmluZ190eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY3VycmluZ192YWx1ZVwiOiByZWN1cnJpbmdfdmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVyY2hhbnRfaWRcIjogJHJvb3RTY29wZS5hY3RpdmVPcmRlci5tZXJjaGFudF9pZFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgT3JkZXJzLnByZXBhcmVPcmRlcihjb250YWluZXIsIFwiQm9va2luZ1wiKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiU2VsZWNjaW9uYSBtw6l0b2RvIGRlIGVudsOtb1wiLCAkKFwiI2NoZWNrb3V0LWNhcnRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib3JkZXJQcm92aWRlclwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQgPSByZXNwLnBheW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPcmRlciA9IHJlc3Aub3JkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGF5bWVudC50b3RhbCA9PSAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQudHJhbnNhY3Rpb25fY29zdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXltZW50X2lkXCI6ICRyb290U2NvcGUuYWN0aXZlUGF5bWVudC5pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJpbGxpbmcuY29tcGxldGVQYWlkT3JkZXIoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC50cmFuc2FjdGlvbiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24ucmVmZXJlbmNlX3NhbGUgPSBcIlBhZ28gSW50ZXJub1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24ucGF5bWVudF9tZXRob2QgPSBcIlBhZ28gSW50ZXJub1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24uZGVzY3JpcHRpb24gPSBcIlBhZ28gSW50ZXJub1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25faWQgPSByZXNwLnBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC50cmFuc2FjdGlvbi50cmFuc2FjdGlvbl9zdGF0ZSA9IFwiQVBQUk9WRURcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3RyYW5zYWN0aW9uUmVzcG9uc2UnLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dQYXltZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dQYXltZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5zY3JvbGxUb1RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb21wbGV0ZVBhaWRPcmRlckVycm9yXCIsIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnYWN0aXZhdGVQYXltZW50Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFuZGxlQ2hlY2tFcnJvcihyZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0Q2FydEVycm9yXCIsIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yIHBvcmZhdm9yIGNvbXVuaWNhdGUgbWFzIHRhcmRlXCIsICQoXCIjY2hlY2tvdXQtY2FydFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja291dEJpbGxpbmdDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdMb2NhdGlvblNlcnZpY2UnLCAnVXNlcnMnLCAnQmlsbGluZycsICckbG9jYXRpb24nLCAnJGFuY2hvclNjcm9sbCcsICdNb2RhbHMnLCAnJG1kRGlhbG9nJywgJ0NhcnQnLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBMb2NhdGlvblNlcnZpY2UsIFVzZXJzLCBCaWxsaW5nLCAkbG9jYXRpb24sICRhbmNob3JTY3JvbGwsIE1vZGFscywgJG1kRGlhbG9nLCBDYXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRyYW5zYWN0aW9uID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYmFua3MgPSBbXTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUucGF5bWVudEFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWRpdENhcmRWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlZGl0UGF5ZXJWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlZGl0QnV5ZXJWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlZGl0byA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dSZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHRIZWFkZXIgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEJvZHkgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhc2ggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kZWJpdG8gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUueWVhcnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9udGhzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkLmdldEZ1bGxZZWFyKClcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IDkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tb250aHMucHVzaChcIjBcIiArIChpICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vbnRocy5wdXNoKGkgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnllYXJzLnB1c2goeWVhciArIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGQgPSAkbG9jYXRpb24uaGFzaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24uaGFzaChpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhbmNob3JTY3JvbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2gob2xkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2FjdGl2YXRlUGF5bWVudCcsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucGF5bWVudEFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtcGF5bWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYWxsICRhbmNob3JTY3JvbGwoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigndHJhbnNhY3Rpb25SZXNwb25zZScsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlTG9hZGVkQ2FydFwiLCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb25SZXNwb25zZShhcmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmtleXRhYiA9IGZ1bmN0aW9uIChldmVudCwgbWF4bGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFdmVudFwiLCBldmVudClcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRJbnB1dCA9IHRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmc7IC8vIGdldCB0aGUgc2libGluZyBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25leHRJbnB1dCcsIG5leHRJbnB1dCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXQnLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXR2YWx1ZScsIHRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3RhcmdldHR5cGUnLCB0YXJnZXQubm9kZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQudmFsdWUubGVuZ3RoIDwgbWF4bGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRJbnB1dCA9PSBudWxsKSAgLy8gY2hlY2sgdGhlIG1heExlbmd0aCBmcm9tIGhlcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dElucHV0LmZvY3VzKCk7ICAgLy8gZm9jdXMgaWYgbm90IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVkaXRUYWIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gdGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBicmFuY2ggPSAoL14oPzo1WzEtNV1bMC05XXsyfXwyMjJbMS05XXwyMlszLTldWzAtOV18MlszLTZdWzAtOV17Mn18MjdbMDFdWzAtOV18MjcyMClbMC05XXsxMn0kLy50ZXN0KHZhbHVlKSkgPyBcIk1BU1RFUkNBUkRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL14oNFswLTldezEyfSg/OlswLTldezN9KT8kKXwoXjYwNjM3NFswLTldezEwfSQpLy50ZXN0KHZhbHVlKSkgPyBcIlZJU0FcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL14zWzQ3XVswLTldezEzfSQvLnRlc3QodmFsdWUpKSA/ICdBTUVYJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL15bMzVdKD86MFswLTVdfFs2OF1bMC05XSlbMC05XXsxMX0kfF4zMFswLTVdezExfSR8XjMwOTVbMC05XXsxMH0kfF4zNlswLTldezEyfSR8XjNbODldWzAtOV17MTJ9JC8udGVzdCh2YWx1ZSkpID8gJ0RJTkVSUydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKC9eNig/OjAxMXw1WzAtOV17Mn18NFs0LTldWzAtOV0pWzAtOV17MTJ9JC8udGVzdCh2YWx1ZSkpID8gJ0RJU0NPVkVSJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL141ODk1NjJbMC05XXsxMH0kLy50ZXN0KHZhbHVlKSkgPyAnTkFSQU5KQSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKC9eNjAzNDg4WzAtOV17MTB9JHxeMjc5OVswLTldezl9JC8udGVzdCh2YWx1ZSkpID8gJ1NIT1BQSU5HJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL142MDQoKFsyM11bMC05XXsyfSl8KDQwMCkpWzAtOV17MTB9JHxeNTg5NjU3WzAtOV17MTB9JC8udGVzdCh2YWx1ZSkpID8gJ0NBQkFMJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL142MDM0OTNbMC05XXsxMH0kLy50ZXN0KHZhbHVlKSkgPyAnQVJHRU5DQVJEJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL141OTA3MTJbMC05XXsxMH0kLy50ZXN0KHZhbHVlKSkgPyAnQ09ERU5TQSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKC9eNjI3MTgwWzAtOV17MTB9JC8udGVzdCh2YWx1ZSkpID8gJ0NNUidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVkaXQgYnJhbmNoXCIsIGJyYW5jaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmNjX2JyYW5jaCA9IGJyYW5jaDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvblJlc3BvbnNlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uc2UgcGF5dVwiLCBkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIENhcnQuY2xlYXJDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtcGF5bWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5tZXNzYWdlICE9IFwiZXJyb3JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1Jlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvbiA9IGRhdGEudHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uX3N0YXRlID09IFwiQVBQUk9WRURcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEhlYWRlciA9IFwiUGFnbyBhcHJvYmFkb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEJvZHkgPSBcIlR1IHBhZ28gaGEgc2lkbyBjb21wbGV0YWRvLCByZXZpc2EgdHUgY29ycmVvIHBhcmEgcmVjaWJpciB0dSBjb21wcmFcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uX3N0YXRlID09IFwiUEVORElOR1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0SGVhZGVyID0gXCJQYWdvIHBlbmRpZW50ZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEJvZHkgPSBcIlR1IHRyYW5zYWNjaW9uIGVzdGEgc2llbmRvIHZlcmlmaWNhZGEsIGN1YW5kbyBjb21wbGV0ZSBsYSB2ZXJpZmljYWNpb24gcmVjaWJpcmFzIHVuIGNvcnJlbyBjb24gZWwgcmVzdWx0YWRvXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0SGVhZGVyID0gXCJQYWdvIG5lZ2Fkb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEJvZHkgPSBcIlR1IHRyYW5zYWNjaW9uIGhhIHNpZG8gbmVnYWRhLiBQb3JmYXZvciBpbnRlbnRhIG90cm8gbWV0b2RvIHUgb3RyYSB0YXJqZXRhLiBFbiBNaSBjdWVudGEgPiBNaXMgUGFnb3MgcHVlZGVzIHJlaW50ZW50YXIgZWwgcGFnb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gZXJyb3IuIFBvcmZhdm9yIHZlcmlmaWNhIHR1cyBkYXRvc1wiLCAkKFwiI2NoZWNrb3V0LXBheW1lbnRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXlDcmVkaXRDYXJkID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfYWRkcmVzcyA9ICRzY29wZS5kYXRhMi5wYXllcl9hZGRyZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9wb3N0YWwgPSAkc2NvcGUuZGF0YTIucGF5ZXJfcG9zdGFsO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9jaXR5ID0gJHNjb3BlLmRhdGEyLnBheWVyX2NpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX3N0YXRlID0gJHNjb3BlLmRhdGEyLnBheWVyX3N0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9jb3VudHJ5ID0gJHNjb3BlLmRhdGEyLnBheWVyX2NvdW50cnk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX3Bob25lID0gJHNjb3BlLmRhdGEyLnBheWVyX3Bob25lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGxhdGZvcm0gPSBcIkJvb2tpbmdcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmVtYWlsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheW1lbnRfaWQgPSAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJpbGxpbmcucGF5Q3JlZGl0Q2FyZCgkc2NvcGUuZGF0YTIsIFwiUGF5VVwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb25SZXNwb25zZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmRhdGEyID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnF1aWNrUGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1aWNrOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50X2lkOiAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtOiBcIkJvb2tpbmdcIlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBCaWxsaW5nLnBheUNyZWRpdENhcmQoY29udGFpbmVyLCBcIlBheVVcIikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb25SZXNwb25zZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuZGF0YTIgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RPcHRpb24gPSBmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE0LnBheW1lbnRfbWV0aG9kID0gb3B0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zY3JvbGxUbyhcImNhc2gtZm9ybVwiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvcHVsYXRlUGF5ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5kYXRhMi5wYXllcl9uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YTIucGF5ZXJfbmFtZS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX25hbWUgPSAkc2NvcGUuZGF0YTIuY2NfbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9uYW1lID0gJHNjb3BlLmRhdGEyLmNjX25hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBheURlYml0Q2FyZCA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZDMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy5wbGF0Zm9ybSA9IFwiQm9va2luZ1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMuZW1haWwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5bWVudF9pZCA9ICRyb290U2NvcGUuYWN0aXZlUGF5bWVudC5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmlsbGluZy5wYXlEZWJpdCgkc2NvcGUuZGF0YTMsIFwiUGF5VVwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5jb2RlID09IFwiU1VDQ0VTU1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25SZXNwb25zZS5zdGF0ZSA9PSBcIlBFTkRJTkdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2hvd1Byb21wdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LmNsZWFyQ2FydCgpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gZGF0YS50cmFuc2FjdGlvblJlc3BvbnNlLmV4dHJhUGFyYW1ldGVycy5CQU5LX1VSTDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIHByb2JsZW1hLiBQb3JmYXZvciBpbnRlbnRhIG90cm8gbWVkaW8uIFwiLCAkKFwiI2NoZWNrb3V0LXBheW1lbnRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBwcm9ibGVtYS4gUG9yZmF2b3IgaW50ZW50YSBvdHJvIG1lZGlvLiBcIiwgJChcIiNjaGVja291dC1wYXltZW50XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXlDYXNoID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkNCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE0LnBsYXRmb3JtID0gXCJCb29raW5nXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5lbWFpbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wYXltZW50X2lkID0gJHJvb3RTY29wZS5hY3RpdmVQYXltZW50LmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaWxsaW5nLnBheUNhc2goJHNjb3BlLmRhdGE0LCBcIlBheVVcIikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWZ0ZXIgcGF5Q2FzaFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LmNsZWFyQ2FydCgpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25SZXNwb25zZS5leHRyYVBhcmFtZXRlcnMuVVJMX1BBWU1FTlRfUkVDRUlQVF9IVE1MKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEudHJhbnNhY3Rpb25SZXNwb25zZS5leHRyYVBhcmFtZXRlcnMuVVJMX1BBWU1FTlRfUkVDRUlQVF9IVE1MO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gcHJvYmxlbWEuIFBvcmZhdm9yIGludGVudGEgb3RybyBtZWRpby4gXCIsICQoXCIjY2hlY2tvdXQtcGF5bWVudFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBwcm9ibGVtYS4gUG9yZmF2b3IgaW50ZW50YSBvdHJvIG1lZGlvLiBcIiwgJChcIiNjaGVja291dC1wYXltZW50XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuMiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5maWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5jY19icmFuY2ggPSBcIlZJU0FcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuY2NfbmFtZSA9IFwiQVBQUk9WRURcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuY2NfbnVtYmVyID0gXCI0MTExMTExMTExMTExMTExXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmNjX3NlY3VyaXR5X2NvZGUgPSBcIjEyM1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5jY19leHBpcmF0aW9uX21vbnRoID0gXCIwOVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5jY19leHBpcmF0aW9uX3llYXIgPSBcIjIwMTdcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfZW1haWwgPSBcImhhcnJlZG9uMDFAZ21haWwuY29tXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX2lkID0gXCIzMjEzMjEzMjFcIjtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsbDIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLnVzZXJfdHlwZSA9IFwiTlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy5wc2VfcmVmZXJlbmNlMiA9IFwiQ0NcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucHNlX3JlZmVyZW5jZTMgPSBcIjEwMjA3MTY1MzVcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5ZXJfZW1haWwgPSBcImhhcnJlZG9uMDFAZ21haWwuY29tXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbGwzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wYXllcl9lbWFpbCA9IFwiaGFycmVkb24wMUBnbWFpbC5jb21cIjtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0Q291bnRyeSA9IGZ1bmN0aW9uIChjb3VudHJ5X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldFJlZ2lvbnNDb3VudHJ5KGNvdW50cnlfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvbnMgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFJlZ2lvbiA9IGZ1bmN0aW9uIChyZWdpb25faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKHJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RQbGFjZSA9IGZ1bmN0aW9uIChjb3VudHJ5X2lkLCByZWdpb25faWQsIGNpdHlfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jb3VudHJ5X2lkID0gY291bnRyeV9pZDtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0UmVnaW9uc0NvdW50cnkoY291bnRyeV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVnaW9uX2lkID0gcmVnaW9uX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKHJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jaXR5X2lkID0gY2l0eV9pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FkZHJlc3NGb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlID0gXCJiaWxsaW5nXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZUFkZHJlc3NGb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlVXNlckRlYml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy51c2VyX3R5cGUgPSBcIk5cIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMuZG9jX3R5cGUgPSBcIk5cIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5ZXJfbmFtZSA9ICRyb290U2NvcGUudXNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy5wYXllcl9pZCA9ICRyb290U2NvcGUudXNlci5kb2NOdW07XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLnBheWVyX3Bob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5ZXJfZW1haWwgPSAkcm9vdFNjb3BlLnVzZXIuZW1haWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlVXNlckNyZWRpdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuY2NfbmFtZSA9ICRyb290U2NvcGUudXNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9uYW1lID0gJHJvb3RTY29wZS51c2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX2lkID0gJHJvb3RTY29wZS51c2VyLmRvY051bTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfcGhvbmUgPSAkcm9vdFNjb3BlLnVzZXIuY2VsbHBob25lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9lbWFpbCA9ICRyb290U2NvcGUudXNlci5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQWRkcmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZVVzZXJDYXNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wYXllcl9lbWFpbCA9ICRyb290U2NvcGUudXNlci5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTQucGF5ZXJfaWQgPSAkcm9vdFNjb3BlLnVzZXIuZG9jTnVtO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZldGNoQWRkcmVzc0ZvclVzZSA9IGZ1bmN0aW9uICh0eXBlRmV0Y2gsIHR5cGVVc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZUZldGNoID09ICdzaGlwcGluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldEFkZHJlc3NJbmZpZWxkcyh0eXBlVXNlLCAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlRmV0Y2ggPT0gJ290aGVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0QWRkcmVzc2VzUG9wdXAoKSkudGhlbihmdW5jdGlvbiAoYWRkcmVzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3QgYWRkcmVzc1wiLCBhZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRBZGRyZXNzSW5maWVsZHModHlwZVVzZSwgYWRkcmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IG5vdGhpbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZXRBZGRyZXNzSW5maWVsZHMgPSBmdW5jdGlvbiAodHlwZSwgYWRkcmVzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYWRkcmVzcy5waG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzLnBob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJwYXllclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9hZGRyZXNzID0gYWRkcmVzcy5hZGRyZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfcG9zdGFsID0gYWRkcmVzcy5wb3N0YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9jaXR5ID0gYWRkcmVzcy5jaXR5TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX3N0YXRlID0gYWRkcmVzcy5yZWdpb25OYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfY291bnRyeSA9IGFkZHJlc3MuY291bnRyeUNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9waG9uZSA9IGFkZHJlc3MucGhvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IFwiYnV5ZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfYWRkcmVzcyA9IGFkZHJlc3MuYWRkcmVzcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX3Bvc3RhbCA9IGFkZHJlc3MucG9zdGFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfY2l0eSA9IGFkZHJlc3MuY2l0eU5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9zdGF0ZSA9IGFkZHJlc3MucmVnaW9uTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX2NvdW50cnkgPSBhZGRyZXNzLmNvdW50cnlDb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfcGhvbmUgPSBhZGRyZXNzLnBob25lO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd01ldGhvZCA9IGZ1bmN0aW9uIChtZXRob2QpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3JlZGl0byA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXNoID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlYml0byA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXRob2QgPT0gXCJQU0VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGViaXRvID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmlsbGluZy5nZXRCYW5rcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5iYW5rcyA9IGRhdGEuYmFua3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGhvZCA9PSBcIkNDXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX2NvdW50cnkgPSBcIkNPXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9jb3VudHJ5ID0gXCJDT1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5hZGRyZXNzZXMgJiYgJHJvb3RTY29wZS5hZGRyZXNzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdnZXRBZGRyZXNzZXMnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3JlZGl0byA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXRob2QgPT0gXCJCQUxPVE9cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FzaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XSlcclxuXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NoZWNrb3V0Qm9va0N0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NhcnQnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBDYXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXBwb2ludG1lbnRzID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudmlzaWJsZUJvb2tpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUGVuZGluZ0l0ZW1zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9hZFBlbmRpbmdJdGVtc1wiLCAkcm9vdFNjb3BlLml0ZW1zKVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkcm9vdFNjb3BlLml0ZW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSAkcm9vdFNjb3BlLml0ZW1zW2l0ZW1dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIml0ZW1cIiwgY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5hdHRyaWJ1dGVzLnR5cGUgPT0gXCJCb29raW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29udGFpbmVyLmF0dHJpYnV0ZXMuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIucGVuZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5wZW5kaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwb2ludG1lbnRzLnB1c2goY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudmlzaWJsZUJvb2tpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYm9va2luZ1NldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYm9va2luZ1NldCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2dyYW1JdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImF2YWlsYWJpbGl0aWVzXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcIk1lcmNoYW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0SWRcIjogaXRlbS5hdHRyaWJ1dGVzLm1lcmNoYW50X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdE5hbWVcIjogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdERlc2NyaXB0aW9uXCI6IGl0ZW0ubnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3RJY29uXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhwZWN0ZWRQcmljZVwiOiBpdGVtLnByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInF1ZXN0aW9uc1wiOiBpdGVtLmF0dHJpYnV0ZXMucXVlc3Rpb25zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1faWRcIjogaXRlbS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJxdWFudGl0eVwiOiBpdGVtLnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInB1cnBvc2VcIjogXCJleHRlcm5hbF9ib29rXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWxlcnRcIjogXCIjY2hlY2tvdXQtYm9va2luZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyBwYXJhbXNwYXJhbXNwYXJhbXNcIiwgcGFyYW1zKTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dCb29raW5nKHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IHJlc3VsdFwiLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdCA9PSBcIkNhcnJpdG8gYWN0dWFsaXphZG9cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wZW5kaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWlzc2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUuYXBwb2ludG1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hcHBvaW50bWVudHNbaV0ucGVuZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXNzaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1pc3NpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmJvb2tpbmdTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnYnVpbGRPcmRlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignU2hpcHBhYmxlJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJCb29raW5nIHNoaXBwYWJsZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFBlbmRpbmdJdGVtcygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdOb3RTaGlwcGFibGUnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFBlbmRpbmdJdGVtcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXBwb2ludG1lbnRzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnYnVpbGRPcmRlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XSkuY29udHJvbGxlcignQ2hlY2tvdXRHYXRld2F5c0N0cmwnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG59KVxyXG4gICAgICAgIFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2NoZWNrb3V0Y3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 11 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('DeliveriesCtrl',['$scope', '$rootScope', 'Food', 'MapService', function ($scope, $rootScope, Food, MapService) {\n            $scope.data = {};\n            $scope.listArticles = {};\n            $scope.deliveries = [];\n            $scope.page = 0;\n            $scope.loadMore = true;\n            $scope.status = 'enqueue';\n            $scope.activeDate = '';\n            $scope.regionVisible = false;\n            $scope.editAddress = false;\n            $scope.mapActive = false;\n            angular.element(document).ready(function () {\n\n                var date = new Date();\n                var day = date.getDay();\n                if (day < 6) {\n                    date.setDate(date.getDate() + 1);\n                } else if (day == 6) {\n                    date.setDate(date.getDate() + 2);\n                }\n                $scope.activeDate = date.getFullYear() + '-' + (date.getMonth() + 1) + \"-\" + date.getDate();\n                $scope.getArticles();\n                $scope.buildDatePicker();\n\n            });\n            $scope.buildDatePicker = function () {\n                var dateFormat = \"yy-mm-dd\",\n                        from = $(\"#from\")\n                        .datepicker({\n                            defaultDate: \"+1d\",\n                            changeMonth: true,\n                            numberOfMonths: 2,\n                            dateFormat: dateFormat\n                        })\n                        .on(\"change\", function () {\n                            console.log(\"date1\", $scope.activeDate);\n                            var date = $scope.getDate(this);\n                            $scope.activeDate = date.getFullYear() + '-' + (date.getMonth() + 1) + \"-\" + date.getDate();\n                            console.log(\"date\", $scope.activeDate);\n                        });\n\n            }\n            $scope.getDate = function (element) {\n                console.log(\"Get date\", element.value);\n                var date;\n                try {\n                    date = $.datepicker.parseDate(\"yy-mm-dd\", element.value);\n                } catch (error) {\n                    date = null;\n                }\n\n                return date;\n            }\n            $scope.updateDels = function () {\n                $scope.page =0;\n                $scope.deliveries = [];\n                $scope.getArticles();\n            }\n            $scope.activateMap = function () {\n                $scope.mapActive = true;\n                console.log(\"Creating map data\")\n                MapService.createMap(4.685419, -74.064161);\n                $scope.createMapData();\n            }\n            $scope.changeScenario = function () {\n                $scope.getDeliveries();\n            }\n            $scope.createMapData = function () {\n                console.log(\"Creating map data\")\n                var firstdelivery = $scope.deliveries[0];\n                var count = 0;\n                var i = 0;\n                for (var item in $scope.deliveries) {\n                    i++;\n                    if ($scope.deliveries[item].address_id == firstdelivery.address_id) {\n                        count++;\n                    } else {\n                        firstdelivery.icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + count + '|FE6256|000000'\n                        MapService.createStop(firstdelivery);\n                        firstdelivery = $scope.deliveries[item];\n                        count = 1;\n                    }\n                    if (i == $scope.deliveries.length) {\n                        firstdelivery.icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + count + '|FE6256|000000'\n                        MapService.createStop(firstdelivery);\n                    }\n                }\n            }\n            $scope.getDeliveries = function () {\n                console.log(\"Status\", $scope.status);\n                $scope.page++;\n                var url = \"includes=user,address&limit=50&order_by=address_id,asc&page=\" + $scope.page + \"&status=\" + $scope.status + \"&delivery=\" + $scope.activeDate + \" 12:00:00\";\n                Food.getDeliveries(url).then(function (data) {\n                    var deliveriesCont = data.data;\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    if (deliveriesCont.length > 0) {\n                        for (item in deliveriesCont) {\n                            var delivery = deliveriesCont[item];\n                            delivery.details = JSON.parse(delivery.details);\n                            delivery.name = delivery.address.address;\n                            delivery.lat = delivery.address.lat;\n                            delivery.delivery = new Date(delivery.delivery);\n                            delivery.long = delivery.address.long;\n                            $scope.deliveries.push(delivery);\n                        }\n                    }\n                    console.log(\"Deliveries\", $scope.deliveries);\n                    $scope.replaceFood();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.clean = function () {\n                $scope.data = {};\n                $scope.regionVisible = false;\n                $scope.cityVisible = false;\n            }\n            $scope.sendReminder = function () {\n                Food.sendReminder().then(function (data) {\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.sendNewsletter = function () {\n                Food.sendNewsletter();\n            }\n            $scope.showAll = function () {\n                console.log(\"Creating map data\")\n                for (item in $scope.deliveries) {\n                    $scope.deliveries[item].marker.setMap($rootScope.map);\n                }\n            }\n            $scope.hideAll = function () {\n                for (item in $scope.deliveries) {\n                    $scope.deliveries[item].marker.setMap(null);\n                }\n            }\n            $scope.showDelivery = function (delivery) {\n                $scope.hideAll();\n                delivery.marker.setMap($rootScope.map);\n            }\n\n            $scope.clean = function () {\n                $scope.data = {};\n                $scope.regionVisible = false;\n                $scope.cityVisible = false;\n            }\n            $scope.updateDeliveryAddress = function (user, address) {\n\n                Food.updateDeliveryAddress(user, address).then(function (data) {\n                    window.location.reload();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getPurchaseOrder = function () {\n                Food.getPurchaseOrder().then(function (data) {\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getArticle = function (id) {\n                console.log(\"getArticle\", id);\n                for (var item in $scope.listArticles) {\n                    if ($scope.listArticles[item].id == id) {\n                        console.log(\"getArticleres\", $scope.listArticles[item]);\n                        return $scope.listArticles[item];\n                    }\n                }\n            }\n            $scope.replaceFood = function () {\n                console.log(\"articles\", $scope.listArticles);\n                for (var item in $scope.deliveries) {\n                    console.log(\"delivery\", $scope.deliveries[item].id);\n                    var attributes = $scope.deliveries[item].details;\n                    if (attributes.dish) {\n                        $scope.deliveries[item].build = false;\n                        $scope.deliveries[item].type_id = attributes.dish.type_id;\n                        var article = $scope.getArticle(attributes.dish.type_id);\n                        if (article) {\n                            attributes.tipoAlmuerzo = article.name;\n                            for (item2 in article.attributes.entradas) {\n                                if (article.attributes.entradas[item2].codigo == attributes.dish.starter_id) {\n                                    attributes.entrada = article.attributes.entradas[item2].valor;\n                                    $scope.deliveries[item].starter_id = attributes.dish.starter_id;\n                                }\n                            }\n                            for (item3 in article.attributes.plato) {\n                                if (article.attributes.plato[item3].codigo == attributes.dish.main_id) {\n                                    attributes.plato = article.attributes.plato[item3].valor;\n                                    $scope.deliveries[item].main_id = attributes.dish.main_id;\n                                }\n                            }\n                            delete attributes.dish;\n                            delete attributes.products;\n                            delete attributes.merchant_id;\n                            $scope.deliveries[item].details = attributes;\n                        }\n                        console.log(\"deliveryDone\", $scope.deliveries[item].id);\n                    } else {\n                        $scope.deliveries[item].type_id = null;\n                        $scope.deliveries[item].starter_id = null;\n                        $scope.deliveries[item].main_id = null;\n                        $scope.deliveries[item].build = true;\n                    }\n                }\n            }\n            $scope.selectMissingType = function (item) {\n                var article = $scope.getArticle(item.type_id);\n                item.starters = article.attributes.entradas;\n                item.mains = article.attributes.plato;\n            }\n            $scope.selectDish = function (item) {\n                var attributes = item.details;\n                var article = $scope.getArticle(item.type_id);\n                attributes.tipoAlmuerzo = article.name;\n                for (item2 in article.attributes.entradas) {\n                    if (article.attributes.entradas[item2].codigo == item.starter_id) {\n                        attributes.entrada = article.attributes.entradas[item2].valor;\n                    }\n                }\n                for (item3 in article.attributes.plato) {\n                    if (article.attributes.plato[item3].codigo == item.main_id) {\n                        attributes.plato = article.attributes.plato[item3].valor;\n                    }\n                }\n                item.details = attributes;\n                var container = {\n                    \"delivery_id\": item.id,\n                    \"type_id\": item.type_id,\n                    \"main_id\": item.main_id\n                };\n                if (item.starter_id) {\n                    container.starter_id = item.starter_id;\n                }\n                item.build = false;\n                console.log(\"Updating dish: \", container);\n                Food.updateMissingDish(container);\n            }\n            $scope.getArticles = function () {\n                Food.getArticlesByDate($scope.activeDate).then(function (data) {\n                    $scope.listArticles = data.data;\n                    for (var item in $scope.listArticles) {\n                        $scope.listArticles[item].attributes = JSON.parse($scope.listArticles[item].attributes);\n                    }\n                    $scope.getDeliveries();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.regenerateDeliveries = function () {\n                Food.regenerateDeliveries().then(function (data) {\n                },\n                        function (data) {\n\n                        });\n            }\n\n            $scope.getInputs = function () {\n                var data;\n                if ($scope.status == \"enqueue\") {\n                    data = {\n                        \"status\": \"enqueue\"\n                    };\n                } else {\n                    data = {\n                        \"status\": $scope.status,\n                        \"provider\": $scope.provider,\n                        \"type\": $scope.scenario\n                    };\n                }\n                return data;\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9kZWxpdmVyaWVzY3RybC5qcz9jMmRhIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdEZWxpdmVyaWVzQ3RybCcsWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdGb29kJywgJ01hcFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBGb29kLCBNYXBTZXJ2aWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmxpc3RBcnRpY2xlcyA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gJ2VucXVldWUnO1xuICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGUgPSAnJztcbiAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEFkZHJlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIGxldCBkYXkgPSBkYXRlLmdldERheSgpO1xuICAgICAgICAgICAgICAgIGlmIChkYXkgPCA2KSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF5ID09IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVEYXRlID0gZGF0ZS5nZXRGdWxsWWVhcigpICsgJy0nICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpICsgXCItXCIgKyBkYXRlLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QXJ0aWNsZXMoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGREYXRlUGlja2VyKCk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkRGF0ZVBpY2tlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IFwieXktbW0tZGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gPSAkKFwiI2Zyb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRlcGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCIrMWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNb250aDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGUxXCIsICRzY29wZS5hY3RpdmVEYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0ZSA9ICRzY29wZS5nZXREYXRlKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVEYXRlID0gZGF0ZS5nZXRGdWxsWWVhcigpICsgJy0nICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpICsgXCItXCIgKyBkYXRlLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGVcIiwgJHNjb3BlLmFjdGl2ZURhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXREYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlXCIsIGVsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRlO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSAkLmRhdGVwaWNrZXIucGFyc2VEYXRlKFwieXktbW0tZGRcIiwgZWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlRGVscyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9MDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRBcnRpY2xlcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmFjdGl2YXRlTWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY4NTQxOSwgLTc0LjA2NDE2MSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTY2VuYXJpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RGVsaXZlcmllcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgIGxldCBmaXJzdGRlbGl2ZXJ5ID0gJHNjb3BlLmRlbGl2ZXJpZXNbMF07XG4gICAgICAgICAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuZGVsaXZlcmllcykge1xuICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5hZGRyZXNzX2lkID09IGZpcnN0ZGVsaXZlcnkuYWRkcmVzc19pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ZGVsaXZlcnkuaWNvbiA9ICdodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9tYXBfcGluX2xldHRlciZjaGxkPScgKyBjb3VudCArICd8RkU2MjU2fDAwMDAwMCdcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlU3RvcChmaXJzdGRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ZGVsaXZlcnkgPSAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAkc2NvcGUuZGVsaXZlcmllcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ZGVsaXZlcnkuaWNvbiA9ICdodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9tYXBfcGluX2xldHRlciZjaGxkPScgKyBjb3VudCArICd8RkU2MjU2fDAwMDAwMCdcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlU3RvcChmaXJzdGRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXREZWxpdmVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhdHVzXCIsICRzY29wZS5zdGF0dXMpO1xuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiaW5jbHVkZXM9dXNlcixhZGRyZXNzJmxpbWl0PTUwJm9yZGVyX2J5PWFkZHJlc3NfaWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJnN0YXR1cz1cIiArICRzY29wZS5zdGF0dXMgKyBcIiZkZWxpdmVyeT1cIiArICRzY29wZS5hY3RpdmVEYXRlICsgXCIgMTI6MDA6MDBcIjtcbiAgICAgICAgICAgICAgICBGb29kLmdldERlbGl2ZXJpZXModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkZWxpdmVyaWVzQ29udCA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA9PSBkYXRhLmxhc3RfcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGl2ZXJpZXNDb250Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBkZWxpdmVyaWVzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWxpdmVyeSA9IGRlbGl2ZXJpZXNDb250W2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGl2ZXJ5LmRldGFpbHMgPSBKU09OLnBhcnNlKGRlbGl2ZXJ5LmRldGFpbHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGl2ZXJ5Lm5hbWUgPSBkZWxpdmVyeS5hZGRyZXNzLmFkZHJlc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnkubGF0ID0gZGVsaXZlcnkuYWRkcmVzcy5sYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnkuZGVsaXZlcnkgPSBuZXcgRGF0ZShkZWxpdmVyeS5kZWxpdmVyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnkubG9uZyA9IGRlbGl2ZXJ5LmFkZHJlc3MubG9uZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllcy5wdXNoKGRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRlbGl2ZXJpZXNcIiwgJHNjb3BlLmRlbGl2ZXJpZXMpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwbGFjZUZvb2QoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNlbmRSZW1pbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBGb29kLnNlbmRSZW1pbmRlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VuZE5ld3NsZXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgRm9vZC5zZW5kTmV3c2xldHRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNob3dBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuZGVsaXZlcmllcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5tYXJrZXIuc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuaGlkZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmRlbGl2ZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0ubWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2hvd0RlbGl2ZXJ5ID0gZnVuY3Rpb24gKGRlbGl2ZXJ5KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBbGwoKTtcbiAgICAgICAgICAgICAgICBkZWxpdmVyeS5tYXJrZXIuc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVEZWxpdmVyeUFkZHJlc3MgPSBmdW5jdGlvbiAodXNlciwgYWRkcmVzcykge1xuXG4gICAgICAgICAgICAgICAgRm9vZC51cGRhdGVEZWxpdmVyeUFkZHJlc3ModXNlciwgYWRkcmVzcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdldFB1cmNoYXNlT3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgRm9vZC5nZXRQdXJjaGFzZU9yZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXRBcnRpY2xlID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXRBcnRpY2xlXCIsIGlkKTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRzY29wZS5saXN0QXJ0aWNsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5saXN0QXJ0aWNsZXNbaXRlbV0uaWQgPT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0QXJ0aWNsZXJlc1wiLCAkc2NvcGUubGlzdEFydGljbGVzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUubGlzdEFydGljbGVzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnJlcGxhY2VGb29kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYXJ0aWNsZXNcIiwgJHNjb3BlLmxpc3RBcnRpY2xlcyk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuZGVsaXZlcmllcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGl2ZXJ5XCIsICRzY29wZS5kZWxpdmVyaWVzW2l0ZW1dLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5kZXRhaWxzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5kaXNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5idWlsZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0udHlwZV9pZCA9IGF0dHJpYnV0ZXMuZGlzaC50eXBlX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFydGljbGUgPSAkc2NvcGUuZ2V0QXJ0aWNsZShhdHRyaWJ1dGVzLmRpc2gudHlwZV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGlwb0FsbXVlcnpvID0gYXJ0aWNsZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbTIgaW4gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnRpY2xlLmF0dHJpYnV0ZXMuZW50cmFkYXNbaXRlbTJdLmNvZGlnbyA9PSBhdHRyaWJ1dGVzLmRpc2guc3RhcnRlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5lbnRyYWRhID0gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzW2l0ZW0yXS52YWxvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyaWVzW2l0ZW1dLnN0YXJ0ZXJfaWQgPSBhdHRyaWJ1dGVzLmRpc2guc3RhcnRlcl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0zIGluIGFydGljbGUuYXR0cmlidXRlcy5wbGF0bykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZS5hdHRyaWJ1dGVzLnBsYXRvW2l0ZW0zXS5jb2RpZ28gPT0gYXR0cmlidXRlcy5kaXNoLm1haW5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucGxhdG8gPSBhcnRpY2xlLmF0dHJpYnV0ZXMucGxhdG9baXRlbTNdLnZhbG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0ubWFpbl9pZCA9IGF0dHJpYnV0ZXMuZGlzaC5tYWluX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhdHRyaWJ1dGVzLmRpc2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXMucHJvZHVjdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXMubWVyY2hhbnRfaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0uZGV0YWlscyA9IGF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGl2ZXJ5RG9uZVwiLCAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS50eXBlX2lkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyaWVzW2l0ZW1dLnN0YXJ0ZXJfaWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0ubWFpbl9pZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5idWlsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0TWlzc2luZ1R5cGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGxldCBhcnRpY2xlID0gJHNjb3BlLmdldEFydGljbGUoaXRlbS50eXBlX2lkKTtcbiAgICAgICAgICAgICAgICBpdGVtLnN0YXJ0ZXJzID0gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzO1xuICAgICAgICAgICAgICAgIGl0ZW0ubWFpbnMgPSBhcnRpY2xlLmF0dHJpYnV0ZXMucGxhdG87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0RGlzaCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBpdGVtLmRldGFpbHM7XG4gICAgICAgICAgICAgICAgbGV0IGFydGljbGUgPSAkc2NvcGUuZ2V0QXJ0aWNsZShpdGVtLnR5cGVfaWQpO1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGlwb0FsbXVlcnpvID0gYXJ0aWNsZS5uYW1lO1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbTIgaW4gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnRpY2xlLmF0dHJpYnV0ZXMuZW50cmFkYXNbaXRlbTJdLmNvZGlnbyA9PSBpdGVtLnN0YXJ0ZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuZW50cmFkYSA9IGFydGljbGUuYXR0cmlidXRlcy5lbnRyYWRhc1tpdGVtMl0udmFsb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpdGVtMyBpbiBhcnRpY2xlLmF0dHJpYnV0ZXMucGxhdG8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFydGljbGUuYXR0cmlidXRlcy5wbGF0b1tpdGVtM10uY29kaWdvID09IGl0ZW0ubWFpbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wbGF0byA9IGFydGljbGUuYXR0cmlidXRlcy5wbGF0b1tpdGVtM10udmFsb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaXRlbS5kZXRhaWxzID0gYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICBcImRlbGl2ZXJ5X2lkXCI6IGl0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgIFwidHlwZV9pZFwiOiBpdGVtLnR5cGVfaWQsXG4gICAgICAgICAgICAgICAgICAgIFwibWFpbl9pZFwiOiBpdGVtLm1haW5faWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLnN0YXJ0ZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnN0YXJ0ZXJfaWQgPSBpdGVtLnN0YXJ0ZXJfaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGl0ZW0uYnVpbGQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIGRpc2g6IFwiLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgIEZvb2QudXBkYXRlTWlzc2luZ0Rpc2goY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXRBcnRpY2xlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBGb29kLmdldEFydGljbGVzQnlEYXRlKCRzY29wZS5hY3RpdmVEYXRlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5saXN0QXJ0aWNsZXMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gJHNjb3BlLmxpc3RBcnRpY2xlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RBcnRpY2xlc1tpdGVtXS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZSgkc2NvcGUubGlzdEFydGljbGVzW2l0ZW1dLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXREZWxpdmVyaWVzKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnJlZ2VuZXJhdGVEZWxpdmVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIEZvb2QucmVnZW5lcmF0ZURlbGl2ZXJpZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SW5wdXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCBkYXRhO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3RhdHVzID09IFwiZW5xdWV1ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiBcImVucXVldWVcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiAkc2NvcGUuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlclwiOiAkc2NvcGUucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnNjZW5hcmlvXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2RlbGl2ZXJpZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 12 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('ExportsCtrl', ['$scope','Merchants','$mdDialog','Modals', function ($scope, Merchants,$mdDialog,Modals) {\r\n                $scope.data = {};\r\n                $scope.orders;\r\n                $scope.from;\r\n                $scope.to;\r\n                $scope.user;\r\n                $scope.activeMerchant = null;\r\n                $scope.activeMerchantObject;\r\n                $scope.changeMerchant = true;\r\n                $scope.showSearch = false;\r\n                $scope.showError = false;\r\n                $scope.datPickerBuilt = false;\r\n                $scope.loadMore = true,\r\n                        $scope.page = 0;\r\n                angular.element(document).ready(function () {\r\n\r\n                    $scope.getMerchantsPrivate()\r\n                    //$scope.getMerchantsPrivate();\r\n                });\r\n                $scope.getMerchants = function () {\r\n                    $scope.page++;\r\n                    Merchants.searchMerchants($scope.searchTerms).then(function (data) {\r\n                        console.log(\"Items\", data.data);\r\n                        $scope.merchants = data.data;\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.getMerchantsPrivate = function () {\r\n                    Merchants.getMerchantsUser().then(function (data) {\r\n                        if (data.status == \"success\") {\r\n                            $scope.merchants = data.data;\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.changeActiveMerchant = function () {\r\n                    $scope.changeMerchant = true;\r\n                }\r\n                $scope.cancelChangeMerchant = function () {\r\n                    $scope.changeMerchant = false;\r\n                }\r\n                $scope.selectMerchant = function (item) {\r\n\r\n                    $scope.page = 0;\r\n                    $scope.items = [];\r\n                    $scope.activeMerchantObject = item;\r\n                    $scope.activeMerchant = item.id + \"\";\r\n                    $scope.changeMerchant = false;\r\n                    if (!$scope.datPickerBuilt) {\r\n                        setTimeout(function () {\r\n                            $scope.buildDatePicker();\r\n                        }, 800);\r\n\r\n                    }\r\n                }\r\n\r\n                $scope.buildDatePicker = function () {\r\n                    $scope.datPickerBuilt = true;\r\n                    var dateFormat = \"yy-mm-dd\",\r\n                            from = $(\"#from\")\r\n                            .datepicker({\r\n                                defaultDate: \"-1m\",\r\n                                changeMonth: true,\r\n                                numberOfMonths: 2,\r\n                                dateFormat: dateFormat\r\n                            })\r\n                            .on(\"change\", function () {\r\n                                to.datepicker(\"option\", \"minDate\", $scope.getDate(this));\r\n                                $scope.from = $scope.getDate(this);\r\n                            }),\r\n                            to = $(\"#to\").datepicker({\r\n                        defaultDate: \"+1w\",\r\n                        changeMonth: true,\r\n                        numberOfMonths: 2,\r\n                        dateFormat: dateFormat\r\n                    })\r\n                            .on(\"change\", function () {\r\n                                from.datepicker(\"option\", \"maxDate\", $scope.getDate(this));\r\n                                $scope.to = $scope.getDate(this);\r\n                            });\r\n                }\r\n                $scope.getDate = function (element) {\r\n                    console.log(\"Get date\", element.value);\r\n                    var date;\r\n                    try {\r\n                        date = $.datepicker.parseDate(\"yy-mm-dd\", element.value);\r\n                    } catch (error) {\r\n                        date = null;\r\n                    }\r\n\r\n                    return date;\r\n                }\r\n                $scope.startExport = function (typeEx) {\r\n                    $scope.showError = false;\r\n                    if(!$scope.activeMerchant){\r\n                        $scope.showError = true;\r\n                        return;\r\n                    }\r\n                    if (typeEx == 'orders') {\r\n                        $scope.getStoreExport()\r\n                    } else {\r\n                        $scope.getContentExport(typeEx)\r\n                    }\r\n                }\r\n\r\n\r\n                $scope.getStoreExport = function () {\r\n                    console.log(\"Date\", $scope.from, $scope.to);\r\n                    var container = {\"from\": $scope.from, \"to\": $scope.to, \"merchant_id\": $scope.activeMerchant, \"type\": 'products'}\r\n                    Merchants.getStoreExport(container).then(function (data) {\r\n                        if (data.status == 'success') {\r\n                            $mdDialog.show(Modals.getExportPopup());\r\n                        } else {\r\n                            Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\");\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                                Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\");\r\n                            });\r\n                }\r\n                $scope.getContentExport = function (typeCont) {\r\n                    var container = {\"merchant_id\": $scope.activeMerchant, \"type\": typeCont}\r\n                    Merchants.getStoreContent(container).then(function (data) {\r\n                        if (data.status == 'success') {\r\n                            $mdDialog.show(Modals.getExportPopup());\r\n                        } else {\r\n                            Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\")\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                                Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\");\r\n                            });\r\n                }\r\n\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9leHBvcnRzY3RybC5qcz9mYWYyIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxyXG5cclxuICAgICAgICAuY29udHJvbGxlcignRXhwb3J0c0N0cmwnLCBbJyRzY29wZScsJ01lcmNoYW50cycsJyRtZERpYWxvZycsJ01vZGFscycsIGZ1bmN0aW9uICgkc2NvcGUsIE1lcmNoYW50cywkbWREaWFsb2csTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVycztcclxuICAgICAgICAgICAgICAgICRzY29wZS5mcm9tO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXI7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50T2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZU1lcmNoYW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93U2VhcmNoID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0UGlja2VyQnVpbHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzUHJpdmF0ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuZ2V0TWVyY2hhbnRzUHJpdmF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XHJcbiAgICAgICAgICAgICAgICAgICAgTWVyY2hhbnRzLnNlYXJjaE1lcmNoYW50cygkc2NvcGUuc2VhcmNoVGVybXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJdGVtc1wiLCBkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldE1lcmNoYW50c1ByaXZhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTWVyY2hhbnRzLmdldE1lcmNoYW50c1VzZXIoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUFjdGl2ZU1lcmNoYW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsQ2hhbmdlTWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZU1lcmNoYW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0TWVyY2hhbnQgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50T2JqZWN0ID0gaXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgPSBpdGVtLmlkICsgXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlTWVyY2hhbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5kYXRQaWNrZXJCdWlsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5idWlsZERhdGVQaWNrZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgODAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZERhdGVQaWNrZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdFBpY2tlckJ1aWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IFwieXktbW0tZGRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gPSAkKFwiI2Zyb21cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRlcGlja2VyKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCItMW1cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNb250aDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kYXRlcGlja2VyKFwib3B0aW9uXCIsIFwibWluRGF0ZVwiLCAkc2NvcGUuZ2V0RGF0ZSh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZyb20gPSAkc2NvcGUuZ2V0RGF0ZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gPSAkKFwiI3RvXCIpLmRhdGVwaWNrZXIoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCIrMXdcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlTW9udGg6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlck9mTW9udGhzOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbS5kYXRlcGlja2VyKFwib3B0aW9uXCIsIFwibWF4RGF0ZVwiLCAkc2NvcGUuZ2V0RGF0ZSh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvID0gJHNjb3BlLmdldERhdGUodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXREYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlXCIsIGVsZW1lbnQudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUgPSAkLmRhdGVwaWNrZXIucGFyc2VEYXRlKFwieXktbW0tZGRcIiwgZWxlbWVudC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zdGFydEV4cG9ydCA9IGZ1bmN0aW9uICh0eXBlRXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoISRzY29wZS5hY3RpdmVNZXJjaGFudCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlRXggPT0gJ29yZGVycycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFN0b3JlRXhwb3J0KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q29udGVudEV4cG9ydCh0eXBlRXgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U3RvcmVFeHBvcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRlXCIsICRzY29wZS5mcm9tLCAkc2NvcGUudG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XCJmcm9tXCI6ICRzY29wZS5mcm9tLCBcInRvXCI6ICRzY29wZS50bywgXCJtZXJjaGFudF9pZFwiOiAkc2NvcGUuYWN0aXZlTWVyY2hhbnQsIFwidHlwZVwiOiAncHJvZHVjdHMnfVxyXG4gICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5nZXRTdG9yZUV4cG9ydChjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdzdWNjZXNzJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldEV4cG9ydFBvcHVwKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gZXJyb3IsIHBvcmZhdm9yIGNvbXVuaWNhdGUgY29uIHNvcG9ydGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciwgcG9yZmF2b3IgY29tdW5pY2F0ZSBjb24gc29wb3J0ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldENvbnRlbnRFeHBvcnQgPSBmdW5jdGlvbiAodHlwZUNvbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1wibWVyY2hhbnRfaWRcIjogJHNjb3BlLmFjdGl2ZU1lcmNoYW50LCBcInR5cGVcIjogdHlwZUNvbnR9XHJcbiAgICAgICAgICAgICAgICAgICAgTWVyY2hhbnRzLmdldFN0b3JlQ29udGVudChjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdzdWNjZXNzJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldEV4cG9ydFBvcHVwKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gZXJyb3IsIHBvcmZhdm9yIGNvbXVuaWNhdGUgY29uIHNvcG9ydGVcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yLCBwb3JmYXZvciBjb211bmljYXRlIGNvbiBzb3BvcnRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9leHBvcnRzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 13 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('FoodAddressesCtrl',['$scope','Food', function ($scope,Food) {\n            $scope.data = {};\n            $scope.addresses;\n            $scope.regionVisible = false;\n            $scope.editAddress = false;\n            $scope.mapActive = false;\n            angular.element(document).ready(function () {\n                $scope.getAddresses();\n            });\n            $scope.delegateAddress = function (address,complete ) {\n                var provider = \"\";\n                if(address.provider == \"Rapigo\"){\n                    provider = \"Basilikum\";\n                } else {\n                    provider = \"Rapigo\";\n                }\n                var theDate = new Date(address.delivery);\n                var container = {\n                    \"address\":address.address,\n                    \"provider\":provider,\n                    \"complete\":complete,\n                    \"merchant_id\":address.merchant_id\n                };\n                Food.delegateDeliveriesAddress(container).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n            }\n\n            $scope.buildAddressData = function (address) {\n                return address;\n            }\n            $scope.getAddresses = function () {\n                Food.getLargestAddresses().then(function (data) {\n                    var addressesCont = data.data;\n                    for (item in addressesCont) {\n                        addressesCont[item] = $scope.buildAddressData(addressesCont[item]);\n                    }\n                    $scope.addresses = addressesCont;\n                },\n                        function (data) {\n\n                        });\n            }\n\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9mb29kYWRkcmVzc2VzY3RybC5qcz83OGY5Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdGb29kQWRkcmVzc2VzQ3RybCcsWyckc2NvcGUnLCdGb29kJywgZnVuY3Rpb24gKCRzY29wZSxGb29kKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NlcztcbiAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEFkZHJlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmRlbGVnYXRlQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzLGNvbXBsZXRlICkge1xuICAgICAgICAgICAgICAgIGxldCBwcm92aWRlciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYoYWRkcmVzcy5wcm92aWRlciA9PSBcIlJhcGlnb1wiKXtcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXIgPSBcIkJhc2lsaWt1bVwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gXCJSYXBpZ29cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IHRoZURhdGUgPSBuZXcgRGF0ZShhZGRyZXNzLmRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NcIjphZGRyZXNzLmFkZHJlc3MsXG4gICAgICAgICAgICAgICAgICAgIFwicHJvdmlkZXJcIjpwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgXCJjb21wbGV0ZVwiOmNvbXBsZXRlLFxuICAgICAgICAgICAgICAgICAgICBcIm1lcmNoYW50X2lkXCI6YWRkcmVzcy5tZXJjaGFudF9pZFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgRm9vZC5kZWxlZ2F0ZURlbGl2ZXJpZXNBZGRyZXNzKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRBZGRyZXNzRGF0YSA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFkZHJlc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIEZvb2QuZ2V0TGFyZ2VzdEFkZHJlc3NlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFkZHJlc3Nlc0NvbnQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBhZGRyZXNzZXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzZXNDb250W2l0ZW1dID0gJHNjb3BlLmJ1aWxkQWRkcmVzc0RhdGEoYWRkcmVzc2VzQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NlcyA9IGFkZHJlc3Nlc0NvbnQ7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvZm9vZGFkZHJlc3Nlc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 14 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('FoodMessagesCtrl',['$scope', 'Food', function ($scope, Food) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page;\n                Food.getMessages(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                    console.log(\"Load more\",$scope.loadMore);\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                Food.updateMessageItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                Food.deleteMessageItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9mb29kbWVzc2FnZXNjdHJsLmpzPzhjOTgiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Zvb2RNZXNzYWdlc0N0cmwnLFsnJHNjb3BlJywgJ0Zvb2QnLCBmdW5jdGlvbiAoJHNjb3BlLCBGb29kKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJvcmRlcl9ieT1pZCxkZXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZTtcbiAgICAgICAgICAgICAgICBGb29kLmdldE1lc3NhZ2VzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2FkIG1vcmVcIiwkc2NvcGUubG9hZE1vcmUpO1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgRm9vZC51cGRhdGVNZXNzYWdlSXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBGb29kLmRlbGV0ZU1lc3NhZ2VJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9mb29kbWVzc2FnZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 15 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('GroupsSelectionCtrl',['$scope', 'Groups', '$rootScope', 'Users', function ($scope, Groups, $rootScope, Users) {\n            $scope.data = {};\n            $scope.invites = [];\n\n            $scope.groups = [];\n            $scope.contacts = [];\n            $scope.chosen = [];\n            $scope.searchText = \"\";\n            $scope.objectSelected = false;\n            $scope.editGroup = false;\n            $scope.isActive = false;\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                console.log(\"Saving: \" + isvalid);\n                if (isvalid) {\n                    $scope.saveGroup();\n                }\n            }\n            $scope.groupToggle = function () {\n                if ($scope.editGroup) {\n                    $scope.editGroup = false;\n                } else {\n                    $scope.editGroup = true;\n                    if ($scope.contacts.length == 0) {\n                        $scope.getContacts();\n                    }\n                }\n            }\n            $scope.activation = function () {\n                if ($scope.isActive) {\n                    $scope.isActive = false;\n                } else {\n                    $scope.isActive = true;\n                }\n            }\n\n            $scope.saveGroup = function () {\n                console.log(\"Data sent\");\n                console.log(JSON.stringify($scope.data));\n                console.log(JSON.stringify($.param($scope.data)));\n                var formData = {name: $scope.data.name, is_public: true, contacts: $scope.invites, completeData: $scope.chosen};\n                Groups.saveGroup($.param(formData)).then(function (data) {\n                    console.log(\"Return group\");\n                    console.log(JSON.stringify(data));\n                    if (data.status == \"success\") {\n                        $scope.selectGroup(data.group);\n                        $scope.groups.push(data.group);\n                    }\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getGroups = function () {\n\n                Groups.getGroups().then(function (data) {\n\n                    var groups = data.data;\n                    for (item in groups) {\n                        var group = groups[item];\n                        group.is_selected = false;\n                        $scope.groups.push(group);\n                    }\n                    if (groups.length == 0) {\n                        $scope.editGroup = true;\n                    }\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getContacts = function () {\n\n                Users.getContacts($scope.searchText).then(function (data) {\n                    $scope.contacts = [];\n                    $scope.contacts = data.data;\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.selectContact = function (contact) {\n                $scope.invites.push(contact.contact_id);\n                $scope.chosen.push(contact);\n                for(item in $scope.contacts){\n                    if($scope.contacts[item].contact_id == contact.contact_id){\n                        $scope.contacts.splice(item, 1);\n                    }\n                }\n            }\n            $scope.deleteContact = function (contact) {\n                for(item in $scope.chosen){\n                    if($scope.chosen[item].contact_id == contact.contact_id){\n                        $scope.chosen.splice(item, 1);\n                    }\n                }\n                for(item in $scope.invites){\n                    if($scope.invites[item] == contact.contact_id){\n                        $scope.chosen.splice(item, 1);\n                    }\n                }\n            }\n\n            $scope.selectGroup = function (group) {\n                group.is_selected = true\n                $scope.isActive = false;\n                $rootScope.$broadcast('ObjectSelected', {object_id: group.id});\n            }\n            $rootScope.$on('PlanSelected', function (event, args) {\n                $scope.isActive = true;\n                if ($scope.groups.length == 0) {\n                    $scope.getGroups();\n                }\n            });\n\n            $scope.clean = function () {\n                $scope.data = {};\n                $scope.invites = [];\n            }\n\n        }])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9ncm91cHNjdHJsLmpzP2FlN2YiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0dyb3Vwc1NlbGVjdGlvbkN0cmwnLFsnJHNjb3BlJywgJ0dyb3VwcycsICckcm9vdFNjb3BlJywgJ1VzZXJzJywgZnVuY3Rpb24gKCRzY29wZSwgR3JvdXBzLCAkcm9vdFNjb3BlLCBVc2Vycykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5pbnZpdGVzID0gW107XG5cbiAgICAgICAgICAgICRzY29wZS5ncm91cHMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5jb250YWN0cyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmNob3NlbiA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLm9iamVjdFNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEdyb3VwID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNhdmluZzogXCIgKyBpc3ZhbGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZUdyb3VwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdyb3VwVG9nZ2xlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZWRpdEdyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0R3JvdXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdEdyb3VwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jb250YWN0cy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENvbnRhY3RzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2F2ZUdyb3VwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YSBzZW50XCIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCRzY29wZS5kYXRhKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJC5wYXJhbSgkc2NvcGUuZGF0YSkpKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSB7bmFtZTogJHNjb3BlLmRhdGEubmFtZSwgaXNfcHVibGljOiB0cnVlLCBjb250YWN0czogJHNjb3BlLmludml0ZXMsIGNvbXBsZXRlRGF0YTogJHNjb3BlLmNob3Nlbn07XG4gICAgICAgICAgICAgICAgR3JvdXBzLnNhdmVHcm91cCgkLnBhcmFtKGZvcm1EYXRhKSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHVybiBncm91cFwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RHcm91cChkYXRhLmdyb3VwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ncm91cHMucHVzaChkYXRhLmdyb3VwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdldEdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIEdyb3Vwcy5nZXRHcm91cHMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuaXNfc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ncm91cHMucHVzaChncm91cCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3Vwcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRHcm91cCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0Q29udGFjdHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBVc2Vycy5nZXRDb250YWN0cygkc2NvcGUuc2VhcmNoVGV4dCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGFjdHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRhY3RzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RDb250YWN0ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW52aXRlcy5wdXNoKGNvbnRhY3QuY29udGFjdF9pZCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNob3Nlbi5wdXNoKGNvbnRhY3QpO1xuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluICRzY29wZS5jb250YWN0cyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5jb250YWN0c1tpdGVtXS5jb250YWN0X2lkID09IGNvbnRhY3QuY29udGFjdF9pZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGFjdHMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbnRhY3QgPSBmdW5jdGlvbiAoY29udGFjdCkge1xuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluICRzY29wZS5jaG9zZW4pe1xuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuY2hvc2VuW2l0ZW1dLmNvbnRhY3RfaWQgPT0gY29udGFjdC5jb250YWN0X2lkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaG9zZW4uc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluICRzY29wZS5pbnZpdGVzKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLmludml0ZXNbaXRlbV0gPT0gY29udGFjdC5jb250YWN0X2lkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaG9zZW4uc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0R3JvdXAgPSBmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgICAgICBncm91cC5pc19zZWxlY3RlZCA9IHRydWVcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ09iamVjdFNlbGVjdGVkJywge29iamVjdF9pZDogZ3JvdXAuaWR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdQbGFuU2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZ3JvdXBzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRHcm91cHMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmludml0ZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XSlcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2dyb3Vwc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 16 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('LeadCtrl', ['$scope', 'Leads', 'Modals', function ($scope, Leads, Modals) {\n                $scope.data = {};\n                $scope.key = \"\";\n                $scope.submitted = false;\n                $scope.category;\n                angular.element(document).ready(function () {\n                    var res = viewData;\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n                    $scope.key = container.key;\n                });\n\n                $scope.send = function (isvalid) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        grecaptcha.ready(function () {\n                            grecaptcha.execute($scope.key, {action: 'submit'}).then(function (token) {\n                                $scope.data.captcha = token;\n                                Modals.showLoader();\n                                Leads.sendLead($scope.data).then(function (data) {\n                                    Modals.hideLoader();\n                                    $scope.data = {};\n                                    Modals.showToast(\"Mensaje enviado\",$(\"#contact-form\"));\n                                },\n                                        function (data) {\n                                        });\n                            });\n                        });\n                    }\n                }\n                $scope.lead = function (isvalid,type) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        grecaptcha.ready(function () {\n                            grecaptcha.execute($scope.key, {action: 'submit'}).then(function (token) {\n                                $scope.data.captcha = token;\n                                $scope.data.type = type;\n                                Modals.showLoader();\n                                Leads.sendLead($scope.data).then(function (data) {\n                                    Modals.hideLoader();\n                                    $scope.data = {};\n                                    $scope.submitted = false;\n                                    Modals.showToast(\"Mensaje enviado\",$(\"#contact-form\"));\n                                },\n                                        function (data) {\n                                        });\n                            });\n                        });\n                    }\n                }\n            }])\n       //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9sZWFkc2N0cmwuanM/ZTM5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignTGVhZEN0cmwnLCBbJyRzY29wZScsICdMZWFkcycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBMZWFkcywgTW9kYWxzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUua2V5ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGE7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5rZXkgPSBjb250YWluZXIua2V5O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbmQgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyZWNhcHRjaGEucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyZWNhcHRjaGEuZXhlY3V0ZSgkc2NvcGUua2V5LCB7YWN0aW9uOiAnc3VibWl0J30pLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNhcHRjaGEgPSB0b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGVhZHMuc2VuZExlYWQoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIk1lbnNhamUgZW52aWFkb1wiLCQoXCIjY29udGFjdC1mb3JtXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxlYWQgPSBmdW5jdGlvbiAoaXN2YWxpZCx0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5leGVjdXRlKCRzY29wZS5rZXksIHthY3Rpb246ICdzdWJtaXQnfSkudGhlbihmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuY2FwdGNoYSA9IHRva2VuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGVhZHMuc2VuZExlYWQoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIk1lbnNhamUgZW52aWFkb1wiLCQoXCIjY29udGFjdC1mb3JtXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSlcbiAgICAgICBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9sZWFkc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 17 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .controller('MapLocationCtrl', ['$scope', '$rootScope', 'MapService', '$cookies', function ($scope, $rootScope, MapService, $cookies) {\n                $scope.map = {center: {latitude: 4.653450, longitude: -74.049605}, zoom: 8};\n                $rootScope.markers = [];\n                $rootScope.mapLoaded = false;\n                $scope.error = \"nada\";\n                var url = window.location.href;\n                var res = url.split(\"/map/\");\n                console.log(\"url\");\n                console.log(JSON.stringify(res));\n                MapService.createMap(4.653450, -74.049605);\n                MapService.postMapLocation();\n                $scope.activeMarker = MapService.createLocationMarker(4.653450, -74.049605, true);\n                console.log(navigator.geolocation);\n                if ($rootScope.shippingAddress && $rootScope.shippingAddress.lat) {\n                    console.log(\"Loading address from cookie\", $rootScope.shippingAddress);\n                    $scope.activeMarker.setPosition(new google.maps.LatLng($rootScope.shippingAddress.lat, $rootScope.shippingAddress.long))\n                    google.maps.event.trigger($scope.activeMarker, 'dragend');\n                } else {\n                    if (navigator.geolocation) {\n                        navigator.geolocation.getCurrentPosition(function (position) {\n                            $scope.$apply(function () {\n                                console.log(\"Position\", position);\n                                $scope.position = position;\n                                $scope.activeMarker.setPosition(new google.maps.LatLng(position.coords.latitude, position.coords.longitude))\n                                google.maps.event.trigger($scope.activeMarker, 'dragend');\n                            });\n                        });\n                    } \n                }\n\n                $scope.default = function () {\n                    MapService.createLocationMarker(4.653450, -74.049605, false);\n                }\n                $scope.cancel = function () {\n                    window.history.back();\n                }\n                $scope.saveLocation = function () {\n                    console.log(\"Loading address to cookie\", $rootScope.shippingAddress);\n                    $cookies.put(\"shippingAddress\", JSON.stringify($rootScope.shippingAddress), {path: \"/\"});\n                    console.log(\"shippingAddress\", JSON.stringify($rootScope.shippingAddress));\n                    var locationS = $cookies.get('locationRefferrer');\n                    $cookies.remove('locationRefferrer');\n                    var url = \"\";\n                    if (locationS && locationS.length > 0) {\n                        url = \"\";\n                        console.log(\"location\", locationS);\n                        if (locationS.includes('?')) {\n                            url = locationS + \"&lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long\n                        } else {\n                            url = locationS + \"?lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long\n                        }\n                        console.log(\"url\", url);\n                        //url = locationS;\n                    } else {\n                        url = \"/?lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long\n                    }\n                    $scope.error = \"la url es: \"+url;\n                    console.log(\"url\", url);\n                    window.location.href = url;\n                }\n\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9tYXBjdHJsLmpzP2JjZDYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdNYXBMb2NhdGlvbkN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ01hcFNlcnZpY2UnLCAnJGNvb2tpZXMnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBNYXBTZXJ2aWNlLCAkY29va2llcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXAgPSB7Y2VudGVyOiB7bGF0aXR1ZGU6IDQuNjUzNDUwLCBsb25naXR1ZGU6IC03NC4wNDk2MDV9LCB6b29tOiA4fTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcExvYWRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvciA9IFwibmFkYVwiO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdXJsLnNwbGl0KFwiL21hcC9cIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cmxcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzKSk7XG4gICAgICAgICAgICAgICAgTWFwU2VydmljZS5jcmVhdGVNYXAoNC42NTM0NTAsIC03NC4wNDk2MDUpO1xuICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UucG9zdE1hcExvY2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1hcmtlciA9IE1hcFNlcnZpY2UuY3JlYXRlTG9jYXRpb25NYXJrZXIoNC42NTM0NTAsIC03NC4wNDk2MDUsIHRydWUpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG5hdmlnYXRvci5nZW9sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzICYmICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvYWRpbmcgYWRkcmVzcyBmcm9tIGNvb2tpZVwiLCAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNYXJrZXIuc2V0UG9zaXRpb24obmV3IGdvb2dsZS5tYXBzLkxhdExuZygkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQsICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcpKVxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5hY3RpdmVNYXJrZXIsICdkcmFnZW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5nZW9sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJQb3NpdGlvblwiLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWFya2VyLnNldFBvc2l0aW9uKG5ldyBnb29nbGUubWFwcy5MYXRMbmcocG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLCBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkc2NvcGUuYWN0aXZlTWFya2VyLCAnZHJhZ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlZmF1bHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlTG9jYXRpb25NYXJrZXIoNC42NTM0NTAsIC03NC4wNDk2MDUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZUxvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvYWRpbmcgYWRkcmVzcyB0byBjb29raWVcIiwgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJzaGlwcGluZ0FkZHJlc3NcIiwgSlNPTi5zdHJpbmdpZnkoJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzaGlwcGluZ0FkZHJlc3NcIiwgSlNPTi5zdHJpbmdpZnkoJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxvY2F0aW9uUyA9ICRjb29raWVzLmdldCgnbG9jYXRpb25SZWZmZXJyZXInKTtcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucmVtb3ZlKCdsb2NhdGlvblJlZmZlcnJlcicpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uUyAmJiBsb2NhdGlvblMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9jYXRpb25cIiwgbG9jYXRpb25TKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvblMuaW5jbHVkZXMoJz8nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGxvY2F0aW9uUyArIFwiJmxhdD1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCArIFwiJmxvbmc9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sb25nXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGxvY2F0aW9uUyArIFwiP2xhdD1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCArIFwiJmxvbmc9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sb25nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInVybFwiLCB1cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy91cmwgPSBsb2NhdGlvblM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIi8/bGF0PVwiICsgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0ICsgXCImbG9uZz1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3IgPSBcImxhIHVybCBlczogXCIrdXJsO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInVybFwiLCB1cmwpO1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybDtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvbWFwY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 18 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('MenuCtrl',['$scope', 'Food', function ($scope, Food) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            $scope.contentType = \"\";\n            $scope.config = {};\n            angular.element(document).ready(function () {\n                $scope.getItems();\n                $scope.contentType = $scope.config.content;\n            });\n\n            $scope.buildItemData = function (item) {\n                item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"type=lunch&order_by=id,desc&page=\" + $scope.page;\n                Food.getMenu(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                Food.updateMenuItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                Food.deleteMenuItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9tZW51Y3RybC5qcz9hNTQ0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsWyckc2NvcGUnLCAnRm9vZCcsIGZ1bmN0aW9uICgkc2NvcGUsIEZvb2QpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICAkc2NvcGUuY29udGVudFR5cGUgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLmNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnRUeXBlID0gJHNjb3BlLmNvbmZpZy5jb250ZW50O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS5idWlsZEl0ZW1EYXRhID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGl0ZW0uYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcInR5cGU9bHVuY2gmb3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XG4gICAgICAgICAgICAgICAgRm9vZC5nZXRNZW51KHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICAgICAgICAgIEZvb2QudXBkYXRlTWVudUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgRm9vZC5kZWxldGVNZW51SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvbWVudWN0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 19 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('MerchantsCtrl', ['$scope', 'Merchants', 'Modals', function ($scope, Merchants, Modals) {\r\n                $scope.data = {};\r\n                $scope.user = {};\r\n                $scope.current = 1;\r\n                $scope.last = 1;\r\n                $scope.total = 1;\r\n                $scope.per_page = 1;\r\n                $scope.merchants = [];\r\n                $scope.categories = [];\r\n                $scope.regionVisible = false;\r\n                $scope.editMerchant = false;\r\n                $scope.showAddress = true;\r\n                $scope.showStore = true;\r\n                $scope.submitted = false;\r\n                $scope.category;\r\n                angular.element(document).ready(function () {\r\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\r\n//                    res = res.replace(/\"\"{/g, '\"\\\"{');\r\n//                    res = res.replace(/}\"\"/g, '}\\\"\"');\r\n                    console.log(\"res\", res);\r\n                    var container = JSON.parse(res);\r\n                    var url = window.location.href;\r\n                    if(url.includes(\"urgencias\")){\r\n                        $scope.showStore = false;\r\n                    }\r\n\r\n                    $scope.category = container.category;\r\n                    $scope.merchants = container.data;\r\n                    for(var item in $scope.merchants){\r\n                        for(var k in $scope.merchants[item].attributes.categories){\r\n                            if($scope.merchants[item].attributes.categories[k].id == $scope.category.id){\r\n                                $scope.merchants[item].activeCategory = $scope.merchants[item].attributes.categories[k];\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if($scope.merchants.length == 1){\r\n                        $scope.openItem($scope.merchants[0]);\r\n                    }\r\n                    console.log(\"Data\", $scope.merchants);\r\n                    $scope.current = container.page;\r\n                    $scope.per_page = container.per_page;\r\n                    $scope.last = container.last_page;\r\n                    $scope.total = container.total;\r\n                    document.getElementById(\"dissapear\").remove();\r\n                });\r\n\r\n                $scope.goTo = function (page) {\r\n                    $scope.current = page;\r\n                    $scope.merchants = [];\r\n                    Modals.showLoader();\r\n                    var where = \"category_id=\" + $scope.category.id + \"&page=\" + $scope.current + \"&limit=\" + 2;\r\n                    if ($scope.category.type.includes(\"nearby\")) {\r\n                        Merchants.getMerchantsNearby(where).then(function (data) {\r\n                            $scope.loadResults(data)\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    } else if ($scope.category.type.includes(\"coverage\")) {\r\n                        Merchants.getMerchantsCoverage(where).then(function (data) {\r\n                            $scope.loadResults(data)\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    } else {\r\n                        Merchants.getMerchants(where).then(function (data) {\r\n                            $scope.loadResults(data)\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                }\r\n\r\n                $scope.loadResults = function (data) {\r\n                    $scope.merchants = data.data;\r\n                    $scope.current = parseInt(data.page);\r\n                    $scope.per_page = parseInt(data.per_page);\r\n                    $scope.last = parseInt(data.last_page);\r\n                    $scope.total = parseInt(data.total);\r\n                    Modals.hideLoader();\r\n                }\r\n                $scope.openItem = function (merchant) {\r\n                    var url = \"\";\r\n                    var merchant_id = merchant.id;\r\n                    if (merchant.categorizable_id) {\r\n                        merchant_id = merchant.categorizable_id;\r\n                    }\r\n                    if ($scope.category) {\r\n                        url = \"/a/products/\" + $scope.category.url + \"?merchant_id=\" + merchant_id;\r\n                    } else {\r\n                        url = \"/a/merchant/\" + merchant.slug + \"/products\";\r\n                    }\r\n\r\n                    window.location.href = url;\r\n                }\r\n            }])\r\n        .controller('MerchantDetailCtrl', ['$scope','$rootScope', 'Merchants', 'Modals', '$mdDialog','Cart', function ($scope,$rootScope, Merchants, Modals, $mdDialog,Cart) {\r\n                $scope.data = {};\r\n                $scope.user = {};\r\n\r\n                $scope.merchant = {};\r\n                angular.element(document).ready(function () {\r\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\r\n//                    res = res.replace(/\"\"{/g, '\"\\\"{');\r\n//                    res = res.replace(/}\"\"/g, '}\\\"\"');\r\n                    console.log(\"res\", res);\r\n                    var container = JSON.parse(res);\r\n\r\n                    console.log(\"Data\", container);\r\n                    $scope.merchant = container;\r\n                    $scope.merchant.availabilities = $scope.merchant.availabilities2;\r\n                    console.log(\"$scope.merchant\", $scope.merchant);\r\n                    //document.getElementById(\"dissapear\").remove();\r\n                });\r\n                $scope.booking = function () {\r\n                    if ($rootScope.user) {\r\n                        var params = {\r\n                            \"availabilities\": $scope.merchant.availabilities,\r\n                            \"type\": \"Merchant\",\r\n                            \"objectId\": $scope.merchant.id,\r\n                            \"objectName\": $scope.merchant.name,\r\n                            \"objectDescription\": $scope.merchant.description,\r\n                            \"objectIcon\": $scope.merchant.icon,\r\n                            \"expectedPrice\": $scope.merchant.unit_cost,\r\n                            \"alert\":\"#book-button\"\r\n                        }\r\n                        Cart.showBooking(params);\r\n                    } else {\r\n                        Modals.showToast(\"Registrate o ingresa para reservar\",$(\"#book-button\"));\r\n                    }\r\n\r\n                    console.log(\"Booking\");\r\n\r\n//                    $mdDialog.show(Modals.getAppPopup()).then(function (platform) {\r\n//                        let url = \"\";\r\n//                        if (platform == \"ios\") {\r\n//                            url = \"\"\r\n//                        } else if (platform == 'android') {\r\n//                            url = \"\"\r\n//                        } else if (platform == 'web') {\r\n//                            url = \"\"\r\n//                        }\r\n//                        console.log(\"Url\", platform, url)\r\n//                        //window.location.href = url;\r\n//\r\n//                    }, function () {\r\n//\r\n//                    });\r\n                }\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9tZXJjaGFudHNjdHJsLmpzPzkwNjAiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXHJcblxyXG4gICAgICAgIC5jb250cm9sbGVyKCdNZXJjaGFudHNDdHJsJywgWyckc2NvcGUnLCAnTWVyY2hhbnRzJywgJ01vZGFscycsIGZ1bmN0aW9uICgkc2NvcGUsIE1lcmNoYW50cywgTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sYXN0ID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1lcmNoYW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FkZHJlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dTdG9yZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnk7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGEucmVwbGFjZSgvQXBwXFxcXE1vZGVsc1xcXFwvZywgXCJcIik7XHJcbi8vICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvXCJcInsvZywgJ1wiXFxcInsnKTtcclxuLy8gICAgICAgICAgICAgICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC99XCJcIi9nLCAnfVxcXCJcIicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IEpTT04ucGFyc2UocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodXJsLmluY2x1ZGVzKFwidXJnZW5jaWFzXCIpKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dTdG9yZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5ID0gY29udGFpbmVyLmNhdGVnb3J5O1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBjb250YWluZXIuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGl0ZW0gaW4gJHNjb3BlLm1lcmNoYW50cyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayBpbiAkc2NvcGUubWVyY2hhbnRzW2l0ZW1dLmF0dHJpYnV0ZXMuY2F0ZWdvcmllcyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUubWVyY2hhbnRzW2l0ZW1dLmF0dHJpYnV0ZXMuY2F0ZWdvcmllc1trXS5pZCA9PSAkc2NvcGUuY2F0ZWdvcnkuaWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHNbaXRlbV0uYWN0aXZlQ2F0ZWdvcnkgPSAkc2NvcGUubWVyY2hhbnRzW2l0ZW1dLmF0dHJpYnV0ZXMuY2F0ZWdvcmllc1trXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUubWVyY2hhbnRzLmxlbmd0aCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5JdGVtKCRzY29wZS5tZXJjaGFudHNbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGFcIiwgJHNjb3BlLm1lcmNoYW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBjb250YWluZXIucGFnZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSBjb250YWluZXIucGVyX3BhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSBjb250YWluZXIubGFzdF9wYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGNvbnRhaW5lci50b3RhbDtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3NhcGVhclwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5nb1RvID0gZnVuY3Rpb24gKHBhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudCA9IHBhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCJjYXRlZ29yeV9pZD1cIiArICRzY29wZS5jYXRlZ29yeS5pZCArIFwiJnBhZ2U9XCIgKyAkc2NvcGUuY3VycmVudCArIFwiJmxpbWl0PVwiICsgMjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5LnR5cGUuaW5jbHVkZXMoXCJuZWFyYnlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWVyY2hhbnRzLmdldE1lcmNoYW50c05lYXJieSh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRSZXN1bHRzKGRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5jYXRlZ29yeS50eXBlLmluY2x1ZGVzKFwiY292ZXJhZ2VcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWVyY2hhbnRzLmdldE1lcmNoYW50c0NvdmVyYWdlKHdoZXJlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFJlc3VsdHMoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5nZXRNZXJjaGFudHMod2hlcmUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyhkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudCA9IHBhcnNlSW50KGRhdGEucGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gcGFyc2VJbnQoZGF0YS5wZXJfcGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSBwYXJzZUludChkYXRhLmxhc3RfcGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gcGFyc2VJbnQoZGF0YS50b3RhbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5vcGVuSXRlbSA9IGZ1bmN0aW9uIChtZXJjaGFudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBtZXJjaGFudF9pZCA9IG1lcmNoYW50LmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXJjaGFudC5jYXRlZ29yaXphYmxlX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lcmNoYW50X2lkID0gbWVyY2hhbnQuY2F0ZWdvcml6YWJsZV9pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIi9hL3Byb2R1Y3RzL1wiICsgJHNjb3BlLmNhdGVnb3J5LnVybCArIFwiP21lcmNoYW50X2lkPVwiICsgbWVyY2hhbnRfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gXCIvYS9tZXJjaGFudC9cIiArIG1lcmNoYW50LnNsdWcgKyBcIi9wcm9kdWN0c1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdNZXJjaGFudERldGFpbEN0cmwnLCBbJyRzY29wZScsJyRyb290U2NvcGUnLCAnTWVyY2hhbnRzJywgJ01vZGFscycsICckbWREaWFsb2cnLCdDYXJ0JywgZnVuY3Rpb24gKCRzY29wZSwkcm9vdFNjb3BlLCBNZXJjaGFudHMsIE1vZGFscywgJG1kRGlhbG9nLENhcnQpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHZpZXdEYXRhLnJlcGxhY2UoL0FwcFxcXFxNb2RlbHNcXFxcL2csIFwiXCIpO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1wiXCJ7L2csICdcIlxcXCJ7Jyk7XHJcbi8vICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvfVwiXCIvZywgJ31cXFwiXCInKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc1wiLCByZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiLCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudCA9IGNvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnQuYXZhaWxhYmlsaXRpZXMgPSAkc2NvcGUubWVyY2hhbnQuYXZhaWxhYmlsaXRpZXMyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLm1lcmNoYW50XCIsICRzY29wZS5tZXJjaGFudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3NhcGVhclwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJvb2tpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhdmFpbGFiaWxpdGllc1wiOiAkc2NvcGUubWVyY2hhbnQuYXZhaWxhYmlsaXRpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJNZXJjaGFudFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3RJZFwiOiAkc2NvcGUubWVyY2hhbnQuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdE5hbWVcIjogJHNjb3BlLm1lcmNoYW50Lm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdERlc2NyaXB0aW9uXCI6ICRzY29wZS5tZXJjaGFudC5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0SWNvblwiOiAkc2NvcGUubWVyY2hhbnQuaWNvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhwZWN0ZWRQcmljZVwiOiAkc2NvcGUubWVyY2hhbnQudW5pdF9jb3N0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbGVydFwiOlwiI2Jvb2stYnV0dG9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dCb29raW5nKHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIlJlZ2lzdHJhdGUgbyBpbmdyZXNhIHBhcmEgcmVzZXJ2YXJcIiwkKFwiI2Jvb2stYnV0dG9uXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQm9va2luZ1wiKTtcclxuXHJcbi8vICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0QXBwUG9wdXAoKSkudGhlbihmdW5jdGlvbiAocGxhdGZvcm0pIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJcIjtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxhdGZvcm0gPT0gXCJpb3NcIikge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIlwiXHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwbGF0Zm9ybSA9PSAnYW5kcm9pZCcpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gXCJcIlxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhdGZvcm0gPT0gJ3dlYicpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gXCJcIlxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVybFwiLCBwbGF0Zm9ybSwgdXJsKVxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7XHJcbi8vXHJcbi8vICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbi8vXHJcbi8vICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvbWVyY2hhbnRzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 20 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('OrdersCtrl',['$scope', 'Orders', function ($scope, Orders) {\n            $scope.data = {};\n            $scope.orders;\n            $scope.from;\n            $scope.to;\n            $scope.loadMore = true,\n                    $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.buildDatePicker();\n                $scope.getOrders();\n            });\n\n            $scope.buildDatePicker = function () {\n                var dateFormat = \"yy-mm-dd\",\n                        from = $(\"#from\")\n                        .datepicker({\n                            defaultDate: \"-1m\",\n                            changeMonth: true,\n                            numberOfMonths: 2,\n                            dateFormat: dateFormat\n                        })\n                        .on(\"change\", function () {\n                            to.datepicker(\"option\", \"minDate\", $scope.getDate(this));\n                            $scope.from = $scope.getDate(this);\n                        }),\n                        to = $(\"#to\").datepicker({\n                    defaultDate: \"+1w\",\n                    changeMonth: true,\n                    numberOfMonths: 2,\n                    dateFormat: dateFormat\n                })\n                        .on(\"change\", function () {\n                            from.datepicker(\"option\", \"maxDate\", $scope.getDate(this));\n                            $scope.to = $scope.getDate(this);\n                        });\n            }\n            $scope.getDate = function (element) {\n                console.log(\"Get date\",element.value);\n                var date;\n                try {\n                    date = $.datepicker.parseDate(\"yy-mm-dd\", element.value);\n                } catch (error) {\n                    date = null;\n                }\n\n                return date;\n            }\n\n            $scope.buildOrderData = function (order) {\n                var items = order.items;\n                for (item in items) {\n                    items[item].attributes = JSON.parse(items[item].attributes);\n                }\n                order.items = items;\n                return order;\n            }\n\n            $scope.getOrders = function () {\n                $scope.page++;\n                var url = \"includes=orderConditions,items,payments,user&order_by=id,desc&page=\" + $scope.page;\n                Orders.getOrders(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    var ordersCont = data.data;\n                    for (item in ordersCont) {\n                        ordersCont[item] = $scope.buildOrderData(ordersCont[item]);\n                    }\n                    $scope.orders = ordersCont;\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateOrderStatus = function (status, order_id) {\n\n                Orders.updateOrderStatus(status, order_id).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getStoreExport = function () {\n                console.log(\"Date\", $scope.from, $scope.to);\n                Orders.getStoreExport($scope.from, $scope.to).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.approveOrder = function (order) {\n                Orders.approveOrder(order.id).then(function (data) {\n                    order.status = \"scheduled\";\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9vcmRlcnNjdHJsLmpzPzNkZGUiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ09yZGVyc0N0cmwnLFsnJHNjb3BlJywgJ09yZGVycycsIGZ1bmN0aW9uICgkc2NvcGUsIE9yZGVycykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlcnM7XG4gICAgICAgICAgICAkc2NvcGUuZnJvbTtcbiAgICAgICAgICAgICRzY29wZS50bztcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZERhdGVQaWNrZXIoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0T3JkZXJzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkRGF0ZVBpY2tlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IFwieXktbW0tZGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gPSAkKFwiI2Zyb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRlcGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCItMW1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNb250aDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kYXRlcGlja2VyKFwib3B0aW9uXCIsIFwibWluRGF0ZVwiLCAkc2NvcGUuZ2V0RGF0ZSh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZyb20gPSAkc2NvcGUuZ2V0RGF0ZSh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG8gPSAkKFwiI3RvXCIpLmRhdGVwaWNrZXIoe1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCIrMXdcIixcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlTW9udGg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG51bWJlck9mTW9udGhzOiAyLFxuICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbS5kYXRlcGlja2VyKFwib3B0aW9uXCIsIFwibWF4RGF0ZVwiLCAkc2NvcGUuZ2V0RGF0ZSh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvID0gJHNjb3BlLmdldERhdGUodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXREYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlXCIsZWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9ICQuZGF0ZXBpY2tlci5wYXJzZURhdGUoXCJ5eS1tbS1kZFwiLCBlbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkYXRlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkT3JkZXJEYXRhID0gZnVuY3Rpb24gKG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW1zID0gb3JkZXIuaXRlbXM7XG4gICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zW2l0ZW1dLmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGl0ZW1zW2l0ZW1dLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcmRlci5pdGVtcyA9IGl0ZW1zO1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmdldE9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPW9yZGVyQ29uZGl0aW9ucyxpdGVtcyxwYXltZW50cyx1c2VyJm9yZGVyX2J5PWlkLGRlc2MmcGFnZT1cIiArICRzY29wZS5wYWdlO1xuICAgICAgICAgICAgICAgIE9yZGVycy5nZXRPcmRlcnModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBvcmRlcnNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gb3JkZXJzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJzQ29udFtpdGVtXSA9ICRzY29wZS5idWlsZE9yZGVyRGF0YShvcmRlcnNDb250W2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JkZXJzID0gb3JkZXJzQ29udDtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVPcmRlclN0YXR1cyA9IGZ1bmN0aW9uIChzdGF0dXMsIG9yZGVyX2lkKSB7XG5cbiAgICAgICAgICAgICAgICBPcmRlcnMudXBkYXRlT3JkZXJTdGF0dXMoc3RhdHVzLCBvcmRlcl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdldFN0b3JlRXhwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZVwiLCAkc2NvcGUuZnJvbSwgJHNjb3BlLnRvKTtcbiAgICAgICAgICAgICAgICBPcmRlcnMuZ2V0U3RvcmVFeHBvcnQoJHNjb3BlLmZyb20sICRzY29wZS50bykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmFwcHJvdmVPcmRlciA9IGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgICAgIE9yZGVycy5hcHByb3ZlT3JkZXIob3JkZXIuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXIuc3RhdHVzID0gXCJzY2hlZHVsZWRcIjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvb3JkZXJzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 21 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('PaymentsCtrl', ['$scope', 'Payments', 'Merchants', function ($scope, Payments, Merchants) {\n                $scope.data = {};\n                $scope.payments;\n                $scope.loadMore = true,\n                        $scope.page = 0;\n                $scope.regionVisible = false;\n                $scope.editPayment = false;\n                angular.element(document).ready(function () {\n                    $scope.getPayments();\n                });\n\n                $scope.getPayments = function () {\n                    $scope.page++;\n                    var url = \"includes=order,user&order_by=id,desc&page=\" + $scope.page;\n                    Payments.getPayments(url).then(function (data) {\n                        if (data.page == data.last_page) {\n                            $scope.loadMore = false;\n                        }\n                        $scope.payments = data.data;\n\n                    },\n                            function (data) {\n\n                            });\n                }\n\n                $scope.approvePayment = function (payment) {\n                    Payments.approvePayment(payment.id).then(function (data) {\n                        payment.status = \"approved\";\n                    },\n                            function (data) {\n\n                            });\n                }\n\n            }]).controller('PaymentsUserCtrl', ['$scope', 'Payments', function ($scope, Payments) {\n        $scope.data = {};\n        $scope.payments;\n        $scope.loadMore = true,\n                $scope.page = 0;\n        $scope.regionVisible = false;\n        $scope.editPayment = false;\n        angular.element(document).ready(function () {\n            $scope.getPayments();\n        });\n\n        $scope.getPayments = function () {\n            $scope.page++;\n            var url = \"includes=order,user&order_by=id,desc&page=\" + $scope.page;\n            Payments.getPaymentsUser(url).then(function (data) {\n                if (data.page == data.last_page) {\n                    $scope.loadMore = false;\n                }\n                $scope.payments = data.data;\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n    }]).controller('PaymentsMerchantCtrl', ['$scope', 'Orders', 'Merchants', function ($scope, Orders, Merchants) {\n        $scope.data = {};\n        $scope.orders = [];\n        $scope.merchants = [];\n        $scope.merchant_id;\n        $scope.loadMore = true,\n                $scope.page = 0;\n        $scope.regionVisible = false;\n        $scope.editPayment = false;\n        $scope.status = \"pending\";\n        angular.element(document).ready(function () {\n            $scope.getMerchants();\n        });\n\n        $scope.getOrders = function (merchant) {\n            $scope.page++;\n            var url = \"includes=items,orderAddresses,orderConditions,user&order_by=id,asc&page=\" + $scope.page + \"&merchant_id=\" + merchant + \"&execution_status=\" + $scope.status;\n            Orders.getOrders(url).then(function (data) {\n                if (data.page == data.last_page) {\n                    $scope.loadMore = false;\n                }\n                $scope.orders = $scope.orders.concat(data.data);\n\n            },\n                    function (data) { \n\n                    });\n        }\n        $scope.loadMoreOrders = function () {\n            $scope.getOrders($scope.merchant_id);\n        }\n        $scope.selectMerchant = function () {\n            $scope.orders = [];\n            $scope.page = 0;\n            $scope.getOrders($scope.merchant_id);\n        }\n        $scope.getMerchants = function () {\n            Merchants.getMerchantsUser().then(function (data) {\n                if (data.status == \"success\") {\n                    $scope.merchants = data.data;\n                    if ($scope.orders.length == 0 && $scope.merchants.length > 0) {\n                        $scope.getOrders($scope.merchants[0].id);\n                    }\n                }\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n        $scope.fullfillOrder = function (order) {\n            var itemsArr = [];\n            for (var item in order.items) {\n                itemsArr.push(order.items[item].id);\n            }\n            var container = {\n                order_id: order.id,\n                items: itemsArr,\n                status:\"fullfill\"\n            }\n            Orders.fullfillOrder(container).then(function (data) {\n                if (data.status == \"success\") {\n                    order.execution_status = \"completed\";\n                    for (var item in order.items) {\n                        order.items[item].fulfillment = \"fulfilled\"; \n                    }\n                }\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n    }]).controller('PaymentsUserCtrl', ['$scope', 'Payments', function ($scope, Payments) {\n        $scope.data = {};\n        $scope.payments;\n        $scope.loadMore = true,\n                $scope.page = 0;\n        $scope.regionVisible = false;\n        $scope.editPayment = false;\n        angular.element(document).ready(function () {\n            $scope.getPayments();\n        });\n\n        $scope.getPayments = function () {\n            $scope.page++;\n            var url = \"includes=order,user&order_by=id,desc&page=\" + $scope.page;\n            Payments.getPaymentsUser(url).then(function (data) {\n                if (data.page == data.last_page) {\n                    $scope.loadMore = false;\n                }\n                $scope.payments = data.data;\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n    }]).controller('PaymentDetailCtrl', ['$scope', 'Payments', '$rootScope', function ($scope, Payments, $rootScope) {\n        $scope.data = {};\n        $scope.payment = {};\n        angular.element(document).ready(function () {\n            $scope.getPayments();\n        });\n\n        $scope.getPayments = function () {\n            $scope.page++;\n            var url = window.location.href;\n            var segments = url.split(\"/\");\n            console.log(\"Payment id\", segments[segments.length - 1])\n            var url2 = \"id=\" + segments[segments.length - 1] + \"&includes=order.items,order.orderConditions,order.orderAddresses\";\n            Payments.getPaymentsUser(url2).then(function (data) {\n                if (data.total > 0) {\n                    var results = data.data;\n                    $scope.payment = results[0]\n                }\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n        $scope.addTransactionCosts = function () {\n            Payments.addTransactionCosts($scope.payment.id).then(function (data) {\n                if (data.status == \"success\") {\n                    console.log(\"after addTransactionCosts\");\n                    $scope.payment = data.payment;\n                } else {\n                    this.api.toast('PAYMENTS.ERROR_CHANGE');\n                }\n            },\n                    function (data) {\n\n                    });\n        }\n\n        $scope.retryPayment = function () {\n            Payments.retryPayment($scope.payment.id).then(function (data) {\n                console.log(\"after addTransactionCosts\", data);\n                if (data.status == \"success\") {\n\n                    $rootScope.activePayment = data.payment;\n                    $rootScope.paymentActive = true;\n                } else {\n                    this.api.toast('PAYMENTS.ERROR_CHANGE');\n                }\n            },\n                    function (data) {\n\n                    });\n        }\n\n    }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9wYXltZW50c2N0cmwuanM/OWJkNSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignUGF5bWVudHNDdHJsJywgWyckc2NvcGUnLCAnUGF5bWVudHMnLCAnTWVyY2hhbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgUGF5bWVudHMsIE1lcmNoYW50cykge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBheW1lbnRzO1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdFBheW1lbnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFBheW1lbnRzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0UGF5bWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPW9yZGVyLHVzZXImb3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XG4gICAgICAgICAgICAgICAgICAgIFBheW1lbnRzLmdldFBheW1lbnRzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA9PSBkYXRhLmxhc3RfcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBheW1lbnRzID0gZGF0YS5kYXRhO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5hcHByb3ZlUGF5bWVudCA9IGZ1bmN0aW9uIChwYXltZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIFBheW1lbnRzLmFwcHJvdmVQYXltZW50KHBheW1lbnQuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnQuc3RhdHVzID0gXCJhcHByb3ZlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1dKS5jb250cm9sbGVyKCdQYXltZW50c1VzZXJDdHJsJywgWyckc2NvcGUnLCAnUGF5bWVudHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBQYXltZW50cykge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAkc2NvcGUucGF5bWVudHM7XG4gICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuZWRpdFBheW1lbnQgPSBmYWxzZTtcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuZ2V0UGF5bWVudHMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLmdldFBheW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPW9yZGVyLHVzZXImb3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XG4gICAgICAgICAgICBQYXltZW50cy5nZXRQYXltZW50c1VzZXIodXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA9PSBkYXRhLmxhc3RfcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBheW1lbnRzID0gZGF0YS5kYXRhO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XSkuY29udHJvbGxlcignUGF5bWVudHNNZXJjaGFudEN0cmwnLCBbJyRzY29wZScsICdPcmRlcnMnLCAnTWVyY2hhbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgT3JkZXJzLCBNZXJjaGFudHMpIHtcbiAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgJHNjb3BlLm9yZGVycyA9IFtdO1xuICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gW107XG4gICAgICAgICRzY29wZS5tZXJjaGFudF9pZDtcbiAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gdHJ1ZSxcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5lZGl0UGF5bWVudCA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuc3RhdHVzID0gXCJwZW5kaW5nXCI7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmdldE1lcmNoYW50cygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuZ2V0T3JkZXJzID0gZnVuY3Rpb24gKG1lcmNoYW50KSB7XG4gICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgbGV0IHVybCA9IFwiaW5jbHVkZXM9aXRlbXMsb3JkZXJBZGRyZXNzZXMsb3JkZXJDb25kaXRpb25zLHVzZXImb3JkZXJfYnk9aWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJm1lcmNoYW50X2lkPVwiICsgbWVyY2hhbnQgKyBcIiZleGVjdXRpb25fc3RhdHVzPVwiICsgJHNjb3BlLnN0YXR1cztcbiAgICAgICAgICAgIE9yZGVycy5nZXRPcmRlcnModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA9PSBkYXRhLmxhc3RfcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVycyA9ICRzY29wZS5vcmRlcnMuY29uY2F0KGRhdGEuZGF0YSk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7IFxuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5sb2FkTW9yZU9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5nZXRPcmRlcnMoJHNjb3BlLm1lcmNoYW50X2lkKTtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuc2VsZWN0TWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUub3JkZXJzID0gW107XG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICAkc2NvcGUuZ2V0T3JkZXJzKCRzY29wZS5tZXJjaGFudF9pZCk7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmdldE1lcmNoYW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIE1lcmNoYW50cy5nZXRNZXJjaGFudHNVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm9yZGVycy5sZW5ndGggPT0gMCAmJiAkc2NvcGUubWVyY2hhbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRPcmRlcnMoJHNjb3BlLm1lcmNoYW50c1swXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuZnVsbGZpbGxPcmRlciA9IGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgbGV0IGl0ZW1zQXJyID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIG9yZGVyLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgaXRlbXNBcnIucHVzaChvcmRlci5pdGVtc1tpdGVtXS5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgIG9yZGVyX2lkOiBvcmRlci5pZCxcbiAgICAgICAgICAgICAgICBpdGVtczogaXRlbXNBcnIsXG4gICAgICAgICAgICAgICAgc3RhdHVzOlwiZnVsbGZpbGxcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgT3JkZXJzLmZ1bGxmaWxsT3JkZXIoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLmV4ZWN1dGlvbl9zdGF0dXMgPSBcImNvbXBsZXRlZFwiO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIG9yZGVyLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5pdGVtc1tpdGVtXS5mdWxmaWxsbWVudCA9IFwiZnVsZmlsbGVkXCI7IFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XSkuY29udHJvbGxlcignUGF5bWVudHNVc2VyQ3RybCcsIFsnJHNjb3BlJywgJ1BheW1lbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgUGF5bWVudHMpIHtcbiAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgJHNjb3BlLnBheW1lbnRzO1xuICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmVkaXRQYXltZW50ID0gZmFsc2U7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmdldFBheW1lbnRzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5nZXRQYXltZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICBsZXQgdXJsID0gXCJpbmNsdWRlcz1vcmRlcix1c2VyJm9yZGVyX2J5PWlkLGRlc2MmcGFnZT1cIiArICRzY29wZS5wYWdlO1xuICAgICAgICAgICAgUGF5bWVudHMuZ2V0UGF5bWVudHNVc2VyKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5wYXltZW50cyA9IGRhdGEuZGF0YTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfV0pLmNvbnRyb2xsZXIoJ1BheW1lbnREZXRhaWxDdHJsJywgWyckc2NvcGUnLCAnUGF5bWVudHMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsIFBheW1lbnRzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICRzY29wZS5wYXltZW50ID0ge307XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmdldFBheW1lbnRzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5nZXRQYXltZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgICAgICBsZXQgc2VnbWVudHMgPSB1cmwuc3BsaXQoXCIvXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJQYXltZW50IGlkXCIsIHNlZ21lbnRzW3NlZ21lbnRzLmxlbmd0aCAtIDFdKVxuICAgICAgICAgICAgbGV0IHVybDIgPSBcImlkPVwiICsgc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0gMV0gKyBcIiZpbmNsdWRlcz1vcmRlci5pdGVtcyxvcmRlci5vcmRlckNvbmRpdGlvbnMsb3JkZXIub3JkZXJBZGRyZXNzZXNcIjtcbiAgICAgICAgICAgIFBheW1lbnRzLmdldFBheW1lbnRzVXNlcih1cmwyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudG90YWwgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGF5bWVudCA9IHJlc3VsdHNbMF1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuYWRkVHJhbnNhY3Rpb25Db3N0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFBheW1lbnRzLmFkZFRyYW5zYWN0aW9uQ29zdHMoJHNjb3BlLnBheW1lbnQuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJhZnRlciBhZGRUcmFuc2FjdGlvbkNvc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGF5bWVudCA9IGRhdGEucGF5bWVudDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwaS50b2FzdCgnUEFZTUVOVFMuRVJST1JfQ0hBTkdFJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5yZXRyeVBheW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBQYXltZW50cy5yZXRyeVBheW1lbnQoJHNjb3BlLnBheW1lbnQuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFmdGVyIGFkZFRyYW5zYWN0aW9uQ29zdHNcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYXltZW50ID0gZGF0YS5wYXltZW50O1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBheW1lbnRBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpLnRvYXN0KCdQQVlNRU5UUy5FUlJPUl9DSEFOR0UnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9wYXltZW50c2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 22 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n        .controller('ProductsCtrl', ['$scope', 'Cart', '$rootScope', '$sce', 'Products', 'Modals', function ($scope, Cart, $rootScope, $sce, Products, Modals) {\r\n                $scope.categories = [];\r\n                $scope.prodIds = [];\r\n                $scope.hasLocation = false;\r\n                $scope.hasMerchant = false;\r\n                $scope.isSearch = false;\r\n                $scope.merchantObj = {};\r\n                $scope.current = 1;\r\n                $scope.last = 1;\r\n                $scope.range;\r\n                $scope.params = {}\r\n                $scope.per_page = 1\r\n                $scope.category_id = null;\r\n                $scope.total = 1;\r\n                $scope.local_total = 0;\r\n\r\n                angular.element(document).ready(function () {\r\n                    $scope.clean();\r\n\r\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\r\n                    console.log(\"viewData\", res);\r\n                    var container = JSON.parse(res);\r\n                    $scope.$apply(function () {\r\n                        $scope.buildProductsFromWhole(container);\r\n                    });\r\n                    console.log($scope.categories);\r\n                    document.getElementById(\"dissapear\").remove();\r\n                    var params = Modals.getAllUrlParams();\r\n                    console.log(\"Params\", params)\r\n                    if (params) {\r\n\r\n                    } else {\r\n                        params = {};\r\n                    }\r\n                    $scope.params = params;\r\n                    $scope.params.includes = \"files,merchant\";\r\n\r\n                    if ($scope.category_id) {\r\n                        $scope.params.category_id = $scope.category_id;\r\n                    }\r\n                    var url = window.location.href;\r\n                    if (url.includes(\"search\")) {\r\n                        $scope.isSearch = true;\r\n                    }\r\n                });\r\n                $rootScope.$on('loadCartVariants', function (event, args) {\r\n                    $scope.updateProductsCart(args, false);\r\n                    if ($rootScope.user) {\r\n                        $scope.checkFavorites();\r\n                    }\r\n                });\r\n                $rootScope.$on('clearCart', function (event, args) {\r\n                    console.log(\"Cart cleared resetting items\")\r\n                    $scope.cartCleared();\r\n\r\n                });\r\n                $rootScope.$on('deleteItem', function (event, args) {\r\n                    console.log(\"item removed resetting items: \", args)\r\n                    $scope.cartDeletedItem(args);\r\n                });\r\n                $scope.clean = function () {\r\n                    angular.forEach(angular.element(\".product-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $scope.changeStore = function () {\r\n                    Cart.changeMerchant()\r\n                }\r\n                $scope.addCatFilter = function (category) {\r\n                    $scope.params.category_id = category;\r\n                    $scope.goTo(1);\r\n                }\r\n                $scope.buildProductsFromWhole = function (container) {\r\n                    $scope.categories = container.categories;\r\n                    $scope.current = container.page;\r\n                    $scope.last = container.last_page;\r\n                    $scope.current = container.page;\r\n                    $scope.per_page = container.per_page;\r\n                    $scope.total = container.total;\r\n                    if (container.category) {\r\n                        $scope.category_id = container.category.id;\r\n                    }\r\n\r\n                    console.log($scope.categories);\r\n                    for (var item in $scope.categories) {\r\n                        for (var k in $scope.categories[item].products) {\r\n                            $scope.prodIds.push($scope.categories[item].products[k].id);\r\n\r\n                            if (!$rootScope.merchant_id && $scope.categories[0].products[0].merchant_id) {\r\n                                $rootScope.merchant_id = $scope.categories[0].products[0].merchant_id;\r\n                            }\r\n                            if (!$scope.categories[item].products[k].merchant_id && $scope.categories[item].products[k].merchants.length > 0) {\r\n                                $scope.categories[item].products[k].merchant_id = $scope.categories[item].products[k].merchants[0].id\r\n                            }\r\n                            $scope.local_total++;\r\n                            if ($scope.categories[item].products[k].files && $scope.categories[item].products[k].files.length > 0) {\r\n                                $scope.categories[item].products[k].imgs = $scope.categories[item].products[k].files;\r\n                            }\r\n                            if ($scope.categories[item].products[k].imgs && $scope.categories[item].products[k].imgs.length > 0) {\r\n                                $scope.categories[item].products[k].src = $scope.categories[item].products[k].imgs[0].file;\r\n                            }\r\n                            $scope.categories[item].products[k].description = $sce.trustAsHtml($scope.categories[item].products[k].description);\r\n                            $scope.categories[item].products[k].activeVariant = $scope.categories[item].products[k].variants[0];\r\n                            $scope.categories[item].products[k].variant_id = $scope.categories[item].products[k].variants[0].id;\r\n                            $scope.categories[item].products[k].quantity = $scope.categories[item].products[k].variants[0].min_quantity;\r\n                            $scope.categories[item].products[k].item_id = null;\r\n                            $scope.categories[item].products[k].isFavorite = false;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.buildProducts = function (resp) {\r\n                    $scope.categories = Products.buildProductInformation(resp);\r\n                    console.log(\"Result build product\", $scope.categories);\r\n                    var attributes = $scope.categories[0].products[0].merchant_attributes;\r\n                    if (typeof attributes == \"string\") {\r\n                        attributes = JSON.parse(attributes);\r\n                    }\r\n\r\n                    if (attributes.store_active) {\r\n                        if (attributes.store_active == 1) {\r\n                            $scope.storeActive = true;\r\n                        }\r\n                    }\r\n                    $scope.merchantObj.merchant_name = $scope.categories[0].products[0].merchant_name;\r\n                    $scope.merchantObj.merchant_description = $scope.categories[0].products[0].merchant_description;\r\n                    $scope.merchantObj.src = $scope.categories[0].products[0].src;\r\n\r\n                    //this.openTutorials();  \r\n                    $scope.merchantObj.merchant_type = $scope.categories[0].products[0].merchant_type;\r\n                    if ($scope.categories.length > 0) {\r\n                        $scope.categories[0].more = true;\r\n                        if ($scope.categories[0].products.length > 0) {\r\n                            $scope.categories[0].products[0].more = true;\r\n                        }\r\n                        if ($scope.categories[0].products.length > 1) {\r\n                            $scope.categories[0].products[1].more = true;\r\n                        }\r\n                    }\r\n                    $scope.current = parseInt(resp.page);\r\n                    $scope.prodIds = [];\r\n                    $scope.last = parseInt(resp.last_page);\r\n                    $scope.current = parseInt(resp.page);\r\n                    $scope.per_page = parseInt(resp.per_page);\r\n                    $scope.total = parseInt(resp.total);\r\n                    $scope.local_total = 0;\r\n                    for (var item in $scope.categories) {\r\n                        for (var k in $scope.categories[item].products) {\r\n                            $scope.local_total++;\r\n                            $scope.prodIds.push($scope.categories[item].products[k].id);\r\n                            $scope.categories[item].products[k].description = $sce.trustAsHtml($scope.categories[item].products[k].description);\r\n                            $scope.categories[item].products[k].activeVariant = $scope.categories[item].products[k].variants[0];\r\n                            $scope.categories[item].products[k].variant_id = $scope.categories[item].products[k].variants[0].id;\r\n                            $scope.categories[item].products[k].quantity = $scope.categories[item].products[k].variants[0].min_quantity;\r\n                            $scope.categories[item].products[k].item_id = null;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.filterPrice = function () {\r\n                    console.log(\"Filtering\", $(\"#amount\").val())\r\n                    var str = $(\"#amount\").val();\r\n                    str = str.replace(\"$\", \"\");\r\n                    str = str.replace(\"$\", \"\");\r\n                    console.log(\"Filtering\", str)\r\n                    var res = str.split(\"-\");\r\n                    console.log(\"Filtering\", res)\r\n                    $scope.params.high = parseInt(res[1].trim());\r\n                    $scope.params.low = parseInt(res[0].trim());\r\n                    $scope.goTo(1);\r\n                }\r\n                $scope.goTo = function (page) {\r\n                    $scope.params.page = page;\r\n                    if ($rootScope.merchant_id) {\r\n                        $scope.params.merchant_id = $rootScope.merchant_id;\r\n                    }\r\n                    Modals.showLoader();\r\n                    $scope.categories = [];\r\n                    if ($scope.isSearch) {\r\n                        Products.searchProducts($scope.params).then(function (resp) {\r\n                            console.log(\"params\", $scope.params);\r\n                            console.log(\"response\", resp);\r\n                            if (resp.total > 0) {\r\n                                $scope.buildProductsFromWhole(resp);\r\n\r\n                                //this.createSlides();\r\n                            }\r\n                            Modals.hideLoader();\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    } else {\r\n                        Products.getProductsMerchant($scope.params).then(function (resp) {\r\n                            console.log(\"params\", $scope.params);\r\n                            console.log(\"response\", resp);\r\n                            if (resp.products_total > 0) {\r\n                                $scope.buildProducts(resp);\r\n\r\n                                //this.createSlides();\r\n                            }\r\n                            Modals.hideLoader();\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    }\r\n\r\n                }\r\n                $scope.selectVariant = function (product) {\r\n                    for (var item in product.variants) {\r\n                        if (product.variant_id == product.variants[item].id) {\r\n                            product.activeVariant = product.variants[item];\r\n                        }\r\n                    }\r\n                }\r\n                $scope.addCartItem = function (product) {\r\n                    var container = {\r\n                        id: product.activeVariant.id,\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        product: product,\r\n                        type: product.type\r\n                    }\r\n                    if((product.activeVariant.is_on_sale && product.activeVariant.sale <1)||(!product.activeVariant.is_on_sale && product.activeVariant.price <1)){\r\n                        Modals.showToast(\"Ese producto no esta a la venta\", $(\"#prod-cont-\" + product.id));\r\n                        return true;\r\n                    }\r\n                    Cart.addCartItem(container, []).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                            product.item_id = data.item.id;\r\n                            product.quantity = data.item.quantity;\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.checkFavorites = function () {\r\n                    var container = {\r\n                        product_ids: $scope.prodIds\r\n                    }\r\n                    Products.checkFavorite(container).then(function (data) {\r\n                        console.log(\"checkFavorites res\", data);\r\n                        if (data.status == \"success\") {\r\n                            var results = data.data;\r\n                            for (var k in results) {\r\n                                for (var i in $scope.categories) {\r\n                                    for (var j in $scope.categories[i].products) {\r\n                                        if ($scope.categories[i].products[j].id == results[k].favoritable_id) {\r\n                                            $scope.categories[i].products[j].isFavorite = true;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.addFavorite = function (product) {\r\n                    if ($rootScope.user) {\r\n                        var container = {\r\n                            object_id: product.id,\r\n                            type: \"Product\"\r\n                        }\r\n                        Products.addFavorite(container).then(function (data) {\r\n                            console.log(\"Add addFavorite\", data);\r\n                            if (data.status == \"success\") {\r\n                                product.isFavorite = true;\r\n                                Modals.showToast(\"Agregado\", $(\"#prod-cont-\" + product.id));\r\n                            } else {\r\n                                Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    } else {\r\n                        Modals.showToast(\"Debes estar logueado para guardar productos\", $(\"#prod-cont-\" + product.id));\r\n                    }\r\n\r\n                }\r\n                $scope.deleteFavorite = function (product) {\r\n                    var container = {\r\n                        object_id: product.id,\r\n                        type: \"Product\"\r\n                    }\r\n                    Products.deleteFavorite(container).then(function (data) {\r\n                        console.log(\"Add addFavorite\", data);\r\n                        if (data.status == \"success\") {\r\n                            Modals.showToast(\"Agregado\", $(\"#prod-cont-\" + product.id));\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.cartCleared = function () {\r\n                    for (var i in $scope.categories) {\r\n                        for (var j in $scope.categories[i].products) {\r\n                            $scope.categories[i].products[j].item_id = null;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.cartDeletedItem = function (item_id) {\r\n                    for (var i in $scope.categories) {\r\n                        for (var j in $scope.categories[i].products) {\r\n                            if ($scope.categories[i].products[j].item_id == item_id) {\r\n                                $scope.categories[i].products[j].item_id = null;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                $scope.updateProductsCart = function (cart, total) {\r\n                    cart:\r\n                            for (var m in cart.items) {\r\n                        for (var i in $scope.categories) {\r\n                            for (var j in $scope.categories[i].products) {\r\n                                $scope.categories[i].products[j].item_id = null;\r\n                                for (var k in $scope.categories[i].products[j].variants) {\r\n                                    var container = cart.items[m];\r\n                                    var variant = $scope.categories[i].products[j].variants[k];\r\n                                    if (container.attributes.product_variant_id == variant.id) {\r\n                                        $scope.categories[i].products[j].item_id = container.id;\r\n                                        $scope.categories[i].products[j].quantity = container.quantity;\r\n                                        if (total) {\r\n                                            continue cart;\r\n                                        }\r\n\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n                $scope.changeCartQuantity = function (product, change) {\r\n                    if (change == \"+\") {\r\n                        product.quantity++;\r\n                    } else {\r\n                        product.quantity--;\r\n                    }\r\n                    var container = {\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            Modals.showToast(\"Error Actualizando\", $(\"#prod-cont-\" + product.id));\r\n                            alert(data.message);\r\n                        } else {\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n            }])\r\n        .controller('ProductDetailCtrl', ['$scope', 'Cart', '$rootScope', '$sce', 'Products', '$mdDialog', 'Modals', function ($scope, Cart, $rootScope, $sce, Products, $mdDialog, Modals) {\r\n                $scope.hasLocation = false;\r\n                $scope.hasMerchant = false;\r\n                $scope.product = {};\r\n                $scope.related_products = [];\r\n                $scope.category_id = null;\r\n                $scope.rating = {};\r\n\r\n                angular.element(document).ready(function () {\r\n                    $scope.clean();\r\n\r\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\r\n                    console.log(\"viewData\", res);\r\n                    var container = JSON.parse(res);\r\n                    console.log(\"Data\", container);\r\n                    $scope.product = container.product;\r\n                    $scope.related_products = container.related_products[0].products;\r\n                    for (var i in $scope.related_products) {\r\n                        var activeVariant = $scope.related_products[i].variants[0];\r\n                        for (var j in $scope.related_products[i].variants) {\r\n                            if ($scope.related_products[i].variants[j].is_on_sale && activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].sale < activeVariant.sale) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            } else if (!$scope.related_products[i].variants[j].is_on_sale && activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].price < activeVariant.sale) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            } else if (!$scope.related_products[i].variants[j].is_on_sale && !activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].price < activeVariant.price) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            } else if ($scope.related_products[i].variants[j].is_on_sale && !activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].sale < activeVariant.price) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            }\r\n                        }\r\n                        $scope.related_products[i].activeVariant = activeVariant;\r\n                        $scope.related_products[i].variant_id = activeVariant.id;\r\n                    }\r\n                    $scope.rating.type = \"Product\";\r\n                    $scope.rating.object_id = $scope.product.id;\r\n                    $scope.rating.rating = '5';\r\n                    $scope.product.variants = $scope.product.product_variants;\r\n                    $scope.product.activeVariant = $scope.product.variants[0];\r\n                    $scope.product.quantity = $scope.product.activeVariant.min_quantity;\r\n                    $scope.product.variant_id = $scope.product.variants[0].id;\r\n                    $scope.product.description = $sce.trustAsHtml($scope.product.description);\r\n                    document.getElementById(\"dissapear\").remove();\r\n                });\r\n                $rootScope.$on('loadCartVariants', function (event, args) {\r\n                    $scope.updateProductsCart(args, false);\r\n                });\r\n                $scope.clean = function () {\r\n                    angular.forEach(angular.element(\".product-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $scope.selectVariant = function (product) {\r\n                    for (var item in product.variants) {\r\n                        if (product.variant_id == product.variants[item].id) {\r\n                            product.activeVariant = product.variants[item];\r\n                        }\r\n                    }\r\n                }\r\n                $scope.addCartItem = function (product) {\r\n                    var container = {\r\n                        id: product.activeVariant.id,\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        product: product\r\n                    }\r\n                    if((product.activeVariant.is_on_sale && product.activeVariant.sale <1)||(!product.activeVariant.is_on_sale && product.activeVariant.price <1)){\r\n                        Modals.showToast(\"Ese producto no esta a la venta\", $(\"#prod-cont-\" + product.id));\r\n                        return true;\r\n                    }\r\n                    Cart.addCartItem(container, []).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            product.item_id = data.item.id;\r\n                            product.quantity = data.item.quantity;\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#add-cart-form\"));\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#add-cart-form\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.addRating = function () {\r\n                    console.log(\"Rating\", $scope.rating);\r\n                    if (!$rootScope.user) {\r\n                        console.log(\"Debes estar loguedo para comentar\");\r\n                        Modals.showToast(\"Debes estar loguedo para comentar\", $(\"#toast-container\"));\r\n                        return;\r\n                    }\r\n                    if ($scope.rating.rating.length > 0) {\r\n                        Modals.showToast(\"Agrega una calificacion\", $(\"#toast-container\"));\r\n                        return;\r\n                    }\r\n                    if ($scope.rating.comment.length > 0) {\r\n                        Modals.showToast(\"Agrega una observacion a tu calificacion\", $(\"#toast-container\"));\r\n                        return;\r\n                    }\r\n                    Products.addRating($scope.rating).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            Modals.showToast(\"Mensaje enviado. Si vuelves a enviar se anula el anterior\", $(\"#toast-container\"))\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#toast-container\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.updateProductsCart = function (cart, total) {\r\n                    var products = $scope.related_products;\r\n                    for (var m in cart.items) {\r\n                        for (var j in products) {\r\n                            for (var k in products[j].variants) {\r\n                                var container = cart.items[m];\r\n                                var variant = products[j].variants[k];\r\n                                if (container.attributes.product_variant_id == variant.id) {\r\n                                    products[j].item_id = container.id;\r\n                                    products[j].quantity = container.quantity;\r\n                                    if (total) {\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $scope.changeCartQuantity = function (product, change) {\r\n                    if (change == \"+\") {\r\n                        product.quantity++;\r\n                    } else {\r\n                        product.quantity--;\r\n                    }\r\n                    var container = {\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9wcm9kdWN0Y3RybC5qcz9kN2ZhIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdQcm9kdWN0c0N0cmwnLCBbJyRzY29wZScsICdDYXJ0JywgJyRyb290U2NvcGUnLCAnJHNjZScsICdQcm9kdWN0cycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBDYXJ0LCAkcm9vdFNjb3BlLCAkc2NlLCBQcm9kdWN0cywgTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2RJZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5oYXNMb2NhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhhc01lcmNoYW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNTZWFyY2ggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudE9iaiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJhbmdlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcyA9IHt9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSAxXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnlfaWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2NhbF90b3RhbCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB2aWV3RGF0YS5yZXBsYWNlKC9BcHBcXFxcTW9kZWxzXFxcXC9nLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInZpZXdEYXRhXCIsIHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IEpTT04ucGFyc2UocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkUHJvZHVjdHNGcm9tV2hvbGUoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuY2F0ZWdvcmllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkaXNzYXBlYXJcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IE1vZGFscy5nZXRBbGxVcmxQYXJhbXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBhcmFtc1wiLCBwYXJhbXMpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLmluY2x1ZGVzID0gXCJmaWxlcyxtZXJjaGFudFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXJhbXMuY2F0ZWdvcnlfaWQgPSAkc2NvcGUuY2F0ZWdvcnlfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLmluY2x1ZGVzKFwic2VhcmNoXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1NlYXJjaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignbG9hZENhcnRWYXJpYW50cycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVQcm9kdWN0c0NhcnQoYXJncywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrRmF2b3JpdGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignY2xlYXJDYXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYXJ0IGNsZWFyZWQgcmVzZXR0aW5nIGl0ZW1zXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhcnRDbGVhcmVkKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignZGVsZXRlSXRlbScsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaXRlbSByZW1vdmVkIHJlc2V0dGluZyBpdGVtczogXCIsIGFyZ3MpXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhcnREZWxldGVkSXRlbShhcmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhbmd1bGFyLmVsZW1lbnQoXCIucHJvZHVjdC1hdHRyaWJ1dGVzXCIpLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGFuZ3VsYXIuZWxlbWVudCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGEuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHggaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IHggKyBcIjogXCIgKyBvYmpbeF0gKyBcIiA8YnIvPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuaHRtbChodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTdG9yZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LmNoYW5nZU1lcmNoYW50KClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRDYXRGaWx0ZXIgPSBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLmNhdGVnb3J5X2lkID0gY2F0ZWdvcnk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdvVG8oMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRQcm9kdWN0c0Zyb21XaG9sZSA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IGNvbnRhaW5lci5jYXRlZ29yaWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gY29udGFpbmVyLnBhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSBjb250YWluZXIubGFzdF9wYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gY29udGFpbmVyLnBhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gY29udGFpbmVyLnBlcl9wYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGNvbnRhaW5lci50b3RhbDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmNhdGVnb3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeV9pZCA9IGNvbnRhaW5lci5jYXRlZ29yeS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5jYXRlZ29yaWVzKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRzY29wZS5jYXRlZ29yaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kSWRzLnB1c2goJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaWQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5tZXJjaGFudF9pZCAmJiAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tZXJjaGFudF9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWVyY2hhbnRfaWQgPSAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tZXJjaGFudF9pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10ubWVyY2hhbnRfaWQgJiYgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10ubWVyY2hhbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5tZXJjaGFudF9pZCA9ICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLm1lcmNoYW50c1swXS5pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvY2FsX3RvdGFsKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uZmlsZXMgJiYgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uZmlsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmltZ3MgPSAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5maWxlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5pbWdzICYmICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmltZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnNyYyA9ICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmltZ3NbMF0uZmlsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmRlc2NyaXB0aW9uID0gJHNjZS50cnVzdEFzSHRtbCgkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5hY3RpdmVWYXJpYW50ID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10udmFyaWFudHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS52YXJpYW50X2lkID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10udmFyaWFudHNbMF0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5xdWFudGl0eSA9ICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnZhcmlhbnRzWzBdLm1pbl9xdWFudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaXNGYXZvcml0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkUHJvZHVjdHMgPSBmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gUHJvZHVjdHMuYnVpbGRQcm9kdWN0SW5mb3JtYXRpb24ocmVzcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXN1bHQgYnVpbGQgcHJvZHVjdFwiLCAkc2NvcGUuY2F0ZWdvcmllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tZXJjaGFudF9hdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0cmlidXRlcyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGF0dHJpYnV0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuc3RvcmVfYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLnN0b3JlX2FjdGl2ZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcmVBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudE9iai5tZXJjaGFudF9uYW1lID0gJHNjb3BlLmNhdGVnb3JpZXNbMF0ucHJvZHVjdHNbMF0ubWVyY2hhbnRfbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRPYmoubWVyY2hhbnRfZGVzY3JpcHRpb24gPSAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tZXJjaGFudF9kZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRPYmouc3JjID0gJHNjb3BlLmNhdGVnb3JpZXNbMF0ucHJvZHVjdHNbMF0uc3JjO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3RoaXMub3BlblR1dG9yaWFscygpOyAgXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50T2JqLm1lcmNoYW50X3R5cGUgPSAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tZXJjaGFudF90eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2F0ZWdvcmllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzWzBdLm1vcmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3JpZXNbMF0ucHJvZHVjdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbMF0ucHJvZHVjdHNbMF0ubW9yZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzWzFdLm1vcmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gcGFyc2VJbnQocmVzcC5wYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZElkcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sYXN0ID0gcGFyc2VJbnQocmVzcC5sYXN0X3BhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gcGFyc2VJbnQocmVzcC5wYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSBwYXJzZUludChyZXNwLnBlcl9wYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSBwYXJzZUludChyZXNwLnRvdGFsKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9jYWxfdG90YWwgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvY2FsX3RvdGFsKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZElkcy5wdXNoKCRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmRlc2NyaXB0aW9uID0gJHNjZS50cnVzdEFzSHRtbCgkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5hY3RpdmVWYXJpYW50ID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10udmFyaWFudHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS52YXJpYW50X2lkID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10udmFyaWFudHNbMF0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5xdWFudGl0eSA9ICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnZhcmlhbnRzWzBdLm1pbl9xdWFudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclByaWNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmlsdGVyaW5nXCIsICQoXCIjYW1vdW50XCIpLnZhbCgpKVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdHIgPSAkKFwiI2Ftb3VudFwiKS52YWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgPSBzdHIucmVwbGFjZShcIiRcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoXCIkXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmlsdGVyaW5nXCIsIHN0cilcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gc3RyLnNwbGl0KFwiLVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZpbHRlcmluZ1wiLCByZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcy5oaWdoID0gcGFyc2VJbnQocmVzWzFdLnRyaW0oKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcy5sb3cgPSBwYXJzZUludChyZXNbMF0udHJpbSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbygxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5nb1RvID0gZnVuY3Rpb24gKHBhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLnBhZ2UgPSBwYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1lcmNoYW50X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXJhbXMubWVyY2hhbnRfaWQgPSAkcm9vdFNjb3BlLm1lcmNoYW50X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5pc1NlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5zZWFyY2hQcm9kdWN0cygkc2NvcGUucGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhcmFtc1wiLCAkc2NvcGUucGFyYW1zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzcG9uc2VcIiwgcmVzcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC50b3RhbCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRQcm9kdWN0c0Zyb21XaG9sZShyZXNwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmNyZWF0ZVNsaWRlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5nZXRQcm9kdWN0c01lcmNoYW50KCRzY29wZS5wYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1zXCIsICRzY29wZS5wYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXNwb25zZVwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnByb2R1Y3RzX3RvdGFsID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5idWlsZFByb2R1Y3RzKHJlc3ApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuY3JlYXRlU2xpZGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0VmFyaWFudCA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiBwcm9kdWN0LnZhcmlhbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0LnZhcmlhbnRfaWQgPT0gcHJvZHVjdC52YXJpYW50c1tpdGVtXS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5hY3RpdmVWYXJpYW50ID0gcHJvZHVjdC52YXJpYW50c1tpdGVtXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRDYXJ0SXRlbSA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb2R1Y3QuYWN0aXZlVmFyaWFudC5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHByb2R1Y3QucXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IHByb2R1Y3QuaXRlbV9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdDogcHJvZHVjdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcHJvZHVjdC50eXBlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKChwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSAmJiBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuc2FsZSA8MSl8fCghcHJvZHVjdC5hY3RpdmVWYXJpYW50LmlzX29uX3NhbGUgJiYgcHJvZHVjdC5hY3RpdmVWYXJpYW50LnByaWNlIDwxKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJFc2UgcHJvZHVjdG8gbm8gZXN0YSBhIGxhIHZlbnRhXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5hZGRDYXJ0SXRlbShjb250YWluZXIsIFtdKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGNhcnRcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkNhcnJpdG8gYWN0dWFsaXphZG9cIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Lml0ZW1faWQgPSBkYXRhLml0ZW0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5ID0gZGF0YS5pdGVtLnF1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoZGF0YS5tZXNzYWdlLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrRmF2b3JpdGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfaWRzOiAkc2NvcGUucHJvZElkc1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5jaGVja0Zhdm9yaXRlKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNoZWNrRmF2b3JpdGVzIHJlc1wiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gcmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLmlkID09IHJlc3VsdHNba10uZmF2b3JpdGFibGVfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pc0Zhdm9yaXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRGYXZvcml0ZSA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X2lkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQcm9kdWN0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5hZGRGYXZvcml0ZShjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGFkZEZhdm9yaXRlXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5pc0Zhdm9yaXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQWdyZWdhZG9cIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoZGF0YS5tZXNzYWdlLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJEZWJlcyBlc3RhciBsb2d1ZWFkbyBwYXJhIGd1YXJkYXIgcHJvZHVjdG9zXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlRmF2b3JpdGUgPSBmdW5jdGlvbiAocHJvZHVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF9pZDogcHJvZHVjdC5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQcm9kdWN0XCJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgUHJvZHVjdHMuZGVsZXRlRmF2b3JpdGUoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGFkZEZhdm9yaXRlXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2Fkb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoZGF0YS5tZXNzYWdlLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FydENsZWFyZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiAkc2NvcGUuY2F0ZWdvcmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pdGVtX2lkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jYXJ0RGVsZXRlZEl0ZW0gPSBmdW5jdGlvbiAoaXRlbV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPT0gaXRlbV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVByb2R1Y3RzQ2FydCA9IGZ1bmN0aW9uIChjYXJ0LCB0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBtIGluIGNhcnQuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiAkc2NvcGUuY2F0ZWdvcmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0udmFyaWFudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGNhcnQuaXRlbXNbbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YXJpYW50ID0gJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0udmFyaWFudHNba107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuYXR0cmlidXRlcy5wcm9kdWN0X3ZhcmlhbnRfaWQgPT0gdmFyaWFudC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0uaXRlbV9pZCA9IGNvbnRhaW5lci5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLnF1YW50aXR5ID0gY29udGFpbmVyLnF1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUgY2FydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUNhcnRRdWFudGl0eSA9IGZ1bmN0aW9uIChwcm9kdWN0LCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlID09IFwiK1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucXVhbnRpdHkrKztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5LS07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBwcm9kdWN0LnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBwcm9kdWN0Lml0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJlcnJvclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiRXJyb3IgQWN0dWFsaXphbmRvXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XSlcclxuICAgICAgICAuY29udHJvbGxlcignUHJvZHVjdERldGFpbEN0cmwnLCBbJyRzY29wZScsICdDYXJ0JywgJyRyb290U2NvcGUnLCAnJHNjZScsICdQcm9kdWN0cycsICckbWREaWFsb2cnLCAnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgQ2FydCwgJHJvb3RTY29wZSwgJHNjZSwgUHJvZHVjdHMsICRtZERpYWxvZywgTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGFzTG9jYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5oYXNNZXJjaGFudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzID0gW107XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnlfaWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJhdGluZyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jbGVhbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGEucmVwbGFjZSgvQXBwXFxcXE1vZGVsc1xcXFwvZywgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2aWV3RGF0YVwiLCByZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRhXCIsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QgPSBjb250YWluZXIucHJvZHVjdDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVsYXRlZF9wcm9kdWN0cyA9IGNvbnRhaW5lci5yZWxhdGVkX3Byb2R1Y3RzWzBdLnByb2R1Y3RzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZVZhcmlhbnQgPSAkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLmlzX29uX3NhbGUgJiYgYWN0aXZlVmFyaWFudC5pc19vbl9zYWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLnNhbGUgPCBhY3RpdmVWYXJpYW50LnNhbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVmFyaWFudCA9ICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbal0uaXNfb25fc2FsZSAmJiBhY3RpdmVWYXJpYW50LmlzX29uX3NhbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbal0ucHJpY2UgPCBhY3RpdmVWYXJpYW50LnNhbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVmFyaWFudCA9ICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbal0uaXNfb25fc2FsZSAmJiAhYWN0aXZlVmFyaWFudC5pc19vbl9zYWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLnByaWNlIDwgYWN0aXZlVmFyaWFudC5wcmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVWYXJpYW50ID0gJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbal1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLmlzX29uX3NhbGUgJiYgIWFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXS5zYWxlIDwgYWN0aXZlVmFyaWFudC5wcmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVWYXJpYW50ID0gJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbal1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0uYWN0aXZlVmFyaWFudCA9IGFjdGl2ZVZhcmlhbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRfaWQgPSBhY3RpdmVWYXJpYW50LmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmF0aW5nLnR5cGUgPSBcIlByb2R1Y3RcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmF0aW5nLm9iamVjdF9pZCA9ICRzY29wZS5wcm9kdWN0LmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yYXRpbmcucmF0aW5nID0gJzUnO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0LnZhcmlhbnRzID0gJHNjb3BlLnByb2R1Y3QucHJvZHVjdF92YXJpYW50cztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdC5hY3RpdmVWYXJpYW50ID0gJHNjb3BlLnByb2R1Y3QudmFyaWFudHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QucXVhbnRpdHkgPSAkc2NvcGUucHJvZHVjdC5hY3RpdmVWYXJpYW50Lm1pbl9xdWFudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdC52YXJpYW50X2lkID0gJHNjb3BlLnByb2R1Y3QudmFyaWFudHNbMF0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QuZGVzY3JpcHRpb24gPSAkc2NlLnRydXN0QXNIdG1sKCRzY29wZS5wcm9kdWN0LmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3NhcGVhclwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2xvYWRDYXJ0VmFyaWFudHMnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlUHJvZHVjdHNDYXJ0KGFyZ3MsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhbmd1bGFyLmVsZW1lbnQoXCIucHJvZHVjdC1hdHRyaWJ1dGVzXCIpLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGFuZ3VsYXIuZWxlbWVudCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGEuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHggaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IHggKyBcIjogXCIgKyBvYmpbeF0gKyBcIiA8YnIvPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuaHRtbChodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RWYXJpYW50ID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIHByb2R1Y3QudmFyaWFudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QudmFyaWFudF9pZCA9PSBwcm9kdWN0LnZhcmlhbnRzW2l0ZW1dLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQgPSBwcm9kdWN0LnZhcmlhbnRzW2l0ZW1dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZENhcnRJdGVtID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJvZHVjdC5hY3RpdmVWYXJpYW50LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogcHJvZHVjdC5pdGVtX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKChwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSAmJiBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuc2FsZSA8MSl8fCghcHJvZHVjdC5hY3RpdmVWYXJpYW50LmlzX29uX3NhbGUgJiYgcHJvZHVjdC5hY3RpdmVWYXJpYW50LnByaWNlIDwxKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJFc2UgcHJvZHVjdG8gbm8gZXN0YSBhIGxhIHZlbnRhXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5hZGRDYXJ0SXRlbShjb250YWluZXIsIFtdKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGNhcnRcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5pdGVtX2lkID0gZGF0YS5pdGVtLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5xdWFudGl0eSA9IGRhdGEuaXRlbS5xdWFudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCIsICQoXCIjYWRkLWNhcnQtZm9ybVwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChkYXRhLm1lc3NhZ2UsICQoXCIjYWRkLWNhcnQtZm9ybVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRSYXRpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSYXRpbmdcIiwgJHNjb3BlLnJhdGluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEZWJlcyBlc3RhciBsb2d1ZWRvIHBhcmEgY29tZW50YXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJEZWJlcyBlc3RhciBsb2d1ZWRvIHBhcmEgY29tZW50YXJcIiwgJChcIiN0b2FzdC1jb250YWluZXJcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmF0aW5nLnJhdGluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2EgdW5hIGNhbGlmaWNhY2lvblwiLCAkKFwiI3RvYXN0LWNvbnRhaW5lclwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yYXRpbmcuY29tbWVudC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2EgdW5hIG9ic2VydmFjaW9uIGEgdHUgY2FsaWZpY2FjaW9uXCIsICQoXCIjdG9hc3QtY29udGFpbmVyXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5hZGRSYXRpbmcoJHNjb3BlLnJhdGluZykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZCBjYXJ0XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJNZW5zYWplIGVudmlhZG8uIFNpIHZ1ZWx2ZXMgYSBlbnZpYXIgc2UgYW51bGEgZWwgYW50ZXJpb3JcIiwgJChcIiN0b2FzdC1jb250YWluZXJcIikpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChkYXRhLm1lc3NhZ2UsICQoXCIjdG9hc3QtY29udGFpbmVyXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVByb2R1Y3RzQ2FydCA9IGZ1bmN0aW9uIChjYXJ0LCB0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0cyA9ICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG0gaW4gY2FydC5pdGVtcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrIGluIHByb2R1Y3RzW2pdLnZhcmlhbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGNhcnQuaXRlbXNbbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhcmlhbnQgPSBwcm9kdWN0c1tqXS52YXJpYW50c1trXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmF0dHJpYnV0ZXMucHJvZHVjdF92YXJpYW50X2lkID09IHZhcmlhbnQuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNbal0uaXRlbV9pZCA9IGNvbnRhaW5lci5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNbal0ucXVhbnRpdHkgPSBjb250YWluZXIucXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUNhcnRRdWFudGl0eSA9IGZ1bmN0aW9uIChwcm9kdWN0LCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlID09IFwiK1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucXVhbnRpdHkrKztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5LS07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBwcm9kdWN0LnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBwcm9kdWN0Lml0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJlcnJvclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkNhcnJpdG8gYWN0dWFsaXphZG9cIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvcHJvZHVjdGN0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 23 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ReportsCtrl', ['$scope', 'Merchants', 'Modals', function ($scope, Merchants, Modals) {\n                $scope.data = {};\n                $scope.user = {};\n                $scope.current = 1;\n                $scope.last = 1;\n                $scope.total = 1;\n                $scope.per_page = 1;\n                $scope.reports = [];\n                $scope.categories = [];\n                $scope.regionVisible = false;\n                $scope.editMerchant = false;\n                $scope.submitted = false;\n                $scope.category;\n                angular.element(document).ready(function () {\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\n//                    res = res.replace(/\"{/g, \"'{\");\n//                    res = res.replace(/}\"/g, \"}'\");\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n\n                    console.log(\"Data\", container);\n                    $scope.category = container.category;\n                    $scope.reports = container.data;\n                    $scope.current = container.page;\n                    $scope.per_page = container.per_page;\n                    $scope.last = container.last_page;\n                    $scope.total = container.total;\n                    document.getElementById(\"dissapear\").remove();\n                });\n\n                $scope.goTo = function (page) {\n                    $scope.current = page;\n                    $scope.reports = [];\n                    Modals.showLoader();\n                    var where = \"category_id=\" + $scope.category.id + \"&page=\" + $scope.current + \"&limit=\" + 2;\n                    if ($scope.category.type.includes(\"nearby\")) {\n                        Merchants.getReportsNearby(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    } else {\n                        Merchants.getReports(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    }\n                }\n\n                $scope.loadResults = function (data) {\n                    $scope.reports = data.data;\n                    $scope.current = parseInt(data.page);\n                    $scope.per_page = parseInt(data.per_page);\n                    $scope.last = parseInt(data.last_page);\n                    $scope.total = parseInt(data.total);\n                    Modals.hideLoader();\n                }\n            }])\n        .controller('ReportDetailCtrl', ['$scope', 'Merchants', 'Modals', function ($scope, Merchants, Modals) {\n                $scope.report = {};\n\n                angular.element(document).ready(function () {\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\n//                    res = res.replace(/\"{/g, \"'{\");\n//                    res = res.replace(/}\"/g, \"}'\");\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n\n                    console.log(\"Data\", container);\n                    $scope.report = container;\n                    //document.getElementById(\"dissapear\").remove();\n                });\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9yZXBvcnRzY3RybC5qcz9kNGM5Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdSZXBvcnRzQ3RybCcsIFsnJHNjb3BlJywgJ01lcmNoYW50cycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBNZXJjaGFudHMsIE1vZGFscykge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudCA9IDE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSAxO1xuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gMTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0cyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1lcmNoYW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHZpZXdEYXRhLnJlcGxhY2UoL0FwcFxcXFxNb2RlbHNcXFxcL2csIFwiXCIpO1xuLy8gICAgICAgICAgICAgICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC9cInsvZywgXCIne1wiKTtcbi8vICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvfVwiL2csIFwifSdcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRhXCIsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeSA9IGNvbnRhaW5lci5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMgPSBjb250YWluZXIuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBjb250YWluZXIucGFnZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gY29udGFpbmVyLnBlcl9wYWdlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGFzdCA9IGNvbnRhaW5lci5sYXN0X3BhZ2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGNvbnRhaW5lci50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkaXNzYXBlYXJcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbyA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gcGFnZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCJjYXRlZ29yeV9pZD1cIiArICRzY29wZS5jYXRlZ29yeS5pZCArIFwiJnBhZ2U9XCIgKyAkc2NvcGUuY3VycmVudCArIFwiJmxpbWl0PVwiICsgMjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yeS50eXBlLmluY2x1ZGVzKFwibmVhcmJ5XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0UmVwb3J0c05lYXJieSh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyhkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0UmVwb3J0cyh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyhkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFJlc3VsdHMgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBwYXJzZUludChkYXRhLnBhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSBwYXJzZUludChkYXRhLnBlcl9wYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSBwYXJzZUludChkYXRhLmxhc3RfcGFnZSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IHBhcnNlSW50KGRhdGEudG90YWwpO1xuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignUmVwb3J0RGV0YWlsQ3RybCcsIFsnJHNjb3BlJywgJ01lcmNoYW50cycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBNZXJjaGFudHMsIE1vZGFscykge1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnQgPSB7fTtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGEucmVwbGFjZSgvQXBwXFxcXE1vZGVsc1xcXFwvZywgXCJcIik7XG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1wiey9nLCBcIid7XCIpO1xuLy8gICAgICAgICAgICAgICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC99XCIvZywgXCJ9J1wiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXNcIiwgcmVzKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IEpTT04ucGFyc2UocmVzKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGFcIiwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydCA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3NhcGVhclwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvcmVwb3J0c2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 24 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('RoutesCtrl', ['$scope', '$rootScope', 'Routes', 'Food', 'MapService', function ($scope, $rootScope, Routes, Food, MapService) {\n                $scope.data = {};\n                $scope.routes;\n                $scope.page = 0;\n                $scope.returns = [{name: \"casa\", address_id: 17663}, {name: \"basilikum\", address_id: 17660}];\n                $scope.loadMore = true;\n                $scope.scenario = 'preorganize';\n                $scope.status = 'pending';\n                $scope.provider = 'Basilikum';\n                $scope.regionVisible = false;\n                $scope.editAddress = false;\n                $scope.mapActive = false;\n                angular.element(document).ready(function () {\n                    $scope.getRoutes();\n                });\n                $scope.save = function (isvalid) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        var existing = false;\n                        if ($scope.data.address_id) {\n                            existing = true;\n                        }\n                        Routes.saveAddress($.param($scope.data)).then(function (data) {\n                            if (existing) {\n                                $scope.updateAddress(data.address);\n                            } else {\n                                $scope.routes.push(data.address);\n                            }\n\n                            $scope.data = {};\n                            $scope.submitted = false;\n                            $scope.editAddress = false;\n                        },\n                                function (data) {\n\n                                });\n                    }\n                }\n                $scope.changeScenario = function () {\n                    //$scope.provider= \"Basilikum\";\n                    console.log(\"provider\", $scope.provider);\n                    $scope.page = 0;\n                    $scope.hideAll();\n                    if ($scope.provider == \"Basilikum\") {\n                        $scope.scenario = \"preorganize\";\n                    }\n                    $scope.routes = [];\n                    $scope.getRoutes();\n                }\n                $scope.activateMap = function () {\n                    $scope.mapActive = true;\n                    console.log(\"Creating map data\")\n                    MapService.createMap(4.685419, -74.064161);\n                    $scope.createMapData();\n                }\n                $scope.createMapData = function () {\n                    console.log(\"Creating map data\")\n                    for (route in $scope.routes) {\n                        var stops = $scope.routes[route].stops;\n                        for (item in stops) {\n                            console.log(\"Creating map data stop\");\n                            stops[item].icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + stops[item].amount + '|FE6256|000000';\n                            stops[item].marker = MapService.createStop(stops[item]);\n                        }\n                        $scope.routes[route].stops = stops;\n                        console.log(\"Creating map data route\")\n                        var color = MapService.getColor();\n                        $scope.routes[route].polyline = MapService.createRoute($scope.routes[route], color);\n                    }\n                }\n                $scope.buildRouteData = function (route) {\n                    var stops = route.stops;\n                    var stopsLat = [];\n                    for (item in stops) {\n                        stops[item].details = JSON.parse(stops[item].details);\n                        var stopCord = {\"lat\": stops[item].address.lat, \"lng\": stops[item].address.long}\n                        stopsLat.push(stopCord);\n                        stops[item].name = stops[item].address.address;\n                        stops[item].lat = stops[item].address.lat;\n                        stops[item].long = stops[item].address.long;\n                        stops[item].moving_delivery = null;\n                        if ($scope.mapActive) {\n                            stops[item].marker = MapService.createStop(stops[item]);\n                        }\n\n                        /*let deliveries = stops[item].deliveries;\n                         for (item2 in deliveries) {\n                         deliveries[item2].details = JSON.parse(deliveries[item2].details);\n                         }\n                         stops[item].deliveries = deliveries;*/\n                    }\n                    route.stops = stops;\n                    route.stopsLat = stopsLat;\n                    if ($scope.mapActive) {\n                        var color = $scope.getRouteColor();\n                        route.polyline = MapService.createRoute(route, color);\n                    }\n                    setTimeout(function () {\n                        var el = document.getElementById('route-' + route.id + '-table');\n                        var sortable = new Sortable(el, {\n                            group: \"routes\",\n                            handle: '.handle',\n                            dataIdAttr: route.id,\n                            onAdd: function (/**Event*/evt) {\n                                console.log(\"On add\", evt);\n                                var attributes = evt.item.attributes;\n                                var routeString = evt.target.id;\n                                routeString = routeString.replace(\"route-\", \"\");\n                                routeString = routeString.replace(\"-table\", \"\");\n                                var route = parseInt(routeString);\n                                var stop = null;\n                                for (item in attributes) {\n                                    if (attributes[item].name == \"data-stop\") {\n                                        stop = attributes[item].value;\n                                    }\n                                }\n                                $scope.updateRouteLocation(route, stop, evt.newIndex, 1000);\n                            },\n                            onUpdate: function (/**Event*/evt) {\n                                // same properties as onEnd\n                                var attributes = evt.item.attributes;\n                                var route = null;\n                                var stop = null;\n                                for (item in attributes) {\n                                    if (attributes[item].name == \"data-route\") {\n                                        route = attributes[item].value;\n                                    }\n                                    if (attributes[item].name == \"data-stop\") {\n                                        stop = attributes[item].value;\n                                    }\n                                }\n                                if (route && stop) {\n                                    $scope.updateRouteLocation(route, stop, evt.newIndex, evt.oldIndex);\n                                }\n\n                            },\n                        });\n                        console.log(\"Setting sortable\");\n                    }, 1000);\n\n                    route.address_id = 17663;\n                    return route;\n                }\n                $scope.updateRouteLocation = function (route, stop, index, old) {\n                    console.log(\"Route\", route);\n                    console.log(\"stop\", stop);\n                    console.log(\"index\", index);\n                    var movingStop = null\n                    var displacedStops = [];\n                    for (item in $scope.routes) {\n                        if ($scope.routes[item].id == route) {\n                            var container = $scope.routes[item];\n                            var counter = 1;\n                            for (stopI in container.stops) {\n                                if (container.stops[stopI].id == stop) {\n                                    movingStop = container.stops[stopI];\n                                } else {\n                                    if (old > index) {\n                                        if (counter >= index) {\n                                            displacedStops.push(container.stops[stopI]);\n                                        }\n                                    } else {\n                                        if (counter > index) {\n                                            displacedStops.push(container.stops[stopI]);\n                                        }\n                                    }\n                                }\n                                counter++;\n                            }\n                        }\n                    }\n\n                    console.log(\"displacedStops\", displacedStops);\n                    if (!movingStop) {\n                        movingStop = {};\n                        movingStop.route_id = route;\n                        movingStop.id = stop;\n                    }\n                    console.log(\"Moving stop\", movingStop);\n                    $('.preloader').fadeIn('slow');\n                    $scope.updateRouteStop(movingStop);\n\n                    setTimeout(function () {\n                        var counter = 1;\n                        if (displacedStops.length > 0) {\n                            for (item in displacedStops) {\n                                $scope.updateSpeed(displacedStops[item], counter);\n                                counter++;\n                                console.log(\"displacing stop\", displacedStops[item]);\n                            }\n                            setTimeout(function () {\n                                window.location.reload();\n                            }, 300 * (counter + 1));\n                        } else {\n                            setTimeout(function () {\n                                window.location.reload();\n                            }, 300 * (counter + 1));\n                        }\n                    }, 1000);\n                }\n                $scope.updateSpeed = function (stop, counter) {\n                    setTimeout(function () {\n                        $scope.updateRouteStop(stop);\n                    }, 300 * (counter + 1));\n                }\n                $scope.getRoutes = function () {\n                    console.log(\"Status\", $scope.status);\n                    console.log(\"provider\", $scope.provider);\n                    $scope.page++;\n                    var url = \"includes=stops.address&order_by=id,asc&page=\" + $scope.page + \"&type=\" + $scope.scenario + \"&status=\" + $scope.status + \"&provider=\" + $scope.provider;\n                    if ($scope.status != \"pending\") {\n                        url = \"includes=stops.address&order_by=id,asc&page=\" + $scope.page + \"&status=\" + $scope.status;\n                    }\n\n                    Routes.getRoutes(url).then(function (data) {\n                        var routesCont = data.data;\n                        if (data.page == data.last_page) {\n                            $scope.loadMore = false;\n                        }\n                        for (item in routesCont) {\n                            routesCont[item] = $scope.buildRouteData(routesCont[item]);\n                        }\n                        $scope.routes = routesCont;\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.clean = function () {\n                    $scope.data = {};\n                    $scope.regionVisible = false;\n                    $scope.cityVisible = false;\n                }\n                $scope.sendReminder = function () {\n                    Food.sendReminder().then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.showAll = function () {\n                    console.log(\"Creating map data\")\n                    for (route in $scope.routes) {\n                        var stops = $scope.routes[route].stops;\n                        for (item in stops) {\n                            console.log(\"Creating map data stop\")\n                            stops[item].marker.setMap($rootScope.map);\n                        }\n                        $scope.routes[route].stops = stops;\n                        $scope.routes[route].polyline.setMap($rootScope.map);\n                    }\n                }\n                $scope.hideAll = function () {\n                    console.log(\"Creating map data\")\n                    for (route in $scope.routes) {\n                        var stops = $scope.routes[route].stops;\n                        for (item in stops) {\n                            console.log(\"Creating map data stop\")\n                            if (stops[item].marker) {\n                                stops[item].marker.setMap(null);\n                            }\n                        }\n                        $scope.routes[route].stops = stops;\n                        if ($scope.routes[route].polyline) {\n                            $scope.routes[route].polyline.setMap(null);\n                        }\n                    }\n                }\n                $scope.showRoute = function (route) {\n                    $scope.hideAll();\n                    console.log(\"Creating map data\")\n                    var stops = route.stops;\n                    for (item in stops) {\n                        console.log(\"Creating map data stop\")\n                        stops[item].marker.setMap($rootScope.map);\n                    }\n                    route.polyline.setMap($rootScope.map);\n                }\n\n                $scope.clean = function () {\n                    $scope.data = {};\n                    $scope.regionVisible = false;\n                    $scope.cityVisible = false;\n                }\n                $scope.updateRouteStop = function (stop) {\n                    Routes.updateRouteStop(stop.id, stop.route_id).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.updateRouteDelivery = function (stop) {\n                    Routes.updateRouteStop(stop.route_id, stop.moving_delivery, stop.id).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteRoute = function (route_id) {\n                    Routes.deleteRoute(route_id).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteStop = function (stop_id) {\n                    Routes.deleteStop(stop_id).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.sendStopToNewRoute = function (stop) {\n                    Routes.sendStopToNewRoute(stop).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.addReturnStop = function (route, address_id) {\n                    Routes.addReturnStop(route, address_id).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.buildRoute = function (route) {\n                    Food.buildScenarioRouteId(route.id).then(function (data) {\n                        route.status = \"scheduled\";\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getPurchaseOrder = function () {\n                    Food.getPurchaseOrder().then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.regenerateScenarios = function () {\n                    Food.regenerateScenarios().then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.regenerateDeliveries = function () {\n                    Food.regenerateDeliveries().then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getTotalShippingCosts = function () {\n                    Food.getSummaryShipping($scope.status).then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getScenarioOrganization = function () {\n                    var data = $scope.getInputs();\n                    Food.getScenarioOrganizationStructure(data).then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.buildScenarioLogistics = function () {\n                    var data = $scope.getInputs();\n                    Food.buildScenarioLogistics(data).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getInputs = function () {\n                    var data;\n                    if ($scope.status == \"enqueue\") {\n                        data = {\n                            \"status\": \"enqueue\"\n                        };\n                    } else {\n                        data = {\n                            \"status\": $scope.status,\n                            \"provider\": $scope.provider,\n                            \"type\": $scope.scenario\n                        };\n                    }\n                    return data;\n                }\n                $scope.getScenarioEmails = function () {\n                    var data = $scope.getInputs();\n                    Food.getScenarioStructure(data).then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n\n            }]).controller('RapigoCtrl', ['$scope', 'Payments', function ($scope, Routes) {\n        $scope.data = {};\n        $scope.key;\n        angular.element(document).ready(function () {\n            var str = window.location.href;\n            var res = str.split(\"/\");\n\n        });\n\n        $scope.getUpdate = function () {\n            Routes.getKeyStatus($scope.key).then(function (data) {\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n    }])\n        .controller('RapigoCtrl', ['$scope', 'MapService', 'Routes', function ($scope, MapService, Routes) {\n                $scope.map = {center: {latitude: 4.653450, longitude: -74.049605}, zoom: 8};\n                $scope.activeMarker = null;\n                $scope.markerStatus = \"\";\n                MapService.createMap(4.653450, -74.049605);\n                angular.element(document).ready(function () {\n                    var str = window.location.href;\n                    var res = str.split(\"/\");\n                    $scope.key = res[res.length - 1];\n                    $scope.getUpdate();\n                });\n                $scope.getUpdate = function () {\n                    Routes.getKeyStatus($scope.key).then(function (data) {\n                        if (data.status == \"success\") {\n                            var results = data.result;\n                            if (results) {\n                                $scope.markerStatus = results.status;\n                                if (results.curier) {\n                                    if (results.curier.lat && !isNaN(results.curier.lat)) {\n                                        if ($scope.activeMarker) {\n                                            $scope.activeMarker.setPosition(new google.maps.LatLng(results.curier.lat, results.curier.lon));\n                                        } else {\n                                            $scope.activeMarker = MapService.createLocationMarker(results.curier.lat, results.curier.lon, true);\n                                        }\n                                        MapService.setCenterMap(results.curier.lat, results.curier.lon);\n                                    }\n                                }\n                                setTimeout(function () {\n                                    $scope.getUpdate();\n                                }, 5000);\n                            }\n\n                        }\n\n                    },\n                            function (data) {\n\n                            });\n                }\n\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9yb3V0ZXNjdHJsLmpzPzE2M2YiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JvdXRlc0N0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1JvdXRlcycsICdGb29kJywgJ01hcFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBSb3V0ZXMsIEZvb2QsIE1hcFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXR1cm5zID0gW3tuYW1lOiBcImNhc2FcIiwgYWRkcmVzc19pZDogMTc2NjN9LCB7bmFtZTogXCJiYXNpbGlrdW1cIiwgYWRkcmVzc19pZDogMTc2NjB9XTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5zY2VuYXJpbyA9ICdwcmVvcmdhbml6ZSc7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9ICdwZW5kaW5nJztcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvdmlkZXIgPSAnQmFzaWxpa3VtJztcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJvdXRlcygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS5hZGRyZXNzX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgUm91dGVzLnNhdmVBZGRyZXNzKCQucGFyYW0oJHNjb3BlLmRhdGEpKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVBZGRyZXNzKGRhdGEuYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlcy5wdXNoKGRhdGEuYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRBZGRyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTY2VuYXJpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUucHJvdmlkZXI9IFwiQmFzaWxpa3VtXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicHJvdmlkZXJcIiwgJHNjb3BlLnByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZUFsbCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnByb3ZpZGVyID09IFwiQmFzaWxpa3VtXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY2VuYXJpbyA9IFwicHJlb3JnYW5pemVcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSb3V0ZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2YXRlTWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWFwQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY4NTQxOSwgLTc0LjA2NDE2MSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVNYXBEYXRhKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVNYXBEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhXCIpXG4gICAgICAgICAgICAgICAgICAgIGZvciAocm91dGUgaW4gJHNjb3BlLnJvdXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0b3BzID0gJHNjb3BlLnJvdXRlc1tyb3V0ZV0uc3RvcHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc3RvcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhIHN0b3BcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0uaWNvbiA9ICdodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9tYXBfcGluX2xldHRlciZjaGxkPScgKyBzdG9wc1tpdGVtXS5hbW91bnQgKyAnfEZFNjI1NnwwMDAwMDAnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLm1hcmtlciA9IE1hcFNlcnZpY2UuY3JlYXRlU3RvcChzdG9wc1tpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcyA9IHN0b3BzO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSByb3V0ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gTWFwU2VydmljZS5nZXRDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlc1tyb3V0ZV0ucG9seWxpbmUgPSBNYXBTZXJ2aWNlLmNyZWF0ZVJvdXRlKCRzY29wZS5yb3V0ZXNbcm91dGVdLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkUm91dGVEYXRhID0gZnVuY3Rpb24gKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdG9wcyA9IHJvdXRlLnN0b3BzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHNMYXQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIHN0b3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wc1tpdGVtXS5kZXRhaWxzID0gSlNPTi5wYXJzZShzdG9wc1tpdGVtXS5kZXRhaWxzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdG9wQ29yZCA9IHtcImxhdFwiOiBzdG9wc1tpdGVtXS5hZGRyZXNzLmxhdCwgXCJsbmdcIjogc3RvcHNbaXRlbV0uYWRkcmVzcy5sb25nfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNMYXQucHVzaChzdG9wQ29yZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wc1tpdGVtXS5uYW1lID0gc3RvcHNbaXRlbV0uYWRkcmVzcy5hZGRyZXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubGF0ID0gc3RvcHNbaXRlbV0uYWRkcmVzcy5sYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wc1tpdGVtXS5sb25nID0gc3RvcHNbaXRlbV0uYWRkcmVzcy5sb25nO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubW92aW5nX2RlbGl2ZXJ5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubWFwQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubWFya2VyID0gTWFwU2VydmljZS5jcmVhdGVTdG9wKHN0b3BzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLypsZXQgZGVsaXZlcmllcyA9IHN0b3BzW2l0ZW1dLmRlbGl2ZXJpZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtMiBpbiBkZWxpdmVyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcmllc1tpdGVtMl0uZGV0YWlscyA9IEpTT04ucGFyc2UoZGVsaXZlcmllc1tpdGVtMl0uZGV0YWlscyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLmRlbGl2ZXJpZXMgPSBkZWxpdmVyaWVzOyovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcm91dGUuc3RvcHMgPSBzdG9wcztcbiAgICAgICAgICAgICAgICAgICAgcm91dGUuc3RvcHNMYXQgPSBzdG9wc0xhdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5tYXBBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb2xvciA9ICRzY29wZS5nZXRSb3V0ZUNvbG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3V0ZS5wb2x5bGluZSA9IE1hcFNlcnZpY2UuY3JlYXRlUm91dGUocm91dGUsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb3V0ZS0nICsgcm91dGUuaWQgKyAnLXRhYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc29ydGFibGUgPSBuZXcgU29ydGFibGUoZWwsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cDogXCJyb3V0ZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICcuaGFuZGxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSWRBdHRyOiByb3V0ZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkFkZDogZnVuY3Rpb24gKC8qKkV2ZW50Ki9ldnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPbiBhZGRcIiwgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBldnQuaXRlbS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcm91dGVTdHJpbmcgPSBldnQudGFyZ2V0LmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVN0cmluZyA9IHJvdXRlU3RyaW5nLnJlcGxhY2UoXCJyb3V0ZS1cIiwgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlU3RyaW5nID0gcm91dGVTdHJpbmcucmVwbGFjZShcIi10YWJsZVwiLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlID0gcGFyc2VJbnQocm91dGVTdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpdGVtXS5uYW1lID09IFwiZGF0YS1zdG9wXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9wID0gYXR0cmlidXRlc1tpdGVtXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlUm91dGVMb2NhdGlvbihyb3V0ZSwgc3RvcCwgZXZ0Lm5ld0luZGV4LCAxMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVXBkYXRlOiBmdW5jdGlvbiAoLyoqRXZlbnQqL2V2dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzYW1lIHByb3BlcnRpZXMgYXMgb25FbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBldnQuaXRlbS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcm91dGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpdGVtXS5uYW1lID09IFwiZGF0YS1yb3V0ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGUgPSBhdHRyaWJ1dGVzW2l0ZW1dLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXNbaXRlbV0ubmFtZSA9PSBcImRhdGEtc3RvcFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcCA9IGF0dHJpYnV0ZXNbaXRlbV0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvdXRlICYmIHN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVSb3V0ZUxvY2F0aW9uKHJvdXRlLCBzdG9wLCBldnQubmV3SW5kZXgsIGV2dC5vbGRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBzb3J0YWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcm91dGUuYWRkcmVzc19pZCA9IDE3NjYzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm91dGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVSb3V0ZUxvY2F0aW9uID0gZnVuY3Rpb24gKHJvdXRlLCBzdG9wLCBpbmRleCwgb2xkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUm91dGVcIiwgcm91dGUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInN0b3BcIiwgc3RvcCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaW5kZXhcIiwgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW92aW5nU3RvcCA9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRpc3BsYWNlZFN0b3BzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUucm91dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnJvdXRlc1tpdGVtXS5pZCA9PSByb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSAkc2NvcGUucm91dGVzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHN0b3BJIGluIGNvbnRhaW5lci5zdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnN0b3BzW3N0b3BJXS5pZCA9PSBzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wID0gY29udGFpbmVyLnN0b3BzW3N0b3BJXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbGQgPiBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudGVyID49IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYWNlZFN0b3BzLnB1c2goY29udGFpbmVyLnN0b3BzW3N0b3BJXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRlciA+IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYWNlZFN0b3BzLnB1c2goY29udGFpbmVyLnN0b3BzW3N0b3BJXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpc3BsYWNlZFN0b3BzXCIsIGRpc3BsYWNlZFN0b3BzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtb3ZpbmdTdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wLnJvdXRlX2lkID0gcm91dGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wLmlkID0gc3RvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1vdmluZyBzdG9wXCIsIG1vdmluZ1N0b3ApO1xuICAgICAgICAgICAgICAgICAgICAkKCcucHJlbG9hZGVyJykuZmFkZUluKCdzbG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVSb3V0ZVN0b3AobW92aW5nU3RvcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY291bnRlciA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzcGxhY2VkU3RvcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBkaXNwbGFjZWRTdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlU3BlZWQoZGlzcGxhY2VkU3RvcHNbaXRlbV0sIGNvdW50ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGlzcGxhY2luZyBzdG9wXCIsIGRpc3BsYWNlZFN0b3BzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAgKiAoY291bnRlciArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAgKiAoY291bnRlciArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVTcGVlZCA9IGZ1bmN0aW9uIChzdG9wLCBjb3VudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVJvdXRlU3RvcChzdG9wKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwICogKGNvdW50ZXIgKyAxKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRSb3V0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhdHVzXCIsICRzY29wZS5zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInByb3ZpZGVyXCIsICRzY29wZS5wcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPXN0b3BzLmFkZHJlc3Mmb3JkZXJfYnk9aWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJnR5cGU9XCIgKyAkc2NvcGUuc2NlbmFyaW8gKyBcIiZzdGF0dXM9XCIgKyAkc2NvcGUuc3RhdHVzICsgXCImcHJvdmlkZXI9XCIgKyAkc2NvcGUucHJvdmlkZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3RhdHVzICE9IFwicGVuZGluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcImluY2x1ZGVzPXN0b3BzLmFkZHJlc3Mmb3JkZXJfYnk9aWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJnN0YXR1cz1cIiArICRzY29wZS5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBSb3V0ZXMuZ2V0Um91dGVzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlc0NvbnQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gcm91dGVzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRSb3V0ZURhdGEocm91dGVzQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzID0gcm91dGVzQ29udDtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jbGVhbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZW5kUmVtaW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIEZvb2Quc2VuZFJlbWluZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICAgICAgZm9yIChyb3V0ZSBpbiAkc2NvcGUucm91dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHMgPSAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBzdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgc3RvcFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLm1hcmtlci5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlc1tyb3V0ZV0uc3RvcHMgPSBzdG9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yb3V0ZXNbcm91dGVdLnBvbHlsaW5lLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICAgICAgZm9yIChyb3V0ZSBpbiAkc2NvcGUucm91dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHMgPSAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBzdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgc3RvcFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdG9wc1tpdGVtXS5tYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcyA9IHN0b3BzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yb3V0ZXNbcm91dGVdLnBvbHlsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlc1tyb3V0ZV0ucG9seWxpbmUuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93Um91dGUgPSBmdW5jdGlvbiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHMgPSByb3V0ZS5zdG9wcztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIHN0b3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhIHN0b3BcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLm1hcmtlci5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvdXRlLnBvbHlsaW5lLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVJvdXRlU3RvcCA9IGZ1bmN0aW9uIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy51cGRhdGVSb3V0ZVN0b3Aoc3RvcC5pZCwgc3RvcC5yb3V0ZV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlUm91dGVEZWxpdmVyeSA9IGZ1bmN0aW9uIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy51cGRhdGVSb3V0ZVN0b3Aoc3RvcC5yb3V0ZV9pZCwgc3RvcC5tb3ZpbmdfZGVsaXZlcnksIHN0b3AuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZVJvdXRlID0gZnVuY3Rpb24gKHJvdXRlX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy5kZWxldGVSb3V0ZShyb3V0ZV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcCA9IGZ1bmN0aW9uIChzdG9wX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy5kZWxldGVTdG9wKHN0b3BfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZW5kU3RvcFRvTmV3Um91dGUgPSBmdW5jdGlvbiAoc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBSb3V0ZXMuc2VuZFN0b3BUb05ld1JvdXRlKHN0b3ApLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRSZXR1cm5TdG9wID0gZnVuY3Rpb24gKHJvdXRlLCBhZGRyZXNzX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy5hZGRSZXR1cm5TdG9wKHJvdXRlLCBhZGRyZXNzX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRSb3V0ZSA9IGZ1bmN0aW9uIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBGb29kLmJ1aWxkU2NlbmFyaW9Sb3V0ZUlkKHJvdXRlLmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3V0ZS5zdGF0dXMgPSBcInNjaGVkdWxlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFB1cmNoYXNlT3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIEZvb2QuZ2V0UHVyY2hhc2VPcmRlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5yZWdlbmVyYXRlU2NlbmFyaW9zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBGb29kLnJlZ2VuZXJhdGVTY2VuYXJpb3MoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnZW5lcmF0ZURlbGl2ZXJpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIEZvb2QucmVnZW5lcmF0ZURlbGl2ZXJpZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0VG90YWxTaGlwcGluZ0Nvc3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBGb29kLmdldFN1bW1hcnlTaGlwcGluZygkc2NvcGUuc3RhdHVzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U2NlbmFyaW9Pcmdhbml6YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gJHNjb3BlLmdldElucHV0cygpO1xuICAgICAgICAgICAgICAgICAgICBGb29kLmdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZFNjZW5hcmlvTG9naXN0aWNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9ICRzY29wZS5nZXRJbnB1dHMoKTtcbiAgICAgICAgICAgICAgICAgICAgRm9vZC5idWlsZFNjZW5hcmlvTG9naXN0aWNzKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRJbnB1dHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnN0YXR1cyA9PSBcImVucXVldWVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiBcImVucXVldWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGF0dXNcIjogJHNjb3BlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb3ZpZGVyXCI6ICRzY29wZS5wcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnNjZW5hcmlvXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U2NlbmFyaW9FbWFpbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gJHNjb3BlLmdldElucHV0cygpO1xuICAgICAgICAgICAgICAgICAgICBGb29kLmdldFNjZW5hcmlvU3RydWN0dXJlKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XSkuY29udHJvbGxlcignUmFwaWdvQ3RybCcsIFsnJHNjb3BlJywgJ1BheW1lbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgUm91dGVzKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICRzY29wZS5rZXk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHN0ciA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICAgICAgdmFyIHJlcyA9IHN0ci5zcGxpdChcIi9cIik7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLmdldFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFJvdXRlcy5nZXRLZXlTdGF0dXMoJHNjb3BlLmtleSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JhcGlnb0N0cmwnLCBbJyRzY29wZScsICdNYXBTZXJ2aWNlJywgJ1JvdXRlcycsIGZ1bmN0aW9uICgkc2NvcGUsIE1hcFNlcnZpY2UsIFJvdXRlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXAgPSB7Y2VudGVyOiB7bGF0aXR1ZGU6IDQuNjUzNDUwLCBsb25naXR1ZGU6IC03NC4wNDk2MDV9LCB6b29tOiA4fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWFya2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWFya2VyU3RhdHVzID0gXCJcIjtcbiAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY1MzQ1MCwgLTc0LjA0OTYwNSk7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHN0ci5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5rZXkgPSByZXNbcmVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0VXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgUm91dGVzLmdldEtleVN0YXR1cygkc2NvcGUua2V5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGRhdGEucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tYXJrZXJTdGF0dXMgPSByZXN1bHRzLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMuY3VyaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5jdXJpZXIubGF0ICYmICFpc05hTihyZXN1bHRzLmN1cmllci5sYXQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1hcmtlci5zZXRQb3NpdGlvbihuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHJlc3VsdHMuY3VyaWVyLmxhdCwgcmVzdWx0cy5jdXJpZXIubG9uKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1hcmtlciA9IE1hcFNlcnZpY2UuY3JlYXRlTG9jYXRpb25NYXJrZXIocmVzdWx0cy5jdXJpZXIubGF0LCByZXN1bHRzLmN1cmllci5sb24sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLnNldENlbnRlck1hcChyZXN1bHRzLmN1cmllci5sYXQsIHJlc3VsdHMuY3VyaWVyLmxvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0VXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9yb3V0ZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 25 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('SitemapCtrl', ['$scope', 'Cart', '$rootScope', 'Modals', function ($scope, Cart, $rootScope, Modals) {\r\n                $scope.data = {};\r\n                $scope.user = {};\r\n                $scope.current = 1;\r\n                $scope.last = 1;\r\n                $scope.total = 1;\r\n                $scope.per_page = 1;\r\n                $scope.merchants = [];\r\n                $scope.categories = [];\r\n                $scope.regionVisible = false;\r\n                $scope.editMerchant = false;\r\n                $scope.submitted = false;\r\n                $scope.category;\r\n                angular.element(document).ready(function () {\r\n                });\r\n                $rootScope.$on('updateShippingAddress', function () {\r\n                    if ($rootScope.user) {\r\n                        Cart.showConfirm(window.location.href);\r\n                    } else {\r\n                        Cart.showConfirmExt(window.location.href);\r\n                    }\r\n                });\r\n\r\n                $scope.goTo = function (type, $event) {\r\n                    if (type == \"merchant\" || type == \"report\") {\r\n                        //$event.preventDefault()\r\n                    }\r\n                    console.log(\"Going\");\r\n                    var url = $event.target.href;\r\n                    if (type.includes(\"nearby\") || type.includes(\"coverage\")) {\r\n\r\n                        if (type.includes(\"nearby\")) {\r\n                            url += \"/nearby\"\r\n                        } else if (type.includes(\"coverage\")) {\r\n                            url += \"/coverage\"\r\n                        }\r\n                        console.log(\"Type\", type);\r\n                        console.log(\"target\", $event.target.href);\r\n                        $event.preventDefault()\r\n\r\n                        if (!$rootScope.shippingAddress) {\r\n                            if ($rootScope.user) {\r\n                                Cart.showConfirm(url);\r\n                            } else {\r\n                                Cart.showConfirmExt(url);\r\n                            }\r\n\r\n                        } else {\r\n                            var params = Modals.getAllUrlParams();\r\n                            if (params) {\r\n\r\n                            } else {\r\n                                params = {};\r\n                            }\r\n                            params.lat = $rootScope.shippingAddress.lat;\r\n                            params.long = $rootScope.shippingAddress.long;\r\n                            console.log(\"params\", params);\r\n\r\n                            console.log(\"res\", Modals.turnObjectToUrl(params, url));\r\n                            window.location.href = Modals.turnObjectToUrl(params, url)\r\n                        }\r\n                    } else {\r\n                        window.location.href = url;\r\n                    }\r\n                }\r\n            }])\r\n        .controller('SearchCtrl', ['$scope', '$rootScope', '$cookies','Modals', function ($scope, $rootScope, $cookies,Modals) {\r\n                $scope.category = \"products|0|coverage\";\r\n                $scope.searchText = \"\";\r\n                $scope.showError = false;\r\n\r\n                angular.element(document).ready(function () {\r\n                    var params;\r\n                    var url = window.location.href;\r\n                    if(url.includes(\"merchant\")){\r\n                        $scope.category = \"merchants|0|list\";\r\n                    } else if(url.includes(\"report\")){\r\n                        $scope.category = \"reports|0|list\";\r\n                    }\r\n                    params = Modals.getAllUrlParams();\r\n                    if (params) {\r\n                        if(params.q){\r\n                            $scope.searchText = decodeURIComponent(params.q);\r\n                        }\r\n                    }\r\n                });\r\n                $scope.selectCat = function () {\r\n                    if ($scope.category.length > 0) {\r\n                        $scope.showError = false;\r\n                    }\r\n                }\r\n\r\n                $scope.search = function () {\r\n                    if ($scope.category.length > 0) {\r\n                        console.log(\"Search: \", $scope.searchText, \" Category: \", $scope.category);\r\n                        var results = $scope.category.split(\"|\");\r\n                        var url = \"\";\r\n                        if (results[0] == \"merchants\") {\r\n                            url = \"/a/merchant-search\";\r\n                        } else if (results[0] == \"reports\") {\r\n                            url = \"/a/report-search\";\r\n                        } else if (results[0] == \"products\") {\r\n                            url = \"/a/product-search\";\r\n                        }\r\n                        if (results[2] == \"nearby\" || results[2] == \"coverage\") {\r\n                            if ($rootScope.shippingAddress) {\r\n                                if (results[1] == \"0\") {\r\n                                    url += \"?lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long + \"&q=\" + $scope.searchText\r\n                                } else {\r\n                                    url += \"?categories=\" + results[1] + \"&lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long + \"&q=\" + $scope.searchText\r\n                                }\r\n\r\n                            } else {\r\n                                if (results[1] == \"0\") {\r\n                                    url += \"?q=\" + $scope.searchText\r\n                                } else {\r\n                                    url += \"?categories=\" + results[1] + \"&q=\" + $scope.searchText\r\n                                }\r\n\r\n                                $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\r\n                                window.location.href = \"/location\";\r\n                                return;\r\n                            }\r\n                        } else {\r\n                            if (results[1] == \"0\") {\r\n                                url += \"?q=\" + $scope.searchText\r\n                            } else {\r\n                                url += \"?categories=\" + results[1] + \"&q=\" + $scope.searchText\r\n                            }\r\n                        }\r\n                        window.location.href = url;\r\n                        //console.log(\"Url\",url);\r\n                    } else {\r\n                        $scope.showError = true;\r\n                    }\r\n                }\r\n            }])\r\n        .controller('HomeCtrl', ['$scope', 'Cart', '$rootScope', 'Modals', function ($scope, Cart, $rootScope, Modals) {\r\n                $scope.data = {};\r\n                $scope.user = {};\r\n                $scope.category;\r\n\r\n\r\n                $scope.goTo = function (type, $event, isCat) {\r\n                    if (type.includes(\"nearby\") || type.includes(\"coverage\")) {\r\n                        var url = $event.currentTarget.href;\r\n                        if (isCat) {\r\n                            if (type.includes(\"nearby\")) {\r\n                                url += \"/nearby\"\r\n                            } else if (type.includes(\"coverage\")) {\r\n                                url += \"/coverage\"\r\n                            }\r\n                        }\r\n\r\n                        console.log(\"Type\", type);\r\n                        console.log(\"target\", $event.currentTarget.href);\r\n                        $event.preventDefault()\r\n\r\n                        if (!$rootScope.shippingAddress) {\r\n                            if ($rootScope.user) {\r\n                                Cart.showConfirm(url);\r\n                            } else {\r\n                                Cart.showConfirmExt(url);\r\n                            }\r\n\r\n                        } else {\r\n                            var params;\r\n                            params = Modals.getAllUrlParams(url);\r\n\r\n                            if (params) {\r\n\r\n                            } else {\r\n                                params = {};\r\n                            }\r\n                            params.lat = $rootScope.shippingAddress.lat;\r\n                            params.long = $rootScope.shippingAddress.long;\r\n                            console.log(\"params\", params);\r\n                            console.log(\"res\", Modals.turnObjectToUrl(params, url));\r\n                            window.location.href = Modals.turnObjectToUrl(params, url)\r\n                        }\r\n                    }\r\n                }\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zaXRlbWFwY3RybC5qcz9kYWRlIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxyXG5cclxuICAgICAgICAuY29udHJvbGxlcignU2l0ZW1hcEN0cmwnLCBbJyRzY29wZScsICdDYXJ0JywgJyRyb290U2NvcGUnLCAnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgQ2FydCwgJHJvb3RTY29wZSwgTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sYXN0ID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1lcmNoYW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnk7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ3VwZGF0ZVNoaXBwaW5nQWRkcmVzcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0NvbmZpcm0od2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0NvbmZpcm1FeHQod2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5nb1RvID0gZnVuY3Rpb24gKHR5cGUsICRldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IFwibWVyY2hhbnRcIiB8fCB0eXBlID09IFwicmVwb3J0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8kZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSAkZXZlbnQudGFyZ2V0LmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoXCJuZWFyYnlcIikgfHwgdHlwZS5pbmNsdWRlcyhcImNvdmVyYWdlXCIpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZS5pbmNsdWRlcyhcIm5lYXJieVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiL25lYXJieVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZS5pbmNsdWRlcyhcImNvdmVyYWdlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCIvY292ZXJhZ2VcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHlwZVwiLCB0eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0YXJnZXRcIiwgJGV2ZW50LnRhcmdldC5ocmVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dDb25maXJtKHVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0NvbmZpcm1FeHQodXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zID0gTW9kYWxzLmdldEFsbFVybFBhcmFtcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMubGF0ID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmxvbmcgPSAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sb25nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJhbXNcIiwgcGFyYW1zKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc1wiLCBNb2RhbHMudHVybk9iamVjdFRvVXJsKHBhcmFtcywgdXJsKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IE1vZGFscy50dXJuT2JqZWN0VG9VcmwocGFyYW1zLCB1cmwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdTZWFyY2hDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckY29va2llcycsJ01vZGFscycsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsICRjb29raWVzLE1vZGFscykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5ID0gXCJwcm9kdWN0c3wwfGNvdmVyYWdlXCI7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVGV4dCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9yID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodXJsLmluY2x1ZGVzKFwibWVyY2hhbnRcIikpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnkgPSBcIm1lcmNoYW50c3wwfGxpc3RcIjtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodXJsLmluY2x1ZGVzKFwicmVwb3J0XCIpKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5ID0gXCJyZXBvcnRzfDB8bGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBNb2RhbHMuZ2V0QWxsVXJsUGFyYW1zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwYXJhbXMucSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVGV4dCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXJhbXMucSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RDYXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yeS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWFyY2g6IFwiLCAkc2NvcGUuc2VhcmNoVGV4dCwgXCIgQ2F0ZWdvcnk6IFwiLCAkc2NvcGUuY2F0ZWdvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9ICRzY29wZS5jYXRlZ29yeS5zcGxpdChcInxcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0c1swXSA9PSBcIm1lcmNoYW50c1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIi9hL21lcmNoYW50LXNlYXJjaFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdHNbMF0gPT0gXCJyZXBvcnRzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IFwiL2EvcmVwb3J0LXNlYXJjaFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdHNbMF0gPT0gXCJwcm9kdWN0c1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIi9hL3Byb2R1Y3Qtc2VhcmNoXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMl0gPT0gXCJuZWFyYnlcIiB8fCByZXN1bHRzWzJdID09IFwiY292ZXJhZ2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMV0gPT0gXCIwXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiP2xhdD1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCArIFwiJmxvbmc9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sb25nICsgXCImcT1cIiArICRzY29wZS5zZWFyY2hUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiP2NhdGVnb3JpZXM9XCIgKyByZXN1bHRzWzFdICsgXCImbGF0PVwiICsgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0ICsgXCImbG9uZz1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcgKyBcIiZxPVwiICsgJHNjb3BlLnNlYXJjaFRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0c1sxXSA9PSBcIjBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCI/cT1cIiArICRzY29wZS5zZWFyY2hUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiP2NhdGVnb3JpZXM9XCIgKyByZXN1bHRzWzFdICsgXCImcT1cIiArICRzY29wZS5zZWFyY2hUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJsb2NhdGlvblJlZmZlcnJlclwiLCB1cmwsIHtwYXRoOiBcIi9cIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9jYXRpb25cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0c1sxXSA9PSBcIjBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCArPSBcIj9xPVwiICsgJHNjb3BlLnNlYXJjaFRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiP2NhdGVnb3JpZXM9XCIgKyByZXN1bHRzWzFdICsgXCImcT1cIiArICRzY29wZS5zZWFyY2hUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJVcmxcIix1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfV0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgWyckc2NvcGUnLCAnQ2FydCcsICckcm9vdFNjb3BlJywgJ01vZGFscycsIGZ1bmN0aW9uICgkc2NvcGUsIENhcnQsICRyb290U2NvcGUsIE1vZGFscykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5nb1RvID0gZnVuY3Rpb24gKHR5cGUsICRldmVudCwgaXNDYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZS5pbmNsdWRlcyhcIm5lYXJieVwiKSB8fCB0eXBlLmluY2x1ZGVzKFwiY292ZXJhZ2VcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9ICRldmVudC5jdXJyZW50VGFyZ2V0LmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoXCJuZWFyYnlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCIvbmVhcmJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZS5pbmNsdWRlcyhcImNvdmVyYWdlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiL2NvdmVyYWdlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUeXBlXCIsIHR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRhcmdldFwiLCAkZXZlbnQuY3VycmVudFRhcmdldC5ocmVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dDb25maXJtKHVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0NvbmZpcm1FeHQodXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gTW9kYWxzLmdldEFsbFVybFBhcmFtcyh1cmwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmxhdCA9ICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5sb25nID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1zXCIsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc1wiLCBNb2RhbHMudHVybk9iamVjdFRvVXJsKHBhcmFtcywgdXJsKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IE1vZGFscy50dXJuT2JqZWN0VG9VcmwocGFyYW1zLCB1cmwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL3NpdGVtYXBjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 26 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('SourcesCtrl',['$scope', 'Billing', '$rootScope', function ($scope, Billing, $rootScope) {\n            $scope.data = {};\n            $scope.months = [];\n            $scope.years = [];\n            $scope.branches = [\n                {\"name\": \"Visa\", \"value\": \"VISA\"},\n                {\"name\": \"Mastercard\", \"value\": \"MASTERCARD\"},\n                {\"name\": \"Visa Debito\", \"value\": \"VISA_DEBIT\"},\n                {\"name\": \"Diners\", \"value\": \"DINERS\"},\n                {\"name\": \"American Express\", \"value\": \"AMEX\"}\n            ];\n            $scope.sources = [];\n            $scope.buying = false;\n            $scope.editSource = false;\n            $scope.showStripe = false;\n            $scope.hideDefault = false;\n            $scope.config = {};\n            angular.element(document).ready(function () {\n                $scope.localGateway = $scope.config.gateway;\n            });\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                console.log(\"Saving: \" + isvalid);\n                if (isvalid) {\n                    $scope.showStripe = true;\n                }\n            }\n            $scope.edit = function () {\n                if ($scope.editSource) {\n                    $scope.editSource = false;\n                } else {\n                    $scope.editSource = true;\n                }\n            }\n            // Create an instance of Elements\n            var elements = stripe.elements({locale: $translate.use()});\n\n            // Custom styling can be passed to options when creating an Element.\n            // (Note that this demo uses a wider set of styles than the guide below.)\n            var style = {\n                base: {\n                    color: '#32325d',\n                    lineHeight: '24px',\n                    fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n                    fontSmoothing: 'antialiased',\n                    fontSize: '16px',\n                    '::placeholder': {\n                        color: '#aab7c4'\n                    }\n                },\n                invalid: {\n                    color: '#fa755a',\n                    iconColor: '#fa755a'\n                }\n            };\n\n            // Create an instance of the card Element\n            var card = elements.create('card', {style: style});\n\n            // Add an instance of the card Element into the `card-element` <div>\n            card.mount('#card-element');\n\n            // Handle real-time validation errors from the card Element.\n            card.addEventListener('change', function (event) {\n                var displayError = document.getElementById('card-errors');\n                if (event.error) {\n                    displayError.textContent = event.error.message;\n                } else {\n                    displayError.textContent = '';\n                }\n            });\n\n            // Handle form submission\n            var form = document.getElementById('payment-form');\n            var ownerInfo = {\n                owner: {\n                    name: $scope.data.name,\n                    address: {\n                        line1: $scope.data.address,\n                        city: $scope.data.city,\n                        postal_code: $scope.data.postal,\n                        country: $scope.data.country,\n                    },\n                    email: $scope.data.email\n                },\n            };\n            form.addEventListener('submit', function (event) {\n                event.preventDefault();\n\n                stripe.createSource(card, ownerInfo).then(function (result) {\n                    if (result.error) {\n                        // Inform the user if there was an error\n                        var errorElement = document.getElementById('card-errors');\n                        errorElement.textContent = result.error.message;\n                    } else {\n                        // Send the source to your server\n                        stripeSourceHandler(result.source);\n                    }\n                });\n            });\n\n            $scope.stripeCreateToken = function () {\n                \n            }\n\n            function stripeSourceHandler(token) {\n                $scope.data.source = token;\n                $scope.saveSource();\n            }\n            $scope.loadMonths = function () {\n                console.log(\"Loading months\");\n                var date = new Date();\n                for (i = 0; i < 15; i++) {\n                    $scope.years.push(date.getFullYear() + i);\n                }\n                for (i = 0; i < 12; i++) {\n                    $scope.months.push(1 + i);\n                }\n            }\n            $scope.saveSource = function () {\n                delete $scope.data['cvc'];\n                delete $scope.data['expMonth'];\n                delete $scope.data['expYear'];\n                delete $scope.data['number'];\n                delete $scope.data['postal'];\n                console.log(\"Data sent\");\n                console.log(JSON.stringify($scope.data));\n                console.log(JSON.stringify($.param($scope.data)));\n                Billing.createSource($.param($scope.data), $rootScope.gateway).then(function (data) {\n                    console.log(\"Return source\");\n                    console.log(JSON.stringify(data));\n                    if (data.type == \"card\") {\n                        var card = data.card;\n                        card.type = \"card\";\n                        $scope.sources.push(card);\n                        $scope.editSource = false;\n                    }\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getSources = function (gateway) {\n                Billing.getSources(gateway).then(function (data) {\n\n                    var sources = data.sources;\n                    for (item in sources) {\n                        if (sources[item].type == \"card\") {\n                            var card = sources[item].card;\n                            card.type = \"card\";\n                            card.id = sources[item].id;\n                            card.is_default = sources[item].is_default;\n                            $scope.sources.push(card);\n                        }\n                    }\n                    if (sources.length == 0) {\n                        $scope.editSource = true;\n                        $scope.hidedefault = true;\n                        $scope.data.default = true;\n                    } else {\n                        $scope.hidedefault = false;\n                    }\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteSource = function (source) {\n                Billing.deleteSource(source.id, $rootScope.gateway).then(function (data) {\n                    for (item in $scope.sources) {\n                        if ($scope.sources[item].id == source.id) {\n                            console.log(\"deleting source\", $scope.sources[item]);\n                            $scope.sources.splice(item, 1);\n                        }\n                    }\n                },\n                        function (data) {\n                        });\n            }\n            $scope.loadTestData = function (source) {\n\n                $scope.data.cvc = \"123\";\n                $scope.data.postal = \"33132\";\n                $scope.data.expYear = \"2020\";\n                $scope.data.expMonth = \"12\";\n\n            }\n            $scope.selectSource = function (source) {\n                $rootScope.$broadcast('SourceSelected', {source: source.id});\n            }\n            $rootScope.$on('GetSources', function (event, args) {\n                $scope.getSources(args.gateway);\n                $scope.buying = true;\n            });\n            $rootScope.$on('GatewaySelected', function (event, args) {\n                if ($rootScope.gateway == $scope.localGateway) {\n                    $scope.getSources($scope.localGateway);\n                    $scope.loadMonths();\n                    $scope.loadTestData();\n                }\n            });\n            $scope.clean = function () {\n                $scope.data = {};\n            }\n            $scope.setAsDefault = function (source) {\n                var data = {};\n                data.source = source.id\n                Billing.setAsDefault(data, $rootScope.gateway).then(function (data) {\n                    for (item in $scope.sources) {\n                        $scope.sources[item].is_default = false;\n                        if ($scope.sources[item].id == source.id) {\n                            $scope.sources[item].is_default = true;\n                        }\n                    }\n                },\n                        function (data) {\n                            window.location.reload();\n                        });\n            }\n\n\n        }]).controller('SourcesPayuCtrl',['$scope', 'Billing', '$rootScope', function ($scope, Billing, $rootScope) {\n    $scope.data = {};\n    $scope.months = [];\n    $scope.years = [];\n    $scope.branches = [\n        {\"name\": \"Visa\", \"value\": \"VISA\"},\n        {\"name\": \"Mastercard\", \"value\": \"MASTERCARD\"},\n        {\"name\": \"Visa Debito\", \"value\": \"VISA_DEBIT\"},\n        {\"name\": \"Diners\", \"value\": \"DINERS\"},\n        {\"name\": \"American Express\", \"value\": \"AMEX\"}\n    ];\n    $scope.sources = [];\n    $scope.buying = false;\n    $scope.showErrors = false;\n    $scope.editSource = false;\n    $scope.errors = [];\n    $scope.config = {};\n    angular.element(document).ready(function () {\n\n        $scope.localGateway = \"PayU\";\n\n    });\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        $scope.showErrors = false;\n        console.log(\"Saving: \" + isvalid);\n        if (isvalid) {\n            $scope.saveSource();\n        }\n    }\n    $scope.edit = function () {\n        if ($scope.editSource) {\n            $scope.editSource = false;\n        } else {\n            $scope.editSource = true;\n        }\n    }\n    $scope.loadMonths = function () {\n        console.log(\"Loading months\");\n        var date = new Date();\n        for (i = 0; i < 15; i++) {\n            $scope.years.push(date.getFullYear() + i);\n        }\n        for (i = 0; i < 12; i++) {\n            $scope.months.push(1 + i);\n        }\n    }\n    $scope.saveSource = function () {\n        console.log(\"Data sent\");\n        console.log(JSON.stringify($scope.data));\n        console.log(JSON.stringify($.param($scope.data)));\n        Billing.createSource($.param($scope.data), $scope.localGateway).then(function (result) {\n            console.log(\"Reply to create\");\n            console.log(JSON.stringify(result));\n            if (result.status == \"success\") {\n                $scope.getSources();\n                $scope.data = {};\n                $scope.data.country = \"CO\";\n                $scope.submitted = false;\n                $scope.editSource = false;\n            } else {\n                $scope.editSource = true;\n                $scope.errors = result;\n                $scope.showErrors = true;\n            }\n\n        },\n                function (data) {\n\n                });\n    }\n    $scope.getSources = function () {\n        Billing.getSources($scope.localGateway).then(function (data) {\n            console.log(\"Sources\");\n            $scope.sources = [];\n            var sources = data.sources;\n            console.log(JSON.stringify(sources));\n            for (item in sources) {\n                var card = sources[item];\n                card.type = \"card\";\n                $scope.sources.push(card);\n            }\n            if (sources.length == 0) {\n                $scope.editSource = true;\n            }\n        },\n                function (data) {\n\n                });\n    }\n    $scope.deleteSource = function (source) {\n        Billing.deleteSource(source.token, $scope.localGateway).then(function (data) {\n            for (item in $scope.sources) {\n                if ($scope.sources[item].token == source.token) {\n                    console.log(\"deleting source\", $scope.sources[item]);\n                    $scope.sources.splice(item, 1);\n                    if ($scope.sources.length == 0) {\n                        $scope.editSource = true;\n                    }\n                }\n            }\n        },\n                function (data) {\n                });\n    }\n    $scope.loadTestData = function () {\n        $scope.data.name = \"Hoovert Arredondo\";\n        $scope.data.line1 = \"Calle 73 # 0-24\";\n        $scope.data.line2 = \"Apto 202\";\n        $scope.data.line3 = \"\";\n        $scope.data.postalCode = \"\";\n        $scope.data.city = \"Bogota\";\n        $scope.data.state = \"Cundinamarca\";\n        $scope.data.country = \"CO\";\n        $scope.data.phone = \"3105507245\";\n        $scope.data.document = \"1020716535\";\n        $scope.data.number = \"4111111111111111\";\n        $scope.data.expMonth = \"10\";\n        $scope.data.expYear = \"2020\";\n        $scope.data.branch = \"VISA\";\n\n    }\n    $scope.selectSource = function (source) {\n        $rootScope.$broadcast('SourceSelected', {source: source.id});\n    }\n    $rootScope.$on('GetSources', function (event, args) {\n        $scope.getSources();\n        $scope.buying = true;\n    });\n    $rootScope.$on('GatewaySelected', function (event, args) {\n        if ($rootScope.gateway == $scope.localGateway) {\n            $scope.getSources();\n            $scope.loadTestData();\n        }\n    });\n    $scope.clean = function () {\n        $scope.data = {};\n    }\n    $scope.setAsDefault = function (source) {\n        var data = {};\n        data.source = source.token\n        Billing.setAsDefault(data, $scope.localGateway).then(function (data) {\n            for (item in $scope.sources) {\n                $scope.sources[item].is_default = false;\n                if ($scope.sources[item].token == source.token) {\n                    $scope.sources[item].is_default = true;\n                }\n            }\n        },\n                function (data) {\n                    window.location.reload();\n                });\n    }\n\n\n}]).controller('SubscriptionsCtrl',['$scope', 'Billing', function ($scope, Billing) {\n    $scope.data = {};\n    $scope.subscriptions = [];\n    $scope.plans = [];\n    $scope.showEdit = false;\n    $scope.localGateway = \"\";\n    angular.element(document).ready(function () {\n        $scope.getSubscriptions();\n    });\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            var data = {plan_id: $scope.data.plan_id};\n            Billing.editSubscription(data, $scope.data.subscription_id, $scope.localGateway).then(function (data) {\n                $scope.data.subscription_id = \"\" + $scope.data.subscription_id;\n                for (item in $scope.subscriptions) {\n                    if ($scope.subscriptions[item].source_id == $scope.data.subscription_id) {\n                        console.log(\"deleting subscription\", $scope.subscriptions[item]);\n                        $scope.subscriptions.splice(item, 1);\n\n                    }\n                }\n                $scope.subscriptions.push(data.subscription);\n            },\n                    function (data) {\n                    });\n        }\n    }\n    $scope.getSubscriptions = function () {\n        Billing.getSubscriptions().then(function (data) {\n            $scope.subscriptions = data.subscriptions;\n            for (x in $scope.subscriptions) {\n                var obj = $scope.subscriptions[x].object;\n                $scope.subscriptions[x].object_name = obj.name;\n                $scope.subscriptions[x].object_code = obj.code;\n                $scope.subscriptions[x].object_status = obj.status;\n                $scope.subscriptions[x].object_ends = obj.ends_at;\n            }\n        },\n                function (data) {\n\n                });\n    }\n    $scope.getPlans = function () {\n        Billing.getPlans().then(function (data) {\n            $scope.plans = data.plans;\n\n        },\n                function (data) {\n\n                });\n    }\n    $scope.deleteSubscription = function (subscription) {\n        Billing.deleteSubscription(subscription.source_id, subscription.gateway).then(function (data) {\n            var subscription_id = \"\" + subscription.source_id;\n            for (item in $scope.subscriptions) {\n                if ($scope.subscriptions[item].source_id == subscription_id) {\n                    $scope.subscriptions.splice(item, 1);\n                }\n            }\n        },\n                function (data) {\n                });\n    }\n    $scope.clean = function () {\n        $scope.data = {};\n    }\n    $scope.editSubscription = function (subscription) {\n        $scope.data.subscription_id = subscription.id;\n        $scope.getPlans();\n        $scope.showEdit = true;\n    }\n\n}]).controller('PlansCtrl',['$scope', '$rootScope', function ($scope, $rootScope) {\n\n    $scope.selectPlan = function (plan) {\n        $rootScope.$broadcast('PlanSelected', {plan: plan});\n    }\n}])\n        .controller('GatewaysCtrl', function ($scope, $rootScope) {\n\n            $scope.data = {};\n            $scope.objectSelected = false;\n\n\n            $scope.selectGateway = function (gateway) {\n                $rootScope.gateway = gateway;\n                $rootScope.$broadcast('GatewaySelected');\n            }\n            $rootScope.$on('ObjectSelected', function (event, args) {\n                $scope.objectSelected = true;\n            });\n        })\n        .controller('SubscriptionPlansStripeCtrl', function ($scope, Billing, $rootScope) {\n            $scope.data = {};\n            $scope.months = [];\n            $scope.years = [];\n            $scope.sources = [];\n            $scope.localGateway = \"\";\n            $scope.sourceSelected = false;\n            $scope.showSources = false;\n            $scope.buying = true;\n            $scope.data.object_id = 1;\n\n            angular.element(document).ready(function () {\n                $scope.localGateway = \"Stripe\";\n            });\n\n            $scope.saveSimple = function (isvalid) {\n                $scope.submitted = true;\n                if (isvalid) {\n                    $scope.createSubscription();\n                }\n            }\n\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                if (isvalid) {\n                    $scope.stripeCreateToken();\n                }\n            }\n            $scope.loadMonths = function () {\n                var date = new Date();\n                for (i = 0; i < 15; i++) {\n                    $scope.years.push(date.getFullYear() + i);\n                }\n                for (i = 0; i < 12; i++) {\n                    $scope.months.push(1 + i);\n                }\n            }\n            $scope.editSources = function () {\n                window.location.href = \"/sources\";\n            }\n            $scope.loadTestData = function () {\n                $scope.data.number = \"4242424242424242\";\n                $scope.data.cvc = \"123\";\n                $scope.data.postal = \"33132\";\n                $scope.data.expYear = \"2020\";\n                $scope.data.expMonth = \"12\";\n            }\n            $scope.createSubscription = function () {\n\n                $scope.data.default = true;\n                delete $scope.data['cvc'];\n                delete $scope.data['expMonth'];\n                delete $scope.data['expYear'];\n                delete $scope.data['number'];\n                delete $scope.data['postal'];\n                console.log(\"Data sent\");\n                console.log(JSON.stringify($scope.data));\n                console.log(JSON.stringify($.param($scope.data)));\n                Billing.createSubscription($.param($scope.data), $scope.localGateway).then(function (data) {\n                    if (\"status\" in data) {\n                        if (data.status == 'success') {\n                            console.log(\"Subscription created\");\n                            $scope.data = {};\n                            $scope.submitted = false;\n                            window.location.href = \"/subscriptions\";\n                        }\n                    }\n                    $scope.errors = data;\n                    $scope.showErrors = true;\n                },\n                        function (data) {\n\n                        });\n            }\n\n            $scope.stripeCreateToken = function () {\n                Stripe.source.create({\n                    type: 'card',\n                    card: {\n                        number: $scope.data.number,\n                        cvc: $scope.data.cvc,\n                        exp_month: $scope.data.expMonth,\n                        exp_year: $scope.data.expYear,\n                    },\n                    owner: {\n                        address: {\n                            postal_code: $scope.data.postal\n                        }\n                    }\n                }, stripeResponseHandler);\n            }\n            $rootScope.$on('PlanSelected', function (event, args) {\n                $scope.data.plan_id = args.plan;\n            });\n            $rootScope.$on('ObjectSelected', function (event, args) {\n                $scope.data.object_id = args.object_id;\n            });\n\n            function stripeResponseHandler(status, response) {\n\n\n                if (response.error) { // Problem!\n\n                    // Show the errors on the form\n                    //$form.find('.payment-errors').text(response.error.message);\n                    //$form.find('button').prop('disabled', false); // Re-enable submission\n\n                } else { // Source was created!\n                    // Get the source ID:\n                    $scope.data.source = response.id;\n                    $scope.createSubscription();\n\n                }\n            }\n            $rootScope.$on('GatewaySelected', function (event, args) {\n                if ($rootScope.gateway == $scope.localGateway) {\n                    console.log(JSON.stringify($scope.config));\n                    var sources = $scope.config.sources;\n                    console.log($scope.localGateway);\n                    for (item in sources) {\n                        console.log(JSON.stringify(sources[item]));\n                        if (sources[item].gateway == $scope.localGateway) {\n                            if (sources[item].has_default) {\n                                $scope.sourceSelected = true;\n                                console.log(\"Has default\");\n                            }\n                        }\n                    }\n                    $scope.loadMonths();\n                    $scope.loadTestData();\n                }\n            });\n        })\n        .controller('SubscriptionPlansPayuCtrl',['$scope', 'Billing', '$rootScope', function ($scope, Billing, $rootScope) {\n    $scope.data = {};\n    $scope.months = [];\n    $scope.years = [];\n    $scope.branches = [\n        {\"name\": \"Visa\", \"value\": \"VISA\"},\n        {\"name\": \"Mastercard\", \"value\": \"MASTERCARD\"},\n        {\"name\": \"Visa Debito\", \"value\": \"VISA_DEBIT\"},\n        {\"name\": \"Diners\", \"value\": \"DINERS\"},\n        {\"name\": \"American Express\", \"value\": \"AMEX\"}\n    ];\n    $scope.sources = [];\n    $scope.localGateway = \"\";\n    $scope.sourceSelected = false;\n    $scope.showSources = false;\n    $scope.buying = true;\n    $scope.hasDefault = false;\n    $scope.newCard = false;\n    $scope.data.object_id = 1;\n\n    angular.element(document).ready(function () {\n        $scope.localGateway = \"PayU\";\n    });\n\n    $scope.saveSimple = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            $scope.createSubscription();\n        }\n    }\n    $scope.selectSource = function (source) {\n        $scope.data.source = source.token;\n        $scope.submitted = true;\n        if ($scope.data.plan_id && $scope.data.object_id) {\n            $scope.sourceSelected = true;\n            $scope.createSubscription();\n        } \n    }\n    $scope.newCardTrigger = function () {\n        $scope.newCard = true;\n        $scope.sourceSelected = false;\n    }\n    $scope.getSources = function () {\n        $scope.sourceSelected = false;\n        $scope.newCard = false;\n        Billing.getSources($scope.localGateway).then(function (data) {\n            console.log(\"Sources\");\n            $scope.sources = [];\n            var sources = data.sources;\n            console.log(JSON.stringify(sources));\n            for (item in sources) {\n                var card = sources[item];\n                card.type = \"card\";\n                $scope.sources.push(card);\n            }\n            if (sources.length == 0) {\n                $scope.newCard = true;\n            }\n        },\n                function (data) {\n\n                });\n    }\n\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            $scope.data.new = true;\n            $scope.createSubscription();\n        }\n    }\n\n    $scope.loadMonths = function () {\n        var date = new Date();\n        for (i = 0; i < 15; i++) {\n            $scope.years.push(date.getFullYear() + i);\n        }\n        for (i = 0; i < 12; i++) {\n            $scope.months.push( 1 + i);\n        }\n        console.log(JSON.stringify($scope.months));\n    }\n    $scope.loadTestData = function () {\n        console.log(\"Loading test data\");\n        $scope.data.name = \"Hoovert Arredondo\";\n        $scope.data.line1 = \"Calle 73 # 0-24\";\n        $scope.data.line2 = \"Apto 202\";\n        $scope.data.line3 = \"\";\n        $scope.data.postalCode = \"\";\n        $scope.data.city = \"Bogota\";\n        $scope.data.state = \"Cundinamarca\";\n        $scope.data.country = \"CO\";\n        $scope.data.phone = \"3105507245\";\n        $scope.data.document = \"1020716535\";\n        $scope.data.number = \"4111111111111111\";\n        $scope.data.expMonth = \"10\";\n        $scope.data.expYear = \"2020\";\n        $scope.data.branch = \"VISA\";\n    }\n    $scope.createSubscription = function () {\n        console.log(\"Data sent\");\n        console.log(JSON.stringify($scope.data));\n        console.log(JSON.stringify($.param($scope.data)));\n        Billing.createSubscription($.param($scope.data), $scope.localGateway).then(function (data) {\n            if (\"status\" in data) {\n                if (data.status == 'success') {\n                    console.log(\"Subscription created\");\n                    $scope.data = {};\n                    window.location.href = \"/subscriptions\";\n                    $scope.submitted = false;\n                    return true;\n                }\n            }\n            $scope.errors = data;\n            $scope.showErrors = true;\n        },\n                function (data) {\n\n                });\n    }\n    $rootScope.$on('PlanSelected', function (event, args) {\n        $scope.data.plan_id = args.plan;\n    });\n    $rootScope.$on('ObjectSelected', function (event, args) {\n        $scope.data.object_id = args.object_id;\n    });\n    $rootScope.$on('GatewaySelected', function (event, args) {\n        console.log($rootScope.gateway);\n        console.log($scope.localGateway);\n        console.log($rootScope.gateway == $scope.localGateway);\n        if ($rootScope.gateway == $scope.localGateway) {\n            console.log(JSON.stringify($scope.config));\n            var sources = $scope.config.sources;\n            console.log($scope.localGateway);\n            for (item in sources) {\n                console.log(JSON.stringify(sources[item]));\n                if (sources[item].gateway == $scope.localGateway) {\n                    if (sources[item].has_default) {\n                        $scope.sourceSelected = true;\n                        $scope.hasDefault = true;\n                        console.log(\"Has default\");\n                    } else {\n                        $scope.sourceSelected = false;\n                        $scope.hasDefault = false;\n                        $scope.getSources();\n                    }\n                } else {\n                    $scope.sourceSelected = false;\n                    $scope.hasDefault = false;\n                    $scope.getSources();\n                }\n\n            }\n            $scope.loadMonths();\n            $scope.loadTestData();\n        }\n    });\n}])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zb3VyY2VzY3RybC5qcz9hNDNmIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdTb3VyY2VzQ3RybCcsWyckc2NvcGUnLCAnQmlsbGluZycsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgQmlsbGluZywgJHJvb3RTY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5tb250aHMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS55ZWFycyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmJyYW5jaGVzID0gW1xuICAgICAgICAgICAgICAgIHtcIm5hbWVcIjogXCJWaXNhXCIsIFwidmFsdWVcIjogXCJWSVNBXCJ9LFxuICAgICAgICAgICAgICAgIHtcIm5hbWVcIjogXCJNYXN0ZXJjYXJkXCIsIFwidmFsdWVcIjogXCJNQVNURVJDQVJEXCJ9LFxuICAgICAgICAgICAgICAgIHtcIm5hbWVcIjogXCJWaXNhIERlYml0b1wiLCBcInZhbHVlXCI6IFwiVklTQV9ERUJJVFwifSxcbiAgICAgICAgICAgICAgICB7XCJuYW1lXCI6IFwiRGluZXJzXCIsIFwidmFsdWVcIjogXCJESU5FUlNcIn0sXG4gICAgICAgICAgICAgICAge1wibmFtZVwiOiBcIkFtZXJpY2FuIEV4cHJlc3NcIiwgXCJ2YWx1ZVwiOiBcIkFNRVhcIn1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmJ1eWluZyA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5zaG93U3RyaXBlID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuaGlkZURlZmF1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5jb25maWcgPSB7fTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2NhbEdhdGV3YXkgPSAkc2NvcGUuY29uZmlnLmdhdGV3YXk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNhdmluZzogXCIgKyBpc3ZhbGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1N0cmlwZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmVkaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5lZGl0U291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBFbGVtZW50c1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gc3RyaXBlLmVsZW1lbnRzKHtsb2NhbGU6ICR0cmFuc2xhdGUudXNlKCl9KTtcblxuICAgICAgICAgICAgLy8gQ3VzdG9tIHN0eWxpbmcgY2FuIGJlIHBhc3NlZCB0byBvcHRpb25zIHdoZW4gY3JlYXRpbmcgYW4gRWxlbWVudC5cbiAgICAgICAgICAgIC8vIChOb3RlIHRoYXQgdGhpcyBkZW1vIHVzZXMgYSB3aWRlciBzZXQgb2Ygc3R5bGVzIHRoYW4gdGhlIGd1aWRlIGJlbG93LilcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IHtcbiAgICAgICAgICAgICAgICBiYXNlOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnIzMyMzI1ZCcsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6ICcyNHB4JyxcbiAgICAgICAgICAgICAgICAgICAgZm9udEZhbWlseTogJ1wiSGVsdmV0aWNhIE5ldWVcIiwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICAgICAgICAgICAgZm9udFNtb290aGluZzogJ2FudGlhbGlhc2VkJyxcbiAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6ICcxNnB4JyxcbiAgICAgICAgICAgICAgICAgICAgJzo6cGxhY2Vob2xkZXInOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNhYWI3YzQnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGludmFsaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjZmE3NTVhJyxcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnI2ZhNzU1YSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgdGhlIGNhcmQgRWxlbWVudFxuICAgICAgICAgICAgdmFyIGNhcmQgPSBlbGVtZW50cy5jcmVhdGUoJ2NhcmQnLCB7c3R5bGU6IHN0eWxlfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBhbiBpbnN0YW5jZSBvZiB0aGUgY2FyZCBFbGVtZW50IGludG8gdGhlIGBjYXJkLWVsZW1lbnRgIDxkaXY+XG4gICAgICAgICAgICBjYXJkLm1vdW50KCcjY2FyZC1lbGVtZW50Jyk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSByZWFsLXRpbWUgdmFsaWRhdGlvbiBlcnJvcnMgZnJvbSB0aGUgY2FyZCBFbGVtZW50LlxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzcGxheUVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcmQtZXJyb3JzJyk7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlFcnJvci50ZXh0Q29udGVudCA9IGV2ZW50LmVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVycm9yLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBmb3JtIHN1Ym1pc3Npb25cbiAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtZm9ybScpO1xuICAgICAgICAgICAgdmFyIG93bmVySW5mbyA9IHtcbiAgICAgICAgICAgICAgICBvd25lcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAkc2NvcGUuZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lMTogJHNjb3BlLmRhdGEuYWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICRzY29wZS5kYXRhLmNpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3N0YWxfY29kZTogJHNjb3BlLmRhdGEucG9zdGFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeTogJHNjb3BlLmRhdGEuY291bnRyeSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6ICRzY29wZS5kYXRhLmVtYWlsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICBzdHJpcGUuY3JlYXRlU291cmNlKGNhcmQsIG93bmVySW5mbykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluZm9ybSB0aGUgdXNlciBpZiB0aGVyZSB3YXMgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyZC1lcnJvcnMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IHJlc3VsdC5lcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2VuZCB0aGUgc291cmNlIHRvIHlvdXIgc2VydmVyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpcGVTb3VyY2VIYW5kbGVyKHJlc3VsdC5zb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLnN0cmlwZUNyZWF0ZVRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzdHJpcGVTb3VyY2VIYW5kbGVyKHRva2VuKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc291cmNlID0gdG9rZW47XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmVTb3VyY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9udGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBtb250aHNcIik7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxNTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS55ZWFycy5wdXNoKGRhdGUuZ2V0RnVsbFllYXIoKSArIGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2goMSArIGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5zYXZlU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnY3ZjJ107XG4gICAgICAgICAgICAgICAgZGVsZXRlICRzY29wZS5kYXRhWydleHBNb250aCddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnZXhwWWVhciddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnbnVtYmVyJ107XG4gICAgICAgICAgICAgICAgZGVsZXRlICRzY29wZS5kYXRhWydwb3N0YWwnXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgc2VudFwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkc2NvcGUuZGF0YSkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCQucGFyYW0oJHNjb3BlLmRhdGEpKSk7XG4gICAgICAgICAgICAgICAgQmlsbGluZy5jcmVhdGVTb3VyY2UoJC5wYXJhbSgkc2NvcGUuZGF0YSksICRyb290U2NvcGUuZ2F0ZXdheSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHVybiBzb3VyY2VcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudHlwZSA9PSBcImNhcmRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmQgPSBkYXRhLmNhcmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VzLnB1c2goY2FyZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0U291cmNlcyA9IGZ1bmN0aW9uIChnYXRld2F5KSB7XG4gICAgICAgICAgICAgICAgQmlsbGluZy5nZXRTb3VyY2VzKGdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlcyA9IGRhdGEuc291cmNlcztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIHNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dLnR5cGUgPT0gXCJjYXJkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZCA9IHNvdXJjZXNbaXRlbV0uY2FyZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmlkID0gc291cmNlc1tpdGVtXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmlzX2RlZmF1bHQgPSBzb3VyY2VzW2l0ZW1dLmlzX2RlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZXMucHVzaChjYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVkZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmRlZmF1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVkZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIEJpbGxpbmcuZGVsZXRlU291cmNlKHNvdXJjZS5pZCwgJHJvb3RTY29wZS5nYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zb3VyY2VzW2l0ZW1dLmlkID09IHNvdXJjZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGVsZXRpbmcgc291cmNlXCIsICRzY29wZS5zb3VyY2VzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmxvYWRUZXN0RGF0YSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcblxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmN2YyA9IFwiMTIzXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsID0gXCIzMzEzMlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmV4cFllYXIgPSBcIjIwMjBcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTJcIjtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ1NvdXJjZVNlbGVjdGVkJywge3NvdXJjZTogc291cmNlLmlkfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignR2V0U291cmNlcycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRTb3VyY2VzKGFyZ3MuZ2F0ZXdheSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1eWluZyA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdHYXRld2F5U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFNvdXJjZXMoJHNjb3BlLmxvY2FsR2F0ZXdheSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9udGhzKCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkVGVzdERhdGEoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5jbGVhbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNldEFzRGVmYXVsdCA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIGRhdGEuc291cmNlID0gc291cmNlLmlkXG4gICAgICAgICAgICAgICAgQmlsbGluZy5zZXRBc0RlZmF1bHQoZGF0YSwgJHJvb3RTY29wZS5nYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZXNbaXRlbV0uaXNfZGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zb3VyY2VzW2l0ZW1dLmlkID09IHNvdXJjZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VzW2l0ZW1dLmlzX2RlZmF1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XSkuY29udHJvbGxlcignU291cmNlc1BheXVDdHJsJyxbJyRzY29wZScsICdCaWxsaW5nJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUubW9udGhzID0gW107XG4gICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgJHNjb3BlLmJyYW5jaGVzID0gW1xuICAgICAgICB7XCJuYW1lXCI6IFwiVmlzYVwiLCBcInZhbHVlXCI6IFwiVklTQVwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIk1hc3RlcmNhcmRcIiwgXCJ2YWx1ZVwiOiBcIk1BU1RFUkNBUkRcIn0sXG4gICAgICAgIHtcIm5hbWVcIjogXCJWaXNhIERlYml0b1wiLCBcInZhbHVlXCI6IFwiVklTQV9ERUJJVFwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIkRpbmVyc1wiLCBcInZhbHVlXCI6IFwiRElORVJTXCJ9LFxuICAgICAgICB7XCJuYW1lXCI6IFwiQW1lcmljYW4gRXhwcmVzc1wiLCBcInZhbHVlXCI6IFwiQU1FWFwifVxuICAgIF07XG4gICAgJHNjb3BlLnNvdXJjZXMgPSBbXTtcbiAgICAkc2NvcGUuYnV5aW5nID0gZmFsc2U7XG4gICAgJHNjb3BlLnNob3dFcnJvcnMgPSBmYWxzZTtcbiAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IGZhbHNlO1xuICAgICRzY29wZS5lcnJvcnMgPSBbXTtcbiAgICAkc2NvcGUuY29uZmlnID0ge307XG4gICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJHNjb3BlLmxvY2FsR2F0ZXdheSA9IFwiUGF5VVwiO1xuXG4gICAgfSk7XG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLnNob3dFcnJvcnMgPSBmYWxzZTtcbiAgICAgICAgY29uc29sZS5sb2coXCJTYXZpbmc6IFwiICsgaXN2YWxpZCk7XG4gICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2F2ZVNvdXJjZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5lZGl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJHNjb3BlLmVkaXRTb3VyY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgJHNjb3BlLmxvYWRNb250aHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBtb250aHNcIik7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDE1OyBpKyspIHtcbiAgICAgICAgICAgICRzY29wZS55ZWFycy5wdXNoKGRhdGUuZ2V0RnVsbFllYXIoKSArIGkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2goMSArIGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5zYXZlU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgc2VudFwiKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLmRhdGEpKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJC5wYXJhbSgkc2NvcGUuZGF0YSkpKTtcbiAgICAgICAgQmlsbGluZy5jcmVhdGVTb3VyY2UoJC5wYXJhbSgkc2NvcGUuZGF0YSksICRzY29wZS5sb2NhbEdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXBseSB0byBjcmVhdGVcIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXN1bHQpKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFNvdXJjZXMoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSBcIkNPXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3JzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmdldFNvdXJjZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEJpbGxpbmcuZ2V0U291cmNlcygkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNvdXJjZXNcIik7XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHNvdXJjZXMgPSBkYXRhLnNvdXJjZXM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzb3VyY2VzKSk7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc291cmNlcykge1xuICAgICAgICAgICAgICAgIHZhciBjYXJkID0gc291cmNlc1tpdGVtXTtcbiAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5wdXNoKGNhcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZXMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICAkc2NvcGUuZGVsZXRlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBCaWxsaW5nLmRlbGV0ZVNvdXJjZShzb3VyY2UudG9rZW4sICRzY29wZS5sb2NhbEdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc291cmNlcykge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc291cmNlc1tpdGVtXS50b2tlbiA9PSBzb3VyY2UudG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkZWxldGluZyBzb3VyY2VcIiwgJHNjb3BlLnNvdXJjZXNbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc291cmNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgICRzY29wZS5sb2FkVGVzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5kYXRhLm5hbWUgPSBcIkhvb3ZlcnQgQXJyZWRvbmRvXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUxID0gXCJDYWxsZSA3MyAjIDAtMjRcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEubGluZTIgPSBcIkFwdG8gMjAyXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUzID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsQ29kZSA9IFwiXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNpdHkgPSBcIkJvZ290YVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5zdGF0ZSA9IFwiQ3VuZGluYW1hcmNhXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSBcIkNPXCI7XG4gICAgICAgICRzY29wZS5kYXRhLnBob25lID0gXCIzMTA1NTA3MjQ1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLmRvY3VtZW50ID0gXCIxMDIwNzE2NTM1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLm51bWJlciA9IFwiNDExMTExMTExMTExMTExMVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTBcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEuZXhwWWVhciA9IFwiMjAyMFwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5icmFuY2ggPSBcIlZJU0FcIjtcblxuICAgIH1cbiAgICAkc2NvcGUuc2VsZWN0U291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ1NvdXJjZVNlbGVjdGVkJywge3NvdXJjZTogc291cmNlLmlkfSk7XG4gICAgfVxuICAgICRyb290U2NvcGUuJG9uKCdHZXRTb3VyY2VzJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XG4gICAgICAgICRzY29wZS5nZXRTb3VyY2VzKCk7XG4gICAgICAgICRzY29wZS5idXlpbmcgPSB0cnVlO1xuICAgIH0pO1xuICAgICRyb290U2NvcGUuJG9uKCdHYXRld2F5U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgaWYgKCRyb290U2NvcGUuZ2F0ZXdheSA9PSAkc2NvcGUubG9jYWxHYXRld2F5KSB7XG4gICAgICAgICAgICAkc2NvcGUuZ2V0U291cmNlcygpO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRUZXN0RGF0YSgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgIH1cbiAgICAkc2NvcGUuc2V0QXNEZWZhdWx0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICBkYXRhLnNvdXJjZSA9IHNvdXJjZS50b2tlblxuICAgICAgICBCaWxsaW5nLnNldEFzRGVmYXVsdChkYXRhLCAkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLnNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlc1tpdGVtXS5pc19kZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zb3VyY2VzW2l0ZW1dLnRva2VuID09IHNvdXJjZS50b2tlbikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlc1tpdGVtXS5pc19kZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cblxuXG59XSkuY29udHJvbGxlcignU3Vic2NyaXB0aW9uc0N0cmwnLFsnJHNjb3BlJywgJ0JpbGxpbmcnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nKSB7XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUuc3Vic2NyaXB0aW9ucyA9IFtdO1xuICAgICRzY29wZS5wbGFucyA9IFtdO1xuICAgICRzY29wZS5zaG93RWRpdCA9IGZhbHNlO1xuICAgICRzY29wZS5sb2NhbEdhdGV3YXkgPSBcIlwiO1xuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZ2V0U3Vic2NyaXB0aW9ucygpO1xuICAgIH0pO1xuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtwbGFuX2lkOiAkc2NvcGUuZGF0YS5wbGFuX2lkfTtcbiAgICAgICAgICAgIEJpbGxpbmcuZWRpdFN1YnNjcmlwdGlvbihkYXRhLCAkc2NvcGUuZGF0YS5zdWJzY3JpcHRpb25faWQsICRzY29wZS5sb2NhbEdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zdWJzY3JpcHRpb25faWQgPSBcIlwiICsgJHNjb3BlLmRhdGEuc3Vic2NyaXB0aW9uX2lkO1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnN1YnNjcmlwdGlvbnNbaXRlbV0uc291cmNlX2lkID09ICRzY29wZS5kYXRhLnN1YnNjcmlwdGlvbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkZWxldGluZyBzdWJzY3JpcHRpb25cIiwgJHNjb3BlLnN1YnNjcmlwdGlvbnNbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnMuc3BsaWNlKGl0ZW0sIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnMucHVzaChkYXRhLnN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAkc2NvcGUuZ2V0U3Vic2NyaXB0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQmlsbGluZy5nZXRTdWJzY3JpcHRpb25zKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnMgPSBkYXRhLnN1YnNjcmlwdGlvbnM7XG4gICAgICAgICAgICBmb3IgKHggaW4gJHNjb3BlLnN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gJHNjb3BlLnN1YnNjcmlwdGlvbnNbeF0ub2JqZWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJzY3JpcHRpb25zW3hdLm9iamVjdF9uYW1lID0gb2JqLm5hbWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnNbeF0ub2JqZWN0X2NvZGUgPSBvYmouY29kZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3Vic2NyaXB0aW9uc1t4XS5vYmplY3Rfc3RhdHVzID0gb2JqLnN0YXR1cztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3Vic2NyaXB0aW9uc1t4XS5vYmplY3RfZW5kcyA9IG9iai5lbmRzX2F0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmdldFBsYW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBCaWxsaW5nLmdldFBsYW5zKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnBsYW5zID0gZGF0YS5wbGFucztcblxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmRlbGV0ZVN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgQmlsbGluZy5kZWxldGVTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uLnNvdXJjZV9pZCwgc3Vic2NyaXB0aW9uLmdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25faWQgPSBcIlwiICsgc3Vic2NyaXB0aW9uLnNvdXJjZV9pZDtcbiAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3Vic2NyaXB0aW9uc1tpdGVtXS5zb3VyY2VfaWQgPT0gc3Vic2NyaXB0aW9uX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJzY3JpcHRpb25zLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgIH1cbiAgICAkc2NvcGUuZWRpdFN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgJHNjb3BlLmRhdGEuc3Vic2NyaXB0aW9uX2lkID0gc3Vic2NyaXB0aW9uLmlkO1xuICAgICAgICAkc2NvcGUuZ2V0UGxhbnMoKTtcbiAgICAgICAgJHNjb3BlLnNob3dFZGl0ID0gdHJ1ZTtcbiAgICB9XG5cbn1dKS5jb250cm9sbGVyKCdQbGFuc0N0cmwnLFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAkc2NvcGUuc2VsZWN0UGxhbiA9IGZ1bmN0aW9uIChwbGFuKSB7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnUGxhblNlbGVjdGVkJywge3BsYW46IHBsYW59KTtcbiAgICB9XG59XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0dhdGV3YXlzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5vYmplY3RTZWxlY3RlZCA9IGZhbHNlO1xuXG5cbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RHYXRld2F5ID0gZnVuY3Rpb24gKGdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdhdGV3YXkgPSBnYXRld2F5O1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnR2F0ZXdheVNlbGVjdGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignT2JqZWN0U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0U2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jb250cm9sbGVyKCdTdWJzY3JpcHRpb25QbGFuc1N0cmlwZUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmxvY2FsR2F0ZXdheSA9IFwiXCI7XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5zaG93U291cmNlcyA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmJ1eWluZyA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5vYmplY3RfaWQgPSAxO1xuXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9jYWxHYXRld2F5ID0gXCJTdHJpcGVcIjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuc2F2ZVNpbXBsZSA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdHJpcGVDcmVhdGVUb2tlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9udGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUueWVhcnMucHVzaChkYXRlLmdldEZ1bGxZZWFyKCkgKyBpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vbnRocy5wdXNoKDEgKyBpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9zb3VyY2VzXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUubG9hZFRlc3REYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLm51bWJlciA9IFwiNDI0MjQyNDI0MjQyNDI0MlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmN2YyA9IFwiMTIzXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsID0gXCIzMzEzMlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmV4cFllYXIgPSBcIjIwMjBcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5jcmVhdGVTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5kZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmRhdGFbJ2N2YyddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnZXhwTW9udGgnXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmRhdGFbJ2V4cFllYXInXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmRhdGFbJ251bWJlciddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsncG9zdGFsJ107XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRhIHNlbnRcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLmRhdGEpKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkLnBhcmFtKCRzY29wZS5kYXRhKSkpO1xuICAgICAgICAgICAgICAgIEJpbGxpbmcuY3JlYXRlU3Vic2NyaXB0aW9uKCQucGFyYW0oJHNjb3BlLmRhdGEpLCAkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0YXR1c1wiIGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1YnNjcmlwdGlvbiBjcmVhdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvc3Vic2NyaXB0aW9uc1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9ycyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc3RyaXBlQ3JlYXRlVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgU3RyaXBlLnNvdXJjZS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2FyZCcsXG4gICAgICAgICAgICAgICAgICAgIGNhcmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogJHNjb3BlLmRhdGEubnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3ZjOiAkc2NvcGUuZGF0YS5jdmMsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBfbW9udGg6ICRzY29wZS5kYXRhLmV4cE1vbnRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwX3llYXI6ICRzY29wZS5kYXRhLmV4cFllYXIsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG93bmVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdGFsX2NvZGU6ICRzY29wZS5kYXRhLnBvc3RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgc3RyaXBlUmVzcG9uc2VIYW5kbGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdQbGFuU2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5wbGFuX2lkID0gYXJncy5wbGFuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignT2JqZWN0U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5vYmplY3RfaWQgPSBhcmdzLm9iamVjdF9pZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBzdHJpcGVSZXNwb25zZUhhbmRsZXIoc3RhdHVzLCByZXNwb25zZSkge1xuXG5cbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHsgLy8gUHJvYmxlbSFcblxuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IHRoZSBlcnJvcnMgb24gdGhlIGZvcm1cbiAgICAgICAgICAgICAgICAgICAgLy8kZm9ybS5maW5kKCcucGF5bWVudC1lcnJvcnMnKS50ZXh0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAvLyRmb3JtLmZpbmQoJ2J1dHRvbicpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpOyAvLyBSZS1lbmFibGUgc3VibWlzc2lvblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gU291cmNlIHdhcyBjcmVhdGVkIVxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHNvdXJjZSBJRDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc291cmNlID0gcmVzcG9uc2UuaWQ7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVTdWJzY3JpcHRpb24oKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdHYXRld2F5U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLmNvbmZpZykpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlcyA9ICRzY29wZS5jb25maWcuc291cmNlcztcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmxvY2FsR2F0ZXdheSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBzb3VyY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzb3VyY2VzW2l0ZW1dKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXS5oYXNfZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlU2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkhhcyBkZWZhdWx0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vbnRocygpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFRlc3REYXRhKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jb250cm9sbGVyKCdTdWJzY3JpcHRpb25QbGFuc1BheXVDdHJsJyxbJyRzY29wZScsICdCaWxsaW5nJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUubW9udGhzID0gW107XG4gICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgJHNjb3BlLmJyYW5jaGVzID0gW1xuICAgICAgICB7XCJuYW1lXCI6IFwiVmlzYVwiLCBcInZhbHVlXCI6IFwiVklTQVwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIk1hc3RlcmNhcmRcIiwgXCJ2YWx1ZVwiOiBcIk1BU1RFUkNBUkRcIn0sXG4gICAgICAgIHtcIm5hbWVcIjogXCJWaXNhIERlYml0b1wiLCBcInZhbHVlXCI6IFwiVklTQV9ERUJJVFwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIkRpbmVyc1wiLCBcInZhbHVlXCI6IFwiRElORVJTXCJ9LFxuICAgICAgICB7XCJuYW1lXCI6IFwiQW1lcmljYW4gRXhwcmVzc1wiLCBcInZhbHVlXCI6IFwiQU1FWFwifVxuICAgIF07XG4gICAgJHNjb3BlLnNvdXJjZXMgPSBbXTtcbiAgICAkc2NvcGUubG9jYWxHYXRld2F5ID0gXCJcIjtcbiAgICAkc2NvcGUuc291cmNlU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAkc2NvcGUuc2hvd1NvdXJjZXMgPSBmYWxzZTtcbiAgICAkc2NvcGUuYnV5aW5nID0gdHJ1ZTtcbiAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICRzY29wZS5uZXdDYXJkID0gZmFsc2U7XG4gICAgJHNjb3BlLmRhdGEub2JqZWN0X2lkID0gMTtcblxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubG9jYWxHYXRld2F5ID0gXCJQYXlVXCI7XG4gICAgfSk7XG5cbiAgICAkc2NvcGUuc2F2ZVNpbXBsZSA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XG4gICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5zZWxlY3RTb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgICRzY29wZS5kYXRhLnNvdXJjZSA9IHNvdXJjZS50b2tlbjtcbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIGlmICgkc2NvcGUuZGF0YS5wbGFuX2lkICYmICRzY29wZS5kYXRhLm9iamVjdF9pZCkge1xuICAgICAgICAgICAgJHNjb3BlLnNvdXJjZVNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICRzY29wZS5jcmVhdGVTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgfSBcbiAgICB9XG4gICAgJHNjb3BlLm5ld0NhcmRUcmlnZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubmV3Q2FyZCA9IHRydWU7XG4gICAgICAgICRzY29wZS5zb3VyY2VTZWxlY3RlZCA9IGZhbHNlO1xuICAgIH1cbiAgICAkc2NvcGUuZ2V0U291cmNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLnNvdXJjZVNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5uZXdDYXJkID0gZmFsc2U7XG4gICAgICAgIEJpbGxpbmcuZ2V0U291cmNlcygkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNvdXJjZXNcIik7XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHNvdXJjZXMgPSBkYXRhLnNvdXJjZXM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzb3VyY2VzKSk7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc291cmNlcykge1xuICAgICAgICAgICAgICAgIHZhciBjYXJkID0gc291cmNlc1tpdGVtXTtcbiAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5wdXNoKGNhcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZXMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubmV3Q2FyZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5uZXcgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvYWRNb250aHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDE1OyBpKyspIHtcbiAgICAgICAgICAgICRzY29wZS55ZWFycy5wdXNoKGRhdGUuZ2V0RnVsbFllYXIoKSArIGkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2goIDEgKyBpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkc2NvcGUubW9udGhzKSk7XG4gICAgfVxuICAgICRzY29wZS5sb2FkVGVzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyB0ZXN0IGRhdGFcIik7XG4gICAgICAgICRzY29wZS5kYXRhLm5hbWUgPSBcIkhvb3ZlcnQgQXJyZWRvbmRvXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUxID0gXCJDYWxsZSA3MyAjIDAtMjRcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEubGluZTIgPSBcIkFwdG8gMjAyXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUzID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsQ29kZSA9IFwiXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNpdHkgPSBcIkJvZ290YVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5zdGF0ZSA9IFwiQ3VuZGluYW1hcmNhXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSBcIkNPXCI7XG4gICAgICAgICRzY29wZS5kYXRhLnBob25lID0gXCIzMTA1NTA3MjQ1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLmRvY3VtZW50ID0gXCIxMDIwNzE2NTM1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLm51bWJlciA9IFwiNDExMTExMTExMTExMTExMVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTBcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEuZXhwWWVhciA9IFwiMjAyMFwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5icmFuY2ggPSBcIlZJU0FcIjtcbiAgICB9XG4gICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEYXRhIHNlbnRcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCRzY29wZS5kYXRhKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCQucGFyYW0oJHNjb3BlLmRhdGEpKSk7XG4gICAgICAgIEJpbGxpbmcuY3JlYXRlU3Vic2NyaXB0aW9uKCQucGFyYW0oJHNjb3BlLmRhdGEpLCAkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoXCJzdGF0dXNcIiBpbiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1YnNjcmlwdGlvbiBjcmVhdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3N1YnNjcmlwdGlvbnNcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3JzID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgICRyb290U2NvcGUuJG9uKCdQbGFuU2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgJHNjb3BlLmRhdGEucGxhbl9pZCA9IGFyZ3MucGxhbjtcbiAgICB9KTtcbiAgICAkcm9vdFNjb3BlLiRvbignT2JqZWN0U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgJHNjb3BlLmRhdGEub2JqZWN0X2lkID0gYXJncy5vYmplY3RfaWQ7XG4gICAgfSk7XG4gICAgJHJvb3RTY29wZS4kb24oJ0dhdGV3YXlTZWxlY3RlZCcsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xuICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLmdhdGV3YXkpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUubG9jYWxHYXRld2F5KTtcbiAgICAgICAgY29uc29sZS5sb2coJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpO1xuICAgICAgICBpZiAoJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCRzY29wZS5jb25maWcpKTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VzID0gJHNjb3BlLmNvbmZpZy5zb3VyY2VzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmxvY2FsR2F0ZXdheSk7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc291cmNlcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHNvdXJjZXNbaXRlbV0pKTtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaXRlbV0uaGFzX2RlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkhhcyBkZWZhdWx0XCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZVNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFNvdXJjZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U291cmNlcygpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmxvYWRNb250aHMoKTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkVGVzdERhdGEoKTtcbiAgICAgICAgfVxuICAgIH0pO1xufV0pXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zb3VyY2VzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 27 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('NotificationsCtrl', ['$scope', '$rootScope', 'Alerts', function ($scope, $rootScope, Alerts) {\n        // With the new view caching in Ionic, Controllers are only called\n        // when they are recreated or on app start, instead of every page change.             // To listen for when this page is active (for example, to refresh data),\n        // listen for the $ionicView.enter event:\n        //\n        $scope.notifications = [];\n        $rootScope.$broadcast('updateNotifList');\n        $scope.noavatar = API.avatar;\n        $scope.delete = function (notification) {\n            Alerts.deleteNotification(notification);\n        };\n        $scope.followNotification = function (id) {\n            Alerts.get(id).then(function (data) {\n                console.log(\"After Get:\");\n                console.log(JSON.stringify(data));\n                Alerts.followNotification(data);\n                console.log(\"After follow:\");\n                console.log(JSON.stringify(data));\n            },\n                    function (data) {\n                    });\n        };\n        $rootScope.$on('updateNotifList', function () {\n            $scope.notifications = [];\n            Alerts.loadNotificationsGlobal(\"50\").then(function (data) {\n                for (notif in data) {\n                    data[notif].created_at = new Date(data[notif].created_at);\n                    if (data[notif].type == \"location_first\") {\n                        data[notif].class = 'ion-android-pin';\n                    } else if (data[notif].type == \"location_last\") {\n                        data[notif].class = 'ion-android-pin';\n                    } else if (data[notif].type == \"notification_location\") {\n                        data[notif].class = 'ion-android-compass';\n                    } else if (data[notif].type == \"emergency\") {\n                        data[notif].class = 'ion-android-warning';\n                    } else if (data[notif].type == \"medical_emergency\") {\n                        data[notif].class = 'ion-ios-medkit';\n                    } else if (data[notif].type == \"emergency_end\") {\n                        data[notif].class = 'ion-flag';\n                    } else if (data[notif].type == \"user_message\") {\n                        data[notif].class = 'ion-email';\n                    } else if (data[notif].type == \"group_message\") {\n                        data[notif].class = 'ion-email';\n                    } else if (data[notif].type == \"new_contact\") {\n                        data[notif].class = 'ion-person-stalker';\n                    } else if (data[notif].type == \"new_group\") {\n                        data[notif].class = 'ion-person-stalker';\n                    } else if (data[notif].type == \"system\") {\n                        data[notif].class = 'ion-alert';\n                    }\n                    try {\n                        $scope.notifications.push(data[notif]);\n                    } catch (err) {\n                        console.log(\"Repetido\");\n                        console.log(JSON.stringify(data[notif]));\n                    }\n\n                }\n                $rootScope.notificationsChanged = false;\n            },\n                    function (data) {\n                    });\n        });\n        $rootScope.$on('receivedNotification', function (event, args) {\n            $rootScope.$broadcast('updateNotifList');\n        });\n        $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {\n            if (toState.name == 'tab.notifications') {\n                console.log(\"Entering notifications\");\n                if ($rootScope.notificationsChanged == true) {\n                    $rootScope.$broadcast('updateNotifList');\n                }\n            }\n        });\n    }]).controller('UserRegisterCtrl', ['$scope', 'LocationService', 'Users', function ($scope, LocationService, Users) {\n        $scope.data = {};\n        $scope.addresses;\n        $scope.regionVisible = false;\n        $scope.cityVisible = false;\n        LocationService.getCountries(\"\").then(function (data) {\n            $scope.countries = data.data;\n        },\n                function (data) {\n\n                });\n\n    }]).controller('UserProfileCtrl', ['$scope', '$rootScope', 'Users','Modals', function ($scope, $rootScope, Users,Modals) {\n        $scope.data = {};\n        angular.element(document).ready(function () {\n            $scope.data = $rootScope.user;\n        });\n        $rootScope.$on('user_loaded', function (event, args) {\n            console.log(\"Loading user\");\n            $scope.data = $rootScope.user;\n        });\n\n        $scope.save = function (isvalid) {\n            $scope.submitted = true;\n            if (isvalid) {\n                Modals.showLoader();\n                Users.saveUser($scope.data).then(function (data) {\n                    Modals.hideLoader();\n                    console.log(\"Resp\",data);\n                    $scope.submitted = false;\n                    if(data.status == \"success\"){\n                        Modals.showToast(\"Actualizacion exitosa\",$(\"#myaccountContent\"));\n                        $scope.data = data.user;\n                    } else {\n                        Modals.showToast(\"Hubo un error actualizando tus datos\",$(\"#myaccountContent\"));\n                    }\n                },\n                        function (data) {\n\n                        });\n            }\n        }\n\n    }]).controller('UserPasswordCtrl', ['$scope', '$rootScope', 'Users','Modals', function ($scope, $rootScope, Users,Modals) {\n        $scope.data = {};\n\n        $scope.save = function (isvalid) {\n            $scope.submitted = true;\n            if (isvalid) {\n                \n                if($scope.data.password != $scope.data.password_confirmation){\n                    return;\n                }\n                Modals.showLoader();\n                Users.updatePassword($scope.data).then(function (data) {\n                    Modals.hideLoader();\n                    console.log(\"Resp\",data);\n                    $scope.submitted = false;\n                    if(data.status == \"success\"){\n                        Modals.showToast(\"Actualizacion exitosa\",$(\"#myaccountContent\"));\n                        //$scope.data = data.user;\n                    }\n                },\n                        function (data) {\n                            Modals.hideLoader();\n                            Modals.showToast(\"Contrasea incorrecta\",$(\"#myaccountContent\"));\n                        });\n            }\n        }\n\n    }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy91c2VyY3RybC5qcz82OTM4Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdOb3RpZmljYXRpb25zQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnQWxlcnRzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgQWxlcnRzKSB7XG4gICAgICAgIC8vIFdpdGggdGhlIG5ldyB2aWV3IGNhY2hpbmcgaW4gSW9uaWMsIENvbnRyb2xsZXJzIGFyZSBvbmx5IGNhbGxlZFxuICAgICAgICAvLyB3aGVuIHRoZXkgYXJlIHJlY3JlYXRlZCBvciBvbiBhcHAgc3RhcnQsIGluc3RlYWQgb2YgZXZlcnkgcGFnZSBjaGFuZ2UuICAgICAgICAgICAgIC8vIFRvIGxpc3RlbiBmb3Igd2hlbiB0aGlzIHBhZ2UgaXMgYWN0aXZlIChmb3IgZXhhbXBsZSwgdG8gcmVmcmVzaCBkYXRhKSxcbiAgICAgICAgLy8gbGlzdGVuIGZvciB0aGUgJGlvbmljVmlldy5lbnRlciBldmVudDpcbiAgICAgICAgLy9cbiAgICAgICAgJHNjb3BlLm5vdGlmaWNhdGlvbnMgPSBbXTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVOb3RpZkxpc3QnKTtcbiAgICAgICAgJHNjb3BlLm5vYXZhdGFyID0gQVBJLmF2YXRhcjtcbiAgICAgICAgJHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgICAgIEFsZXJ0cy5kZWxldGVOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmZvbGxvd05vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgQWxlcnRzLmdldChpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWZ0ZXIgR2V0OlwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICAgICAgQWxlcnRzLmZvbGxvd05vdGlmaWNhdGlvbihkYXRhKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFmdGVyIGZvbGxvdzpcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRyb290U2NvcGUuJG9uKCd1cGRhdGVOb3RpZkxpc3QnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUubm90aWZpY2F0aW9ucyA9IFtdO1xuICAgICAgICAgICAgQWxlcnRzLmxvYWROb3RpZmljYXRpb25zR2xvYmFsKFwiNTBcIikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGZvciAobm90aWYgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jcmVhdGVkX2F0ID0gbmV3IERhdGUoZGF0YVtub3RpZl0uY3JlYXRlZF9hdCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibG9jYXRpb25fZmlyc3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWFuZHJvaWQtcGluJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibG9jYXRpb25fbGFzdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jbGFzcyA9ICdpb24tYW5kcm9pZC1waW4nO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbbm90aWZdLnR5cGUgPT0gXCJub3RpZmljYXRpb25fbG9jYXRpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWFuZHJvaWQtY29tcGFzcyc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtub3RpZl0udHlwZSA9PSBcImVtZXJnZW5jeVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jbGFzcyA9ICdpb24tYW5kcm9pZC13YXJuaW5nJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibWVkaWNhbF9lbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWlvcy1tZWRraXQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbbm90aWZdLnR5cGUgPT0gXCJlbWVyZ2VuY3lfZW5kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbm90aWZdLmNsYXNzID0gJ2lvbi1mbGFnJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwidXNlcl9tZXNzYWdlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbm90aWZdLmNsYXNzID0gJ2lvbi1lbWFpbCc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtub3RpZl0udHlwZSA9PSBcImdyb3VwX21lc3NhZ2VcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWVtYWlsJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibmV3X2NvbnRhY3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLXBlcnNvbi1zdGFsa2VyJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibmV3X2dyb3VwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbm90aWZdLmNsYXNzID0gJ2lvbi1wZXJzb24tc3RhbGtlcic7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtub3RpZl0udHlwZSA9PSBcInN5c3RlbVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jbGFzcyA9ICdpb24tYWxlcnQnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm90aWZpY2F0aW9ucy5wdXNoKGRhdGFbbm90aWZdKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlcGV0aWRvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YVtub3RpZl0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUubm90aWZpY2F0aW9uc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJ3JlY2VpdmVkTm90aWZpY2F0aW9uJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZU5vdGlmTGlzdCcpO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uIChldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHRvU3RhdGUubmFtZSA9PSAndGFiLm5vdGlmaWNhdGlvbnMnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbnRlcmluZyBub3RpZmljYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm5vdGlmaWNhdGlvbnNDaGFuZ2VkID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVOb3RpZkxpc3QnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1dKS5jb250cm9sbGVyKCdVc2VyUmVnaXN0ZXJDdHJsJywgWyckc2NvcGUnLCAnTG9jYXRpb25TZXJ2aWNlJywgJ1VzZXJzJywgZnVuY3Rpb24gKCRzY29wZSwgTG9jYXRpb25TZXJ2aWNlLCBVc2Vycykge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAkc2NvcGUuYWRkcmVzc2VzO1xuICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENvdW50cmllcyhcIlwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuY291bnRyaWVzID0gZGF0YS5kYXRhO1xuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgIH1dKS5jb250cm9sbGVyKCdVc2VyUHJvZmlsZUN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1VzZXJzJywnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgVXNlcnMsTW9kYWxzKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSAkcm9vdFNjb3BlLnVzZXI7XG4gICAgICAgIH0pO1xuICAgICAgICAkcm9vdFNjb3BlLiRvbigndXNlcl9sb2FkZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyB1c2VyXCIpO1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSAkcm9vdFNjb3BlLnVzZXI7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xuICAgICAgICAgICAgICAgIFVzZXJzLnNhdmVVc2VyKCRzY29wZS5kYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcFwiLGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBY3R1YWxpemFjaW9uIGV4aXRvc2FcIiwkKFwiI215YWNjb3VudENvbnRlbnRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhLnVzZXI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciBhY3R1YWxpemFuZG8gdHVzIGRhdG9zXCIsJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfV0pLmNvbnRyb2xsZXIoJ1VzZXJQYXNzd29yZEN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1VzZXJzJywnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgVXNlcnMsTW9kYWxzKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCRzY29wZS5kYXRhLnBhc3N3b3JkICE9ICRzY29wZS5kYXRhLnBhc3N3b3JkX2NvbmZpcm1hdGlvbil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICBVc2Vycy51cGRhdGVQYXNzd29yZCgkc2NvcGUuZGF0YSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BcIixkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQWN0dWFsaXphY2lvbiBleGl0b3NhXCIsJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmRhdGEgPSBkYXRhLnVzZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDb250cmFzZcOxYSBpbmNvcnJlY3RhXCIsJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy91c2VyY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 28 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ZonesCtrl', ['$scope', '$rootScope', 'Zones', 'MapService', 'Merchants', function ($scope, $rootScope, Zones, MapService, Merchants) {\n                $scope.data = {};\n                $scope.items = [];\n                $scope.merchants = [];\n                $scope.providers = [{\"name\": \"Mi Paquete\", \"value\": \"MiPaquete\"}, {\"name\": \"Rapigo\", \"value\": \"Rapigo\"}, {\"name\": \"Propio\", \"value\": \"Propio\"}], {\"name\": \"Basilikum\", \"value\": \"Basilikum\"};\n                $scope.activeMerchant;\n                $scope.activeMerchantObject = {};\n                $scope.searchTerms = \"\";\n                $scope.changeMerchant = false;\n                $scope.createNewMerchant = false;\n                $scope.loadMore = true,\n                        $scope.page = 0;\n                angular.element(document).ready(function () {\n                    console.log(\"Getting merchants and zones\");\n                    $scope.getMerchants();\n                    MapService.createMap(4.685419, -74.064161);\n                });\n\n                $scope.getMerchants = function () {\n                    Merchants.getMerchantsUser().then(function (data) {\n                        if (data.status == \"success\") {\n                            $scope.merchants = data.data;\n                            $scope.activeMerchant = $scope.merchants[0].id;\n                            $scope.getItems();\n                        }\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $rootScope.$on(\"zone-updated\", function (evt, data) {\n                    for (item in $scope.items) {\n                        if ($scope.items[item].id == data.id) {\n                            $scope.items[item].isActive = true;\n                            $scope.$digest();\n                        }\n                    }\n                });\n\n                $scope.buildItemData = function (item) {\n                    item.isActive = false;\n                    //item.attributes = JSON.parse(item.attributes);\n                    return item;\n                }\n                $scope.changeActiveMerchant = function () {\n                    $scope.changeMerchant = true;\n                }\n                $scope.createItemStart = function () {\n                    $scope.createNewMerchant = true;\n                }\n                $scope.cancelChangeMerchant = function () {\n                    $scope.changeMerchant = false;\n                }\n                $scope.activateMap = function () {\n                    $scope.mapActive = true;\n                    console.log(\"Creating map data\")\n\n                    $scope.createMapData();\n                }\n                $scope.createMapData = function () {\n                    console.log(\"Creating map data\")\n                    for (item in $scope.items) {\n                        console.log(\"Creating map data item\")\n                        var color = MapService.getColor();\n                        $scope.items[item].polygon = MapService.createPolygon($scope.items[item], color);\n                    }\n                }\n                $scope.clearMap = function () {\n                    for (item in $scope.items) {\n                        console.log(\"Creating map data item\")\n                        $scope.items[item].polygon.setMap(null);\n                        $scope.items[item].isActive = false;\n                    }\n                }\n                $scope.changeScenario = function () {\n                    $scope.clearMap();\n                    $scope.items = [];\n                    $scope.page = 0;\n                    $scope.getItems();\n                }\n                $scope.getColor = function () {\n                    var routeColors = [\"#FF0000\", \"#800000\", \"#FFFF00\", \"#808000\", \"#00FF00\", \"#008000\", \"#00FFFF\", \"#008080\", \"#0000FF\", \"#000080\", \"#FF00FF\", \"#800080\"];\n                    var random = Math.round(Math.random() * (routeColors.length - 1));\n                    return routeColors[random];\n                }\n                $scope.selectItem = function (zone) {\n                    $scope.clearMap();\n                    zone.isActive = true;\n                    zone.polygon.setMap($rootScope.map);\n                }\n                $scope.createItem = function () {\n                    $scope.clearMap();\n                    var centerMap = $rootScope.map.getCenter();\n                    var center = {\"lat\": centerMap.lat(), \"lng\": centerMap.lng()};\n                    console.log(\"Center Map\", center.lat);\n                    var coverage = [{\"lat\": center.lat + 0.006, \"lng\": center.lng},\n                        {\"lat\": center.lat - 0.006, \"lng\": center.lng - 0.006}, {\"lat\": center.lat - 0.006, \"lng\": center.lng + 0.006}, {\"lat\": center.lat + 0.006, \"lng\": center.lng}];\n                    var item = {\n                        \"city_id\": 524,\n                        \"region_id\": 11,\n                        \"address_id\": 14,\n                        \"country_id\": 1,\n                        \"merchant_id\": $scope.activeMerchant,\n                        \"provider\": $scope.activeProvider,\n                        \"coverage\": JSON.stringify(coverage),\n                        \"lat\": 4.649824,\n                        \"long\": -74.058881\n                    };\n                    Zones.createZoneItem(item).then(function (data) {\n                        var color = MapService.getColor();\n                        var item = data.item;\n                        item.isActive = false;\n                        item.polygon = MapService.createPolygon(item, color);\n                        $scope.items.push(item);\n                    },\n                            function (data) {\n\n                            });\n                }\n\n                $scope.getItems = function () {\n                    $scope.page++;\n                    var url = \"order_by=id,desc&page=\" + $scope.page + \"&merchant_id=\" + $scope.activeMerchant;\n                    Zones.getZones(url).then(function (data) {\n                        if (data.page == data.last_page) {\n                            $scope.loadMore = false;\n                        }\n                        console.log(\"Items\", data.data);\n                        var itemsCont = data.data;\n                        for (item in itemsCont) {\n                            itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                        }\n                        $scope.items = $scope.items.concat(itemsCont);\n                        $scope.activateMap();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.searchMerchants = function () {\n                    $scope.page++;\n                    Merchants.searchMerchants($scope.searchTerms).then(function (data) {\n                        console.log(\"Items\", data.data);\n                        $scope.merchants = data.data;\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.selectMerchant = function (item) {\n                    $scope.activeMerchantObject = item;\n                    $scope.clearMap();\n                    $scope.page = 0;\n                    $scope.items = [];\n                    $scope.activeMerchant = item.id + \"\";\n                    $scope.changeMerchant = false;\n                    $scope.getItems();\n                }\n                $scope.selectMerchantObject = function () {\n                    console.log(\"Selecting merchant: \", $scope.activeMerchant);\n                    $scope.clearMap();\n                    $scope.page = 0;\n                    $scope.items = [];\n                    $scope.getItems();\n                }\n                $scope.updateItem = function (data) {\n                    var item = data;\n                    var results = [];\n                    var last = null;\n                    item.polygon.getPaths().forEach(function (path, index) {\n                        console.log(\"path\", index);\n                        var vertices = path;\n                        for (var i = 0; i < vertices.getLength(); i++) {\n                            var xy = vertices.getAt(i);\n                            var point = {\"lat\": xy.lat(), \"lng\": xy.lng()};\n                            results.push(point);\n                            if (i == 0) {\n                                last = point;\n                            }\n                        }\n                    });\n                    results.push(last);\n                    var polygon = item.polygon;\n                    delete item.polygon;\n                    delete item.isActive;\n                    item.coverage = JSON.stringify(results);\n                    console.log(\"Zone\", item);\n                    console.log(\"Points\", results);\n                    Zones.updateZoneItem(item).then(function (data) {\n                        item.polygon = polygon;\n                        item.isActive = false;\n                        console.log(\"updateZoneItem\", data);\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteItem = function (item) {\n                    console.log(\"Zone\", item);\n                    Zones.deleteZoneItem(item).then(function (data) {\n                        for (item in $scope.items) {\n                            console.log(\"Creating map data item\")\n                            $scope.items[item].polygon.setMap(null);\n                            $scope.items[item].isActive = false;\n                            $scope.items.splice(item, 1);\n                        }\n\n                    },\n                            function (data) {\n\n                            });\n                }\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy96b25lc2N0cmwuanM/ODRiYyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignWm9uZXNDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdab25lcycsICdNYXBTZXJ2aWNlJywgJ01lcmNoYW50cycsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIFpvbmVzLCBNYXBTZXJ2aWNlLCBNZXJjaGFudHMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvdmlkZXJzID0gW3tcIm5hbWVcIjogXCJNaSBQYXF1ZXRlXCIsIFwidmFsdWVcIjogXCJNaVBhcXVldGVcIn0sIHtcIm5hbWVcIjogXCJSYXBpZ29cIiwgXCJ2YWx1ZVwiOiBcIlJhcGlnb1wifSwge1wibmFtZVwiOiBcIlByb3Bpb1wiLCBcInZhbHVlXCI6IFwiUHJvcGlvXCJ9XSwge1wibmFtZVwiOiBcIkJhc2lsaWt1bVwiLCBcInZhbHVlXCI6IFwiQmFzaWxpa3VtXCJ9O1xuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNZXJjaGFudDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnRPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVGVybXMgPSBcIlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVOZXdNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0dGluZyBtZXJjaGFudHMgYW5kIHpvbmVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlTWFwKDQuNjg1NDE5LCAtNzQuMDY0MTYxKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRNZXJjaGFudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5nZXRNZXJjaGFudHNVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgPSAkc2NvcGUubWVyY2hhbnRzWzBdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbihcInpvbmUtdXBkYXRlZFwiLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuaXRlbXNbaXRlbV0uaWQgPT0gZGF0YS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRkaWdlc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUFjdGl2ZU1lcmNoYW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlTWVyY2hhbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlSXRlbVN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlTmV3TWVyY2hhbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsQ2hhbmdlTWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGVNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhXCIpXG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS5pdGVtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSBpdGVtXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBNYXBTZXJ2aWNlLmdldENvbG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXNbaXRlbV0ucG9seWdvbiA9IE1hcFNlcnZpY2UuY3JlYXRlUG9seWdvbigkc2NvcGUuaXRlbXNbaXRlbV0sIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgaXRlbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLnBvbHlnb24uc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZVNjZW5hcmlvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlQ29sb3JzID0gW1wiI0ZGMDAwMFwiLCBcIiM4MDAwMDBcIiwgXCIjRkZGRjAwXCIsIFwiIzgwODAwMFwiLCBcIiMwMEZGMDBcIiwgXCIjMDA4MDAwXCIsIFwiIzAwRkZGRlwiLCBcIiMwMDgwODBcIiwgXCIjMDAwMEZGXCIsIFwiIzAwMDA4MFwiLCBcIiNGRjAwRkZcIiwgXCIjODAwMDgwXCJdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKHJvdXRlQ29sb3JzLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlQ29sb3JzW3JhbmRvbV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RJdGVtID0gZnVuY3Rpb24gKHpvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgIHpvbmUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB6b25lLnBvbHlnb24uc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZUl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jbGVhck1hcCgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgY2VudGVyTWFwID0gJHJvb3RTY29wZS5tYXAuZ2V0Q2VudGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjZW50ZXIgPSB7XCJsYXRcIjogY2VudGVyTWFwLmxhdCgpLCBcImxuZ1wiOiBjZW50ZXJNYXAubG5nKCl9O1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNlbnRlciBNYXBcIiwgY2VudGVyLmxhdCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb3ZlcmFnZSA9IFt7XCJsYXRcIjogY2VudGVyLmxhdCArIDAuMDA2LCBcImxuZ1wiOiBjZW50ZXIubG5nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcImxhdFwiOiBjZW50ZXIubGF0IC0gMC4wMDYsIFwibG5nXCI6IGNlbnRlci5sbmcgLSAwLjAwNn0sIHtcImxhdFwiOiBjZW50ZXIubGF0IC0gMC4wMDYsIFwibG5nXCI6IGNlbnRlci5sbmcgKyAwLjAwNn0sIHtcImxhdFwiOiBjZW50ZXIubGF0ICsgMC4wMDYsIFwibG5nXCI6IGNlbnRlci5sbmd9XTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImNpdHlfaWRcIjogNTI0LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWdpb25faWRcIjogMTEsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NfaWRcIjogMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvdW50cnlfaWRcIjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVyY2hhbnRfaWRcIjogJHNjb3BlLmFjdGl2ZU1lcmNoYW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlclwiOiAkc2NvcGUuYWN0aXZlUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvdmVyYWdlXCI6IEpTT04uc3RyaW5naWZ5KGNvdmVyYWdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGF0XCI6IDQuNjQ5ODI0LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJsb25nXCI6IC03NC4wNTg4ODFcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMuY3JlYXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gTWFwU2VydmljZS5nZXRDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSBkYXRhLml0ZW07XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnBvbHlnb24gPSBNYXBTZXJ2aWNlLmNyZWF0ZVBvbHlnb24oaXRlbSwgY29sb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IFwib3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2UgKyBcIiZtZXJjaGFudF9pZD1cIiArICRzY29wZS5hY3RpdmVNZXJjaGFudDtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMuZ2V0Wm9uZXModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGl0ZW1zQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQ29udFtpdGVtXSA9ICRzY29wZS5idWlsZEl0ZW1EYXRhKGl0ZW1zQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSAkc2NvcGUuaXRlbXMuY29uY2F0KGl0ZW1zQ29udCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2hNZXJjaGFudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5zZWFyY2hNZXJjaGFudHMoJHNjb3BlLnNlYXJjaFRlcm1zKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdE1lcmNoYW50ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50T2JqZWN0ID0gaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNZXJjaGFudCA9IGl0ZW0uaWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlTWVyY2hhbnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RNZXJjaGFudE9iamVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3RpbmcgbWVyY2hhbnQ6IFwiLCAkc2NvcGUuYWN0aXZlTWVyY2hhbnQpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVJdGVtID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbGFzdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucG9seWdvbi5nZXRQYXRocygpLmZvckVhY2goZnVuY3Rpb24gKHBhdGgsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhdGhcIiwgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZlcnRpY2VzID0gcGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMuZ2V0TGVuZ3RoKCk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4eSA9IHZlcnRpY2VzLmdldEF0KGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2ludCA9IHtcImxhdFwiOiB4eS5sYXQoKSwgXCJsbmdcIjogeHkubG5nKCl9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0ID0gcG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGxhc3QpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9seWdvbiA9IGl0ZW0ucG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0ucG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0uaXNBY3RpdmU7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY292ZXJhZ2UgPSBKU09OLnN0cmluZ2lmeShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJab25lXCIsIGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvaW50c1wiLCByZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMudXBkYXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wb2x5Z29uID0gcG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlWm9uZUl0ZW1cIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiWm9uZVwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMuZGVsZXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS5pdGVtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgaXRlbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5wb2x5Z29uLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXNbaXRlbV0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvem9uZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 29 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ZonesPubCtrl',['$scope', '$rootScope', 'Food', 'MapService', function ($scope, $rootScope, Food, MapService) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.merchants = [{\"name\": \"Plan de almuerzos\", \"value\": 1299}, {\"name\": \"Para preparar en casa\", \"value\": 1300}, {\"name\": \"Catering\", \"value\": 1301}];\n            $scope.providers = [{\"name\": \"Basilikum\", \"value\": \"Basilikum\"}, {\"name\": \"Rapigo\", \"value\": \"Rapigo\"}];\n            $scope.activeMerchant = 1299 + \"\";\n            $scope.activeProvider = \"Basilikum\";\n            $scope.loadMore = true,\n                    $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n                MapService.createMap(4.685419, -74.064161);\n            });\n\n            $scope.buildItemData = function (item) {\n                item.isActive = false;\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n            $scope.activateMap = function () {\n                $scope.mapActive = true;\n                console.log(\"Creating map data\")\n\n                $scope.createMapData();\n            }\n            $scope.createMapData = function () {\n                console.log(\"Creating map data\")\n                for (item in $scope.items) {\n                    console.log(\"Creating map data item\")\n                    var color = MapService.getColor();\n                    $scope.items[item].polygon = MapService.createPolygon($scope.items[item], color);\n                }\n            }\n            $scope.clearMap = function () {\n                for (item in $scope.items) {\n                    console.log(\"Creating map data item\")\n                    $scope.items[item].polygon.setMap(null);\n                    $scope.items[item].isActive = false;\n                }\n            }\n            $scope.changeScenario = function () {\n                $scope.clearMap();\n                $scope.items = [];\n                $scope.page = 0;\n                $scope.getItems();\n            }\n            $scope.getColor = function () {\n                var routeColors = [\"#FF0000\", \"#800000\", \"#FFFF00\", \"#808000\", \"#00FF00\", \"#008000\", \"#00FFFF\", \"#008080\", \"#0000FF\", \"#000080\", \"#FF00FF\", \"#800080\"];\n                var random = Math.round(Math.random() * (routeColors.length - 1));\n                return routeColors[random];\n            }\n            $scope.selectItem = function (zone) {\n                $scope.clearMap();\n                zone.isActive = true;\n                zone.polygon.setMap($rootScope.map);\n            }\n            $scope.createItem = function () {\n                $scope.clearMap();\n                var coverage = [{\"lat\": 4.661880, \"lng\": -74.056724},\n                    {\"lat\": 4.656747, \"lng\": -74.060458}, {\"lat\": 4.656277, \"lng\": -74.052304}];\n                var item = {\n                    \"city_id\": 524,\n                    \"region_id\": 11,\n                    \"address_id\": 14,\n                    \"country_id\": 1,\n                    \"merchant_id\": $scope.activeMerchant,\n                    \"provider\": $scope.activeProvider,\n                    \"coverage\": JSON.stringify(coverage),\n                    \"lat\": 4.649824,\n                    \"long\": -74.058881\n                };\n                Food.createZoneItem(item).then(function (data) {\n                    var color = MapService.getColor();\n                    var item = data.item;\n                    item.polygon = MapService.createPolygon(item, color);\n                    $scope.items.push(item);\n                },\n                        function (data) {\n\n                        });\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page + \"&merchant_id=\" + $scope.activeMerchant + \"&provider=\" + $scope.activeProvider;\n                Food.getZones(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\", data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                    $scope.activateMap();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (data) {\n                var item = data;\n                var results = [];\n                var last = null;\n                item.polygon.getPaths().forEach(function (path, index) {\n                    console.log(\"path\", index);\n                    var vertices = path;\n                    for (var i = 0; i < vertices.getLength(); i++) {\n                        var xy = vertices.getAt(i);\n                        var point = {\"lat\": xy.lat(), \"lng\": xy.lng()};\n                        results.push(point);\n                        if (i == 0) {\n                            last = point;\n                        }\n                    }\n                });\n                results.push(last);\n                var polygon = item.polygon;\n                delete item.polygon;\n                delete item.isActive;\n                item.coverage = JSON.stringify(results);\n                console.log(\"Zone\", item);\n                console.log(\"Points\", results);\n                Food.updateZoneItem(item).then(function (data) {\n                    item.polygon = polygon;\n                    console.log(\"updateZoneItem\", data);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n                console.log(\"Zone\", item);\n                Food.deleteZoneItem(item).then(function (data) {\n                    for (item in $scope.items) {\n                        console.log(\"Creating map data item\")\n                        $scope.items[item].polygon.setMap(null);\n                        $scope.items[item].isActive = false;\n                        $scope.items.splice(item, 1);\n                    }\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy96b25lc3B1YmN0cmwuanM/ODYyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignWm9uZXNQdWJDdHJsJyxbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0Zvb2QnLCAnTWFwU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIEZvb2QsIE1hcFNlcnZpY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBbe1wibmFtZVwiOiBcIlBsYW4gZGUgYWxtdWVyem9zXCIsIFwidmFsdWVcIjogMTI5OX0sIHtcIm5hbWVcIjogXCJQYXJhIHByZXBhcmFyIGVuIGNhc2FcIiwgXCJ2YWx1ZVwiOiAxMzAwfSwge1wibmFtZVwiOiBcIkNhdGVyaW5nXCIsIFwidmFsdWVcIjogMTMwMX1dO1xuICAgICAgICAgICAgJHNjb3BlLnByb3ZpZGVycyA9IFt7XCJuYW1lXCI6IFwiQmFzaWxpa3VtXCIsIFwidmFsdWVcIjogXCJCYXNpbGlrdW1cIn0sIHtcIm5hbWVcIjogXCJSYXBpZ29cIiwgXCJ2YWx1ZVwiOiBcIlJhcGlnb1wifV07XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgPSAxMjk5ICsgXCJcIjtcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVQcm92aWRlciA9IFwiQmFzaWxpa3VtXCI7XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY4NTQxOSwgLTc0LjA2NDE2MSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGl0ZW0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvL2l0ZW0uYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoaXRlbS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5hY3RpdmF0ZU1hcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWFwQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhXCIpXG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlTWFwRGF0YSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSBpdGVtXCIpXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb2xvciA9IE1hcFNlcnZpY2UuZ2V0Q29sb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLnBvbHlnb24gPSBNYXBTZXJ2aWNlLmNyZWF0ZVBvbHlnb24oJHNjb3BlLml0ZW1zW2l0ZW1dLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSBpdGVtXCIpXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5wb2x5Z29uLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNoYW5nZVNjZW5hcmlvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jbGVhck1hcCgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsZXQgcm91dGVDb2xvcnMgPSBbXCIjRkYwMDAwXCIsIFwiIzgwMDAwMFwiLCBcIiNGRkZGMDBcIiwgXCIjODA4MDAwXCIsIFwiIzAwRkYwMFwiLCBcIiMwMDgwMDBcIiwgXCIjMDBGRkZGXCIsIFwiIzAwODA4MFwiLCBcIiMwMDAwRkZcIiwgXCIjMDAwMDgwXCIsIFwiI0ZGMDBGRlwiLCBcIiM4MDAwODBcIl07XG4gICAgICAgICAgICAgICAgbGV0IHJhbmRvbSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChyb3V0ZUNvbG9ycy5sZW5ndGggLSAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlQ29sb3JzW3JhbmRvbV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uICh6b25lKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwKCk7XG4gICAgICAgICAgICAgICAgem9uZS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgem9uZS5wb2x5Z29uLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuY3JlYXRlSXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAoKTtcbiAgICAgICAgICAgICAgICBsZXQgY292ZXJhZ2UgPSBbe1wibGF0XCI6IDQuNjYxODgwLCBcImxuZ1wiOiAtNzQuMDU2NzI0fSxcbiAgICAgICAgICAgICAgICAgICAge1wibGF0XCI6IDQuNjU2NzQ3LCBcImxuZ1wiOiAtNzQuMDYwNDU4fSwge1wibGF0XCI6IDQuNjU2Mjc3LCBcImxuZ1wiOiAtNzQuMDUyMzA0fV07XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY2l0eV9pZFwiOiA1MjQsXG4gICAgICAgICAgICAgICAgICAgIFwicmVnaW9uX2lkXCI6IDExLFxuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NfaWRcIjogMTQsXG4gICAgICAgICAgICAgICAgICAgIFwiY291bnRyeV9pZFwiOiAxLFxuICAgICAgICAgICAgICAgICAgICBcIm1lcmNoYW50X2lkXCI6ICRzY29wZS5hY3RpdmVNZXJjaGFudCxcbiAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlclwiOiAkc2NvcGUuYWN0aXZlUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIFwiY292ZXJhZ2VcIjogSlNPTi5zdHJpbmdpZnkoY292ZXJhZ2UpLFxuICAgICAgICAgICAgICAgICAgICBcImxhdFwiOiA0LjY0OTgyNCxcbiAgICAgICAgICAgICAgICAgICAgXCJsb25nXCI6IC03NC4wNTg4ODFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIEZvb2QuY3JlYXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBNYXBTZXJ2aWNlLmdldENvbG9yKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpdGVtID0gZGF0YS5pdGVtO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnBvbHlnb24gPSBNYXBTZXJ2aWNlLmNyZWF0ZVBvbHlnb24oaXRlbSwgY29sb3IpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIm9yZGVyX2J5PWlkLGRlc2MmcGFnZT1cIiArICRzY29wZS5wYWdlICsgXCImbWVyY2hhbnRfaWQ9XCIgKyAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgKyBcIiZwcm92aWRlcj1cIiArICRzY29wZS5hY3RpdmVQcm92aWRlcjtcbiAgICAgICAgICAgICAgICBGb29kLmdldFpvbmVzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpdGVtc0NvbnQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBpdGVtc0NvbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQ29udFtpdGVtXSA9ICRzY29wZS5idWlsZEl0ZW1EYXRhKGl0ZW1zQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gJHNjb3BlLml0ZW1zLmNvbmNhdChpdGVtc0NvbnQpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICAgICAgICAgICAgbGV0IGxhc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgIGl0ZW0ucG9seWdvbi5nZXRQYXRocygpLmZvckVhY2goZnVuY3Rpb24gKHBhdGgsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGF0aFwiLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2ZXJ0aWNlcyA9IHBhdGg7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMuZ2V0TGVuZ3RoKCk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHh5ID0gdmVydGljZXMuZ2V0QXQoaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSB7XCJsYXRcIjogeHkubGF0KCksIFwibG5nXCI6IHh5LmxuZygpfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IHBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGxhc3QpO1xuICAgICAgICAgICAgICAgIHZhciBwb2x5Z29uID0gaXRlbS5wb2x5Z29uO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBpdGVtLnBvbHlnb247XG4gICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0uaXNBY3RpdmU7XG4gICAgICAgICAgICAgICAgaXRlbS5jb3ZlcmFnZSA9IEpTT04uc3RyaW5naWZ5KHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiWm9uZVwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvaW50c1wiLCByZXN1bHRzKTtcbiAgICAgICAgICAgICAgICBGb29kLnVwZGF0ZVpvbmVJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5wb2x5Z29uID0gcG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGVab25lSXRlbVwiLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJab25lXCIsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIEZvb2QuZGVsZXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhIGl0ZW1cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5wb2x5Z29uLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL3pvbmVzcHViY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 30 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Addresses',['$q', '$http', function ($q, $http) {\n\n            var getAddresses = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/addresses' \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveAddress = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/addresses',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            var deleteAddress = function (address) {\n                var def = $q.defer();\n                $http({\n                    method: 'DELETE',\n                    url: '/api/addresses/' + address\n                })\n                        .success(function (data) {\n                            console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to Delete Address\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                getAddresses:getAddresses,\n                saveAddress:saveAddress,\n                deleteAddress:deleteAddress\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9hZGRyZXNzLmpzPzMyMDgiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIFxuICAgICAgICAuc2VydmljZSgnQWRkcmVzc2VzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMnIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2F2ZUFkZHJlc3MgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGRlbGV0ZUFkZHJlc3MgPSBmdW5jdGlvbiAoYWRkcmVzcykge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMvJyArIGFkZHJlc3NcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gRGVsZXRlIEFkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnZXRBZGRyZXNzZXM6Z2V0QWRkcmVzc2VzLFxuICAgICAgICAgICAgICAgIHNhdmVBZGRyZXNzOnNhdmVBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGRlbGV0ZUFkZHJlc3M6ZGVsZXRlQWRkcmVzc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvYWRkcmVzcy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 31 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Billing',['$q', '$http', function ($q, $http) {\n\n            var payCreditCard = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_cc/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to payCreditCard\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var payInBank = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_in_bank/Local',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to payInBank\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var completePaidOrder = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/complete_paid/Food',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to completePaidOrder\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var retryPayment = function (payment) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/retry/'+payment,\n                        \n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to retryPayment\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            \n            var addTransactionCosts = function (payment) {\n                var def = $q.defer();\n                \n                $http({\n                        method: 'POST',\n                        url: '/api/billing/add_transaction_costs/'+payment,\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to addTransactionCosts\");\n                        });\n                return def.promise;\n            }\n\n            var payDebit = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_debit/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to payDebit\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var payCash = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_cash/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to payCash\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getBanks = function (where) {\n                var url =\"/api/payu/banks\";\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: url,\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to getBanks\");\n                        });\n                return def.promise;\n            }\n            return {\n                payCreditCard: payCreditCard,\n                payInBank:payInBank,\n                completePaidOrder: completePaidOrder,\n                retryPayment:retryPayment,\n                addTransactionCosts:addTransactionCosts,\n                payDebit: payDebit,\n                payCash:payCash,\n                getBanks:getBanks\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9iaWxsaW5nLmpzPzg2NGEiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIFxuICAgICAgICAuc2VydmljZSgnQmlsbGluZycsWyckcScsICckaHR0cCcsIGZ1bmN0aW9uICgkcSwgJGh0dHApIHtcblxuICAgICAgICAgICAgdmFyIHBheUNyZWRpdENhcmQgPSBmdW5jdGlvbiAoZGF0YSxwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL3BheV9jYy8nK3BsYXRmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHBheUNyZWRpdENhcmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwYXlJbkJhbmsgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL3BheV9pbl9iYW5rL0xvY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBwYXlJbkJhbmtcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb21wbGV0ZVBhaWRPcmRlciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvY29tcGxldGVfcGFpZC9Gb29kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjb21wbGV0ZVBhaWRPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJldHJ5UGF5bWVudCA9IGZ1bmN0aW9uIChwYXltZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvcmV0cnkvJytwYXltZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byByZXRyeVBheW1lbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGFkZFRyYW5zYWN0aW9uQ29zdHMgPSBmdW5jdGlvbiAocGF5bWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL2FkZF90cmFuc2FjdGlvbl9jb3N0cy8nK3BheW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhZGRUcmFuc2FjdGlvbkNvc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcGF5RGViaXQgPSBmdW5jdGlvbiAoZGF0YSxwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL3BheV9kZWJpdC8nK3BsYXRmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHBheURlYml0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGF5Q2FzaCA9IGZ1bmN0aW9uIChkYXRhLHBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvcGF5X2Nhc2gvJytwbGF0Zm9ybSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBwYXlDYXNoXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRCYW5rcyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPVwiL2FwaS9wYXl1L2JhbmtzXCI7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0QmFua3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBheUNyZWRpdENhcmQ6IHBheUNyZWRpdENhcmQsXG4gICAgICAgICAgICAgICAgcGF5SW5CYW5rOnBheUluQmFuayxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVBhaWRPcmRlcjogY29tcGxldGVQYWlkT3JkZXIsXG4gICAgICAgICAgICAgICAgcmV0cnlQYXltZW50OnJldHJ5UGF5bWVudCxcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2FjdGlvbkNvc3RzOmFkZFRyYW5zYWN0aW9uQ29zdHMsXG4gICAgICAgICAgICAgICAgcGF5RGViaXQ6IHBheURlYml0LFxuICAgICAgICAgICAgICAgIHBheUNhc2g6cGF5Q2FzaCxcbiAgICAgICAgICAgICAgICBnZXRCYW5rczpnZXRCYW5rc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvYmlsbGluZy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 32 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .service('Booking', ['$q', '$http', function ($q, $http) {\n\n                var getBookingsObject = function (objectB) {\n                    var url = '/api/bookings';\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url,\n                        params: objectB\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to getBookingsObject\");\n                            });\n\n                    return def.promise;\n                    /**/\n\n                }\n                var getBooking = function (objectB) {\n                    var url = '/api/bookings/' + objectB;\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to getBooking\");\n                            });\n\n                    return def.promise;\n                    /**/\n                }\n                var getObjectsWithBookingUser = function () {\n                    var url = '/bookings/user';\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to getObjectsWithBookingUser\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var checkExistingBooking = function (booking_id) {\n                    var url = '/api/bookings/' + booking_id + \"/check\";\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to checkExistingBooking\");\n                            });\n\n                    return def.promise;\n                    /**/\n                }\n                var addBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: '/api/bookings',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to addBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n\n                var editBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: '/api/bookings/edit',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to editBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var immediateBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: '/api/bookings/now',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to immediateBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var getAvailabilitiesObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'GET',\n                        url: \"/api/availabilities\",\n                        params: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to getAvailabilitiesObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var changeStatusBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: \"/api/bookings/status\",\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to changeStatusBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var deleteBookingObject = function (objectId) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'DELETE',\n                        url: \"/api/bookings/\" + objectId\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to deleteBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var getMonthName = function (month) {\n                    if (month == 0) {\n                        return \"Enero\"\n                    }\n                    if (month == 1) {\n                        return \"Febrero\"\n                    }\n                    if (month == 2) {\n                        return \"Marzo\"\n                    }\n                    if (month == 3) {\n                        return \"Abril\"\n                    }\n                    if (month == 4) {\n                        return \"Mayo\"\n                    }\n                    if (month == 5) {\n                        return \"Junio\"\n                    }\n                    if (month == 6) {\n                        return \"Julio\"\n                    }\n                    if (month == 7) {\n                        return \"Agosto\"\n                    }\n                    if (month == 8) {\n                        return \"Septiembre\"\n                    }\n                    if (month == 9) {\n                        return \"Octubre\"\n                    }\n                    if (month == 10) {\n                        return \"Noviembre\"\n                    }\n                    if (month == 11) {\n                        return \"Diciembre\"\n                    }\n                }\n\n                return {\n                    getBookingsObject: getBookingsObject,\n                    getBooking: getBooking,\n                    getObjectsWithBookingUser: getObjectsWithBookingUser,\n                    checkExistingBooking: checkExistingBooking,\n                    addBookingObject: addBookingObject,\n                    editBookingObject: editBookingObject,\n                    immediateBookingObject: immediateBookingObject,\n                    getAvailabilitiesObject: getAvailabilitiesObject,\n                    changeStatusBookingObject: changeStatusBookingObject,\n                    deleteBookingObject:deleteBookingObject,\n                    getMonthName:getMonthName\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9ib29raW5nLmpzPzM1MjciXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLnNlcnZpY2UoJ0Jvb2tpbmcnLCBbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGdldEJvb2tpbmdzT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdEIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Jvb2tpbmdzJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogb2JqZWN0QlxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0Qm9va2luZ3NPYmplY3RcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldEJvb2tpbmcgPSBmdW5jdGlvbiAob2JqZWN0Qikge1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYm9va2luZ3MvJyArIG9iamVjdEI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldEJvb2tpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRPYmplY3RzV2l0aEJvb2tpbmdVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9ib29raW5ncy91c2VyJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0T2JqZWN0c1dpdGhCb29raW5nVXNlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGVja0V4aXN0aW5nQm9va2luZyA9IGZ1bmN0aW9uIChib29raW5nX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9ib29raW5ncy8nICsgYm9va2luZ19pZCArIFwiL2NoZWNrXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGNoZWNrRXhpc3RpbmdCb29raW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYWRkQm9va2luZ09iamVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYm9va2luZ3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkQm9va2luZ09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGVkaXRCb29raW5nT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9ib29raW5ncy9lZGl0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGVkaXRCb29raW5nT2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGltbWVkaWF0ZUJvb2tpbmdPYmplY3QgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2Jvb2tpbmdzL25vdycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBpbW1lZGlhdGVCb29raW5nT2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldEF2YWlsYWJpbGl0aWVzT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9hdmFpbGFiaWxpdGllc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRBdmFpbGFiaWxpdGllc09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VTdGF0dXNCb29raW5nT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvYm9va2luZ3Mvc3RhdHVzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjaGFuZ2VTdGF0dXNCb29raW5nT2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlbGV0ZUJvb2tpbmdPYmplY3QgPSBmdW5jdGlvbiAob2JqZWN0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9ib29raW5ncy9cIiArIG9iamVjdElkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZUJvb2tpbmdPYmplY3RcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0TW9udGhOYW1lID0gZnVuY3Rpb24gKG1vbnRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJFbmVyb1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIkZlYnJlcm9cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJNYXJ6b1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIkFicmlsXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiTWF5b1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIkp1bmlvXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gNikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiSnVsaW9cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSA3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJBZ29zdG9cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSA4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJTZXB0aWVtYnJlXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiT2N0dWJyZVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDEwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJOb3ZpZW1icmVcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAxMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiRGljaWVtYnJlXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGdldEJvb2tpbmdzT2JqZWN0OiBnZXRCb29raW5nc09iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0Qm9va2luZzogZ2V0Qm9va2luZyxcbiAgICAgICAgICAgICAgICAgICAgZ2V0T2JqZWN0c1dpdGhCb29raW5nVXNlcjogZ2V0T2JqZWN0c1dpdGhCb29raW5nVXNlcixcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tFeGlzdGluZ0Jvb2tpbmc6IGNoZWNrRXhpc3RpbmdCb29raW5nLFxuICAgICAgICAgICAgICAgICAgICBhZGRCb29raW5nT2JqZWN0OiBhZGRCb29raW5nT2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBlZGl0Qm9va2luZ09iamVjdDogZWRpdEJvb2tpbmdPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGltbWVkaWF0ZUJvb2tpbmdPYmplY3Q6IGltbWVkaWF0ZUJvb2tpbmdPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGdldEF2YWlsYWJpbGl0aWVzT2JqZWN0OiBnZXRBdmFpbGFiaWxpdGllc09iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlU3RhdHVzQm9va2luZ09iamVjdDogY2hhbmdlU3RhdHVzQm9va2luZ09iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlQm9va2luZ09iamVjdDpkZWxldGVCb29raW5nT2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBnZXRNb250aE5hbWU6Z2V0TW9udGhOYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL2Jvb2tpbmcuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 33 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n        .service('Cart', ['$q', '$http', '$mdDialog', 'Modals', '$cookies', '$rootScope', function ($q, $http, $mdDialog, Modals, $cookies, $rootScope) {\r\n\r\n                var showConfirm = function (url) {\r\n                    $mdDialog.show(Modals.getLocationPrompt()).then(function (answer) {\r\n                        if (answer == \"map\") {\r\n                            $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\r\n                            window.location.href = \"/location\";\r\n                        } else if (answer == 'address') {\r\n                            showAdvanced();\r\n                        }\r\n\r\n                    }, function () {\r\n\r\n                    });\r\n                };\r\n                var showQuestionaire = function (questions) {\r\n                    $mdDialog.show(Modals.getQuestionairePopup(questions)).then(function (answer) {\r\n                        console.log(\"questions\", answer)\r\n\r\n                    }, function () {\r\n\r\n                    });\r\n                };\r\n                var showConfirmExt = function (url) {\r\n                    $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\r\n                    window.location.href = \"/location\";\r\n                };\r\n                var checkProduct = function (variant) {\r\n                    console.log(\"Checking: \", variant, $rootScope.user);\r\n                    if (variant.type == \"booking\" && $rootScope.user) {\r\n                        appointmentbook(variant.product);\r\n                        return false;\r\n                    } else {\r\n                        console.log(\"Check prod\", $rootScope.shippingAddress);\r\n                        if (variant.is_shippable) {\r\n                            if ($rootScope.shippingAddress) {\r\n                                return checkMerchant();\r\n                            }\r\n                            showConfirm(window.location.href);\r\n                            return false;\r\n                        } else {\r\n                            return checkMerchant();\r\n                        }\r\n                    }\r\n\r\n                };\r\n                appointmentbook = function (item) {\r\n                    var questions = [];\r\n                    var location = null;\r\n                    var container = null;\r\n                    console.log(\"variants\", item.variants)\r\n                    for (var i in item.variants) {\r\n                        if (item.variant_id == item.variants[i].id) {\r\n                            container = item.variants[i];\r\n                            break;\r\n                        }\r\n                    }\r\n                    console.log(\"Container\", container);\r\n                    if (container.attributes) {\r\n                        if (container.attributes.questions) {\r\n                            questions = container.attributes.questions;\r\n                        }\r\n                        if (container.attributes.location) {\r\n                            location = container.attributes.location;\r\n                        }\r\n                    }\r\n                    var params = {\r\n                        \"availabilities\": null,\r\n                        \"type\": \"Merchant\",\r\n                        \"objectId\": item.merchant_id,\r\n                        \"objectName\": item.merchant_name,\r\n                        \"objectDescription\": item.merchant_description,\r\n                        \"objectIcon\": item.merchant_icon,\r\n                        \"expectedPrice\": item.activeVariant.price,\r\n                        \"questions\": questions,\r\n                        \"variant\": container,\r\n                        \"product_variant_id\": item.variant_id,\r\n                        \"quantity\": item.amount,\r\n                        \"purpose\": \"external_book\",\r\n                        \"alert\":\"#prod-cont-\" + item.id\r\n                    }\r\n                    if(location){\r\n                        params.location = location;\r\n                    }\r\n                    showBooking(params);\r\n                }\r\n                var getCategoryFromUrl = function () {\r\n                    var theUrl = window.location.href;\r\n                    var segments = theUrl.split(\"/\")\r\n                    var category = segments[(segments.length - 1)];\r\n                    if (category.includes(\"?\")) {\r\n                        category = category.split(\"?\")[0];\r\n                    }\r\n                    if (isNaN(category)) {\r\n                        return null;\r\n                    }\r\n                    return category;\r\n                };\r\n                var checkMerchant = function () {\r\n                    if ($rootScope.merchant_id) {\r\n                        return true;\r\n                    } else {\r\n                        var category = getCategoryFromUrl();\r\n                        console.log(\"Searching for merchants in cat:\", category);\r\n                        showMerchants(category);\r\n                    }\r\n                };\r\n                var changeMerchant = function () {\r\n                    var category = getCategoryFromUrl();\r\n                    console.log(\"Searching for merchants in cat:\", category);\r\n                    showMerchants(category);\r\n                };\r\n                var showBooking = function (params) {\r\n                    var def = $q.defer();\r\n                    $mdDialog.show(Modals.getBookingPrompt(params)).then(function (result) {\r\n                        console.log(\"Got result\", $rootScope.cartMessage);\r\n                        Modals.hideLoader();\r\n                        Modals.showToast($rootScope.cartMessage, $(params.alert));\r\n                        def.resolve($rootScope.cartMessage);\r\n                    }, function () {\r\n                        console.log(\"Got nothing\");\r\n                        Modals.hideLoader();\r\n                        def.resolve(null);\r\n                    });\r\n                    return def.promise;\r\n                };\r\n                var showAdvanced = function () {\r\n                    $mdDialog.show(Modals.getAddressesPopup()).then(function (address) {\r\n                        console.log(\"Got address\", address);\r\n                        $rootScope.shippingAddress = address;\r\n                        $rootScope.lat = address.lat;\r\n                        $cookies.put(\"shippingAddress\", JSON.stringify(address), {path: \"/\"});\r\n                    }, function () {\r\n                        console.log(\"Got nothing\");\r\n                    });\r\n                };\r\n                var checkVariant = function (variant) {\r\n                    console.log(\"Variant\", variant);\r\n                    if (variant.attributes.questions) {\r\n                        showQuestionaire(variant.attributes.questions)\r\n                    }\r\n                };\r\n                var showMerchants = function (category) {\r\n                    $mdDialog.show(Modals.getMerchantsPopup(category)).then(function (merchant) {\r\n                        console.log(\"Got merchant\", merchant);\r\n                        var params = Modals.getAllUrlParams();\r\n                        if (params) {\r\n\r\n                        } else {\r\n                            params = {};\r\n                        }\r\n                        var theUrl = window.location.href;\r\n                        if (theUrl.includes(\"?\")) {\r\n                            theUrl = theUrl.split(\"?\")[0];\r\n                        }\r\n                        params.merchant_id = merchant.id\r\n                        var first = true;\r\n                        for (var k in params) {\r\n                            if (params.hasOwnProperty(k)) {\r\n                                if (first) {\r\n                                    theUrl = \"?\" + k + \"=\" + params[k];\r\n                                } else {\r\n                                    theUrl = \"&\" + k + \"=\" + params[k];\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        window.location.href = theUrl;\r\n                    }, function () {\r\n                        console.log(\"Got nothing\");\r\n                    });\r\n                };\r\n                var postToServer = function (postData) {\r\n                    console.log(\"Post to server\", postData);\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"post\",\r\n                        url: \"/api/cart/add\",\r\n                        data: postData\r\n                    })\r\n                            .success(function (data) {\r\n                                // console.log(data);\r\n                                def.resolve(data);\r\n                            })\r\n                            .error(function () {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n                    return def.promise;\r\n                };\r\n                var checkCart = function () {\r\n                    console.log(\"Post checkCart\");\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"post\",\r\n                        url: \"/api/cart/check\",\r\n                        data: {}\r\n                    })\r\n                            .success(function (data) {\r\n                                // console.log(data);\r\n                                def.resolve(data);\r\n                            })\r\n                            .error(function () {\r\n                                def.reject(\"Failed to checkCart\");\r\n                            });\r\n                    return def.promise;\r\n                };\r\n\r\n                var addCartItem = function (container, extras) {\r\n                    console.log(\"Check variant: \", container);\r\n                    var results = checkProduct(container);\r\n                    container.merchant_id = $rootScope.merchant_id;\r\n                    if (!container.item_id) {\r\n                        container.item_id = null;\r\n                    }\r\n                    var actvVariant = container.product.activeVariant;\r\n                    var def = $q.defer();\r\n                    if (!results) {\r\n                        def.resolve({status: \"pending_location\", message: \"msg\"});\r\n                    } else {\r\n                        if (actvVariant.attributes && actvVariant.attributes.questions && actvVariant.type == \"product\") {\r\n                            $mdDialog.show(Modals.getQuestionairePopup(actvVariant.attributes.questions)).then(function (results) {\r\n                                var data = [];\r\n                                for (var i in results) {\r\n                                    var container$1 = {\r\n                                        \"name\": results[i].name,\r\n                                        \"value\": results[i].value\r\n                                    }\r\n                                    data.push(container$1);\r\n                                }\r\n                                var postData = {\r\n                                    product_variant_id: container.id,\r\n                                    merchant_id: container.merchant_id,\r\n                                    quantity: container.quantity,\r\n                                    item_id: container.item_id,\r\n                                    extras: {data: data}\r\n                                };\r\n                                postToServer(postData).then(function (data) {\r\n                                    def.resolve(data);\r\n                                }, function () {\r\n                                    def.reject(\"Failed to get nearby\");\r\n                                });\r\n                            }, function () {\r\n                                def.resolve({status: \"pending_questions\", message: \"Debes completar estas preguntas para comprar este producto\"});\r\n                            });\r\n                        } else {\r\n                            var postData = {\r\n                                product_variant_id: container.id,\r\n                                merchant_id: container.merchant_id,\r\n                                quantity: container.quantity,\r\n                                item_id: container.item_id,\r\n                                extras: extras\r\n                            };\r\n                            postToServer(postData).then(function (data) {\r\n                                def.resolve(data);\r\n                            }, function () {\r\n                                def.reject(\"Failed to postToServer\");\r\n                            });\r\n                        }\r\n                    }\r\n                    return def.promise;\r\n                };\r\n                var updateCartItem = function (data) {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"post\",\r\n                        url: \"/api/cart/update\",\r\n                        data: data\r\n                    })\r\n                            .success(function (data) {\r\n                                // console.log(data);\r\n                                def.resolve(data);\r\n                            })\r\n                            .error(function () {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCart = function () {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"GET\",\r\n                        url: \"/api/cart/get\"\r\n                    })\r\n                            .success(function (data) {\r\n                                def.resolve(data);\r\n                            })\r\n                            .error(function () {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n                    return def.promise;\r\n                };\r\n                var getCheckoutCart = function () {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"GET\",\r\n                        url: \"/api/cart/checkout\"\r\n                    })\r\n                            .success(function (data) {\r\n                                def.resolve(data);\r\n                            })\r\n                            .error(function () {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n                    return def.promise;\r\n                };\r\n\r\n                var clearCart = function () {\r\n\r\n                    var def = $q.defer();\r\n\r\n                    $http({\r\n                        method: \"post\",\r\n                        url: \"/api/cart/clear\",\r\n                    })\r\n                            .success(function (data) {\r\n                                // console.log(data);\r\n                                def.resolve(data);\r\n                            })\r\n                            .error(function () {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                return {\r\n                    getCheckoutCart: getCheckoutCart,\r\n                    getCart: getCart,\r\n                    addCartItem: addCartItem,\r\n                    postToServer: postToServer,\r\n                    updateCartItem: updateCartItem,\r\n                    showBooking: showBooking,\r\n                    checkCart:checkCart,\r\n                    showConfirm: showConfirm,\r\n                    showConfirmExt: showConfirmExt,\r\n                    clearCart: clearCart,\r\n                    changeMerchant: changeMerchant\r\n                };\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXJ0LmpzP2YyMjYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXHJcbiAgICAgICAgLnNlcnZpY2UoJ0NhcnQnLCBbJyRxJywgJyRodHRwJywgJyRtZERpYWxvZycsICdNb2RhbHMnLCAnJGNvb2tpZXMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkcSwgJGh0dHAsICRtZERpYWxvZywgTW9kYWxzLCAkY29va2llcywgJHJvb3RTY29wZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzaG93Q29uZmlybSA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0TG9jYXRpb25Qcm9tcHQoKSkudGhlbihmdW5jdGlvbiAoYW5zd2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbnN3ZXIgPT0gXCJtYXBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgdXJsLCB7cGF0aDogXCIvXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9jYXRpb25cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbnN3ZXIgPT0gJ2FkZHJlc3MnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93QWR2YW5jZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBzaG93UXVlc3Rpb25haXJlID0gZnVuY3Rpb24gKHF1ZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRRdWVzdGlvbmFpcmVQb3B1cChxdWVzdGlvbnMpKS50aGVuKGZ1bmN0aW9uIChhbnN3ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJxdWVzdGlvbnNcIiwgYW5zd2VyKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBzaG93Q29uZmlybUV4dCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJsb2NhdGlvblJlZmZlcnJlclwiLCB1cmwsIHtwYXRoOiBcIi9cIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9jYXRpb25cIjtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tQcm9kdWN0ID0gZnVuY3Rpb24gKHZhcmlhbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNraW5nOiBcIiwgdmFyaWFudCwgJHJvb3RTY29wZS51c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFudC50eXBlID09IFwiYm9va2luZ1wiICYmICRyb290U2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBvaW50bWVudGJvb2sodmFyaWFudC5wcm9kdWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2sgcHJvZFwiLCAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYW50LmlzX3NoaXBwYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoZWNrTWVyY2hhbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja01lcmNoYW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGFwcG9pbnRtZW50Ym9vayA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHF1ZXN0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBsb2NhdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2YXJpYW50c1wiLCBpdGVtLnZhcmlhbnRzKVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gaXRlbS52YXJpYW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS52YXJpYW50X2lkID09IGl0ZW0udmFyaWFudHNbaV0uaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGl0ZW0udmFyaWFudHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbnRhaW5lclwiLCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmF0dHJpYnV0ZXMucXVlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbnMgPSBjb250YWluZXIuYXR0cmlidXRlcy5xdWVzdGlvbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5hdHRyaWJ1dGVzLmxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbiA9IGNvbnRhaW5lci5hdHRyaWJ1dGVzLmxvY2F0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXZhaWxhYmlsaXRpZXNcIjogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiTWVyY2hhbnRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3RJZFwiOiBpdGVtLm1lcmNoYW50X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdE5hbWVcIjogaXRlbS5tZXJjaGFudF9uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdERlc2NyaXB0aW9uXCI6IGl0ZW0ubWVyY2hhbnRfZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0SWNvblwiOiBpdGVtLm1lcmNoYW50X2ljb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhwZWN0ZWRQcmljZVwiOiBpdGVtLmFjdGl2ZVZhcmlhbnQucHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicXVlc3Rpb25zXCI6IHF1ZXN0aW9ucyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YXJpYW50XCI6IGNvbnRhaW5lcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9kdWN0X3ZhcmlhbnRfaWRcIjogaXRlbS52YXJpYW50X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IGl0ZW0uYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInB1cnBvc2VcIjogXCJleHRlcm5hbF9ib29rXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWxlcnRcIjpcIiNwcm9kLWNvbnQtXCIgKyBpdGVtLmlkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGxvY2F0aW9uKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmxvY2F0aW9uID0gbG9jYXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNob3dCb29raW5nKHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q2F0ZWdvcnlGcm9tVXJsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0aGVVcmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc2VnbWVudHMgPSB0aGVVcmwuc3BsaXQoXCIvXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNhdGVnb3J5ID0gc2VnbWVudHNbKHNlZ21lbnRzLmxlbmd0aCAtIDEpXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnkuaW5jbHVkZXMoXCI/XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5ID0gY2F0ZWdvcnkuc3BsaXQoXCI/XCIpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oY2F0ZWdvcnkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrTWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWVyY2hhbnRfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNhdGVnb3J5ID0gZ2V0Q2F0ZWdvcnlGcm9tVXJsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VhcmNoaW5nIGZvciBtZXJjaGFudHMgaW4gY2F0OlwiLCBjYXRlZ29yeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dNZXJjaGFudHMoY2F0ZWdvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlTWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNhdGVnb3J5ID0gZ2V0Q2F0ZWdvcnlGcm9tVXJsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWFyY2hpbmcgZm9yIG1lcmNoYW50cyBpbiBjYXQ6XCIsIGNhdGVnb3J5KTtcclxuICAgICAgICAgICAgICAgICAgICBzaG93TWVyY2hhbnRzKGNhdGVnb3J5KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgc2hvd0Jvb2tpbmcgPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldEJvb2tpbmdQcm9tcHQocGFyYW1zKSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IHJlc3VsdFwiLCAkcm9vdFNjb3BlLmNhcnRNZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdCgkcm9vdFNjb3BlLmNhcnRNZXNzYWdlLCAkKHBhcmFtcy5hbGVydCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZSgkcm9vdFNjb3BlLmNhcnRNZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IG5vdGhpbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgc2hvd0FkdmFuY2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRBZGRyZXNzZXNQb3B1cCgpKS50aGVuKGZ1bmN0aW9uIChhZGRyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IGFkZHJlc3NcIiwgYWRkcmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzID0gYWRkcmVzcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5sYXQgPSBhZGRyZXNzLmxhdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwic2hpcHBpbmdBZGRyZXNzXCIsIEpTT04uc3RyaW5naWZ5KGFkZHJlc3MpLCB7cGF0aDogXCIvXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IG5vdGhpbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrVmFyaWFudCA9IGZ1bmN0aW9uICh2YXJpYW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJWYXJpYW50XCIsIHZhcmlhbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYW50LmF0dHJpYnV0ZXMucXVlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dRdWVzdGlvbmFpcmUodmFyaWFudC5hdHRyaWJ1dGVzLnF1ZXN0aW9ucylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIHNob3dNZXJjaGFudHMgPSBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0TWVyY2hhbnRzUG9wdXAoY2F0ZWdvcnkpKS50aGVuKGZ1bmN0aW9uIChtZXJjaGFudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBtZXJjaGFudFwiLCBtZXJjaGFudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSBNb2RhbHMuZ2V0QWxsVXJsUGFyYW1zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGhlVXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGVVcmwuaW5jbHVkZXMoXCI/XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVVcmwgPSB0aGVVcmwuc3BsaXQoXCI/XCIpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5tZXJjaGFudF9pZCA9IG1lcmNoYW50LmlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaXJzdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgaW4gcGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmhhc093blByb3BlcnR5KGspKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVVybCA9IFwiP1wiICsgayArIFwiPVwiICsgcGFyYW1zW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVVybCA9IFwiJlwiICsgayArIFwiPVwiICsgcGFyYW1zW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB0aGVVcmw7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBub3RoaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBwb3N0VG9TZXJ2ZXIgPSBmdW5jdGlvbiAocG9zdERhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3QgdG8gc2VydmVyXCIsIHBvc3REYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NhcnQvYWRkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHBvc3REYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrQ2FydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3QgY2hlY2tDYXJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvY2FydC9jaGVja1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjaGVja0NhcnRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBhZGRDYXJ0SXRlbSA9IGZ1bmN0aW9uIChjb250YWluZXIsIGV4dHJhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2sgdmFyaWFudDogXCIsIGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSBjaGVja1Byb2R1Y3QoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIubWVyY2hhbnRfaWQgPSAkcm9vdFNjb3BlLm1lcmNoYW50X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGFpbmVyLml0ZW1faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgYWN0dlZhcmlhbnQgPSBjb250YWluZXIucHJvZHVjdC5hY3RpdmVWYXJpYW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZSh7c3RhdHVzOiBcInBlbmRpbmdfbG9jYXRpb25cIiwgbWVzc2FnZTogXCJtc2dcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3R2VmFyaWFudC5hdHRyaWJ1dGVzICYmIGFjdHZWYXJpYW50LmF0dHJpYnV0ZXMucXVlc3Rpb25zICYmIGFjdHZWYXJpYW50LnR5cGUgPT0gXCJwcm9kdWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRRdWVzdGlvbmFpcmVQb3B1cChhY3R2VmFyaWFudC5hdHRyaWJ1dGVzLnF1ZXN0aW9ucykpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gcmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IHJlc3VsdHNbaV0ubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogcmVzdWx0c1tpXS52YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaChjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcG9zdERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfdmFyaWFudF9pZDogY29udGFpbmVyLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogY29udGFpbmVyLm1lcmNoYW50X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogY29udGFpbmVyLnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBjb250YWluZXIuaXRlbV9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFzOiB7ZGF0YTogZGF0YX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RUb1NlcnZlcihwb3N0RGF0YSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZSh7c3RhdHVzOiBcInBlbmRpbmdfcXVlc3Rpb25zXCIsIG1lc3NhZ2U6IFwiRGViZXMgY29tcGxldGFyIGVzdGFzIHByZWd1bnRhcyBwYXJhIGNvbXByYXIgZXN0ZSBwcm9kdWN0b1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb3N0RGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3ZhcmlhbnRfaWQ6IGNvbnRhaW5lci5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogY29udGFpbmVyLm1lcmNoYW50X2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBjb250YWluZXIucXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogY29udGFpbmVyLml0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFzOiBleHRyYXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0VG9TZXJ2ZXIocG9zdERhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHBvc3RUb1NlcnZlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlQ2FydEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvY2FydC91cGRhdGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q2FydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvY2FydC9nZXRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBnZXRDaGVja291dENhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NhcnQvY2hlY2tvdXRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2xlYXJDYXJ0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9jYXJ0L2NsZWFyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2hlY2tvdXRDYXJ0OiBnZXRDaGVja291dENhcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2FydDogZ2V0Q2FydCxcclxuICAgICAgICAgICAgICAgICAgICBhZGRDYXJ0SXRlbTogYWRkQ2FydEl0ZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zdFRvU2VydmVyOiBwb3N0VG9TZXJ2ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2FydEl0ZW06IHVwZGF0ZUNhcnRJdGVtLFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3dCb29raW5nOiBzaG93Qm9va2luZyxcclxuICAgICAgICAgICAgICAgICAgICBjaGVja0NhcnQ6Y2hlY2tDYXJ0LFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtOiBzaG93Q29uZmlybSxcclxuICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUV4dDogc2hvd0NvbmZpcm1FeHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJDYXJ0OiBjbGVhckNhcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlTWVyY2hhbnQ6IGNoYW5nZU1lcmNoYW50XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXJ0LmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 34 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Categories',['$q', '$http', function ($q, $http) {\n\n            var getCategories = function (typeCategory) {\n                var url = \"/api/categories/\"+typeCategory;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                getCategories:getCategories,\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXRlZ29yaWVzLmpzP2RiZGMiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5zZXJ2aWNlKCdDYXRlZ29yaWVzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0Q2F0ZWdvcmllcyA9IGZ1bmN0aW9uICh0eXBlQ2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL2NhdGVnb3JpZXMvXCIrdHlwZUNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnZXRDYXRlZ29yaWVzOmdldENhdGVnb3JpZXMsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXRlZ29yaWVzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 35 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Food',['$q', '$http', function ($q, $http) {\n\n            var sendNewsletter = function () {\n                var url = '/api/food/newsletter' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to sendNewsletter\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getDeliveries = function (where) {\n                var url = '/api/food/deliveries' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getDeliveries\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getMenu = function (where) {\n                var url = '/api/food/menu' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getZones = function (where) {\n                var url = '/api/admin/zones' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getMessages = function (where) {\n                var url = '/api/food/messages' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getLargestAddresses = function () {\n                var url = '/api/food/largest_addresses' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getLargestAddresses\");\n                        });\n                return def.promise;\n            }\n            var delegateDeliveriesAddress = function (data) {\n                var url = '/api/food/delegate_deliveries' ;\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:data\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getLargestAddresses\");\n                        });\n                return def.promise;\n            }\n            \n            var updateDeliveryAddress = function (user,address) {\n                var url = '/api/food/user/'+user+\"/address/\"+address ;\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:{}\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to updateDeliveryAddress\");\n                        });\n                return def.promise;\n            }\n            var updateMissingDish = function (dish) {\n                var url = '/api/food/update_dish';\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:dish\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to updateDeliveryAddress\");\n                        });\n                return def.promise;\n            }\n            var buildScenarioRouteId = function (route_id) {\n                var url = '/api/food/build_route_id/'+route_id ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to buildScenarioRouteId\");\n                        });\n                return def.promise;\n            }\n            var buildScenarioPositive = function (scenario) {\n                var url = '/api/food/build_scenario_positive/'+scenario ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to buildScenarioPositive\");\n                        });\n                return def.promise;\n            }\n            var buildCompleteScenario = function (scenario) {\n                var url = '/api/food/build_complete_scenario/'+scenario ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to buildCompleteScenario\");\n                        });\n                return def.promise;\n            }\n            var getScenarioStructure = function (data) {\n                var url = '/api/food/get_scenario_structure';\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getScenarioStructure\");\n                        });\n                return def.promise;\n            }\n            var getSummaryShipping = function (status) {\n                var url = '/api/food/summary/'+status ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getSummaryShipping\");\n                        });\n                return def.promise;\n            }\n            var getScenarioOrganizationStructure = function (data) {\n                var url = '/api/food/route_organize' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getScenarioOrganizationStructure\");\n                        });\n                return def.promise;\n            }\n            var buildScenarioLogistics = function (data) {\n                var url = '/api/food/build_scenario_logistics' ;\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:data\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to buildScenarioLogistics\");\n                        });\n                return def.promise;\n            }\n            var getPurchaseOrder = function () {\n                var url = '/api/food/purchase_order' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getPurchaseOrder\");\n                        });\n                return def.promise;\n            }\n            var regenerateScenarios = function () {\n                var url = '/api/food/regenerate_scenarios';\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to regenerateScenarios\");\n                        });\n                return def.promise;\n            }\n            var regenerateDeliveries = function () {\n                var url = '/api/food/regenerate_deliveries';\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to regenerateDeliveries\");\n                        });\n                return def.promise;\n            }\n            var updateMenuItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/food/menu/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateMenuItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var updateZoneItem = function (item) {\n                console.log(\"Updating zone item\",item);\n                var def = $q.defer();\n                $http({\n                        method: 'PATCH',\n                        url: '/api/admin/zones/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var createZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/admin/zones',\n                        data: item, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to createZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var updateMessageItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/food/messages/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateMessageItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var sendReminder = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/food/reminder',\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to sendReminder\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteMessageItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/food/messages/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteMessageItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/zones/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteMenuItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/food/content/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteMenuItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getArticlesByDate = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/articles?start_date='+item\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to getArticlesByDate\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getMenu:getMenu,\n                getZones:getZones,\n                getPurchaseOrder:getPurchaseOrder,\n                delegateDeliveriesAddress:delegateDeliveriesAddress,\n                getMessages:getMessages,\n                getArticlesByDate:getArticlesByDate,\n                updateDeliveryAddress:updateDeliveryAddress,\n                buildScenarioLogistics:buildScenarioLogistics,\n                regenerateDeliveries:regenerateDeliveries,\n                getScenarioStructure:getScenarioStructure,\n                getSummaryShipping:getSummaryShipping,\n                buildScenarioRouteId:buildScenarioRouteId,\n                getDeliveries:getDeliveries,\n                sendReminder:sendReminder,\n                buildCompleteScenario:buildCompleteScenario,\n                regenerateScenarios:regenerateScenarios,\n                buildScenarioPositive:buildScenarioPositive,\n                updateZoneItem:updateZoneItem,\n                createZoneItem:createZoneItem,\n                updateMenuItem:updateMenuItem,\n                getScenarioOrganizationStructure:getScenarioOrganizationStructure, \n                updateMessageItem:updateMessageItem,\n                sendNewsletter:sendNewsletter,\n                deleteZoneItem:deleteZoneItem,\n                updateMissingDish:updateMissingDish,\n                deleteMenuItem:deleteMenuItem,\n                deleteMessageItem:deleteMessageItem,\n                getLargestAddresses:getLargestAddresses\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9mb29kLmpzPzNjODQiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIFxuICAgICAgICAuc2VydmljZSgnRm9vZCcsWyckcScsICckaHR0cCcsIGZ1bmN0aW9uICgkcSwgJGh0dHApIHtcblxuICAgICAgICAgICAgdmFyIHNlbmROZXdzbGV0dGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL25ld3NsZXR0ZXInIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNlbmROZXdzbGV0dGVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXREZWxpdmVyaWVzID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvZGVsaXZlcmllcycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgZ2V0RGVsaXZlcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TWVudSA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL21lbnUnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IGdldEFydGljbGVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRab25lcyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi96b25lcycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgZ2V0QXJ0aWNsZXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldE1lc3NhZ2VzID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvbWVzc2FnZXMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IGdldEFydGljbGVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRMYXJnZXN0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL2xhcmdlc3RfYWRkcmVzc2VzJyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgZ2V0TGFyZ2VzdEFkZHJlc3Nlc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZURlbGl2ZXJpZXNBZGRyZXNzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9kZWxlZ2F0ZV9kZWxpdmVyaWVzJyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6ZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgZ2V0TGFyZ2VzdEFkZHJlc3Nlc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHVwZGF0ZURlbGl2ZXJ5QWRkcmVzcyA9IGZ1bmN0aW9uICh1c2VyLGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC91c2VyLycrdXNlcitcIi9hZGRyZXNzL1wiK2FkZHJlc3MgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOnt9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZURlbGl2ZXJ5QWRkcmVzc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGRhdGVNaXNzaW5nRGlzaCA9IGZ1bmN0aW9uIChkaXNoKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvdXBkYXRlX2Rpc2gnO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRpc2hcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlRGVsaXZlcnlBZGRyZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJ1aWxkU2NlbmFyaW9Sb3V0ZUlkID0gZnVuY3Rpb24gKHJvdXRlX2lkKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvYnVpbGRfcm91dGVfaWQvJytyb3V0ZV9pZCA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBidWlsZFNjZW5hcmlvUm91dGVJZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBidWlsZFNjZW5hcmlvUG9zaXRpdmUgPSBmdW5jdGlvbiAoc2NlbmFyaW8pIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9idWlsZF9zY2VuYXJpb19wb3NpdGl2ZS8nK3NjZW5hcmlvIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGJ1aWxkU2NlbmFyaW9Qb3NpdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBidWlsZENvbXBsZXRlU2NlbmFyaW8gPSBmdW5jdGlvbiAoc2NlbmFyaW8pIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9idWlsZF9jb21wbGV0ZV9zY2VuYXJpby8nK3NjZW5hcmlvIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGJ1aWxkQ29tcGxldGVTY2VuYXJpb1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTY2VuYXJpb1N0cnVjdHVyZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvZ2V0X3NjZW5hcmlvX3N0cnVjdHVyZSc7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0U2NlbmFyaW9TdHJ1Y3R1cmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0U3VtbWFyeVNoaXBwaW5nID0gZnVuY3Rpb24gKHN0YXR1cykge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL3N1bW1hcnkvJytzdGF0dXMgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0U3VtbWFyeVNoaXBwaW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9yb3V0ZV9vcmdhbml6ZScgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczpkYXRhXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJ1aWxkU2NlbmFyaW9Mb2dpc3RpY3MgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL2J1aWxkX3NjZW5hcmlvX2xvZ2lzdGljcycgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYnVpbGRTY2VuYXJpb0xvZ2lzdGljc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRQdXJjaGFzZU9yZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL3B1cmNoYXNlX29yZGVyJyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRQdXJjaGFzZU9yZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlZ2VuZXJhdGVTY2VuYXJpb3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvcmVnZW5lcmF0ZV9zY2VuYXJpb3MnO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gcmVnZW5lcmF0ZVNjZW5hcmlvc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWdlbmVyYXRlRGVsaXZlcmllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9yZWdlbmVyYXRlX2RlbGl2ZXJpZXMnO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gcmVnZW5lcmF0ZURlbGl2ZXJpZXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlTWVudUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9mb29kL21lbnUvJytpdGVtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZU1lbnVJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGRhdGVab25lSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGluZyB6b25lIGl0ZW1cIixpdGVtKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3pvbmVzLycraXRlbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGl0ZW0sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byB1cGRhdGVab25lSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3JlYXRlWm9uZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZG1pbi96b25lcycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gY3JlYXRlWm9uZUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHVwZGF0ZU1lc3NhZ2VJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvZm9vZC9tZXNzYWdlcy8nK2l0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlTWVzc2FnZUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbmRSZW1pbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvZm9vZC9yZW1pbmRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNlbmRSZW1pbmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlTWVzc2FnZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2Zvb2QvbWVzc2FnZXMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVNZXNzYWdlSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlWm9uZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3pvbmVzLycraXRlbS5pZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlWm9uZUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZU1lbnVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9mb29kL2NvbnRlbnQvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVNZW51SXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0QXJ0aWNsZXNCeURhdGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FydGljbGVzP3N0YXJ0X2RhdGU9JytpdGVtXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRBcnRpY2xlc0J5RGF0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0TWVudTpnZXRNZW51LFxuICAgICAgICAgICAgICAgIGdldFpvbmVzOmdldFpvbmVzLFxuICAgICAgICAgICAgICAgIGdldFB1cmNoYXNlT3JkZXI6Z2V0UHVyY2hhc2VPcmRlcixcbiAgICAgICAgICAgICAgICBkZWxlZ2F0ZURlbGl2ZXJpZXNBZGRyZXNzOmRlbGVnYXRlRGVsaXZlcmllc0FkZHJlc3MsXG4gICAgICAgICAgICAgICAgZ2V0TWVzc2FnZXM6Z2V0TWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgZ2V0QXJ0aWNsZXNCeURhdGU6Z2V0QXJ0aWNsZXNCeURhdGUsXG4gICAgICAgICAgICAgICAgdXBkYXRlRGVsaXZlcnlBZGRyZXNzOnVwZGF0ZURlbGl2ZXJ5QWRkcmVzcyxcbiAgICAgICAgICAgICAgICBidWlsZFNjZW5hcmlvTG9naXN0aWNzOmJ1aWxkU2NlbmFyaW9Mb2dpc3RpY3MsXG4gICAgICAgICAgICAgICAgcmVnZW5lcmF0ZURlbGl2ZXJpZXM6cmVnZW5lcmF0ZURlbGl2ZXJpZXMsXG4gICAgICAgICAgICAgICAgZ2V0U2NlbmFyaW9TdHJ1Y3R1cmU6Z2V0U2NlbmFyaW9TdHJ1Y3R1cmUsXG4gICAgICAgICAgICAgICAgZ2V0U3VtbWFyeVNoaXBwaW5nOmdldFN1bW1hcnlTaGlwcGluZyxcbiAgICAgICAgICAgICAgICBidWlsZFNjZW5hcmlvUm91dGVJZDpidWlsZFNjZW5hcmlvUm91dGVJZCxcbiAgICAgICAgICAgICAgICBnZXREZWxpdmVyaWVzOmdldERlbGl2ZXJpZXMsXG4gICAgICAgICAgICAgICAgc2VuZFJlbWluZGVyOnNlbmRSZW1pbmRlcixcbiAgICAgICAgICAgICAgICBidWlsZENvbXBsZXRlU2NlbmFyaW86YnVpbGRDb21wbGV0ZVNjZW5hcmlvLFxuICAgICAgICAgICAgICAgIHJlZ2VuZXJhdGVTY2VuYXJpb3M6cmVnZW5lcmF0ZVNjZW5hcmlvcyxcbiAgICAgICAgICAgICAgICBidWlsZFNjZW5hcmlvUG9zaXRpdmU6YnVpbGRTY2VuYXJpb1Bvc2l0aXZlLFxuICAgICAgICAgICAgICAgIHVwZGF0ZVpvbmVJdGVtOnVwZGF0ZVpvbmVJdGVtLFxuICAgICAgICAgICAgICAgIGNyZWF0ZVpvbmVJdGVtOmNyZWF0ZVpvbmVJdGVtLFxuICAgICAgICAgICAgICAgIHVwZGF0ZU1lbnVJdGVtOnVwZGF0ZU1lbnVJdGVtLFxuICAgICAgICAgICAgICAgIGdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlOmdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlLCBcbiAgICAgICAgICAgICAgICB1cGRhdGVNZXNzYWdlSXRlbTp1cGRhdGVNZXNzYWdlSXRlbSxcbiAgICAgICAgICAgICAgICBzZW5kTmV3c2xldHRlcjpzZW5kTmV3c2xldHRlcixcbiAgICAgICAgICAgICAgICBkZWxldGVab25lSXRlbTpkZWxldGVab25lSXRlbSxcbiAgICAgICAgICAgICAgICB1cGRhdGVNaXNzaW5nRGlzaDp1cGRhdGVNaXNzaW5nRGlzaCxcbiAgICAgICAgICAgICAgICBkZWxldGVNZW51SXRlbTpkZWxldGVNZW51SXRlbSxcbiAgICAgICAgICAgICAgICBkZWxldGVNZXNzYWdlSXRlbTpkZWxldGVNZXNzYWdlSXRlbSxcbiAgICAgICAgICAgICAgICBnZXRMYXJnZXN0QWRkcmVzc2VzOmdldExhcmdlc3RBZGRyZXNzZXNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL2Zvb2QuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 36 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Groups',['$q', '$http', function ($q, $http) {\n\n            var getGroups = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/groups' \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveGroup = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/groups',\n                        data: data, // pass in data as strings\n                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            return {\n                saveGroup: saveGroup,\n                getGroups:getGroups\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9ncm91cHMuanM/OGVhMiJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgXG4gICAgICAgIC5zZXJ2aWNlKCdHcm91cHMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRHcm91cHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2dyb3VwcycgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzYXZlR3JvdXAgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9ncm91cHMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9ICAvLyBzZXQgdGhlIGhlYWRlcnMgc28gYW5ndWxhciBwYXNzaW5nIGluZm8gYXMgZm9ybSBkYXRhIChub3QgcmVxdWVzdCBwYXlsb2FkKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzYXZlR3JvdXA6IHNhdmVHcm91cCxcbiAgICAgICAgICAgICAgICBnZXRHcm91cHM6Z2V0R3JvdXBzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9ncm91cHMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 37 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Leads',['$q', '$http', function ($q, $http) {\n\n            var sendLead = function (data) {\n                var url = \"/api/leads\";\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:data\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to sendLead\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                sendLead:sendLead,\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9sZWFkcy5qcz84ZGQyIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuc2VydmljZSgnTGVhZHMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBzZW5kTGVhZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9sZWFkc1wiO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2VuZExlYWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzZW5kTGVhZDpzZW5kTGVhZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL2xlYWRzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 38 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('LocationService', ['$q', '$http', '$rootScope', function ($q, $http, $rootScope) {\n\n                var shared = function (where) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"get\",\n                        url: \"/api/locations\" + where,\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getCityFromLat = function (lat, longit) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"get\",\n                        headers: {\n                            'Content-Type': \"application/json\",\n                            'X-Auth-Token': undefined,\n                            'Authorization': undefined\n                        },\n                        url: \"http://maps.googleapis.com/maps/api/geocode/json?latlng=\" + lat + \",\" + longit + \"&sensor=true\",\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var merchants = function (data) {\n\n                    var def = $q.defer();\n                    console.log(\"Getting merchants\")\n                    console.log(JSON.stringify(data));\n                    $http({\n                        method: \"get\",\n                        url: \"/api/merchants/nearby\",\n                        params: data\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function (data) {\n                                console.log(JSON.stringify(data));\n                                def.reject(\"Failed to get nearby merchants\");\n                            });\n\n                    return def.promise;\n                };\n                var getLocationsTrip = function (data) {\n                    console.log(\"Get locations trip: /historic_locations?target_id=\" + data.user_id + \"&trip_id=\" + data.trip);\n                    var def = $q.defer();\n                    var url = \"/historic_locations?target_id=\" + data.user_id + \"&trip_id=\" + data.trip;\n                    if (data.page) {\n                        url = url + \"&page=\" + data.page;\n                    }\n                    if (data.perpage) {\n                        url = url + \"&per_page=\" + data.perpage;\n                    }\n                    $http.get(url)\n                            .success(function (res) {\n                                def.resolve(res);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getUserHash = function (  ) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"get\",\n                        url: \"/api/locations/hash\",\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function (data) {\n                                console.log(JSON.stringify(data));\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getCitiesRegion = function (regionId) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"get\",\n                        url: \"/api/cities?limit=50&region_id=\" + regionId,\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getCities = function (where) {\n                    var url = '/api/cities';\n                    if (where) {\n                        url = url + \"?\" + where;\n                    }\n                    var def = $q.defer();\n                    $http({\n                        method: \"get\",\n                        url: url,\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n                    return def.promise;\n                };\n                var getRegionFromCity = function (city) {\n                    var def = $q.defer();\n                    $http.post(\"/api/cities/from\", city\n                            )\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function (data) {\n                                def.reject(data);\n                            });\n\n                    return def.promise;\n                };\n                var getRegionsCountry = function (countryID) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"get\",\n                        url: \"/api/regions?limit=40&country_id=\" + countryID,\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getCountry = function (id) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"get\",\n                        url: \"/api/countries?id=\" + id,\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getCountries = function () {\n                    var def = $q.defer();\n                    $http({\n                        method: \"get\",\n                        url: \"/api/countries?limit=50&order_by=name,asc\",\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n\n                return {\n                    shared: shared,\n                    merchants: merchants,\n                    getCountries: getCountries,\n                    getCities:getCities,\n                    getUserHash: getUserHash,\n                    getCityFromLat: getCityFromLat,\n                    getRegionFromCity: getRegionFromCity,\n                    getLocationsTrip: getLocationsTrip,\n                    getCitiesRegion: getCitiesRegion,\n                    getRegionsCountry: getRegionsCountry,\n                    getCountry: getCountry,\n                    getRegionName: function (region_id) {\n                        for (region in $rootScope.regions) {\n                            var container = $rootScope.regions[region];\n                            if (container.id == parseInt(region_id)) {\n                                return container.name;\n                            }\n                        }\n                        return null;\n                    },\n                    isRegionsLoaded: function () {\n                        if ($rootScope.regions) {\n                            return true;\n                        } else {\n                            return false;\n                        }\n                    },\n                    isCountriesLoaded: function () {\n                        if ($rootScope.countries) {\n                            return true;\n                        } else {\n                            return false;\n                        }\n                    },\n                    getRegions: function () {\n                        return $rootScope.regions;\n                    }\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9sb2NhdGlvbi5qcz9mOGMwIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuc2VydmljZSgnTG9jYXRpb25TZXJ2aWNlJywgWyckcScsICckaHR0cCcsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRxLCAkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZCA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvbG9jYXRpb25zXCIgKyB3aGVyZSxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q2l0eUZyb21MYXQgPSBmdW5jdGlvbiAobGF0LCBsb25naXQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdYLUF1dGgtVG9rZW4nOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiaHR0cDovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvZ2VvY29kZS9qc29uP2xhdGxuZz1cIiArIGxhdCArIFwiLFwiICsgbG9uZ2l0ICsgXCImc2Vuc29yPXRydWVcIixcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgbWVyY2hhbnRzID0gZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXR0aW5nIG1lcmNoYW50c1wiKVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL21lcmNoYW50cy9uZWFyYnlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5IG1lcmNoYW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0TG9jYXRpb25zVHJpcCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGxvY2F0aW9ucyB0cmlwOiAvaGlzdG9yaWNfbG9jYXRpb25zP3RhcmdldF9pZD1cIiArIGRhdGEudXNlcl9pZCArIFwiJnRyaXBfaWQ9XCIgKyBkYXRhLnRyaXApO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IFwiL2hpc3RvcmljX2xvY2F0aW9ucz90YXJnZXRfaWQ9XCIgKyBkYXRhLnVzZXJfaWQgKyBcIiZ0cmlwX2lkPVwiICsgZGF0YS50cmlwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIiZwYWdlPVwiICsgZGF0YS5wYWdlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBlcnBhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCArIFwiJnBlcl9wYWdlPVwiICsgZGF0YS5wZXJwYWdlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBnZXRVc2VySGFzaCA9IGZ1bmN0aW9uICggICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2xvY2F0aW9ucy9oYXNoXCIsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGdldENpdGllc1JlZ2lvbiA9IGZ1bmN0aW9uIChyZWdpb25JZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NpdGllcz9saW1pdD01MCZyZWdpb25faWQ9XCIgKyByZWdpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGdldENpdGllcyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvY2l0aWVzJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIj9cIiArIHdoZXJlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBnZXRSZWdpb25Gcm9tQ2l0eSA9IGZ1bmN0aW9uIChjaXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KFwiL2FwaS9jaXRpZXMvZnJvbVwiLCBjaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBnZXRSZWdpb25zQ291bnRyeSA9IGZ1bmN0aW9uIChjb3VudHJ5SUQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9yZWdpb25zP2xpbWl0PTQwJmNvdW50cnlfaWQ9XCIgKyBjb3VudHJ5SUQsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBnZXRDb3VudHJ5ID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9jb3VudHJpZXM/aWQ9XCIgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGdldENvdW50cmllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NvdW50cmllcz9saW1pdD01MCZvcmRlcl9ieT1uYW1lLGFzY1wiLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZDogc2hhcmVkLFxuICAgICAgICAgICAgICAgICAgICBtZXJjaGFudHM6IG1lcmNoYW50cyxcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q291bnRyaWVzOiBnZXRDb3VudHJpZXMsXG4gICAgICAgICAgICAgICAgICAgIGdldENpdGllczpnZXRDaXRpZXMsXG4gICAgICAgICAgICAgICAgICAgIGdldFVzZXJIYXNoOiBnZXRVc2VySGFzaCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eUZyb21MYXQ6IGdldENpdHlGcm9tTGF0LFxuICAgICAgICAgICAgICAgICAgICBnZXRSZWdpb25Gcm9tQ2l0eTogZ2V0UmVnaW9uRnJvbUNpdHksXG4gICAgICAgICAgICAgICAgICAgIGdldExvY2F0aW9uc1RyaXA6IGdldExvY2F0aW9uc1RyaXAsXG4gICAgICAgICAgICAgICAgICAgIGdldENpdGllc1JlZ2lvbjogZ2V0Q2l0aWVzUmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICBnZXRSZWdpb25zQ291bnRyeTogZ2V0UmVnaW9uc0NvdW50cnksXG4gICAgICAgICAgICAgICAgICAgIGdldENvdW50cnk6IGdldENvdW50cnksXG4gICAgICAgICAgICAgICAgICAgIGdldFJlZ2lvbk5hbWU6IGZ1bmN0aW9uIChyZWdpb25faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAocmVnaW9uIGluICRyb290U2NvcGUucmVnaW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWluZXIgPSAkcm9vdFNjb3BlLnJlZ2lvbnNbcmVnaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmlkID09IHBhcnNlSW50KHJlZ2lvbl9pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpc1JlZ2lvbnNMb2FkZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpc0NvdW50cmllc0xvYWRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuY291bnRyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0UmVnaW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUucmVnaW9ucztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9sb2NhdGlvbi5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 39 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .factory('MapService', ['$q', '$rootScope', 'LocationService', function ($q, $rootScope, LocationService) {\n                var myLatlng;\n                var mapOptions;\n                $rootScope.map;\n                $rootScope.iconpath = \"http://hoovert.com/images/icons\";\n                $rootScope.markers = [];\n                $rootScope.polylines = [];\n                var infoWindow;\n\n                var createMap = function (latitude, longitude) {\n\n                    var myLatlng = new google.maps.LatLng(latitude, longitude);\n                    mapOptions = {\n                        center: myLatlng,\n                        zoom: 12,\n                        mapTypeId: google.maps.MapTypeId.ROADMAP\n                    };\n                    if (document.getElementById(\"map\")) {\n                        $rootScope.map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n                        infoWindow = new google.maps.InfoWindow();\n                        $rootScope.geocoder = new google.maps.Geocoder();\n                        $rootScope.mapActive = true;\n                        $rootScope.mapLoaded = true;\n                        $rootScope.tracking = true;\n                        $rootScope.mapSemaphore = true;\n                    }\n                }\n                var createMarker = function (info) {\n                    damap = $rootScope.map;\n                    console.log(\"info received in marker\");\n                    console.log(JSON.stringify(info));\n                    var pinclass = \"\";\n                    if (info.activity == \"still\") {\n                        pinclass = \"masculine-avatar.svg\";\n                        console.log(\"entro still\");\n                    } else if (info.activity == \"on_foot\") {\n                        console.log(\"entro on foot\");\n                        pinclass = \"pedestrian-walking.svg\";\n                    } else if (info.activity == \"in_vehicle\") {\n                        pinclass = \"car-front.svg\";\n                    } else if (info.activity == \"on_bicycle\") {\n                        pinclass = \"cycling.svg\";\n                    } else if (info.activity == \"running\") {\n                        pinclass = \"running.svg\";\n                    } else if (info.activity == \"\") {\n                        console.log(\"entro blank\");\n                        pinclass = \"map-pin.svg\";\n                    }\n                    var marker = new google.maps.Marker({\n                        id: info.id,\n                        user_id: info.user_id,\n                        position: new google.maps.LatLng(info.lat, info.long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        report_time: info.report_time,\n                        speed: info.speed,\n                        activity: info.activity,\n                        battery: info.battery,\n                        name: info.name,\n                        status: info.status,\n                        islast: info.islast,\n                        icon: {\n                            fillColor: '#ffffff',\n                            url: $rootScope.iconpath + \"/\" + pinclass,\n                            fillOpacity: 1,\n                            strokeColor: '#ffffff',\n                            strokeWeight: 0,\n                            scaledSize: new google.maps.Size(35, 35)\n                        }\n                    });\n                    marker.content = '<div class=\"infoWindowContent\">' + info.id + ' ' + info.name + '</div>';\n                    google.maps.event.addListener(marker, 'click', function () {\n                        infoWindow.setContent('<h2>' + marker.report_time + '</h2>' + marker.content);\n                        infoWindow.open($rootScope.map, marker);\n                    });\n                    return marker;\n                }\n                var createLocationMarker = function (lat, long, trigger) {\n                    damap = $rootScope.map;\n                    console.log(\"info received in marker\");\n                    var marker = new google.maps.Marker({\n                        position: new google.maps.LatLng(lat, long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        draggable: true,\n                    });\n                    google.maps.event.addListener(marker, 'dragend', function () {\n                        var location = marker.getPosition();\n                        setCenterMap(location.lat(), location.lng());\n                        getAddressAndPostal(location.lat(), location.lng(), 1);\n                    });\n                    if (trigger) {\n                        google.maps.event.trigger(marker, 'dragend');\n                    }\n                    $rootScope.locationMarker = marker;\n                    return marker;\n                }\n                var createReport = function (info) {\n                    damap = $rootScope.map;\n\n                    var marker = new google.maps.Marker({\n                        id: info.id,\n                        position: new google.maps.LatLng(info.lat, info.long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        created_at: info.created_at,\n                        name: info.name\n                    });\n                    marker.content = '<div class=\"infoWindowContent\">' + info.id + ' ' + info.name + '</div>';\n                    google.maps.event.addListener(marker, 'click', function () {\n                        infoWindow.setContent('<h2>' + marker.created_at + '</h2>' + marker.content);\n                        infoWindow.open($rootScope.map, marker);\n                    });\n                    return marker;\n                }\n                var createStop = function (stop) {\n                    damap = $rootScope.map;\n                    console.log(\"creating stop\", stop)\n                    var marker = new google.maps.Marker({\n                        id: stop.id,\n                        icon: stop.icon,\n                        position: new google.maps.LatLng(stop.lat, stop.long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        name: stop.name\n                    });\n                    marker.content = '<div class=\"infoWindowContent\">' + stop.id + ' ' + stop.name + '</div>';\n                    google.maps.event.addListener(marker, 'click', function () {\n                        infoWindow.setContent('<h2>' + marker.created_at + '</h2>' + marker.content);\n                        infoWindow.open($rootScope.map, marker);\n                    });\n                    return marker;\n                }\n                var createRoute = function (route, color) {\n                    damap = $rootScope.map;\n                    console.log(\"createRoute\", route)\n                    var flightPlanCoordinates = route.stopsLat;\n                    var flightPath = new google.maps.Polyline({\n                        path: flightPlanCoordinates,\n                        geodesic: true,\n                        strokeColor: color,\n                        strokeOpacity: 1.0,\n                        strokeWeight: 2\n                    });\n                    flightPath.setMap(damap);\n                    return flightPath;\n                }\n                var getColor = function () {\n                    var routeColors = [\"#FF0000\", \"#800000\", \"#FFFF00\", \"#808000\", \"#00FF00\", \"#008000\", \"#00FFFF\", \"#008080\", \"#0000FF\", \"#000080\", \"#FF00FF\", \"#800080\"];\n                    var random = Math.round(Math.random() * (routeColors.length - 1));\n                    return routeColors[random];\n                }\n                var createPolygon = function (zone, color) {\n                    damap = $rootScope.map;\n                    console.log(\"createRoute\", zone)\n                    var triangleCoords = JSON.parse(zone.coverage);\n\n                    // Construct the polygon.\n                    var bermudaTriangle = new google.maps.Polygon({\n                        id: zone.id,\n                        paths: triangleCoords,\n                        strokeColor: color,\n                        strokeOpacity: 0.8,\n                        editable: true,\n                        strokeWeight: 2,\n                        fillColor: '#FF0000',\n                        fillOpacity: 0.35,\n                        draggable: true,\n                        geodesic: true\n                    });\n                    bermudaTriangle.setMap(damap);\n                    bermudaTriangle.getPaths().forEach(function (path, index) {\n                        google.maps.event.addListener(path, 'insert_at', function () {\n                            console.log('zzinsert_at', zone.id);\n                            $rootScope.$broadcast(\"zone-updated\", zone);\n                            zone.isActive = true;\n                        });\n                        google.maps.event.addListener(path, 'remove_at', function () {\n                            console.log('zzinsert_at', zone.id);\n                            $rootScope.$broadcast(\"zone-updated\", zone);\n                            zone.isActive = true;\n                        });\n                        google.maps.event.addListener(path, 'set_at', function () {\n                            console.log('zzinsert_at', zone.id);\n                            $rootScope.$broadcast(\"zone-updated\", zone);\n                        });\n                    });\n\n                    google.maps.event.addListener(bermudaTriangle, 'dragend', function () {\n                        console.log('set_at.', bermudaTriangle.id);\n                    });\n                    return bermudaTriangle;\n                }\n\n                var consoleLogMarkers = function (damarkers) {\n                    for (marker in damarkers) {\n                        if (damarkers[marker]) {\n                            console.log(\"id: \" + damarkers[marker].id);\n                            console.log(\"speed: \" + damarkers[marker].speed);\n                            console.log(\"activity: \" + damarkers[marker].activity);\n                            console.log(\"battery: \" + damarkers[marker].battery);\n                            console.log(\"lat: \" + damarkers[marker].lat);\n                            console.log(\"long: \" + damarkers[marker].long);\n                            console.log(\"name: \" + damarkers[marker].name);\n                            console.log(\"type: \" + damarkers[marker].type);\n                            console.log(\"user_id: \" + damarkers[marker].user_id);\n                            console.log(\"report_time: \" + damarkers[marker].report_time);\n                        } else {\n                            console.log(\"Marker is null: \" + marker);\n                            console.log(damarkers[marker]);\n                        }\n\n                    }\n                }\n                var updateLocations = function (hash, page) {\n                    console.log(\"Updating locations\");\n                    if ($rootScope.mapActive) {\n                        console.log(\"Map Active\");\n                        if ($rootScope.mapSemaphore) {\n                            console.log(\"rootscope mapsemaphore true\");\n                            $rootScope.mapSemaphore = false;\n                            var where = \"?page=\" + page + \"&hash_id=\" + hash;\n                            getServerLocations(where, hash);\n                        }\n                    }\n                }\n                var deleteUserMarkers = function (dauser_id) {\n                    for (marker in $rootScope.markers) {\n                        if ($rootScope.markers[marker]) {\n                            if ($rootScope.markers[marker].user_id == dauser_id) {\n                                $rootScope.markers[marker].setMap(null);\n                                $rootScope.markers.splice(marker, 1);\n                            }\n                        } else {\n                            $rootScope.markers.splice(marker, 1);\n                        }\n                    }\n                }\n                var findUserInPolyline = function (dauser_id) {\n                    for (polyline in $rootScope.polylines) {\n                        if ($rootScope.polylines[polyline].user_id == dauser_id) {\n                            return $rootScope.polylines[polyline];\n                        }\n                    }\n                    return null;\n                };\n                var addToUserPolyline = function (info) {\n                    console.log(\"add user to polyline\");\n                    if (!$rootScope.mapLoaded) {\n                        $rootScope.mapLoaded = true;\n                        createMap(info.lat, info.long);\n                    }\n                    var coords = new google.maps.LatLng(info.lat, info.long);\n                    var poly = findUserInPolyline(info.user_id);\n                    if (poly) {\n                        deleteUserMarkers(info.user_id);\n                        console.log(\"pos added to existing poly\");\n                        var path = poly.getPath();\n                        path.push(coords);\n                        if (info.status == \"emergency\") {\n                            poly.status = \"emergency\";\n                        }\n                    } else {\n                        poly = new google.maps.Polyline({\n                            strokeColor: '#000000',\n                            strokeOpacity: 1.0,\n                            strokeWeight: 3,\n                            user_id: info.user_id,\n                            name: info.name,\n                            status: info.status,\n                            visible: true,\n                            isActive: false,\n                        });\n                        var path = poly.getPath();\n                        path.push(coords);\n                        poly.setMap($rootScope.map);\n                        console.log(\"new poly created and pos added: \" + poly.user_id);\n                        $rootScope.polylines.push(poly);\n                    }\n                    info.owner_type = \"user\";\n                    setCenterMap(info.lat, info.long);\n                    // Add a new marker at the new plotted point on the polyline.\n                    var marker = createMarker(info);\n                    $rootScope.activeMarker = marker;\n                    $rootScope.markers.push(marker);\n                };\n                var setCenterMap = function (lat, long) {\n                    console.log(\"Setting map center\");\n                    myLatlng = new google.maps.LatLng(lat, long);\n                    if ($rootScope.map) {\n                        $rootScope.map.setZoom(15);\n                        $rootScope.map.setCenter(myLatlng);\n                    }\n                }\n                var checkMarkers = function (info) {\n                    var i = 0;\n                    for (target in info) {\n                        if (info[target].id) {\n                            checkLocationExists(info[target]);\n                        }\n                    }\n                }\n                var checkLocationExists = function (location) {\n                    console.log(\"Checking database for location: \" + location.id);\n                    if ($rootScope.activeMarker) {\n                        if (location.id > $rootScope.activeMarker.id) {\n                            location.status = true;\n                            console.log(\"Location exists: \");\n                            addToUserPolyline(location);\n                        }\n                    } else {\n                        addToUserPolyline(location);\n                    }\n\n                };\n                var postMapLocation = function () {\n                    $rootScope.map.addListener('dblclick', function (e) {\n                        var location = e.latLng;\n                        $rootScope.locationMarker.setPosition(location);\n                        google.maps.event.trigger($rootScope.locationMarker, 'dragend');\n                        setCenterMap(location.lat(), location.lng());\n                        getAddressAndPostal(location.lat(), location.lng(), 1);\n                    });\n                    $rootScope.map.addListener('click', function (e) {\n                        var location = e.latLng;\n                        $rootScope.locationMarker.setPosition(location);\n                        google.maps.event.trigger($rootScope.locationMarker, 'dragend');\n                        setCenterMap(location.lat(), location.lng());\n                        getAddressAndPostal(location.lat(), location.lng(), 1);\n                    });\n                };\n\n                var decodeAddressFromLatResult = function (results) {\n\n                    var container = \"\";\n                    try {\n                        container = results[0].formatted_address;\n                    } catch (err) {\n\n                    }\n                    return container;\n                }\n                /**\n                 * prepares report data for creating a marker\n                 */\n                var decodePostalFromLatResult = function (results) {\n                    if (results.length > 0) {\n                        var container;\n                        var address = results[0]\n                        var found = false\n                        var i = 0;\n                        var components = address.address_components\n                        var postal = \"\";\n                        do {\n                            container = components[i]\n                            for (var item in container.types) {\n                                if (container.types[item] == \"postal_code\") {\n                                    postal = container.long_name;\n                                    found = true;\n                                }\n                            }\n                            i++;\n                            if (i >= results.length) {\n                                found = true;\n                            }\n                        } while (found == false);\n                        console.log(\"decodePostalFromLatResult\", postal);\n                        return postal;\n                    }\n\n                }\n                var decodeCityFromLatResult = function (results) {\n                    if (results.length > 0) {\n                        var container;\n                        var address = results[0]\n                        var found = false\n                        var i = 0;\n                        var components = address.address_components\n                        var city = \"\";\n                        do {\n                            container = components[i]\n                            for (var item in container.types) {\n                                if (container.types[item] == \"administrative_area_level_1\") {\n                                    city = container.long_name;\n                                    found = true;\n                                }\n                            }\n                            i++;\n                            if (i >= results.length) {\n                                found = true;\n                            }\n                        } while (found == false);\n                        console.log(\"decodeCityFromLatResult\", city);\n                        return city;\n                    }\n\n                }\n                var getAddressAndPostal = function (lat, long, attempts) {\n                    var this$1 = this;\n\n\n                    getAddressFromLat(lat, long).then(function (resp) {\n                        console.log(\"Address from lat\", resp);\n                        if (resp) {\n                            var city = decodeCityFromLatResult(resp);\n                            var where = \"name=\" + city;\n                            console.log(\"Address where\", where);\n                            LocationService.getCities(where).then(function (data) {\n                                console.log(\"Address data\", data);\n                                if (data.total > 0) {\n                                    var results = data.data;\n                                    var city = results[0];\n                                    $rootScope.isActive = false;\n                                    var container = {\n                                        address: decodeAddressFromLatResult(resp),\n                                        postal: decodePostalFromLatResult(resp),\n                                        lat: lat,\n                                        long: long,\n                                        city_id: city.id,\n                                        region_id: city.region_id,\n                                        country_id:1,\n                                        countryCode:\"CO\"\n                                    }\n                                    if($rootScope.shippingAddress){\n                                        $rootScope.shippingAddress.address = decodeAddressFromLatResult(resp);\n                                        $rootScope.shippingAddress.postal = decodePostalFromLatResult(resp);\n                                        $rootScope.shippingAddress.lat = lat;\n                                        $rootScope.shippingAddress.long = long;\n                                        $rootScope.shippingAddress.city_id = city.id;\n                                        $rootScope.shippingAddress.region_id = city.region_id;\n                                        $rootScope.shippingAddress.country_id = 1;\n                                    } else {\n                                        $rootScope.shippingAddress = container;\n                                    }\n                                    \n                                } else {\n                                    var container$1 = {\n                                        address: decodeAddressFromLatResult(resp),\n                                        postal: decodePostalFromLatResult(resp),\n                                        lat: lat,\n                                        long: long,\n                                        country_id:1\n                                    }\n                                    if($rootScope.shippingAddress){\n                                        $rootScope.shippingAddress.address = decodeAddressFromLatResult(resp);\n                                        $rootScope.shippingAddress.postal = decodePostalFromLatResult(resp);\n                                        $rootScope.shippingAddress.lat = lat;\n                                        $rootScope.shippingAddress.long = long;\n                                        $rootScope.shippingAddress.country_id = 1;\n                                    } else {\n                                        $rootScope.shippingAddress = container$1;\n                                    }\n                                }\n                            },\n                                    function (data) {\n                                        console.log(data);\n                                        var container = {\n                                            address: decodeAddressFromLatResult(resp),\n                                            postal: decodePostalFromLatResult(resp),\n                                            lat: lat,\n                                            long: long,\n                                            country_id:1\n                                        }\n                                        $rootScope.shippingAddress = container;\n                                    });\n                        } else {\n                            console.log(\"Attempts\", attempts);\n                            if (attempts < 8) {\n                                attempts++;\n                                var vm = this$1;\n                                setTimeout(function () {\n                                    vm.getAddressAndPostal(lat, long, attempts)\n                                }, 1000);\n                            }\n                        }\n\n                    }).catch(function (error) {\n                        console.log('Error getting location', error);\n                    });\n                }\n                var getAddressFromLat = function (lat, long) {\n                    var deferred = $q.defer();\n                    var latlng = {\n                        lat: parseFloat(lat),\n                        lng: parseFloat(long),\n                    };\n                    $rootScope.geocoder.geocode({location: latlng}, function (results, status) {\n                        if (status === \"OK\") {\n                            if (results[0]) {\n                                deferred.resolve(results);\n                            } else {\n                                deferred.resolve([]);\n                            }\n                        } else {\n                            window.alert(\"Geocoder failed due to: \" + status);\n                        }\n                    });\n                    return deferred.promise;\n                }\n                var getServerLocations = function (where, hash) {\n                    LocationService.shared(where).then(function (data) {\n                        if (data.total == 0) {\n                            $rootScope.isActive = false;\n                            alert(\"User has no active locations\");\n                        } else {\n                            var pins = data.data;\n                            checkMarkers(pins);\n                            if (data.page < data.last_page) {\n                                var dapage = data.page + 1;\n                                var where = \"?page=\" + dapage + \"&hash_id=\" + hash;\n                                getServerLocations(where, hash);\n                            } else {\n                                $rootScope.mapSemaphore = true;\n                                setTimeout(function () {\n                                    console.log(\"Timeout Triggered\");\n                                    updateLocations(hash, data.page);\n                                }, $rootScope.sharedTimeout);\n                            }\n                        }\n                    },\n                            function (data) {\n                                console.log(data);\n                            });\n                }\n                return {\n                    updateLocations: updateLocations,\n                    createMap: createMap,\n                    postMapLocation: postMapLocation,\n                    createStop: createStop,\n                    createRoute: createRoute,\n                    createLocationMarker: createLocationMarker,\n                    getColor: getColor,\n                    getAddressAndPostal: getAddressAndPostal,\n                    createPolygon: createPolygon,\n                    createReport: createReport\n                };\n            }])\n        //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tYXAuanM/MmFiOCJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgLmZhY3RvcnkoJ01hcFNlcnZpY2UnLCBbJyRxJywgJyRyb290U2NvcGUnLCAnTG9jYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkcm9vdFNjb3BlLCBMb2NhdGlvblNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXlMYXRsbmc7XG4gICAgICAgICAgICAgICAgdmFyIG1hcE9wdGlvbnM7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pY29ucGF0aCA9IFwiaHR0cDovL2hvb3ZlcnQuY29tL2ltYWdlcy9pY29uc1wiO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFya2VycyA9IFtdO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3c7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlTWFwID0gZnVuY3Rpb24gKGxhdGl0dWRlLCBsb25naXR1ZGUpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbXlMYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdGl0dWRlLCBsb25naXR1ZGUpO1xuICAgICAgICAgICAgICAgICAgICBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyOiBteUxhdGxuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IDEyLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKSwgbWFwT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudHJhY2tpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBTZW1hcGhvcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVNYXJrZXIgPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICBkYW1hcCA9ICRyb290U2NvcGUubWFwO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImluZm8gcmVjZWl2ZWQgaW4gbWFya2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShpbmZvKSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwaW5jbGFzcyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmFjdGl2aXR5ID09IFwic3RpbGxcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcIm1hc2N1bGluZS1hdmF0YXIuc3ZnXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVudHJvIHN0aWxsXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJvbl9mb290XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZW50cm8gb24gZm9vdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJwZWRlc3RyaWFuLXdhbGtpbmcuc3ZnXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5hY3Rpdml0eSA9PSBcImluX3ZlaGljbGVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcImNhci1mcm9udC5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmFjdGl2aXR5ID09IFwib25fYmljeWNsZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwiY3ljbGluZy5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmFjdGl2aXR5ID09IFwicnVubmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicnVubmluZy5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmFjdGl2aXR5ID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZW50cm8gYmxhbmtcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwibWFwLXBpbi5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogaW5mby5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IGluZm8udXNlcl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGluZm8ubGF0LCBpbmZvLmxvbmcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBkYW1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBvcnRfdGltZTogaW5mby5yZXBvcnRfdGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwZWVkOiBpbmZvLnNwZWVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHk6IGluZm8uYWN0aXZpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXR0ZXJ5OiBpbmZvLmJhdHRlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IGluZm8uc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNsYXN0OiBpbmZvLmlzbGFzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICRyb290U2NvcGUuaWNvbnBhdGggKyBcIi9cIiArIHBpbmNsYXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDM1LCAzNSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci5jb250ZW50ID0gJzxkaXYgY2xhc3M9XCJpbmZvV2luZG93Q29udGVudFwiPicgKyBpbmZvLmlkICsgJyAnICsgaW5mby5uYW1lICsgJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCc8aDI+JyArIG1hcmtlci5yZXBvcnRfdGltZSArICc8L2gyPicgKyBtYXJrZXIuY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4oJHJvb3RTY29wZS5tYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFya2VyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlTG9jYXRpb25NYXJrZXIgPSBmdW5jdGlvbiAobGF0LCBsb25nLCB0cmlnZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaW5mbyByZWNlaXZlZCBpbiBtYXJrZXJcIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG9uZyksXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IGRhbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2RyYWdlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbG9jYXRpb24gPSBtYXJrZXIuZ2V0UG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChsb2NhdGlvbi5sYXQoKSwgbG9jYXRpb24ubG5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzc0FuZFBvc3RhbChsb2NhdGlvbi5sYXQoKSwgbG9jYXRpb24ubG5nKCksIDEpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyaWdnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIobWFya2VyLCAnZHJhZ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubG9jYXRpb25NYXJrZXIgPSBtYXJrZXI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXJrZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVSZXBvcnQgPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICBkYW1hcCA9ICRyb290U2NvcGUubWFwO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpbmZvLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoaW5mby5sYXQsIGluZm8ubG9uZyksXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IGRhbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGluZm8uY3JlYXRlZF9hdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGluZm8ubmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLmNvbnRlbnQgPSAnPGRpdiBjbGFzcz1cImluZm9XaW5kb3dDb250ZW50XCI+JyArIGluZm8uaWQgKyAnICcgKyBpbmZvLm5hbWUgKyAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoJzxoMj4nICsgbWFya2VyLmNyZWF0ZWRfYXQgKyAnPC9oMj4nICsgbWFya2VyLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKCRyb290U2NvcGUubWFwLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZVN0b3AgPSBmdW5jdGlvbiAoc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBkYW1hcCA9ICRyb290U2NvcGUubWFwO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0aW5nIHN0b3BcIiwgc3RvcClcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHN0b3AuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiBzdG9wLmljb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzdG9wLmxhdCwgc3RvcC5sb25nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogZGFtYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc3RvcC5uYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXIuY29udGVudCA9ICc8ZGl2IGNsYXNzPVwiaW5mb1dpbmRvd0NvbnRlbnRcIj4nICsgc3RvcC5pZCArICcgJyArIHN0b3AubmFtZSArICc8L2Rpdj4nO1xuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudCgnPGgyPicgKyBtYXJrZXIuY3JlYXRlZF9hdCArICc8L2gyPicgKyBtYXJrZXIuY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4oJHJvb3RTY29wZS5tYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFya2VyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlUm91dGUgPSBmdW5jdGlvbiAocm91dGUsIGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlUm91dGVcIiwgcm91dGUpXG4gICAgICAgICAgICAgICAgICAgIHZhciBmbGlnaHRQbGFuQ29vcmRpbmF0ZXMgPSByb3V0ZS5zdG9wc0xhdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZsaWdodFBhdGggPSBuZXcgZ29vZ2xlLm1hcHMuUG9seWxpbmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogZmxpZ2h0UGxhbkNvb3JkaW5hdGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2VvZGVzaWM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VDb2xvcjogY29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6IDJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGZsaWdodFBhdGguc2V0TWFwKGRhbWFwKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZsaWdodFBhdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlQ29sb3JzID0gW1wiI0ZGMDAwMFwiLCBcIiM4MDAwMDBcIiwgXCIjRkZGRjAwXCIsIFwiIzgwODAwMFwiLCBcIiMwMEZGMDBcIiwgXCIjMDA4MDAwXCIsIFwiIzAwRkZGRlwiLCBcIiMwMDgwODBcIiwgXCIjMDAwMEZGXCIsIFwiIzAwMDA4MFwiLCBcIiNGRjAwRkZcIiwgXCIjODAwMDgwXCJdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKHJvdXRlQ29sb3JzLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlQ29sb3JzW3JhbmRvbV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVQb2x5Z29uID0gZnVuY3Rpb24gKHpvbmUsIGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlUm91dGVcIiwgem9uZSlcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyaWFuZ2xlQ29vcmRzID0gSlNPTi5wYXJzZSh6b25lLmNvdmVyYWdlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDb25zdHJ1Y3QgdGhlIHBvbHlnb24uXG4gICAgICAgICAgICAgICAgICAgIHZhciBiZXJtdWRhVHJpYW5nbGUgPSBuZXcgZ29vZ2xlLm1hcHMuUG9seWdvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogem9uZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhzOiB0cmlhbmdsZUNvb3JkcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZU9wYWNpdHk6IDAuOCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsbENvbG9yOiAnI0ZGMDAwMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsT3BhY2l0eTogMC4zNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlb2Rlc2ljOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBiZXJtdWRhVHJpYW5nbGUuc2V0TWFwKGRhbWFwKTtcbiAgICAgICAgICAgICAgICAgICAgYmVybXVkYVRyaWFuZ2xlLmdldFBhdGhzKCkuZm9yRWFjaChmdW5jdGlvbiAocGF0aCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHBhdGgsICdpbnNlcnRfYXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3p6aW5zZXJ0X2F0Jywgem9uZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KFwiem9uZS11cGRhdGVkXCIsIHpvbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvbmUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihwYXRoLCAncmVtb3ZlX2F0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd6emluc2VydF9hdCcsIHpvbmUuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChcInpvbmUtdXBkYXRlZFwiLCB6b25lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6b25lLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIocGF0aCwgJ3NldF9hdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnenppbnNlcnRfYXQnLCB6b25lLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoXCJ6b25lLXVwZGF0ZWRcIiwgem9uZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoYmVybXVkYVRyaWFuZ2xlLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZXRfYXQuJywgYmVybXVkYVRyaWFuZ2xlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiZXJtdWRhVHJpYW5nbGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNvbnNvbGVMb2dNYXJrZXJzID0gZnVuY3Rpb24gKGRhbWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiBkYW1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYW1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaWQ6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3BlZWQ6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0uc3BlZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWN0aXZpdHk6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0uYWN0aXZpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYmF0dGVyeTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5iYXR0ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImxhdDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5sYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9uZzogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5sb25nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5hbWU6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0eXBlOiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLnR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlcl9pZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlcG9ydF90aW1lOiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLnJlcG9ydF90aW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXJrZXIgaXMgbnVsbDogXCIgKyBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhbWFya2Vyc1ttYXJrZXJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB1cGRhdGVMb2NhdGlvbnMgPSBmdW5jdGlvbiAoaGFzaCwgcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIGxvY2F0aW9uc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFwQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1hcCBBY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBTZW1hcGhvcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJvb3RzY29wZSBtYXBzZW1hcGhvcmUgdHJ1ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3aGVyZSA9IFwiP3BhZ2U9XCIgKyBwYWdlICsgXCImaGFzaF9pZD1cIiArIGhhc2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U2VydmVyTG9jYXRpb25zKHdoZXJlLCBoYXNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlVXNlck1hcmtlcnMgPSBmdW5jdGlvbiAoZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdLnVzZXJfaWQgPT0gZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnNwbGljZShtYXJrZXIsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnNwbGljZShtYXJrZXIsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmaW5kVXNlckluUG9seWxpbmUgPSBmdW5jdGlvbiAoZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAocG9seWxpbmUgaW4gJHJvb3RTY29wZS5wb2x5bGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGFkZFRvVXNlclBvbHlsaW5lID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJhZGQgdXNlciB0byBwb2x5bGluZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLm1hcExvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTWFwKGluZm8ubGF0LCBpbmZvLmxvbmcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb29yZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGluZm8ubGF0LCBpbmZvLmxvbmcpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9seSA9IGZpbmRVc2VySW5Qb2x5bGluZShpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9seSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlVXNlck1hcmtlcnMoaW5mby51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicG9zIGFkZGVkIHRvIGV4aXN0aW5nIHBvbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHBvbHkuZ2V0UGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKGNvb3Jkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5zdGF0dXMgPT0gXCJlbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkuc3RhdHVzID0gXCJlbWVyZ2VuY3lcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkgPSBuZXcgZ29vZ2xlLm1hcHMuUG9seWxpbmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiAnIzAwMDAwMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlT3BhY2l0eTogMS4wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyX2lkOiBpbmZvLnVzZXJfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogaW5mby5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gcG9seS5nZXRQYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goY29vcmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkuc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmV3IHBvbHkgY3JlYXRlZCBhbmQgcG9zIGFkZGVkOiBcIiArIHBvbHkudXNlcl9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBvbHlsaW5lcy5wdXNoKHBvbHkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGluZm8ub3duZXJfdHlwZSA9IFwidXNlclwiO1xuICAgICAgICAgICAgICAgICAgICBzZXRDZW50ZXJNYXAoaW5mby5sYXQsIGluZm8ubG9uZyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBhIG5ldyBtYXJrZXIgYXQgdGhlIG5ldyBwbG90dGVkIHBvaW50IG9uIHRoZSBwb2x5bGluZS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IGNyZWF0ZU1hcmtlcihpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVNYXJrZXIgPSBtYXJrZXI7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgc2V0Q2VudGVyTWFwID0gZnVuY3Rpb24gKGxhdCwgbG9uZykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNldHRpbmcgbWFwIGNlbnRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgbXlMYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG9uZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcC5zZXRDZW50ZXIobXlMYXRsbmcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGVja01hcmtlcnMgPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodGFyZ2V0IGluIGluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvW3RhcmdldF0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja0xvY2F0aW9uRXhpc3RzKGluZm9bdGFyZ2V0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrTG9jYXRpb25FeGlzdHMgPSBmdW5jdGlvbiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVja2luZyBkYXRhYmFzZSBmb3IgbG9jYXRpb246IFwiICsgbG9jYXRpb24uaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5hY3RpdmVNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbi5pZCA+ICRyb290U2NvcGUuYWN0aXZlTWFya2VyLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uc3RhdHVzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvY2F0aW9uIGV4aXN0czogXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFRvVXNlclBvbHlsaW5lKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFRvVXNlclBvbHlsaW5lKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgcG9zdE1hcExvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcC5hZGRMaXN0ZW5lcignZGJsY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gZS5sYXRMbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmxvY2F0aW9uTWFya2VyLnNldFBvc2l0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIoJHJvb3RTY29wZS5sb2NhdGlvbk1hcmtlciwgJ2RyYWdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChsb2NhdGlvbi5sYXQoKSwgbG9jYXRpb24ubG5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzc0FuZFBvc3RhbChsb2NhdGlvbi5sYXQoKSwgbG9jYXRpb24ubG5nKCksIDEpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAuYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGUubGF0TG5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5sb2NhdGlvbk1hcmtlci5zZXRQb3NpdGlvbihsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRyb290U2NvcGUubG9jYXRpb25NYXJrZXIsICdkcmFnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRDZW50ZXJNYXAobG9jYXRpb24ubGF0KCksIGxvY2F0aW9uLmxuZygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEFkZHJlc3NBbmRQb3N0YWwobG9jYXRpb24ubGF0KCksIGxvY2F0aW9uLmxuZygpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBkZWNvZGVBZGRyZXNzRnJvbUxhdFJlc3VsdCA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSByZXN1bHRzWzBdLmZvcm1hdHRlZF9hZGRyZXNzO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIHByZXBhcmVzIHJlcG9ydCBkYXRhIGZvciBjcmVhdGluZyBhIG1hcmtlclxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHZhciBkZWNvZGVQb3N0YWxGcm9tTGF0UmVzdWx0ID0gZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhZGRyZXNzID0gcmVzdWx0c1swXVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb21wb25lbnRzID0gYWRkcmVzcy5hZGRyZXNzX2NvbXBvbmVudHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb3N0YWwgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbXBvbmVudHNbaV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIGNvbnRhaW5lci50eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnR5cGVzW2l0ZW1dID09IFwicG9zdGFsX2NvZGVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdGFsID0gY29udGFpbmVyLmxvbmdfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPj0gcmVzdWx0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKGZvdW5kID09IGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdFwiLCBwb3N0YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvc3RhbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWNvZGVDaXR5RnJvbUxhdFJlc3VsdCA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWRkcmVzcyA9IHJlc3VsdHNbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29tcG9uZW50cyA9IGFkZHJlc3MuYWRkcmVzc19jb21wb25lbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2l0eSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gY29tcG9uZW50c1tpXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gY29udGFpbmVyLnR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIudHlwZXNbaXRlbV0gPT0gXCJhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2l0eSA9IGNvbnRhaW5lci5sb25nX25hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID49IHJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IHdoaWxlIChmb3VuZCA9PSBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlY29kZUNpdHlGcm9tTGF0UmVzdWx0XCIsIGNpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNpdHk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0QWRkcmVzc0FuZFBvc3RhbCA9IGZ1bmN0aW9uIChsYXQsIGxvbmcsIGF0dGVtcHRzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzc0Zyb21MYXQobGF0LCBsb25nKS50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZHJlc3MgZnJvbSBsYXRcIiwgcmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaXR5ID0gZGVjb2RlQ2l0eUZyb21MYXRSZXN1bHQocmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdoZXJlID0gXCJuYW1lPVwiICsgY2l0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZHJlc3Mgd2hlcmVcIiwgd2hlcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRDaXRpZXMod2hlcmUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZGRyZXNzIGRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRvdGFsID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2l0eSA9IHJlc3VsdHNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3M6IGRlY29kZUFkZHJlc3NGcm9tTGF0UmVzdWx0KHJlc3ApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RhbDogZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdChyZXNwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXQ6IGxhdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb25nOiBsb25nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHlfaWQ6IGNpdHkuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uX2lkOiBjaXR5LnJlZ2lvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2lkOjEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeUNvZGU6XCJDT1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MuYWRkcmVzcyA9IGRlY29kZUFkZHJlc3NGcm9tTGF0UmVzdWx0KHJlc3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLnBvc3RhbCA9IGRlY29kZVBvc3RhbEZyb21MYXRSZXN1bHQocmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0ID0gbGF0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcgPSBsb25nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmNpdHlfaWQgPSBjaXR5LmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLnJlZ2lvbl9pZCA9IGNpdHkucmVnaW9uX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmNvdW50cnlfaWQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiBkZWNvZGVBZGRyZXNzRnJvbUxhdFJlc3VsdChyZXNwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0YWw6IGRlY29kZVBvc3RhbEZyb21MYXRSZXN1bHQocmVzcCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBsYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9uZzogbG9uZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2lkOjFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5hZGRyZXNzID0gZGVjb2RlQWRkcmVzc0Zyb21MYXRSZXN1bHQocmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MucG9zdGFsID0gZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdChyZXNwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQgPSBsYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZyA9IGxvbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeV9pZCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzID0gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogZGVjb2RlQWRkcmVzc0Zyb21MYXRSZXN1bHQocmVzcCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RhbDogZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdChyZXNwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBsYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvbmc6IGxvbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cnlfaWQ6MVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkF0dGVtcHRzXCIsIGF0dGVtcHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ZW1wdHMgPCA4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2bSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0uZ2V0QWRkcmVzc0FuZFBvc3RhbChsYXQsIGxvbmcsIGF0dGVtcHRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgZ2V0dGluZyBsb2NhdGlvbicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRBZGRyZXNzRnJvbUxhdCA9IGZ1bmN0aW9uIChsYXQsIGxvbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF0bG5nID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBwYXJzZUZsb2F0KGxhdCksXG4gICAgICAgICAgICAgICAgICAgICAgICBsbmc6IHBhcnNlRmxvYXQobG9uZyksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ2VvY29kZXIuZ2VvY29kZSh7bG9jYXRpb246IGxhdGxuZ30sIChyZXN1bHRzLCBzdGF0dXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IFwiT0tcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxlcnQoXCJHZW9jb2RlciBmYWlsZWQgZHVlIHRvOiBcIiArIHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldFNlcnZlckxvY2F0aW9ucyA9IGZ1bmN0aW9uICh3aGVyZSwgaGFzaCkge1xuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2Uuc2hhcmVkKHdoZXJlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS50b3RhbCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiVXNlciBoYXMgbm8gYWN0aXZlIGxvY2F0aW9uc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpbnMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tNYXJrZXJzKHBpbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPCBkYXRhLmxhc3RfcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGFwYWdlID0gZGF0YS5wYWdlICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCI/cGFnZT1cIiArIGRhcGFnZSArIFwiJmhhc2hfaWQ9XCIgKyBoYXNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2ZXJMb2NhdGlvbnMod2hlcmUsIGhhc2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2VtYXBob3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRpbWVvdXQgVHJpZ2dlcmVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlTG9jYXRpb25zKGhhc2gsIGRhdGEucGFnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sICRyb290U2NvcGUuc2hhcmVkVGltZW91dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVMb2NhdGlvbnM6IHVwZGF0ZUxvY2F0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTWFwOiBjcmVhdGVNYXAsXG4gICAgICAgICAgICAgICAgICAgIHBvc3RNYXBMb2NhdGlvbjogcG9zdE1hcExvY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVTdG9wOiBjcmVhdGVTdG9wLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVSb3V0ZTogY3JlYXRlUm91dGUsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxvY2F0aW9uTWFya2VyOiBjcmVhdGVMb2NhdGlvbk1hcmtlcixcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q29sb3I6IGdldENvbG9yLFxuICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzQW5kUG9zdGFsOiBnZXRBZGRyZXNzQW5kUG9zdGFsLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVQb2x5Z29uOiBjcmVhdGVQb2x5Z29uLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVSZXBvcnQ6IGNyZWF0ZVJlcG9ydFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XSlcbiAgICAgICAgXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvbWFwLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 40 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .factory('MapDashService',['$q', '$rootScope', 'LocationService', function ($q, $rootScope, LocationService) {\n            var myLatlng;\n            var mapOptions;\n            $rootScope.map;\n            $rootScope.iconpath = \"http://hoovert.com/images/icons\";\n            $rootScope.meicon = \"wasp.svg\";\n            $rootScope.markers = [];\n            $rootScope.polylines = [];\n            var infoWindow;\n\n            var createMap = function (element) {\n                var dalength = $rootScope.markers.length;\n                var zoom = 12;\n                var myLatlng = new google.maps.LatLng(4.704296, -74.073775);\n\n                mapOptions = {\n                    center: myLatlng,\n                    zoom: zoom,\n                    mapTypeId: google.maps.MapTypeId.ROADMAP,\n                };\n\n                var map = new google.maps.Map(document.getElementById(element), mapOptions);\n                infoWindow = new google.maps.InfoWindow();\n                if (element == \"map\") {\n                    $rootScope.mapActive = true;\n                    $rootScope.mapLoaded = true;\n                    $rootScope.mapSemaphore = true;\n                }\n\n\n                return map;\n            }\n            var setCenterMap = function (lat, long) {\n                console.log(\"Setting map center\");\n                myLatlng = new google.maps.LatLng(lat, long);\n                if ($rootScope.map) {\n                    $rootScope.map.setZoom(15);\n                    $rootScope.map.setCenter(myLatlng);\n                }\n            }\n            var getMarkers = function () {\n                return $rootScope.markers;\n            };\n            var getUserMarker = function (dauser_id) {\n                for (marker in $rootScope.markers) {\n                    var container = $rootScope.markers[marker];\n                    if (container.user_id == parseInt(dauser_id)) {\n                        return container;\n                    }\n                }\n                return null;\n            };\n\n            var findUserInPolyline = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline].user_id == dauser_id) {\n                        return $rootScope.polylines[polyline];\n                    }\n                }\n                return null;\n            };\n            var getUserPolyline = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline].user_id == dauser_id) {\n                        return $rootScope.polylines[polyline];\n                    }\n                }\n                return null;\n            };\n            var addToUserPolyline = function (info) {\n                console.log(\"add user to polyline\");\n                removeFromUnknowns(info.user_id);\n                if (info.islast == \"1\") {\n                    deleteUserObjects(info.user_id);\n                } else {\n                    var coords = new google.maps.LatLng(info.lat, info.long);\n                    var poly = findUserInPolyline(info.user_id);\n                    if (poly) {\n                        deleteUserMarkers(info.user_id);\n                        console.log(\"pos added to existing poly\");\n                        var path = poly.getPath();\n                        path.push(coords);\n                        if (info.status == \"emergency\") {\n                            poly.status = \"emergency\";\n                        }\n                    } else {\n\n                        poly = new google.maps.Polyline({\n                            strokeColor: '#000000',\n                            strokeOpacity: 1.0,\n                            strokeWeight: 3,\n                            user_id: info.user_id,\n                            name: info.name,\n                            status: info.status,\n                            visible: $rootScope.rootMapMarkers,\n                            isActive: false,\n                        });\n                        var path = poly.getPath();\n                        path.push(coords);\n                        if ($rootScope.rootMapMarkers) {\n                            poly.setMap($rootScope.map);\n                        } else {\n                            poly.setMap(null);\n                        }\n                        console.log(\"new poly created and pos added: \" + poly.user_id);\n                        $rootScope.polylines.push(poly);\n\n                    }\n                    info.owner_type = \"user\";\n                    checkActive(info);\n                    // Add a new marker at the new plotted point on the polyline.\n                    var marker = createMarker(info, $rootScope.rootMapMarkers);\n                    $rootScope.markers.push(marker);\n                }\n\n            };\n            var showAllPolylines = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    $rootScope.polylines[polyline].setMap($rootScope.map);\n                }\n            };\n            var showAllMerchants = function () {\n                for (marker in $rootScope.merchants) {\n                    $rootScope.merchants[marker].setMap($rootScope.map);\n                }\n            };\n            var showAllReports = function () {\n                for (marker in $rootScope.reports) {\n                    $rootScope.reports[marker].setMap($rootScope.map);\n                }\n                console.log(\"Done showing reports\");\n            };\n\n            var checkActive = function (info) {\n                console.log(\"Check active: \" + info.owner_type);\n                console.log(JSON.stringify(info));\n                console.log(\"Active type: \" + $rootScope.mapActiveType + \" id: \" + $rootScope.mapId);\n                if ($rootScope.mapActiveType) {\n\n                } else {\n                    $rootScope.mapActiveType = info.owner_type;\n                }\n                if ($rootScope.mapId) {\n\n                } else {\n                    $rootScope.mapId = info.user_id;\n                }\n                if ($rootScope.mapActiveType == info.owner_type) {\n                    console.log(\"type the same mapid: \" + $rootScope.mapId + \" user: \" + info.user_id);\n                    if ($rootScope.mapActiveType == \"me\") {\n                        setActive(\"me\", -1, null);\n                    }\n                    if ($rootScope.mapId == info.user_id) {\n                        console.log(\"Set center map, id the same\");\n                        setCenterMap(info.lat, info.long)\n                    }\n                }\n            };\n            var getNearbyMerchants = function (lat, lng) {\n                var location = {lat: lat, long: lng, radius: $rootScope.radius};\n                LocationService.merchants(location).then(function (data) {\n                    var pins = data.merchants;\n                    console.log(JSON.stringify(data));\n                    console.log(\"merchants received from server: \" + pins.length);\n                    if (pins.length == 0) {\n                        alert('No tenemos informacion de puntos de seguridad en ese punto');\n                    } else {\n                        cleanMerchants(data);\n                    }\n                },\n                        function (data) {\n                            console.log(data);\n                        });\n            };\n            var loadUserTrip = function (user_id, trip) {\n                $rootScope.rootMapMarkers = false;\n                contactTripLocations(user_id, trip).then(function (res) {\n                    console.log(\"locations in trip: \" + trip + \" count: \" + res.length);\n                    console.log(JSON.stringify(res));\n                    if (res.length > 0) {\n                        displayTrip(res);\n                    } else {\n                        alert('No encuentro ese viaje');\n                    }\n                },\n                        function (data) {\n                        });\n            };\n            var postMap = function () {\n                $rootScope.map.addListener('dblclick', function (e) {\n                    var location = e.latLng;\n                    setCenterMap(location.lat(), location.lng());\n                    getNearbyMerchants(location.lat(), location.lng());\n                });\n                if ($rootScope.memarkerpending) {\n                    console.log(\"me marker was created before map so loading now\");\n                    $rootScope.memarkerpending = false;\n                    $rootScope.memarker.setMap($rootScope.map);\n                }\n                if ($rootScope.merchantspending) {\n                    console.log(\"merchants were created before map so loading now\");\n                    showAllMerchants();\n                    showAllReports();\n                    $rootScope.merchantspending = false;\n                }\n                setActive($rootScope.mapActiveType, $rootScope.mapId, null);\n                alert('doble click para encontrar puntos de seguridad');\n            };\n            var setActive = function (type, id, latLng) {\n                console.log(\"Setting as active: \" + id + \" type: \" + type);\n                $rootScope.mapActiveType = type;\n                $rootScope.mapId = id;\n                window.localStorage.setItem(\"MAP_ACTIVE_TYPE\", type);\n                window.localStorage.setItem(\"MAP_ACTIVE_ID\", id);\n                if (latLng) {\n                    setCenterMap(latLng.lat(), latLng.lng());\n                } else {\n                    var centered = false;\n                    if (type == \"emergency\" || type == \"user\" || type == \"medical_emergency\" || type == \"me\") {\n                        $rootScope.tracking = true;\n                        $rootScope.rootMapMarkers = true;\n                        if (setVisibleUser($rootScope.mapId)) {\n                            centered = true\n                        }\n                    } else if (type == \"trip\") {\n                        var trip_id = $rootScope.contactTrip;\n                        var contact_id = $rootScope.contactIdTrip;\n                        loadUserTrip(contact_id, trip_id)\n                        centered = true;\n                    }\n                    if (!centered) {\n                        var markerslength = $rootScope.markers.length;\n                        if (markerslength > 0) {\n                            var marker = $rootScope.markers[markerslength - 1];\n                            if (marker) {\n                                var e = marker.getPosition();\n                                var location = e.latLng;\n                                if (location) {\n                                    setActive(\"user\", marker.user_id);\n                                    return true;\n                                }\n\n                            }\n                        }\n                    }\n                    if (!centered) {\n                        if ($rootScope.trackingActive) {\n                            if (type != \"me\") {\n                                setActive(\"me\", -1);\n                            }\n                            return true;\n                        }\n\n                    }\n                }\n            };\n\n            var cleanMerchants = function (data) {\n                var newmerchants = data.merchants;\n                for (merchant in newmerchants) {\n                    var found = false;\n                    for (marker in $rootScope.merchants) {\n                        if (newmerchants[merchant].id == $rootScope.merchants[marker].id) {\n                            found = true;\n                            break;\n                        }\n                    }\n                    if (found == false) {\n                        $rootScope.merchants.push(createMerchant(newmerchants[merchant]));\n                    }\n                }\n                var newreports = data.reports;\n                for (report in newreports) {\n                    var found = false;\n                    for (marker in $rootScope.reports) {\n                        if (newreports[report].id == $rootScope.reports[marker].id) {\n                            found = true;\n                            break;\n                        }\n                    }\n                    if (found == false) {\n                        newreports[report].type = \"Report\";\n                        $rootScope.reports.push(createMerchant(newreports[report]));\n                    }\n                }\n                return null;\n            }\n            var deleteUserObjects = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline]) {\n                        if ($rootScope.polylines[polyline].user_id = dauser_id) {\n                            deleteUserMarkers($rootScope.polylines[polyline].user_id);\n                            $rootScope.polylines[polyline].setMap(null);\n                            $rootScope.polylines.splice(polyline, 1);\n                        }\n                    }\n                }\n            };\n            var setVisibleUser = function (dauser_id) {\n                if (dauser_id > 0) {\n                    for (marker in $rootScope.markers) {\n                        if ($rootScope.markers[marker].user_id = dauser_id) {\n                            var latLng = $rootScope.markers[marker].getPosition();\n                            setCenterMap(latLng.lat(), latLng.lng());\n                            $rootScope.markers[marker].setMap($rootScope.map);\n                            return true;\n                        }\n                    }\n                } else {\n                    if ($rootScope.memarker) {\n                        var latLng = $rootScope.memarker.getPosition();\n                        setCenterMap(latLng.lat(), latLng.lng());\n                        return true;\n                    }\n\n                }\n                return false;\n\n            };\n            var hideAllPolylines = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline]) {\n                        $rootScope.polylines[polyline].setMap(null);\n                    }\n                }\n            };\n            var addToUnknowns = function (dauser_id) {\n                var found = false;\n                for (unknown in $rootScope.followingUnknown) {\n                    if ($rootScope.followingUnknown[unknown] == dauser_id) {\n                        found = true;\n                    }\n                }\n                if (found == false) {\n                    $rootScope.followingUnknown.push(dauser_id);\n                }\n            };\n            var removeFromUnknowns = function (dauser_id) {\n                for (unknown in $rootScope.followingUnknown) {\n                    if ($rootScope.followingUnknown[unknown] == dauser_id) {\n                        console.log(\"Removing user: \" + dauser_id + \" from unknowns\");\n                        $rootScope.followingUnknown.splice(unknown, 1);\n\n                        return true;\n                    }\n                }\n                return false;\n            };\n            var checkUnknownsMarker = function () {\n                if ($rootScope.followingUnknown.length > 0) {\n                    $rootScope.tracking = true;\n                    $rootScope.mapSemaphore = true;\n                    console.log(\"Unknown markers\");\n                    console.log(JSON.stringify($rootScope.followingUnknown));\n                    setTimeout(function () {\n                        console.log(\"Timeout Triggered unknowns\");\n                        updateLocations();\n                    }, $rootScope.sharedTimeout);\n                } else {\n                    window.localStorage.setItem(\"USER_TRACKING\", false);\n                    console.log(\"No one is sharing location with user\");\n                    $rootScope.$broadcast('NoSharers');\n                }\n            };\n            var createMarker = function (info, active) {\n                if (active && $rootScope.map) {\n                    damap = $rootScope.map;\n                } else {\n                    damap = null;\n                }\n                console.log(\"info received in marker\");\n                console.log(JSON.stringify(info));\n                var pinclass = \"\";\n                if (info.activity == \"still\") {\n                    pinclass = \"masculine-avatar.svg\";\n                    console.log(\"entro still\");\n                } else if (info.activity == \"on_foot\") {\n                    console.log(\"entro on foot\");\n                    pinclass = \"pedestrian-walking.svg\";\n                } else if (info.activity == \"in_vehicle\") {\n                    pinclass = \"car-front.svg\";\n                } else if (info.activity == \"on_bicycle\") {\n                    pinclass = \"cycling.svg\";\n                } else if (info.activity == \"running\") {\n                    pinclass = \"running.svg\";\n                } else if (info.activity == \"\") {\n                    console.log(\"entro blank\");\n                    pinclass = \"map-pin.svg\";\n                }\n                console.log(\"Icon path marker\");\n                console.log($rootScope.iconpath + \"/\" + pinclass);\n                var marker = new google.maps.Marker({\n                    id: info.id,\n                    user_id: info.user_id,\n                    position: new google.maps.LatLng(info.lat, info.long),\n                    map: damap,\n                    animation: google.maps.Animation.DROP,\n                    report_time: info.report_time,\n                    speed: info.speed,\n                    activity: info.activity,\n                    battery: info.battery,\n                    name: info.name,\n                    status: info.status,\n                    islast: info.islast,\n                    icon: {\n                        fillColor: '#ffffff',\n                        url: $rootScope.iconpath + \"/\" + pinclass,\n                        fillOpacity: 1,\n                        strokeColor: '#ffffff',\n                        strokeWeight: 0,\n                        scaledSize: new google.maps.Size(35, 35)\n                    }\n                });\n                marker.content = '<div class=\"infoWindowContent\">' + info.id + ' ' + info.name + '<br/><a onClick=\"window.open(\\'http://waze.to/?ll=' + info.lat + ',' + info.long\n                        + '&navigate=yes' + '\\',\\'_system\\',\\'location=yes\\');return false;\">Waze</a><br/><a href=\"tel:' + info.phone + '\">' + info.phone + '</a></div>';\n                google.maps.event.addListener(marker, 'click', function () {\n                    infoWindow.setContent('<h2>' + marker.report_time + '</h2>' + marker.content);\n                    infoWindow.open($rootScope.map, marker);\n                    var latlong = marker.getPosition();\n                    setActive(\"user\", marker.user_id, latlong);\n                });\n                if (info.status == \"emergency\") {\n                    var latLng = marker.getPosition();\n                    setActive(\"emergency\", info.user_id, latLng);\n                }\n\n                return marker;\n            }\n            var createMerchant = function (info) {\n                if ($rootScope.map) {\n                    damap = $rootScope.map;\n                } else {\n                    damap = null;\n                    $rootScope.merchantspending = true;\n                    console.log(\"Merchant pending from adding to map\");\n                }\n                var pinclass = \"\";\n                if (info.type == \"police\") {\n                    pinclass = \"police-shield.svg\";\n                } else if (info.type == \"medical\") {\n                    pinclass = \"medic-suitcase.svg\";\n                } else if (info.type == \"Report\") {\n                    pinclass = \"pin.svg\";\n                }\n                console.log(\"icon: \" + $rootScope.iconpath + \"/\" + pinclass + \" for type: \" + info.type);\n                var marker = new google.maps.Marker({\n                    id: info.id,\n                    position: new google.maps.LatLng(info.lat, info.long),\n                    map: damap,\n                    animation: google.maps.Animation.DROP,\n                    icon: {\n                        fillColor: '#ffffff',\n                        url: $rootScope.iconpath + \"/\" + pinclass,\n                        fillOpacity: 1,\n                        strokeColor: '#ffffff',\n                        strokeWeight: 0,\n                        scaledSize: new google.maps.Size(25, 25)\n                    }\n                });\n                marker.content = '<div class=\"infoWindowContent\">' + info.type + '<br/><a class=\"button icon-left ion-ios7-telephone button-calm button-outline\" href=\"tel:+ ' + info.telephone + '\">' + info.telephone + '</a><br/>' + info.address + '<br/><a onClick=\"window.open(\\'http://waze.to/?ll=' + info.lat + ',' + info.long + '&navigate=yes' + '\\',\\'_system\\',\\'location=yes\\');return false;\">Waze</a></div>';\n                var pinclass = \"\";\n                if (info.type == \"police\") {\n                    pinclass = \"map-icon-police\";\n                } else if (info.type == \"medical\") {\n                    pinclass = \"map-icon-health\";\n                } else if (info.type == \"Report\") {\n                    pinclass = \"map-icon-report\";\n                    marker.content = '<div class=\"infoWindowContent\">' + info.type + '<br/>' + info.address + '<br/><a onClick=\"window.open(\\'http://waze.to/?ll=' + info.lat + ',' + info.long + '&navigate=yes' + '\\',\\'_system\\',\\'location=yes\\');return false;\">Waze</a></div>';\n                }\n                console.log(\"creating merchant\");\n                var infoWindow = new google.maps.InfoWindow();\n\n                google.maps.event.addListener(marker, 'click', function () {\n                    infoWindow.setContent('<h2>' + info.name + '</h2>' + marker.content);\n                    infoWindow.open($rootScope.map, marker);\n                });\n                return marker;\n            }\n            var checkMarkers = function (info) {\n                var def = $q.defer();\n                var i = 0;\n                for (target in info) {\n                    if (info[target].id) {\n                        i++;\n                        if ($rootScope.lastLocation < info[target].id) {\n                            $rootScope.lastLocation = info[target].id;\n                        }\n                        checkLocationExists(info[target]).then(function (res) {\n                            i--;\n                            if (i == 0) {\n                                def.resolve(\"done\");\n                            }\n                        }, function (err) {\n                            console.log(\"Error in checking locations\");\n                            console.error(JSON.stringify(err));\n                            i--;\n                            if (i == 0) {\n                                def.resolve(\"done\");\n                            }\n                        });\n                    }\n                }\n                return def.promise;\n            }\n            var deleteUserMarkers = function (dauser_id) {\n                for (marker in $rootScope.markers) {\n                    if ($rootScope.markers[marker]) {\n                        if ($rootScope.markers[marker].user_id == dauser_id) {\n                            $rootScope.markers[marker].setMap(null);\n                            $rootScope.markers.splice(marker, 1);\n                        }\n                    } else {\n                        $rootScope.markers.splice(marker, 1);\n                    }\n                }\n            }\n            var hideAllActiveMarkers = function () {\n                hideMarkers($rootScope.markers);\n                hideAllPolylines();\n            }\n            var hideMarkers = function (damarkers) {\n                for (marker in damarkers) {\n                    if (damarkers[marker]) {\n                        damarkers[marker].setMap(null);\n                    }\n                }\n            }\n            var clearTemps = function () {\n                if ($rootScope.tempMarkers) {\n                    for (marker in $rootScope.tempMarkers) {\n                        if ($rootScope.tempMarkers[marker]) {\n                            $rootScope.tempMarkers[marker].setMap(null);\n                        }\n                    }\n                    $rootScope.tempMarkers = [];\n                }\n                if ($rootScope.tempPolyline) {\n                    $rootScope.tempPolyline.setMap(null);\n                    $rootScope.tempPolyline = null;\n                }\n            }\n            var showAllActiveMarkers = function () {\n                showMarkers($rootScope.markers);\n                showAllPolylines();\n            }\n            var showMarkers = function (damarkers) {\n                for (marker in damarkers) {\n                    if (damarkers[marker]) {\n                        damarkers[marker].setMap($rootScope.map);\n                    }\n                }\n            }\n            var consoleLogMarkers = function (damarkers) {\n                for (marker in damarkers) {\n                    if (damarkers[marker]) {\n                        console.log(\"id: \" + damarkers[marker].id);\n                        console.log(\"speed: \" + damarkers[marker].speed);\n                        console.log(\"activity: \" + damarkers[marker].activity);\n                        console.log(\"battery: \" + damarkers[marker].battery);\n                        console.log(\"lat: \" + damarkers[marker].lat);\n                        console.log(\"long: \" + damarkers[marker].long);\n                        console.log(\"name: \" + damarkers[marker].name);\n                        console.log(\"trip: \" + damarkers[marker].trip);\n                        console.log(\"type: \" + damarkers[marker].type);\n                        console.log(\"user_id: \" + damarkers[marker].user_id);\n                        console.log(\"report_time: \" + damarkers[marker].report_time);\n                    } else {\n                        console.log(\"Marker is null: \" + marker);\n                        console.log(damarkers[marker]);\n                    }\n\n                }\n            }\n            var getMarker = function (daid) {\n                console.log($rootScope.markers.length);\n                for (marker in $rootScope.markers) {\n                    console.log(\"Comparing markers\");\n                    if ($rootScope.markers[marker]) {\n                        console.log($rootScope.markers[marker].id);\n                        console.log(daid);\n                        if ($rootScope.markers[marker].id == daid) {\n                            console.log(\"Marker found, returning now\");\n                            return $rootScope.markers[marker];\n                        }\n                    } else {\n                        $rootScope.markers.splice(marker, 1);\n                    }\n\n                }\n                return null;\n            }\n\n            var checkLocationExists = function (location) {\n                var def = $q.defer();\n                console.log(\"Checking database for location: \" + location.id);\n                var found = false;\n                for (item in $rootScope.markers) {\n                    if ($rootScope.markers[item].id == location.id) {\n                        found = true;\n                    }\n                }\n                if (found) {\n                    location.status = true;\n                    console.log(\"Location exists: \");\n                    var marker = getUserMarker(location.user_id);\n                    if (marker) {\n                        console.log(\"User Marker Found\");\n                        if (marker.id >= location.id) {\n                            console.log(\"User Marker older\");\n                        } else {\n                            console.log(\"User Marker newer\");\n                            addToUserPolyline(location);\n                        }\n                    } else {\n                        console.log(\"Marker does not exist\");\n                        addToUserPolyline(location);\n                    }\n                    def.resolve(location);\n                } else {\n                    location.status = true;\n\n                    console.log(\"Location does not exists\");\n                    addToUserPolyline(location);\n                }\n                return def.promise;\n            };\n            var contactTrips = function (user_id, page, per_page) {\n                var offset = (page - 1) * per_page;\n                console.log(\"Trying sql contactTrips not implemented yet\");\n\n            };\n            var contactTripsCount = function (user_id) {\n                console.log(\"Trying sql user trips not implemented yet\");\n                var query = \"SELECT COUNT(id) as total FROM locations where user_id = ?  group by trip\";\n            };\n            var displayTrip = function (res) {\n                var flightPlanCoordinates = [\n                ];\n                var container;\n                if ($rootScope.tempMarkers) {\n                    hideMarkers($rootScope.tempMarkers);\n\n                }\n                $rootScope.tempMarkers = [];\n                console.log(\"Showing markers: \" + res.length);\n                console.log(JSON.stringify(res));\n                var coords;\n                var trip;\n                var user;\n                for (i = 0; i < res.length; i++) {\n                    if (res[i]) {\n                        coords = new google.maps.LatLng(res[i].lat, res[i].long);\n                        console.log(\"Showing marker: \");\n                        trip = res[i].trip;\n                        user = res[i].user_id;\n                        marker = createMarker(res[i], true);\n                        $rootScope.tempMarkers.push(marker);\n                        flightPlanCoordinates.push(coords);\n                        container = res[i];\n                    }\n                }\n                $rootScope.contactIdTrip = user;\n                $rootScope.contactTrip = trip;\n                setCenterMap(coords.lat(), coords.lng());\n                var flightPath = new google.maps.Polyline({\n                    path: flightPlanCoordinates,\n                    geodesic: true,\n                    strokeColor: '#FF0000',\n                    strokeOpacity: 1.0,\n                    strokeWeight: 2,\n                    user_id: container.user_id,\n                    name: container.name,\n                    status: \"closed\",\n                });\n                if ($rootScope.tempPolyline) {\n                    $rootScope.tempPolyline.setMap(null);\n                    $rootScope.tempPolyline = null;\n                }\n                flightPath.setMap($rootScope.map);\n                $rootScope.tempPolyline = flightPath;\n            };\n\n            var contactTripLocations = function (user_id, trip_id) {\n                console.log(\"contact trip locations not implemented at present: \" + user_id + \" trip: \" + trip_id);\n\n            };\n            var updateLocations = function () {\n                console.log(\"Updating locations\");\n                if ($rootScope.tracking) {\n                    console.log(\"rootscope tracking true\");\n                    if ($rootScope.mapSemaphore) {\n                        console.log(\"rootscope mapsemaphore true\");\n                        $rootScope.mapSemaphore = false;\n                        var lastLocation = $rootScope.lastLocation;\n                        var dapage = 1;\n                        var where = \"?page=\" + dapage + \"&id_after=\" + lastLocation;\n                        getServerLocations(where, lastLocation);\n                    } else {\n                        checkUnknownsMarker();\n                    }\n                } else {\n                    checkUnknownsMarker();\n                }\n\n            }\n            var saveTrip = function (trip) {\n                console.log(\"saveTrip: \");\n                console.log(JSON.stringify(trip));\n                LocationService.getLocationsTrip(trip)\n                        .then(function (data) {\n                            var pins = data.data;\n                            console.log(\"Locations received from server: \" + pins.length);\n                            console.log(JSON.stringify(pins));\n                            checkMarkers(pins);\n                            if (data.page < data.last_page) {\n                                if (data.page == 4) {\n                                    $rootScope.$broadcast('receivedTripDetail', {trigger_id: trip.user_id});\n                                    return;\n                                } else {\n                                    trip.page = data.page + 1;\n                                    saveTrip(trip);\n                                }\n\n                            } else {\n                                $rootScope.$broadcast('receivedTripDetail', {trigger_id: trip.user_id});\n                            }\n\n                        },\n                                function (data) {\n                                    console.log(data);\n                                });\n            }\n            var getServerLocations = function (where, idafter) {\n                LocationService.shared(where).then(function (data) {\n                    if (data.total == 0) {\n                        checkUnknownsMarker();\n                    } else {\n                        var pins = data.data;\n                        pins.reverse();\n                        checkMarkers(pins).then(function (data) {\n                            $rootScope.mapSharedLoaded = true;\n                        },\n                                function (data) {\n                                    console.log(data);\n                                });\n                        if (data.page < data.last_page) {\n                            var dapage = data.page + 1;\n                            var where = \"?page=\" + dapage + \"&id_after=\" + idafter;\n                            getServerLocations(where, idafter);\n                        } else {\n                            $rootScope.mapSemaphore = true;\n                            setTimeout(function () {\n                                console.log(\"Timeout Triggered\");\n                                updateLocations();\n                            }, $rootScope.sharedTimeout);\n                        }\n                    }\n                },\n                        function (data) {\n                            console.log(data);\n                        });\n            }\n            return {\n                createMarker: createMarker,\n                clearTemps: clearTemps,\n                createMap: createMap,\n                getNearbyMerchants: getNearbyMerchants,\n                contactTripsCount: contactTripsCount,\n                deleteUserObjects: deleteUserObjects,\n                deleteUserMarkers: deleteUserMarkers,\n                getUserPolyline: getUserPolyline,\n                saveTrip: saveTrip,\n                checkMarkers: checkMarkers,\n                contactTripLocations: contactTripLocations,\n                contactTrips: contactTrips,\n                consoleLogMarkers: consoleLogMarkers,\n                getMarker: getMarker,\n                hideAllActiveMarkers: hideAllActiveMarkers,\n                hideMarkers: hideMarkers,\n                showAllActiveMarkers: showAllActiveMarkers,\n                showMarkers: showMarkers,\n                updateLocations: updateLocations,\n                getMarkers: getMarkers,\n                getUserMarker: getUserMarker,\n                displayTrip: displayTrip,\n                addToUnknowns: addToUnknowns,\n                removeFromUnknowns: removeFromUnknowns,\n                setActive: setActive,\n                checkActive: checkActive,\n                postMap: postMap\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tYXBEYXNoLmpzP2RhYmUiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5mYWN0b3J5KCdNYXBEYXNoU2VydmljZScsWyckcScsICckcm9vdFNjb3BlJywgJ0xvY2F0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJHJvb3RTY29wZSwgTG9jYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbXlMYXRsbmc7XG4gICAgICAgICAgICB2YXIgbWFwT3B0aW9ucztcbiAgICAgICAgICAgICRyb290U2NvcGUubWFwO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5pY29ucGF0aCA9IFwiaHR0cDovL2hvb3ZlcnQuY29tL2ltYWdlcy9pY29uc1wiO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5tZWljb24gPSBcIndhc3Auc3ZnXCI7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzID0gW107XG4gICAgICAgICAgICB2YXIgaW5mb1dpbmRvdztcblxuICAgICAgICAgICAgdmFyIGNyZWF0ZU1hcCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhbGVuZ3RoID0gJHJvb3RTY29wZS5tYXJrZXJzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IDEyO1xuICAgICAgICAgICAgICAgIHZhciBteUxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoNC43MDQyOTYsIC03NC4wNzM3NzUpO1xuXG4gICAgICAgICAgICAgICAgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyOiBteUxhdGxuZyxcbiAgICAgICAgICAgICAgICAgICAgem9vbTogem9vbSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudCksIG1hcE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ID09IFwibWFwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcExvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2VtYXBob3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHJldHVybiBtYXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2V0Q2VudGVyTWFwID0gZnVuY3Rpb24gKGxhdCwgbG9uZykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBtYXAgY2VudGVyXCIpO1xuICAgICAgICAgICAgICAgIG15TGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXQsIGxvbmcpO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcCkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcC5zZXRab29tKDE1KTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAuc2V0Q2VudGVyKG15TGF0bG5nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TWFya2VycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5tYXJrZXJzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBnZXRVc2VyTWFya2VyID0gZnVuY3Rpb24gKGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIudXNlcl9pZCA9PSBwYXJzZUludChkYXVzZXJfaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGZpbmRVc2VySW5Qb2x5bGluZSA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGdldFVzZXJQb2x5bGluZSA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGFkZFRvVXNlclBvbHlsaW5lID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFkZCB1c2VyIHRvIHBvbHlsaW5lXCIpO1xuICAgICAgICAgICAgICAgIHJlbW92ZUZyb21Vbmtub3ducyhpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgIGlmIChpbmZvLmlzbGFzdCA9PSBcIjFcIikge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVVc2VyT2JqZWN0cyhpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb29yZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGluZm8ubGF0LCBpbmZvLmxvbmcpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9seSA9IGZpbmRVc2VySW5Qb2x5bGluZShpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9seSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlVXNlck1hcmtlcnMoaW5mby51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicG9zIGFkZGVkIHRvIGV4aXN0aW5nIHBvbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHBvbHkuZ2V0UGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKGNvb3Jkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5zdGF0dXMgPT0gXCJlbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkuc3RhdHVzID0gXCJlbWVyZ2VuY3lcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcG9seSA9IG5ldyBnb29nbGUubWFwcy5Qb2x5bGluZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjMDAwMDAwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IGluZm8udXNlcl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBpbmZvLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBwb2x5LmdldFBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChjb29yZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUucm9vdE1hcE1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2x5LnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJuZXcgcG9seSBjcmVhdGVkIGFuZCBwb3MgYWRkZWQ6IFwiICsgcG9seS51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzLnB1c2gocG9seSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmZvLm93bmVyX3R5cGUgPSBcInVzZXJcIjtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tBY3RpdmUoaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBhIG5ldyBtYXJrZXIgYXQgdGhlIG5ldyBwbG90dGVkIHBvaW50IG9uIHRoZSBwb2x5bGluZS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IGNyZWF0ZU1hcmtlcihpbmZvLCAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnB1c2gobWFya2VyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2hvd0FsbFBvbHlsaW5lcyA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzW3BvbHlsaW5lXS5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2hvd0FsbE1lcmNoYW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLm1lcmNoYW50cykge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1lcmNoYW50c1ttYXJrZXJdLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBzaG93QWxsUmVwb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLnJlcG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5yZXBvcnRzW21hcmtlcl0uc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEb25lIHNob3dpbmcgcmVwb3J0c1wiKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBjaGVja0FjdGl2ZSA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVjayBhY3RpdmU6IFwiICsgaW5mby5vd25lcl90eXBlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShpbmZvKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBY3RpdmUgdHlwZTogXCIgKyAkcm9vdFNjb3BlLm1hcEFjdGl2ZVR5cGUgKyBcIiBpZDogXCIgKyAkcm9vdFNjb3BlLm1hcElkKTtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBBY3RpdmVUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcEFjdGl2ZVR5cGUgPSBpbmZvLm93bmVyX3R5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcElkKSB7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcElkID0gaW5mby51c2VyX2lkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBBY3RpdmVUeXBlID09IGluZm8ub3duZXJfdHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInR5cGUgdGhlIHNhbWUgbWFwaWQ6IFwiICsgJHJvb3RTY29wZS5tYXBJZCArIFwiIHVzZXI6IFwiICsgaW5mby51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFwQWN0aXZlVHlwZSA9PSBcIm1lXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEFjdGl2ZShcIm1lXCIsIC0xLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBJZCA9PSBpbmZvLnVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0IGNlbnRlciBtYXAsIGlkIHRoZSBzYW1lXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGluZm8ubGF0LCBpbmZvLmxvbmcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGdldE5lYXJieU1lcmNoYW50cyA9IGZ1bmN0aW9uIChsYXQsIGxuZykge1xuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtsYXQ6IGxhdCwgbG9uZzogbG5nLCByYWRpdXM6ICRyb290U2NvcGUucmFkaXVzfTtcbiAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UubWVyY2hhbnRzKGxvY2F0aW9uKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwaW5zID0gZGF0YS5tZXJjaGFudHM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXJjaGFudHMgcmVjZWl2ZWQgZnJvbSBzZXJ2ZXI6IFwiICsgcGlucy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGlucy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ05vIHRlbmVtb3MgaW5mb3JtYWNpb24gZGUgcHVudG9zIGRlIHNlZ3VyaWRhZCBlbiBlc2UgcHVudG8nKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuTWVyY2hhbnRzKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgbG9hZFVzZXJUcmlwID0gZnVuY3Rpb24gKHVzZXJfaWQsIHRyaXApIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY29udGFjdFRyaXBMb2NhdGlvbnModXNlcl9pZCwgdHJpcCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9jYXRpb25zIGluIHRyaXA6IFwiICsgdHJpcCArIFwiIGNvdW50OiBcIiArIHJlcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXMpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VHJpcChyZXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ05vIGVuY3VlbnRybyBlc2UgdmlhamUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHBvc3RNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAuYWRkTGlzdGVuZXIoJ2RibGNsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gZS5sYXRMbmc7XG4gICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChsb2NhdGlvbi5sYXQoKSwgbG9jYXRpb24ubG5nKCkpO1xuICAgICAgICAgICAgICAgICAgICBnZXROZWFyYnlNZXJjaGFudHMobG9jYXRpb24ubGF0KCksIGxvY2F0aW9uLmxuZygpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tZW1hcmtlcnBlbmRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZSBtYXJrZXIgd2FzIGNyZWF0ZWQgYmVmb3JlIG1hcCBzbyBsb2FkaW5nIG5vd1wiKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZW1hcmtlcnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZW1hcmtlci5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tZXJjaGFudHNwZW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibWVyY2hhbnRzIHdlcmUgY3JlYXRlZCBiZWZvcmUgbWFwIHNvIGxvYWRpbmcgbm93XCIpO1xuICAgICAgICAgICAgICAgICAgICBzaG93QWxsTWVyY2hhbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgIHNob3dBbGxSZXBvcnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWVyY2hhbnRzcGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRBY3RpdmUoJHJvb3RTY29wZS5tYXBBY3RpdmVUeXBlLCAkcm9vdFNjb3BlLm1hcElkLCBudWxsKTtcbiAgICAgICAgICAgICAgICBhbGVydCgnZG9ibGUgY2xpY2sgcGFyYSBlbmNvbnRyYXIgcHVudG9zIGRlIHNlZ3VyaWRhZCcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBzZXRBY3RpdmUgPSBmdW5jdGlvbiAodHlwZSwgaWQsIGxhdExuZykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBhcyBhY3RpdmU6IFwiICsgaWQgKyBcIiB0eXBlOiBcIiArIHR5cGUpO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwQWN0aXZlVHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBJZCA9IGlkO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIk1BUF9BQ1RJVkVfVFlQRVwiLCB0eXBlKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJNQVBfQUNUSVZFX0lEXCIsIGlkKTtcbiAgICAgICAgICAgICAgICBpZiAobGF0TG5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChsYXRMbmcubGF0KCksIGxhdExuZy5sbmcoKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlcmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IFwiZW1lcmdlbmN5XCIgfHwgdHlwZSA9PSBcInVzZXJcIiB8fCB0eXBlID09IFwibWVkaWNhbF9lbWVyZ2VuY3lcIiB8fCB0eXBlID09IFwibWVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50cmFja2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXRWaXNpYmxlVXNlcigkcm9vdFNjb3BlLm1hcElkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcmVkID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJ0cmlwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmlwX2lkID0gJHJvb3RTY29wZS5jb250YWN0VHJpcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWN0X2lkID0gJHJvb3RTY29wZS5jb250YWN0SWRUcmlwO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFVzZXJUcmlwKGNvbnRhY3RfaWQsIHRyaXBfaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjZW50ZXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlcnNsZW5ndGggPSAkcm9vdFNjb3BlLm1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlcnNsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9ICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJzbGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IG1hcmtlci5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBlLmxhdExuZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRBY3RpdmUoXCJ1c2VyXCIsIG1hcmtlci51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjZW50ZXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudHJhY2tpbmdBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSAhPSBcIm1lXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QWN0aXZlKFwibWVcIiwgLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGNsZWFuTWVyY2hhbnRzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3bWVyY2hhbnRzID0gZGF0YS5tZXJjaGFudHM7XG4gICAgICAgICAgICAgICAgZm9yIChtZXJjaGFudCBpbiBuZXdtZXJjaGFudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWVyY2hhbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3bWVyY2hhbnRzW21lcmNoYW50XS5pZCA9PSAkcm9vdFNjb3BlLm1lcmNoYW50c1ttYXJrZXJdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZXJjaGFudHMucHVzaChjcmVhdGVNZXJjaGFudChuZXdtZXJjaGFudHNbbWVyY2hhbnRdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld3JlcG9ydHMgPSBkYXRhLnJlcG9ydHM7XG4gICAgICAgICAgICAgICAgZm9yIChyZXBvcnQgaW4gbmV3cmVwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gJHJvb3RTY29wZS5yZXBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3cmVwb3J0c1tyZXBvcnRdLmlkID09ICRyb290U2NvcGUucmVwb3J0c1ttYXJrZXJdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3cmVwb3J0c1tyZXBvcnRdLnR5cGUgPSBcIlJlcG9ydFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5yZXBvcnRzLnB1c2goY3JlYXRlTWVyY2hhbnQobmV3cmVwb3J0c1tyZXBvcnRdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlVXNlck9iamVjdHMgPSBmdW5jdGlvbiAoZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgZm9yIChwb2x5bGluZSBpbiAkcm9vdFNjb3BlLnBvbHlsaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdLnVzZXJfaWQgPSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVVc2VyTWFya2Vycygkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBvbHlsaW5lcy5zcGxpY2UocG9seWxpbmUsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBzZXRWaXNpYmxlVXNlciA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF1c2VyX2lkID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS51c2VyX2lkID0gZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhdExuZyA9ICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGxhdExuZy5sYXQoKSwgbGF0TG5nLmxuZygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWVtYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXRMbmcgPSAkcm9vdFNjb3BlLm1lbWFya2VyLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRDZW50ZXJNYXAobGF0TG5nLmxhdCgpLCBsYXRMbmcubG5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgaGlkZUFsbFBvbHlsaW5lcyA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzW3BvbHlsaW5lXS5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGFkZFRvVW5rbm93bnMgPSBmdW5jdGlvbiAoZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yICh1bmtub3duIGluICRyb290U2NvcGUuZm9sbG93aW5nVW5rbm93bikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5mb2xsb3dpbmdVbmtub3duW3Vua25vd25dID09IGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmZvbGxvd2luZ1Vua25vd24ucHVzaChkYXVzZXJfaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmVtb3ZlRnJvbVVua25vd25zID0gZnVuY3Rpb24gKGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGZvciAodW5rbm93biBpbiAkcm9vdFNjb3BlLmZvbGxvd2luZ1Vua25vd24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuZm9sbG93aW5nVW5rbm93blt1bmtub3duXSA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZpbmcgdXNlcjogXCIgKyBkYXVzZXJfaWQgKyBcIiBmcm9tIHVua25vd25zXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5mb2xsb3dpbmdVbmtub3duLnNwbGljZSh1bmtub3duLCAxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjaGVja1Vua25vd25zTWFya2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmZvbGxvd2luZ1Vua25vd24ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRyYWNraW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBTZW1hcGhvcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVua25vd24gbWFya2Vyc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHJvb3RTY29wZS5mb2xsb3dpbmdVbmtub3duKSk7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lb3V0IFRyaWdnZXJlZCB1bmtub3duc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUxvY2F0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB9LCAkcm9vdFNjb3BlLnNoYXJlZFRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIlVTRVJfVFJBQ0tJTkdcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vIG9uZSBpcyBzaGFyaW5nIGxvY2F0aW9uIHdpdGggdXNlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdOb1NoYXJlcnMnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGNyZWF0ZU1hcmtlciA9IGZ1bmN0aW9uIChpbmZvLCBhY3RpdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlICYmICRyb290U2NvcGUubWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImluZm8gcmVjZWl2ZWQgaW4gbWFya2VyXCIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGluZm8pKTtcbiAgICAgICAgICAgICAgICB2YXIgcGluY2xhc3MgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChpbmZvLmFjdGl2aXR5ID09IFwic3RpbGxcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwibWFzY3VsaW5lLWF2YXRhci5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBzdGlsbFwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJvbl9mb290XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBvbiBmb290XCIpO1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicGVkZXN0cmlhbi13YWxraW5nLnN2Z1wiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5hY3Rpdml0eSA9PSBcImluX3ZlaGljbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwiY2FyLWZyb250LnN2Z1wiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5hY3Rpdml0eSA9PSBcIm9uX2JpY3ljbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwiY3ljbGluZy5zdmdcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJydW5uaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcInJ1bm5pbmcuc3ZnXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmFjdGl2aXR5ID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBibGFua1wiKTtcbiAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcIm1hcC1waW4uc3ZnXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSWNvbiBwYXRoIG1hcmtlclwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLmljb25wYXRoICsgXCIvXCIgKyBwaW5jbGFzcyk7XG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICBpZDogaW5mby5pZCxcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogaW5mby51c2VyX2lkLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhpbmZvLmxhdCwgaW5mby5sb25nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBkYW1hcCxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICAgICAgcmVwb3J0X3RpbWU6IGluZm8ucmVwb3J0X3RpbWUsXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiBpbmZvLnNwZWVkLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eTogaW5mby5hY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgICAgYmF0dGVyeTogaW5mby5iYXR0ZXJ5LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogaW5mby5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIGlzbGFzdDogaW5mby5pc2xhc3QsXG4gICAgICAgICAgICAgICAgICAgIGljb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogJyNmZmZmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAkcm9vdFNjb3BlLmljb25wYXRoICsgXCIvXCIgKyBwaW5jbGFzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDM1LCAzNSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG1hcmtlci5jb250ZW50ID0gJzxkaXYgY2xhc3M9XCJpbmZvV2luZG93Q29udGVudFwiPicgKyBpbmZvLmlkICsgJyAnICsgaW5mby5uYW1lICsgJzxici8+PGEgb25DbGljaz1cIndpbmRvdy5vcGVuKFxcJ2h0dHA6Ly93YXplLnRvLz9sbD0nICsgaW5mby5sYXQgKyAnLCcgKyBpbmZvLmxvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICsgJyZuYXZpZ2F0ZT15ZXMnICsgJ1xcJyxcXCdfc3lzdGVtXFwnLFxcJ2xvY2F0aW9uPXllc1xcJyk7cmV0dXJuIGZhbHNlO1wiPldhemU8L2E+PGJyLz48YSBocmVmPVwidGVsOicgKyBpbmZvLnBob25lICsgJ1wiPicgKyBpbmZvLnBob25lICsgJzwvYT48L2Rpdj4nO1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoJzxoMj4nICsgbWFya2VyLnJlcG9ydF90aW1lICsgJzwvaDI+JyArIG1hcmtlci5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKCRyb290U2NvcGUubWFwLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF0bG9uZyA9IG1hcmtlci5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBzZXRBY3RpdmUoXCJ1c2VyXCIsIG1hcmtlci51c2VyX2lkLCBsYXRsb25nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoaW5mby5zdGF0dXMgPT0gXCJlbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF0TG5nID0gbWFya2VyLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHNldEFjdGl2ZShcImVtZXJnZW5jeVwiLCBpbmZvLnVzZXJfaWQsIGxhdExuZyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjcmVhdGVNZXJjaGFudCA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1lcmNoYW50c3BlbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1lcmNoYW50IHBlbmRpbmcgZnJvbSBhZGRpbmcgdG8gbWFwXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGluY2xhc3MgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChpbmZvLnR5cGUgPT0gXCJwb2xpY2VcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicG9saWNlLXNoaWVsZC5zdmdcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8udHlwZSA9PSBcIm1lZGljYWxcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwibWVkaWMtc3VpdGNhc2Uuc3ZnXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLnR5cGUgPT0gXCJSZXBvcnRcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicGluLnN2Z1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImljb246IFwiICsgJHJvb3RTY29wZS5pY29ucGF0aCArIFwiL1wiICsgcGluY2xhc3MgKyBcIiBmb3IgdHlwZTogXCIgKyBpbmZvLnR5cGUpO1xuICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZm8uaWQsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGluZm8ubGF0LCBpbmZvLmxvbmcpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IGRhbWFwLFxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJHJvb3RTY29wZS5pY29ucGF0aCArIFwiL1wiICsgcGluY2xhc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsT3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtYXJrZXIuY29udGVudCA9ICc8ZGl2IGNsYXNzPVwiaW5mb1dpbmRvd0NvbnRlbnRcIj4nICsgaW5mby50eXBlICsgJzxici8+PGEgY2xhc3M9XCJidXR0b24gaWNvbi1sZWZ0IGlvbi1pb3M3LXRlbGVwaG9uZSBidXR0b24tY2FsbSBidXR0b24tb3V0bGluZVwiIGhyZWY9XCJ0ZWw6KyAnICsgaW5mby50ZWxlcGhvbmUgKyAnXCI+JyArIGluZm8udGVsZXBob25lICsgJzwvYT48YnIvPicgKyBpbmZvLmFkZHJlc3MgKyAnPGJyLz48YSBvbkNsaWNrPVwid2luZG93Lm9wZW4oXFwnaHR0cDovL3dhemUudG8vP2xsPScgKyBpbmZvLmxhdCArICcsJyArIGluZm8ubG9uZyArICcmbmF2aWdhdGU9eWVzJyArICdcXCcsXFwnX3N5c3RlbVxcJyxcXCdsb2NhdGlvbj15ZXNcXCcpO3JldHVybiBmYWxzZTtcIj5XYXplPC9hPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgdmFyIHBpbmNsYXNzID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoaW5mby50eXBlID09IFwicG9saWNlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcIm1hcC1pY29uLXBvbGljZVwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09IFwibWVkaWNhbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJtYXAtaWNvbi1oZWFsdGhcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8udHlwZSA9PSBcIlJlcG9ydFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJtYXAtaWNvbi1yZXBvcnRcIjtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLmNvbnRlbnQgPSAnPGRpdiBjbGFzcz1cImluZm9XaW5kb3dDb250ZW50XCI+JyArIGluZm8udHlwZSArICc8YnIvPicgKyBpbmZvLmFkZHJlc3MgKyAnPGJyLz48YSBvbkNsaWNrPVwid2luZG93Lm9wZW4oXFwnaHR0cDovL3dhemUudG8vP2xsPScgKyBpbmZvLmxhdCArICcsJyArIGluZm8ubG9uZyArICcmbmF2aWdhdGU9eWVzJyArICdcXCcsXFwnX3N5c3RlbVxcJyxcXCdsb2NhdGlvbj15ZXNcXCcpO3JldHVybiBmYWxzZTtcIj5XYXplPC9hPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRpbmcgbWVyY2hhbnRcIik7XG4gICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuXG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudCgnPGgyPicgKyBpbmZvLm5hbWUgKyAnPC9oMj4nICsgbWFya2VyLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4oJHJvb3RTY29wZS5tYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGVja01hcmtlcnMgPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKHRhcmdldCBpbiBpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvW3RhcmdldF0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmxhc3RMb2NhdGlvbiA8IGluZm9bdGFyZ2V0XS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubGFzdExvY2F0aW9uID0gaW5mb1t0YXJnZXRdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tMb2NhdGlvbkV4aXN0cyhpbmZvW3RhcmdldF0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKFwiZG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBpbiBjaGVja2luZyBsb2NhdGlvbnNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihKU09OLnN0cmluZ2lmeShlcnIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShcImRvbmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZVVzZXJNYXJrZXJzID0gZnVuY3Rpb24gKGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS51c2VyX2lkID09IGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMuc3BsaWNlKG1hcmtlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMuc3BsaWNlKG1hcmtlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGlkZUFsbEFjdGl2ZU1hcmtlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaGlkZU1hcmtlcnMoJHJvb3RTY29wZS5tYXJrZXJzKTtcbiAgICAgICAgICAgICAgICBoaWRlQWxsUG9seWxpbmVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGlkZU1hcmtlcnMgPSBmdW5jdGlvbiAoZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYW1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYXJrZXJzW21hcmtlcl0uc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNsZWFyVGVtcHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudGVtcE1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gJHJvb3RTY29wZS50ZW1wTWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudGVtcE1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcE1hcmtlcnNbbWFya2VyXS5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS50ZW1wUG9seWxpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wUG9seWxpbmUuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRlbXBQb2x5bGluZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNob3dBbGxBY3RpdmVNYXJrZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNob3dNYXJrZXJzKCRyb290U2NvcGUubWFya2Vycyk7XG4gICAgICAgICAgICAgICAgc2hvd0FsbFBvbHlsaW5lcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNob3dNYXJrZXJzID0gZnVuY3Rpb24gKGRhbWFya2Vycykge1xuICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluIGRhbWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGFtYXJrZXJzW21hcmtlcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFya2Vyc1ttYXJrZXJdLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29uc29sZUxvZ01hcmtlcnMgPSBmdW5jdGlvbiAoZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYW1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNwZWVkOiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLnNwZWVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWN0aXZpdHk6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0uYWN0aXZpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJiYXR0ZXJ5OiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLmJhdHRlcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJsYXQ6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0ubGF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9uZzogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5sb25nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmFtZTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHJpcDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS50cmlwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHlwZTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS50eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlcl9pZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVwb3J0X3RpbWU6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0ucmVwb3J0X3RpbWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXJrZXIgaXMgbnVsbDogXCIgKyBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGFtYXJrZXJzW21hcmtlcl0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TWFya2VyID0gZnVuY3Rpb24gKGRhaWQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLm1hcmtlcnMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb21wYXJpbmcgbWFya2Vyc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS5pZCA9PSBkYWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXJrZXIgZm91bmQsIHJldHVybmluZyBub3dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnNwbGljZShtYXJrZXIsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjaGVja0xvY2F0aW9uRXhpc3RzID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVja2luZyBkYXRhYmFzZSBmb3IgbG9jYXRpb246IFwiICsgbG9jYXRpb24uaWQpO1xuICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkcm9vdFNjb3BlLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFya2Vyc1tpdGVtXS5pZCA9PSBsb2NhdGlvbi5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5zdGF0dXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvY2F0aW9uIGV4aXN0czogXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gZ2V0VXNlck1hcmtlcihsb2NhdGlvbi51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIE1hcmtlciBGb3VuZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXIuaWQgPj0gbG9jYXRpb24uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgTWFya2VyIG9sZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgTWFya2VyIG5ld2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFRvVXNlclBvbHlsaW5lKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTWFya2VyIGRvZXMgbm90IGV4aXN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9Vc2VyUG9seWxpbmUobG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5zdGF0dXMgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICBhZGRUb1VzZXJQb2x5bGluZShsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY29udGFjdFRyaXBzID0gZnVuY3Rpb24gKHVzZXJfaWQsIHBhZ2UsIHBlcl9wYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IChwYWdlIC0gMSkgKiBwZXJfcGFnZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRyeWluZyBzcWwgY29udGFjdFRyaXBzIG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY29udGFjdFRyaXBzQ291bnQgPSBmdW5jdGlvbiAodXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHJ5aW5nIHNxbCB1c2VyIHRyaXBzIG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCJTRUxFQ1QgQ09VTlQoaWQpIGFzIHRvdGFsIEZST00gbG9jYXRpb25zIHdoZXJlIHVzZXJfaWQgPSA/ICBncm91cCBieSB0cmlwXCI7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGRpc3BsYXlUcmlwID0gZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIHZhciBmbGlnaHRQbGFuQ29vcmRpbmF0ZXMgPSBbXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnRlbXBNYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGhpZGVNYXJrZXJzKCRyb290U2NvcGUudGVtcE1hcmtlcnMpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcE1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgbWFya2VyczogXCIgKyByZXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXMpKTtcbiAgICAgICAgICAgICAgICB2YXIgY29vcmRzO1xuICAgICAgICAgICAgICAgIHZhciB0cmlwO1xuICAgICAgICAgICAgICAgIHZhciB1c2VyO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc1tpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29vcmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhyZXNbaV0ubGF0LCByZXNbaV0ubG9uZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgbWFya2VyOiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmlwID0gcmVzW2ldLnRyaXA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gcmVzW2ldLnVzZXJfaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIgPSBjcmVhdGVNYXJrZXIocmVzW2ldLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcE1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmxpZ2h0UGxhbkNvb3JkaW5hdGVzLnB1c2goY29vcmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHJlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNvbnRhY3RJZFRyaXAgPSB1c2VyO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuY29udGFjdFRyaXAgPSB0cmlwO1xuICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChjb29yZHMubGF0KCksIGNvb3Jkcy5sbmcoKSk7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWdodFBhdGggPSBuZXcgZ29vZ2xlLm1hcHMuUG9seWxpbmUoe1xuICAgICAgICAgICAgICAgICAgICBwYXRoOiBmbGlnaHRQbGFuQ29vcmRpbmF0ZXMsXG4gICAgICAgICAgICAgICAgICAgIGdlb2Rlc2ljOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2VDb2xvcjogJyNGRjAwMDAnLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLjAsXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMixcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogY29udGFpbmVyLnVzZXJfaWQsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGNvbnRhaW5lci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFwiY2xvc2VkXCIsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudGVtcFBvbHlsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcFBvbHlsaW5lLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wUG9seWxpbmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmbGlnaHRQYXRoLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wUG9seWxpbmUgPSBmbGlnaHRQYXRoO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGNvbnRhY3RUcmlwTG9jYXRpb25zID0gZnVuY3Rpb24gKHVzZXJfaWQsIHRyaXBfaWQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbnRhY3QgdHJpcCBsb2NhdGlvbnMgbm90IGltcGxlbWVudGVkIGF0IHByZXNlbnQ6IFwiICsgdXNlcl9pZCArIFwiIHRyaXA6IFwiICsgdHJpcF9pZCk7XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdXBkYXRlTG9jYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRpbmcgbG9jYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnRyYWNraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicm9vdHNjb3BlIHRyYWNraW5nIHRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyb290c2NvcGUgbWFwc2VtYXBob3JlIHRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RMb2NhdGlvbiA9ICRyb290U2NvcGUubGFzdExvY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhcGFnZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBcIj9wYWdlPVwiICsgZGFwYWdlICsgXCImaWRfYWZ0ZXI9XCIgKyBsYXN0TG9jYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2ZXJMb2NhdGlvbnMod2hlcmUsIGxhc3RMb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja1Vua25vd25zTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjaGVja1Vua25vd25zTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2F2ZVRyaXAgPSBmdW5jdGlvbiAodHJpcCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2F2ZVRyaXA6IFwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh0cmlwKSk7XG4gICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldExvY2F0aW9uc1RyaXAodHJpcClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpbnMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2NhdGlvbnMgcmVjZWl2ZWQgZnJvbSBzZXJ2ZXI6IFwiICsgcGlucy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHBpbnMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja01hcmtlcnMocGlucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA8IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdyZWNlaXZlZFRyaXBEZXRhaWwnLCB7dHJpZ2dlcl9pZDogdHJpcC51c2VyX2lkfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlwLnBhZ2UgPSBkYXRhLnBhZ2UgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZVRyaXAodHJpcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgncmVjZWl2ZWRUcmlwRGV0YWlsJywge3RyaWdnZXJfaWQ6IHRyaXAudXNlcl9pZH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTZXJ2ZXJMb2NhdGlvbnMgPSBmdW5jdGlvbiAod2hlcmUsIGlkYWZ0ZXIpIHtcbiAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2Uuc2hhcmVkKHdoZXJlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRvdGFsID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrVW5rbm93bnNNYXJrZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaW5zID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGlucy5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja01hcmtlcnMocGlucykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2hhcmVkTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlIDwgZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGFwYWdlID0gZGF0YS5wYWdlICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBcIj9wYWdlPVwiICsgZGFwYWdlICsgXCImaWRfYWZ0ZXI9XCIgKyBpZGFmdGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFNlcnZlckxvY2F0aW9ucyh3aGVyZSwgaWRhZnRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2VtYXBob3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lb3V0IFRyaWdnZXJlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlTG9jYXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJHJvb3RTY29wZS5zaGFyZWRUaW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNyZWF0ZU1hcmtlcjogY3JlYXRlTWFya2VyLFxuICAgICAgICAgICAgICAgIGNsZWFyVGVtcHM6IGNsZWFyVGVtcHMsXG4gICAgICAgICAgICAgICAgY3JlYXRlTWFwOiBjcmVhdGVNYXAsXG4gICAgICAgICAgICAgICAgZ2V0TmVhcmJ5TWVyY2hhbnRzOiBnZXROZWFyYnlNZXJjaGFudHMsXG4gICAgICAgICAgICAgICAgY29udGFjdFRyaXBzQ291bnQ6IGNvbnRhY3RUcmlwc0NvdW50LFxuICAgICAgICAgICAgICAgIGRlbGV0ZVVzZXJPYmplY3RzOiBkZWxldGVVc2VyT2JqZWN0cyxcbiAgICAgICAgICAgICAgICBkZWxldGVVc2VyTWFya2VyczogZGVsZXRlVXNlck1hcmtlcnMsXG4gICAgICAgICAgICAgICAgZ2V0VXNlclBvbHlsaW5lOiBnZXRVc2VyUG9seWxpbmUsXG4gICAgICAgICAgICAgICAgc2F2ZVRyaXA6IHNhdmVUcmlwLFxuICAgICAgICAgICAgICAgIGNoZWNrTWFya2VyczogY2hlY2tNYXJrZXJzLFxuICAgICAgICAgICAgICAgIGNvbnRhY3RUcmlwTG9jYXRpb25zOiBjb250YWN0VHJpcExvY2F0aW9ucyxcbiAgICAgICAgICAgICAgICBjb250YWN0VHJpcHM6IGNvbnRhY3RUcmlwcyxcbiAgICAgICAgICAgICAgICBjb25zb2xlTG9nTWFya2VyczogY29uc29sZUxvZ01hcmtlcnMsXG4gICAgICAgICAgICAgICAgZ2V0TWFya2VyOiBnZXRNYXJrZXIsXG4gICAgICAgICAgICAgICAgaGlkZUFsbEFjdGl2ZU1hcmtlcnM6IGhpZGVBbGxBY3RpdmVNYXJrZXJzLFxuICAgICAgICAgICAgICAgIGhpZGVNYXJrZXJzOiBoaWRlTWFya2VycyxcbiAgICAgICAgICAgICAgICBzaG93QWxsQWN0aXZlTWFya2Vyczogc2hvd0FsbEFjdGl2ZU1hcmtlcnMsXG4gICAgICAgICAgICAgICAgc2hvd01hcmtlcnM6IHNob3dNYXJrZXJzLFxuICAgICAgICAgICAgICAgIHVwZGF0ZUxvY2F0aW9uczogdXBkYXRlTG9jYXRpb25zLFxuICAgICAgICAgICAgICAgIGdldE1hcmtlcnM6IGdldE1hcmtlcnMsXG4gICAgICAgICAgICAgICAgZ2V0VXNlck1hcmtlcjogZ2V0VXNlck1hcmtlcixcbiAgICAgICAgICAgICAgICBkaXNwbGF5VHJpcDogZGlzcGxheVRyaXAsXG4gICAgICAgICAgICAgICAgYWRkVG9Vbmtub3duczogYWRkVG9Vbmtub3ducyxcbiAgICAgICAgICAgICAgICByZW1vdmVGcm9tVW5rbm93bnM6IHJlbW92ZUZyb21Vbmtub3ducyxcbiAgICAgICAgICAgICAgICBzZXRBY3RpdmU6IHNldEFjdGl2ZSxcbiAgICAgICAgICAgICAgICBjaGVja0FjdGl2ZTogY2hlY2tBY3RpdmUsXG4gICAgICAgICAgICAgICAgcG9zdE1hcDogcG9zdE1hcFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvbWFwRGFzaC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 41 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .service('Merchants',['$q', '$http', function ($q, $http) {\r\n\r\n            var getMerchants = function (where) {\r\n                var url = \"/api/merchants\";\r\n                if (where) {\r\n                    url = url + \"?\" + where;\r\n                }\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n            var getMerchantsUser = function (where) {\r\n                var url = \"/api/user/merchants\";\r\n                if (where) {\r\n                    url = url + \"?\" + where;\r\n                }\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n            var getReports = function (where) {\r\n                var url = \"/api/reports\";\r\n                if (where) {\r\n                    url = url + \"?\" + where;\r\n                }\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n            var getMerchantsCoverage = function (data) {\r\n                var url = \"/api/private/merchants/coverage\";\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url,\r\n                    params:data\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n            var getMerchantsNearby = function (data) {\r\n                var url = \"/api/private/merchants/nearby\";\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url,\r\n                    params:data\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n            var getReportsNearby = function (data) {\r\n                var url = \"/api/private/reports/nearby\";\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url,\r\n                    params:data\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n            var getMerchantsPrivate = function (where) {\r\n                var url = \"/api/merchants\";\r\n                if (where) {\r\n                    url = url + \"?\" + where;\r\n                }\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n            }\r\n            var getStoreExport = function (data) {\r\n                var url = '/api/admin/merchant/orders' ;\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'POST',\r\n                    url: url,\r\n                    data:data\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to getStoreExport\");\r\n                        });\r\n\r\n                return def.promise;\r\n                /**/\r\n\r\n            }\r\n            var getStoreContent = function (data) {\r\n                var url = '/api/admin/merchant/content' ;\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'POST',\r\n                    url: url,\r\n                    data:data\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to getStoreExport\");\r\n                        });\r\n\r\n                return def.promise;\r\n                /**/\r\n\r\n            }\r\n\r\n            var searchMerchants = function (where) {\r\n                var url = \"/api/merchants/search\";\r\n                if (where) {\r\n                    url = url + \"?search=\" + where;\r\n                }\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'get',\r\n                    url: url\r\n                })\r\n                        .success(function (data) {\r\n                            // console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to get merchants\");\r\n                        });\r\n                return def.promise;\r\n\r\n            }\r\n\r\n            var saveMerchant = function (data) {\r\n                var def = $q.defer();\r\n                var url = \"/api/merchants\";\r\n                var method = \"POST\";\r\n                if (data.id) {\r\n                    var url = \"/api/merchants/\" + data.id;\r\n                    var method = \"PATCH\";\r\n                }\r\n                $http({\r\n                    method: method,\r\n                    url: url,\r\n                    data: data, // pass in data as strings\r\n                    headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\r\n                })\r\n                        .success(function (data) {\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to save/create merchant\");\r\n                        });\r\n\r\n                return def.promise;\r\n                /**/\r\n\r\n            }\r\n\r\n            var deleteMerchant = function (merchant_id) {\r\n                var def = $q.defer();\r\n                $http({\r\n                    method: 'DELETE',\r\n                    url: '/api/merchants/' + merchant_id\r\n                })\r\n                        .success(function (data) {\r\n                            console.log(data);\r\n                            def.resolve(data);\r\n                        })\r\n                        .error(function () {\r\n                            def.reject(\"Failed to Delete Merchant\");\r\n                        });\r\n\r\n                return def.promise;\r\n                /**/\r\n\r\n            }\r\n\r\n            return {\r\n                getMerchants: getMerchants,\r\n                getMerchantsNearby:getMerchantsNearby,\r\n                getReportsNearby:getReportsNearby,\r\n                getMerchantsUser:getMerchantsUser,\r\n                getReports:getReports,\r\n                getMerchantsCoverage: getMerchantsCoverage,\r\n                getMerchantsPrivate: getMerchantsPrivate,\r\n                saveMerchant: saveMerchant,\r\n                getStoreContent:getStoreContent,\r\n                getStoreExport:getStoreExport,\r\n                searchMerchants: searchMerchants,\r\n                deleteMerchant: deleteMerchant\r\n            };\r\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tZXJjaGFudHMuanM/OThlNCJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcclxuXHJcbiAgICAgICAgLnNlcnZpY2UoJ01lcmNoYW50cycsWyckcScsICckaHR0cCcsIGZ1bmN0aW9uICgkcSwgJGh0dHApIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBnZXRNZXJjaGFudHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIi9hcGkvbWVyY2hhbnRzXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIj9cIiArIHdoZXJlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZ2V0TWVyY2hhbnRzVXNlciA9IGZ1bmN0aW9uICh3aGVyZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS91c2VyL21lcmNoYW50c1wiO1xyXG4gICAgICAgICAgICAgICAgaWYgKHdoZXJlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/XCIgKyB3aGVyZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbWVyY2hhbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGdldFJlcG9ydHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIi9hcGkvcmVwb3J0c1wiO1xyXG4gICAgICAgICAgICAgICAgaWYgKHdoZXJlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/XCIgKyB3aGVyZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbWVyY2hhbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGdldE1lcmNoYW50c0NvdmVyYWdlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIi9hcGkvcHJpdmF0ZS9tZXJjaGFudHMvY292ZXJhZ2VcIjtcclxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOmRhdGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbWVyY2hhbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGdldE1lcmNoYW50c05lYXJieSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL3ByaXZhdGUvbWVyY2hhbnRzL25lYXJieVwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6ZGF0YVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZ2V0UmVwb3J0c05lYXJieSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL3ByaXZhdGUvcmVwb3J0cy9uZWFyYnlcIjtcclxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOmRhdGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbWVyY2hhbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGdldE1lcmNoYW50c1ByaXZhdGUgPSBmdW5jdGlvbiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIi9hcGkvbWVyY2hhbnRzXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIj9cIiArIHdoZXJlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnZXRTdG9yZUV4cG9ydCA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYWRtaW4vbWVyY2hhbnQvb3JkZXJzJyA7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRTdG9yZUV4cG9ydFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgLyoqL1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZ2V0U3RvcmVDb250ZW50ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9tZXJjaGFudC9jb250ZW50JyA7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRTdG9yZUV4cG9ydFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgLyoqL1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHNlYXJjaE1lcmNoYW50cyA9IGZ1bmN0aW9uICh3aGVyZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9tZXJjaGFudHMvc2VhcmNoXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIj9zZWFyY2g9XCIgKyB3aGVyZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbWVyY2hhbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBzYXZlTWVyY2hhbnQgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCIvYXBpL21lcmNoYW50c1wiO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IFwiUE9TVFwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCIvYXBpL21lcmNoYW50cy9cIiArIGRhdGEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IFwiUEFUQ0hcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9ICAvLyBzZXQgdGhlIGhlYWRlcnMgc28gYW5ndWxhciBwYXNzaW5nIGluZm8gYXMgZm9ybSBkYXRhIChub3QgcmVxdWVzdCBwYXlsb2FkKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzYXZlL2NyZWF0ZSBtZXJjaGFudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgLyoqL1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGRlbGV0ZU1lcmNoYW50ID0gZnVuY3Rpb24gKG1lcmNoYW50X2lkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvbWVyY2hhbnRzLycgKyBtZXJjaGFudF9pZFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIERlbGV0ZSBNZXJjaGFudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgLyoqL1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGdldE1lcmNoYW50czogZ2V0TWVyY2hhbnRzLFxyXG4gICAgICAgICAgICAgICAgZ2V0TWVyY2hhbnRzTmVhcmJ5OmdldE1lcmNoYW50c05lYXJieSxcclxuICAgICAgICAgICAgICAgIGdldFJlcG9ydHNOZWFyYnk6Z2V0UmVwb3J0c05lYXJieSxcclxuICAgICAgICAgICAgICAgIGdldE1lcmNoYW50c1VzZXI6Z2V0TWVyY2hhbnRzVXNlcixcclxuICAgICAgICAgICAgICAgIGdldFJlcG9ydHM6Z2V0UmVwb3J0cyxcclxuICAgICAgICAgICAgICAgIGdldE1lcmNoYW50c0NvdmVyYWdlOiBnZXRNZXJjaGFudHNDb3ZlcmFnZSxcclxuICAgICAgICAgICAgICAgIGdldE1lcmNoYW50c1ByaXZhdGU6IGdldE1lcmNoYW50c1ByaXZhdGUsXHJcbiAgICAgICAgICAgICAgICBzYXZlTWVyY2hhbnQ6IHNhdmVNZXJjaGFudCxcclxuICAgICAgICAgICAgICAgIGdldFN0b3JlQ29udGVudDpnZXRTdG9yZUNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBnZXRTdG9yZUV4cG9ydDpnZXRTdG9yZUV4cG9ydCxcclxuICAgICAgICAgICAgICAgIHNlYXJjaE1lcmNoYW50czogc2VhcmNoTWVyY2hhbnRzLFxyXG4gICAgICAgICAgICAgICAgZGVsZXRlTWVyY2hhbnQ6IGRlbGV0ZU1lcmNoYW50XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvbWVyY2hhbnRzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 42 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Modals', ['$mdToast', '$mdDialog', function ($mdToast, $mdDialog) {\n\n                var getAddressesPopup = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Addresses', '$rootScope', function ($scope, $mdDialog, Addresses, $rootScope) {\n                                $scope.addresses = [];\n\n                                $scope.getAddresses = function () {\n                                    if ($rootScope.addresses && $rootScope.addresses.length > 0) {\n                                        $scope.addresses = $rootScope.addresses;\n                                    } else {\n                                        Addresses.getAddresses().then(function (data) {\n                                            $scope.addresses = data.addresses;\n\n                                        },\n                                                function (data) {\n\n                                                });\n                                    }\n\n                                }\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n\n                                $scope.selectAddress = function (address) {\n                                    $mdDialog.hide(address);\n                                };\n                                $scope.getAddresses();\n                            }],\n                        templateUrl: '/templates/addressList.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getExportPopup = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.enviar = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/exportConfirmation.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getAppPopup = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Addresses', '$rootScope', function ($scope, $mdDialog, Addresses, $rootScope) {\n                                $scope.addresses = [];\n\n                                $scope.selectPlatform = function (platform) {\n                                    $mdDialog.hide(platform);\n\n\n                                }\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                            }],\n                        templateUrl: '/templates/mobileApp.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getMerchantsPopup = function (category) {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Merchants', '$rootScope', function ($scope, $mdDialog, Merchants, $rootScope) {\n                                $scope.merchants = [];\n\n                                $scope.getMerchants = function () {\n                                    var container = null;\n                                    if (category) {\n                                        container = {lat: $rootScope.shippingAddress.lat, long: $rootScope.shippingAddress.long, category: category};\n                                    } else {\n                                        container = {lat: $rootScope.shippingAddress.lat, long: $rootScope.shippingAddress.long};\n                                    }\n                                    Merchants.getMerchantsCoverage(container).then(function (data) {\n                                        $scope.merchants = data.data;\n                                    },\n                                            function (data) {\n                                            });\n                                }\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n\n                                $scope.selectMerchant = function (merchant) {\n                                    $mdDialog.hide(merchant);\n                                };\n                                $scope.getMerchants();\n                            }],\n                        templateUrl: '/templates/merchantsList.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getQuestionairePopup = function (questions) {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Merchants', '$rootScope', function ($scope, $mdDialog) {\n                                $scope.questions = questions;\n\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.checkValue = function (item) {\n                                    console.log(\"Checking: \", item);\n                                };\n\n                                $scope.save = function () {\n                                    $mdDialog.hide($scope.questions);\n                                };\n                            }],\n                        templateUrl: '/templates/questionaire.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n\n                var getLocationPrompt = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.answer = function (answer) {\n                                    $mdDialog.hide(answer);\n                                };\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/locationPrompt.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getLocationExtPrompt = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.answer = function (answer) {\n                                    $mdDialog.hide(answer);\n                                };\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/locationExtPrompt.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getBookingPrompt = function (params) {\n                    return {\n                        controller: 'BookingCtrl',\n                        resolve: {\n                            getParams: function () {\n                                return params;\n                            }\n                        },\n                        templateUrl: '/templates/booking.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                        backdrop  : 'static',\n                        keyboard  : false\n                    }\n                }\n                var showToast = function (message, parent) {\n                    if (message == \"CLEAR_CART\") {\n                        message = \"Debes vaciar tu carro para esa compra\";\n                    }\n                    var pinTo = getToastPosition();\n                    var toast = $mdToast.simple()\n                            .textContent(message)\n                            .position(pinTo)\n                            .hideDelay(3000)\n                    if (parent) {\n                        toast = $mdToast.simple()\n                                .textContent(message)\n                                .position(pinTo)\n                                .parent(parent)\n                                .hideDelay(3000)\n                    }\n\n                    $mdToast.show(toast);\n                }\n                var last = {\n                    bottom: false,\n                    top: true,\n                    left: false,\n                    right: true\n                };\n\n                var toastPosition = angular.extend({}, last);\n\n                var getToastPosition = function () {\n                    sanitizePosition();\n\n                    return Object.keys(toastPosition)\n                            .filter(function (pos) {\n                                return toastPosition[pos];\n                            }).join(' ');\n                };\n                function sanitizePosition() {\n                    var current = toastPosition;\n\n                    if (current.bottom && last.top) {\n                        current.top = false;\n                    }\n                    if (current.top && last.bottom) {\n                        current.bottom = false;\n                    }\n                    if (current.right && last.left) {\n                        current.left = false;\n                    }\n                    if (current.left && last.right) {\n                        current.right = false;\n                    }\n\n                    last = angular.extend({}, current);\n                }\n                var showLoader = function () {\n                    $mdDialog.show({\n                        controller: function () {\n\n                        },\n                        template: '<md-dialog style=\"background-color:transparent;box-shadow:none\">' +\n                                '<div layout=\"row\" layout-sm=\"column\" layout-align=\"center center\" aria-label=\"wait\" style=\"overflow:hidden\">' +\n                                '<md-progress-circular md-mode=\"indeterminate\" ></md-progress-circular>' +\n                                '</div>' +\n                                '</md-dialog>',\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                        fullscreen: false\n                    })\n                            .then(function (answer) {\n\n                            });\n                }\n                var hideLoader = function () {\n                    $mdDialog.hide()\n                            .then(function (answer) {\n\n                            });\n                }\n                var turnObjectToUrl = function (params, theUrl) {\n                    if (theUrl.includes(\"?\")) {\n                        theUrl = theUrl.split(\"?\")[0];\n                    }\n                    var first = true;\n                    for (var k in params) {\n                        if (params.hasOwnProperty(k)) {\n                            if (first) {\n                                theUrl += \"?\" + k + \"=\" + params[k];\n                                first = false;\n                            } else {\n                                theUrl += \"&\" + k + \"=\" + params[k];\n                            }\n                        }\n                    }\n                    return theUrl;\n                }\n                getAllUrlParams = function (url) {\n                    // get query string from url (optional) or window\n                    var queryString = url ? url.split('?')[1] : window.location.search.slice(1);\n                    console.log(\"Query string\",queryString);\n                    // we'll store the parameters here\n                    var obj = null;\n\n                    // if query string exists\n                    if (queryString) {\n                        obj = {};\n                        // stuff after # is not part of query string, so get rid of it\n                        queryString = queryString.split('#')[0];\n\n                        // split our query string into its component parts\n                        var arr = queryString.split('&');\n\n                        for (var i = 0; i < arr.length; i++) {\n                            // separate the keys and the values\n                            var a = arr[i].split('=');\n\n                            // set parameter name and value (use 'true' if empty)\n                            var paramName = a[0];\n                            var paramValue = typeof (a[1]) === 'undefined' ? true : a[1];\n\n                            // (optional) keep case consistent\n                            paramName = paramName.toLowerCase();\n                            if (typeof paramValue === 'string')\n                                paramValue = paramValue.toLowerCase();\n\n                            // if the paramName ends with square brackets, e.g. colors[] or colors[2]\n                            if (paramName.match(/\\[(\\d+)?\\]$/)) {\n\n                                // create key if it doesn't exist\n                                var key = paramName.replace(/\\[(\\d+)?\\]/, '');\n                                if (!obj[key])\n                                    obj[key] = [];\n\n                                // if it's an indexed array e.g. colors[2]\n                                if (paramName.match(/\\[\\d+\\]$/)) {\n                                    // get the index value and add the entry at the appropriate position\n                                    var index = /\\[(\\d+)\\]/.exec(paramName)[1];\n                                    obj[key][index] = paramValue;\n                                } else {\n                                    // otherwise add the value to the end of the array\n                                    obj[key].push(paramValue);\n                                }\n                            } else {\n                                // we're dealing with a string\n                                if (!obj[paramName]) {\n                                    // if it doesn't exist, create property\n                                    obj[paramName] = paramValue;\n                                } else if (obj[paramName] && typeof obj[paramName] === 'string') {\n                                    // if property does exist and it's a string, convert it to an array\n                                    obj[paramName] = [obj[paramName]];\n                                    obj[paramName].push(paramValue);\n                                } else {\n                                    // otherwise add the property\n                                    obj[paramName].push(paramValue);\n                                }\n                            }\n                        }\n                    }\n                    return obj;\n                }\n\n\n                return {\n                    getAddressesPopup: getAddressesPopup,\n                    getExportPopup: getExportPopup,\n                    getBookingPrompt:getBookingPrompt,\n                    getLocationPrompt: getLocationPrompt,\n                    getLocationExtPrompt: getLocationExtPrompt,\n                    getMerchantsPopup: getMerchantsPopup,\n                    getQuestionairePopup: getQuestionairePopup,\n                    showToast: showToast,\n                    getAppPopup: getAppPopup,\n                    showLoader: showLoader,\n                    turnObjectToUrl: turnObjectToUrl,\n                    hideLoader: hideLoader,\n                    getAllUrlParams: getAllUrlParams\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tb2RhbHMuanM/MzUwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgLnNlcnZpY2UoJ01vZGFscycsIFsnJG1kVG9hc3QnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24gKCRtZFRvYXN0LCAkbWREaWFsb2cpIHtcblxuICAgICAgICAgICAgICAgIHZhciBnZXRBZGRyZXNzZXNQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdBZGRyZXNzZXMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZywgQWRkcmVzc2VzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuYWRkcmVzc2VzICYmICRyb290U2NvcGUuYWRkcmVzc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc2VzID0gJHJvb3RTY29wZS5hZGRyZXNzZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFkZHJlc3Nlcy5nZXRBZGRyZXNzZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBkYXRhLmFkZHJlc3NlcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RBZGRyZXNzID0gZnVuY3Rpb24gKGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGFkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvYWRkcmVzc0xpc3QuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgZGlhbG9ncyBzaG91bGQgZnVsbHkgY292ZXIgYXBwbGljYXRpb24gdG8gcHJldmVudCBpbnRlcmFjdGlvbiBvdXRzaWRlIG9mIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRFeHBvcnRQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZW52aWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9leHBvcnRDb25maXJtYXRpb24uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgZGlhbG9ncyBzaG91bGQgZnVsbHkgY292ZXIgYXBwbGljYXRpb24gdG8gcHJldmVudCBpbnRlcmFjdGlvbiBvdXRzaWRlIG9mIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRBcHBQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdBZGRyZXNzZXMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZywgQWRkcmVzc2VzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UGxhdGZvcm0gPSBmdW5jdGlvbiAocGxhdGZvcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKHBsYXRmb3JtKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbW9iaWxlQXBwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vZGFsIGRpYWxvZ3Mgc2hvdWxkIGZ1bGx5IGNvdmVyIGFwcGxpY2F0aW9uIHRvIHByZXZlbnQgaW50ZXJhY3Rpb24gb3V0c2lkZSBvZiBkaWFsb2dcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0TWVyY2hhbnRzUG9wdXAgPSBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdNZXJjaGFudHMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZywgTWVyY2hhbnRzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSB7bGF0OiAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQsIGxvbmc6ICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcsIGNhdGVnb3J5OiBjYXRlZ29yeX07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHtsYXQ6ICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCwgbG9uZzogJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZ307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0TWVyY2hhbnRzQ292ZXJhZ2UoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RNZXJjaGFudCA9IGZ1bmN0aW9uIChtZXJjaGFudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUobWVyY2hhbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbWVyY2hhbnRzTGlzdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldFF1ZXN0aW9uYWlyZVBvcHVwID0gZnVuY3Rpb24gKHF1ZXN0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ01lcmNoYW50cycsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbnMgPSBxdWVzdGlvbnM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGVja1ZhbHVlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2tpbmc6IFwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCRzY29wZS5xdWVzdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3F1ZXN0aW9uYWlyZS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0TG9jYXRpb25Qcm9tcHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckbWREaWFsb2cnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbWREaWFsb2cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlciA9IGZ1bmN0aW9uIChhbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGFuc3dlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9sb2NhdGlvblByb21wdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldExvY2F0aW9uRXh0UHJvbXB0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24gKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbiAoYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShhbnN3ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbG9jYXRpb25FeHRQcm9tcHQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgZGlhbG9ncyBzaG91bGQgZnVsbHkgY292ZXIgYXBwbGljYXRpb24gdG8gcHJldmVudCBpbnRlcmFjdGlvbiBvdXRzaWRlIG9mIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRCb29raW5nUHJvbXB0ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Jvb2tpbmdDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRQYXJhbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2Jvb2tpbmcuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgZGlhbG9ncyBzaG91bGQgZnVsbHkgY292ZXIgYXBwbGljYXRpb24gdG8gcHJldmVudCBpbnRlcmFjdGlvbiBvdXRzaWRlIG9mIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2Ryb3AgIDogJ3N0YXRpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlib2FyZCAgOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzaG93VG9hc3QgPSBmdW5jdGlvbiAobWVzc2FnZSwgcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlID09IFwiQ0xFQVJfQ0FSVFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCJEZWJlcyB2YWNpYXIgdHUgY2Fycm8gcGFyYSBlc2EgY29tcHJhXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBpblRvID0gZ2V0VG9hc3RQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9hc3QgPSAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChtZXNzYWdlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihwaW5UbylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ID0gJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KG1lc3NhZ2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihwaW5UbylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhcmVudChwYXJlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3codG9hc3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbGFzdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdG9wOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHRydWVcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvYXN0UG9zaXRpb24gPSBhbmd1bGFyLmV4dGVuZCh7fSwgbGFzdCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0VG9hc3RQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2FuaXRpemVQb3NpdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0b2FzdFBvc2l0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHBvcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9hc3RQb3NpdGlvbltwb3NdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oJyAnKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNhbml0aXplUG9zaXRpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gdG9hc3RQb3NpdGlvbjtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5ib3R0b20gJiYgbGFzdC50b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQudG9wID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQudG9wICYmIGxhc3QuYm90dG9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmJvdHRvbSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LnJpZ2h0ICYmIGxhc3QubGVmdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5sZWZ0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubGVmdCAmJiBsYXN0LnJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnJpZ2h0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBsYXN0ID0gYW5ndWxhci5leHRlbmQoe30sIGN1cnJlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hvd0xvYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICc8bWQtZGlhbG9nIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtib3gtc2hhZG93Om5vbmVcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgbGF5b3V0PVwicm93XCIgbGF5b3V0LXNtPVwiY29sdW1uXCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiIGFyaWEtbGFiZWw9XCJ3YWl0XCIgc3R5bGU9XCJvdmVyZmxvdzpoaWRkZW5cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxtZC1wcm9ncmVzcy1jaXJjdWxhciBtZC1tb2RlPVwiaW5kZXRlcm1pbmF0ZVwiID48L21kLXByb2dyZXNzLWNpcmN1bGFyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbjogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoYW5zd2VyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGhpZGVMb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoYW5zd2VyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHR1cm5PYmplY3RUb1VybCA9IGZ1bmN0aW9uIChwYXJhbXMsIHRoZVVybCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhlVXJsLmluY2x1ZGVzKFwiP1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhlVXJsID0gdGhlVXJsLnNwbGl0KFwiP1wiKVswXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgZmlyc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVVcmwgKz0gXCI/XCIgKyBrICsgXCI9XCIgKyBwYXJhbXNba107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlVXJsICs9IFwiJlwiICsgayArIFwiPVwiICsgcGFyYW1zW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhlVXJsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZXRBbGxVcmxQYXJhbXMgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCBxdWVyeSBzdHJpbmcgZnJvbSB1cmwgKG9wdGlvbmFsKSBvciB3aW5kb3dcbiAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyaW5nID0gdXJsID8gdXJsLnNwbGl0KCc/JylbMV0gOiB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlF1ZXJ5IHN0cmluZ1wiLHF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UnbGwgc3RvcmUgdGhlIHBhcmFtZXRlcnMgaGVyZVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBxdWVyeSBzdHJpbmcgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWVyeVN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdHVmZiBhZnRlciAjIGlzIG5vdCBwYXJ0IG9mIHF1ZXJ5IHN0cmluZywgc28gZ2V0IHJpZCBvZiBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmcgPSBxdWVyeVN0cmluZy5zcGxpdCgnIycpWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzcGxpdCBvdXIgcXVlcnkgc3RyaW5nIGludG8gaXRzIGNvbXBvbmVudCBwYXJ0c1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IHF1ZXJ5U3RyaW5nLnNwbGl0KCcmJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VwYXJhdGUgdGhlIGtleXMgYW5kIHRoZSB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGFycltpXS5zcGxpdCgnPScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHBhcmFtZXRlciBuYW1lIGFuZCB2YWx1ZSAodXNlICd0cnVlJyBpZiBlbXB0eSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1OYW1lID0gYVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZSA9IHR5cGVvZiAoYVsxXSkgPT09ICd1bmRlZmluZWQnID8gdHJ1ZSA6IGFbMV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAob3B0aW9uYWwpIGtlZXAgY2FzZSBjb25zaXN0ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1OYW1lID0gcGFyYW1OYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbVZhbHVlID09PSAnc3RyaW5nJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1WYWx1ZSA9IHBhcmFtVmFsdWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBwYXJhbU5hbWUgZW5kcyB3aXRoIHNxdWFyZSBicmFja2V0cywgZS5nLiBjb2xvcnNbXSBvciBjb2xvcnNbMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1OYW1lLm1hdGNoKC9cXFsoXFxkKyk/XFxdJC8pKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIGtleSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBwYXJhbU5hbWUucmVwbGFjZSgvXFxbKFxcZCspP1xcXS8sICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmpba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtrZXldID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBhbiBpbmRleGVkIGFycmF5IGUuZy4gY29sb3JzWzJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbU5hbWUubWF0Y2goL1xcW1xcZCtcXF0kLykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgaW5kZXggdmFsdWUgYW5kIGFkZCB0aGUgZW50cnkgYXQgdGhlIGFwcHJvcHJpYXRlIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAvXFxbKFxcZCspXFxdLy5leGVjKHBhcmFtTmFtZSlbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba2V5XVtpbmRleF0gPSBwYXJhbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGFkZCB0aGUgdmFsdWUgdG8gdGhlIGVuZCBvZiB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtrZXldLnB1c2gocGFyYW1WYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkZWFsaW5nIHdpdGggYSBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmpbcGFyYW1OYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQgZG9lc24ndCBleGlzdCwgY3JlYXRlIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpbcGFyYW1OYW1lXSA9IHBhcmFtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob2JqW3BhcmFtTmFtZV0gJiYgdHlwZW9mIG9ialtwYXJhbU5hbWVdID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgcHJvcGVydHkgZG9lcyBleGlzdCBhbmQgaXQncyBhIHN0cmluZywgY29udmVydCBpdCB0byBhbiBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW3BhcmFtTmFtZV0gPSBbb2JqW3BhcmFtTmFtZV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW3BhcmFtTmFtZV0ucHVzaChwYXJhbVZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBhZGQgdGhlIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpbcGFyYW1OYW1lXS5wdXNoKHBhcmFtVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzZXNQb3B1cDogZ2V0QWRkcmVzc2VzUG9wdXAsXG4gICAgICAgICAgICAgICAgICAgIGdldEV4cG9ydFBvcHVwOiBnZXRFeHBvcnRQb3B1cCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0Qm9va2luZ1Byb21wdDpnZXRCb29raW5nUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICBnZXRMb2NhdGlvblByb21wdDogZ2V0TG9jYXRpb25Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIGdldExvY2F0aW9uRXh0UHJvbXB0OiBnZXRMb2NhdGlvbkV4dFByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0TWVyY2hhbnRzUG9wdXA6IGdldE1lcmNoYW50c1BvcHVwLFxuICAgICAgICAgICAgICAgICAgICBnZXRRdWVzdGlvbmFpcmVQb3B1cDogZ2V0UXVlc3Rpb25haXJlUG9wdXAsXG4gICAgICAgICAgICAgICAgICAgIHNob3dUb2FzdDogc2hvd1RvYXN0LFxuICAgICAgICAgICAgICAgICAgICBnZXRBcHBQb3B1cDogZ2V0QXBwUG9wdXAsXG4gICAgICAgICAgICAgICAgICAgIHNob3dMb2FkZXI6IHNob3dMb2FkZXIsXG4gICAgICAgICAgICAgICAgICAgIHR1cm5PYmplY3RUb1VybDogdHVybk9iamVjdFRvVXJsLFxuICAgICAgICAgICAgICAgICAgICBoaWRlTG9hZGVyOiBoaWRlTG9hZGVyLFxuICAgICAgICAgICAgICAgICAgICBnZXRBbGxVcmxQYXJhbXM6IGdldEFsbFVybFBhcmFtc1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tb2RhbHMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 43 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Orders',['$q', '$http', function ($q, $http) {\n\n            var getOrders = function (where) {\n                var url = '/api/orders' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get orders\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getStoreExport = function (from,to) {\n                var url = '/api/store/reports' ;\n                var def = $q.defer();\n                console.log(\"getStoreExport\",from,to);\n                $http({\n                    method: 'POST',\n                    url: url,\n                    data:{from:from,to:to}\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getStoreExport\");\n                        });\n                return def.promise;\n            }\n            var fullfillOrder = function (data) {\n                var url = '/api/items/status' ;\n                var def = $q.defer();\n                console.log(\"fullfillOrder\",data);\n                $http({\n                    method: 'POST',\n                    url: url,\n                    data:data\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to fullfillOrder\");\n                        });\n                return def.promise;\n            }\n            var approveOrder = function (order_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/'+order_id+\"/approve\",\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to approveOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            var updateOrderStatus = function (status,order_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/'+order_id+\"/build\",\n                        data: {\"status\":status}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateOrderStatus\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setShippingAddress = function (data) {\n                console.log(\"Setting order address: \",data)\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/shipping',\n                        data: data // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to setShippingAddress\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setPlatformShippingCondition = function (order,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/platform/shipping/'+order,\n                        data: platform, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to setPlatformShippingCondition\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getPlatformShippingPrice = function (order,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/orders/platform/shipping/'+order,\n                        params: platform, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateOrderStatus\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var prepareOrder = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/prepare/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to prepareOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setDiscounts = function (order,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/discounts/'+platform+\"/\"+order,\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to setDiscounts\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setCoupon = function (coupon) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/coupon',\n                        data: {\"coupon\":coupon}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to setCoupon\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var checkOrder = function (order,data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/check/'+order,\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to checkOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getOrder = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/orders/active',\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to getOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getOrders:getOrders,\n                getOrder:getOrder,\n                checkOrder:checkOrder,\n                approveOrder:approveOrder,\n                fullfillOrder:fullfillOrder,\n                setShippingAddress:setShippingAddress,\n                prepareOrder:prepareOrder,\n                setPlatformShippingCondition:setPlatformShippingCondition,\n                getPlatformShippingPrice:getPlatformShippingPrice,\n                setDiscounts:setDiscounts,\n                setCoupon:setCoupon,\n                getStoreExport:getStoreExport,\n                updateOrderStatus:updateOrderStatus\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9vcmRlcnMuanM/ODg1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgXG4gICAgICAgIC5zZXJ2aWNlKCdPcmRlcnMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRPcmRlcnMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvb3JkZXJzJyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBvcmRlcnNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTdG9yZUV4cG9ydCA9IGZ1bmN0aW9uIChmcm9tLHRvKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL3N0b3JlL3JlcG9ydHMnIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldFN0b3JlRXhwb3J0XCIsZnJvbSx0byk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6e2Zyb206ZnJvbSx0bzp0b31cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0U3RvcmVFeHBvcnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnVsbGZpbGxPcmRlciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2l0ZW1zL3N0YXR1cycgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZnVsbGZpbGxPcmRlclwiLGRhdGEpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZnVsbGZpbGxPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcHByb3ZlT3JkZXIgPSBmdW5jdGlvbiAob3JkZXJfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXJzLycrb3JkZXJfaWQrXCIvYXBwcm92ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhcHByb3ZlT3JkZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdXBkYXRlT3JkZXJTdGF0dXMgPSBmdW5jdGlvbiAoc3RhdHVzLG9yZGVyX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy8nK29yZGVyX2lkK1wiL2J1aWxkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XCJzdGF0dXNcIjpzdGF0dXN9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlT3JkZXJTdGF0dXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNldFNoaXBwaW5nQWRkcmVzcyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIG9yZGVyIGFkZHJlc3M6IFwiLGRhdGEpXG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9zaGlwcGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzZXRTaGlwcGluZ0FkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb24gPSBmdW5jdGlvbiAob3JkZXIscGxhdGZvcm0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXJzL3BsYXRmb3JtL3NoaXBwaW5nLycrb3JkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBwbGF0Zm9ybSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb25cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFBsYXRmb3JtU2hpcHBpbmdQcmljZSA9IGZ1bmN0aW9uIChvcmRlcixwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9wbGF0Zm9ybS9zaGlwcGluZy8nK29yZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwbGF0Zm9ybSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZU9yZGVyU3RhdHVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwcmVwYXJlT3JkZXIgPSBmdW5jdGlvbiAoZGF0YSxwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlcnMvcHJlcGFyZS8nK3BsYXRmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHByZXBhcmVPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2V0RGlzY291bnRzID0gZnVuY3Rpb24gKG9yZGVyLHBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9kaXNjb3VudHMvJytwbGF0Zm9ybStcIi9cIitvcmRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2V0RGlzY291bnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzZXRDb3Vwb24gPSBmdW5jdGlvbiAoY291cG9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9jb3Vwb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1wiY291cG9uXCI6Y291cG9ufSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNldENvdXBvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hlY2tPcmRlciA9IGZ1bmN0aW9uIChvcmRlcixkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9jaGVjay8nK29yZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGNoZWNrT3JkZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldE9yZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9hY3RpdmUnLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0T3JkZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdldE9yZGVyczpnZXRPcmRlcnMsXG4gICAgICAgICAgICAgICAgZ2V0T3JkZXI6Z2V0T3JkZXIsXG4gICAgICAgICAgICAgICAgY2hlY2tPcmRlcjpjaGVja09yZGVyLFxuICAgICAgICAgICAgICAgIGFwcHJvdmVPcmRlcjphcHByb3ZlT3JkZXIsXG4gICAgICAgICAgICAgICAgZnVsbGZpbGxPcmRlcjpmdWxsZmlsbE9yZGVyLFxuICAgICAgICAgICAgICAgIHNldFNoaXBwaW5nQWRkcmVzczpzZXRTaGlwcGluZ0FkZHJlc3MsXG4gICAgICAgICAgICAgICAgcHJlcGFyZU9yZGVyOnByZXBhcmVPcmRlcixcbiAgICAgICAgICAgICAgICBzZXRQbGF0Zm9ybVNoaXBwaW5nQ29uZGl0aW9uOnNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb24sXG4gICAgICAgICAgICAgICAgZ2V0UGxhdGZvcm1TaGlwcGluZ1ByaWNlOmdldFBsYXRmb3JtU2hpcHBpbmdQcmljZSxcbiAgICAgICAgICAgICAgICBzZXREaXNjb3VudHM6c2V0RGlzY291bnRzLFxuICAgICAgICAgICAgICAgIHNldENvdXBvbjpzZXRDb3Vwb24sXG4gICAgICAgICAgICAgICAgZ2V0U3RvcmVFeHBvcnQ6Z2V0U3RvcmVFeHBvcnQsXG4gICAgICAgICAgICAgICAgdXBkYXRlT3JkZXJTdGF0dXM6dXBkYXRlT3JkZXJTdGF0dXNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL29yZGVycy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 44 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Passport',['$q', '$http', function ($q, $http) {\n\n            var getOauthClients = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/oauth/clients'\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to get clients\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var createOauthClient = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/oauth/clients',\n                        data: data // pass in data as strings\n                        //headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to create client\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var updateOauthClient = function (data,id) {\n                var def = $q.defer();\n                $http({\n                        method: 'PUT',\n                        url: '/oauth/clients/'+id,\n                        data: data, // pass in data as strings\n                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to update client\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deleteOauthClient = function (client) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/oauth/clients/'+client\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to delete client\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getScopes = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/oauth/scopes' \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getPersonalAccessTokens = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/oauth/personal-access-tokens' \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var createPersonalAccessToken = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/oauth/personal-access-tokens',\n                        data: data, // pass in data as strings\n                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to create client\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deletePersonalAccessTokens = function (client) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/oauth/personal-access-tokens/'+client\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to delete client\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getTokens = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/user/authtokens' \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deleteTokens = function (token) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/oauth/tokens/'+token\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to delete client\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            \n            return {\n                getOauthClients: getOauthClients,\n                createOauthClient:createOauthClient,\n                updateOauthClient:updateOauthClient,\n                deleteOauthClient:deleteOauthClient,\n                getScopes:getScopes,\n                getPersonalAccessTokens:getPersonalAccessTokens,\n                deletePersonalAccessTokens:deletePersonalAccessTokens,\n                getTokens:getTokens,\n                deleteTokens:deleteTokens,\n                createPersonalAccessToken:createPersonalAccessToken,\n\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXNzcG9ydC5qcz80MjU3Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1Bhc3Nwb3J0JyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0T2F1dGhDbGllbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvY2xpZW50cydcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBjbGllbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNyZWF0ZU9hdXRoQ2xpZW50ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9vYXV0aC9jbGllbnRzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ30gIC8vIHNldCB0aGUgaGVhZGVycyBzbyBhbmd1bGFyIHBhc3NpbmcgaW5mbyBhcyBmb3JtIGRhdGEgKG5vdCByZXF1ZXN0IHBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjcmVhdGUgY2xpZW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlT2F1dGhDbGllbnQgPSBmdW5jdGlvbiAoZGF0YSxpZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvY2xpZW50cy8nK2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9ICAvLyBzZXQgdGhlIGhlYWRlcnMgc28gYW5ndWxhciBwYXNzaW5nIGluZm8gYXMgZm9ybSBkYXRhIChub3QgcmVxdWVzdCBwYXlsb2FkKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZU9hdXRoQ2xpZW50ID0gZnVuY3Rpb24gKGNsaWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvY2xpZW50cy8nK2NsaWVudFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTY29wZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvc2NvcGVzJyBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFBlcnNvbmFsQWNjZXNzVG9rZW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL29hdXRoL3BlcnNvbmFsLWFjY2Vzcy10b2tlbnMnIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3JlYXRlUGVyc29uYWxBY2Nlc3NUb2tlbiA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvcGVyc29uYWwtYWNjZXNzLXRva2VucycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ30gIC8vIHNldCB0aGUgaGVhZGVycyBzbyBhbmd1bGFyIHBhc3NpbmcgaW5mbyBhcyBmb3JtIGRhdGEgKG5vdCByZXF1ZXN0IHBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjcmVhdGUgY2xpZW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlUGVyc29uYWxBY2Nlc3NUb2tlbnMgPSBmdW5jdGlvbiAoY2xpZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9vYXV0aC9wZXJzb25hbC1hY2Nlc3MtdG9rZW5zLycrY2xpZW50XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGUgY2xpZW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFRva2VucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvdXNlci9hdXRodG9rZW5zJyBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZVRva2VucyA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvdG9rZW5zLycrdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZSBjbGllbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0T2F1dGhDbGllbnRzOiBnZXRPYXV0aENsaWVudHMsXG4gICAgICAgICAgICAgICAgY3JlYXRlT2F1dGhDbGllbnQ6Y3JlYXRlT2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgICAgdXBkYXRlT2F1dGhDbGllbnQ6dXBkYXRlT2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgICAgZGVsZXRlT2F1dGhDbGllbnQ6ZGVsZXRlT2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgICAgZ2V0U2NvcGVzOmdldFNjb3BlcyxcbiAgICAgICAgICAgICAgICBnZXRQZXJzb25hbEFjY2Vzc1Rva2VuczpnZXRQZXJzb25hbEFjY2Vzc1Rva2VucyxcbiAgICAgICAgICAgICAgICBkZWxldGVQZXJzb25hbEFjY2Vzc1Rva2VuczpkZWxldGVQZXJzb25hbEFjY2Vzc1Rva2VucyxcbiAgICAgICAgICAgICAgICBnZXRUb2tlbnM6Z2V0VG9rZW5zLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVRva2VuczpkZWxldGVUb2tlbnMsXG4gICAgICAgICAgICAgICAgY3JlYXRlUGVyc29uYWxBY2Nlc3NUb2tlbjpjcmVhdGVQZXJzb25hbEFjY2Vzc1Rva2VuLFxuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXNzcG9ydC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 45 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Payments',['$q', '$http', function ($q, $http) {\n\n            var getPayments = function (where) {\n                var url = '/api/payments' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get payments\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getPaymentsUser = function (where) {\n                var url = '/api/billing/payments' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get payments\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var approvePayment = function (payment_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/payments/'+payment_id+\"/approve\",\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to approvePayment\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var retryPayment = function (payment_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/retry/'+payment_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to retryPayment\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var addTransactionCosts = function (payment_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/add_transaction_costs/'+payment_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to addTransactionCosts\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n\n            return {\n                getPayments:getPayments,\n                getPaymentsUser:getPaymentsUser,\n                retryPayment:retryPayment,\n                addTransactionCosts:addTransactionCosts,\n                approvePayment:approvePayment\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXltZW50cy5qcz9kMTI2Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1BheW1lbnRzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0UGF5bWVudHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvcGF5bWVudHMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IHBheW1lbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0UGF5bWVudHNVc2VyID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2JpbGxpbmcvcGF5bWVudHMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IHBheW1lbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXBwcm92ZVBheW1lbnQgPSBmdW5jdGlvbiAocGF5bWVudF9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9wYXltZW50cy8nK3BheW1lbnRfaWQrXCIvYXBwcm92ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhcHByb3ZlUGF5bWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmV0cnlQYXltZW50ID0gZnVuY3Rpb24gKHBheW1lbnRfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYmlsbGluZy9yZXRyeS8nK3BheW1lbnRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHJldHJ5UGF5bWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYWRkVHJhbnNhY3Rpb25Db3N0cyA9IGZ1bmN0aW9uIChwYXltZW50X2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvYWRkX3RyYW5zYWN0aW9uX2Nvc3RzLycrcGF5bWVudF9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkVHJhbnNhY3Rpb25Db3N0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnZXRQYXltZW50czpnZXRQYXltZW50cyxcbiAgICAgICAgICAgICAgICBnZXRQYXltZW50c1VzZXI6Z2V0UGF5bWVudHNVc2VyLFxuICAgICAgICAgICAgICAgIHJldHJ5UGF5bWVudDpyZXRyeVBheW1lbnQsXG4gICAgICAgICAgICAgICAgYWRkVHJhbnNhY3Rpb25Db3N0czphZGRUcmFuc2FjdGlvbkNvc3RzLFxuICAgICAgICAgICAgICAgIGFwcHJvdmVQYXltZW50OmFwcHJvdmVQYXltZW50XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXltZW50cy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 46 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('ProductImport',['$q', '$http', function ($q, $http) {\n\n            var getProducts = function (where) {\n                var url = '/api/admin/store/products' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getProducts\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getVariants = function (where) {\n                var url = '/api/admin/store/variants' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getVariants\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getMerchants = function (where) {\n                var url = '/api/admin/store/merchants' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getMerchants\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getCategories = function (where) {\n                var url = '/api/admin/store/categories' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getCategories\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteProductItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/products/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteProductItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteMerchantItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/merchants/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteMerchantItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteVariantItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/variants/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteVariantItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteCategoryItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/categories/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteCategoryItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getProducts:getProducts,\n                getVariants:getVariants,\n                getMerchants:getMerchants,\n                getCategories:getCategories,\n                deleteProductItem:deleteProductItem,\n                deleteMerchantItem:deleteMerchantItem,\n                deleteVariantItem:deleteVariantItem,\n                deleteCategoryItem:deleteCategoryItem\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wcm9kdWN0LWltcG9ydC5qcz8zM2M0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1Byb2R1Y3RJbXBvcnQnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRQcm9kdWN0cyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9zdG9yZS9wcm9kdWN0cycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRQcm9kdWN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0VmFyaWFudHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYWRtaW4vc3RvcmUvdmFyaWFudHMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0VmFyaWFudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldE1lcmNoYW50cyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9zdG9yZS9tZXJjaGFudHMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0TWVyY2hhbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRDYXRlZ29yaWVzID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2FkbWluL3N0b3JlL2NhdGVnb3JpZXMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0Q2F0ZWdvcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlUHJvZHVjdEl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3N0b3JlL3Byb2R1Y3RzLycraXRlbS5pZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlUHJvZHVjdEl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZU1lcmNoYW50SXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vc3RvcmUvbWVyY2hhbnRzLycraXRlbS5pZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlTWVyY2hhbnRJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVWYXJpYW50SXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vc3RvcmUvdmFyaWFudHMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVWYXJpYW50SXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlQ2F0ZWdvcnlJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZG1pbi9zdG9yZS9jYXRlZ29yaWVzLycraXRlbS5pZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlQ2F0ZWdvcnlJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnZXRQcm9kdWN0czpnZXRQcm9kdWN0cyxcbiAgICAgICAgICAgICAgICBnZXRWYXJpYW50czpnZXRWYXJpYW50cyxcbiAgICAgICAgICAgICAgICBnZXRNZXJjaGFudHM6Z2V0TWVyY2hhbnRzLFxuICAgICAgICAgICAgICAgIGdldENhdGVnb3JpZXM6Z2V0Q2F0ZWdvcmllcyxcbiAgICAgICAgICAgICAgICBkZWxldGVQcm9kdWN0SXRlbTpkZWxldGVQcm9kdWN0SXRlbSxcbiAgICAgICAgICAgICAgICBkZWxldGVNZXJjaGFudEl0ZW06ZGVsZXRlTWVyY2hhbnRJdGVtLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVZhcmlhbnRJdGVtOmRlbGV0ZVZhcmlhbnRJdGVtLFxuICAgICAgICAgICAgICAgIGRlbGV0ZUNhdGVnb3J5SXRlbTpkZWxldGVDYXRlZ29yeUl0ZW1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL3Byb2R1Y3QtaW1wb3J0LmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 47 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Products', ['$q', '$http', function ($q, $http) {\n\n                var addRating = function (rating) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/ratings\",\n                        data: rating\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var addFavorite = function (data) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/favorites\",\n                        data: data\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var deleteFavorite = function (data) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/favorites/delete\",\n                        data: data\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var checkFavorite = function (rating) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/products/favorites\",\n                        data: rating\n                    })\n                            .success(function (data) {\n                                // console.log(data);\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var getProductsMerchant = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"GET\",\n                        url: \"/api/merchants/products\",\n                        params: data\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to getProductsMerchant\");\n                            });\n                    return def.promise;\n                };\n                var searchProducts = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"GET\",\n                        url: \"/api/products/search\",\n                        params: data\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                            .error(function () {\n                                def.reject(\"Failed to searchProducts\");\n                            });\n                    return def.promise;\n                };\n                var buildProduct = function (container, merchant) {\n                    var productInfo = {};\n\n                    productInfo.id = container.product_id;\n                    productInfo.name = container.prod_name;\n                    productInfo.description = container.prod_desc;\n                    productInfo.isActive = container.isActive;\n                    productInfo.slug = container.slug;\n                    productInfo.description_more = false;\n                    productInfo.more = false;\n                    productInfo.type = container.type;\n                    productInfo.merchant_description_more = false;\n                    if (merchant) {\n                        productInfo.merchant_name = merchant.merchant_name;\n                        productInfo.merchant_id = merchant.merchant_id;\n                        productInfo.merchant_description = merchant.merchant_description;\n                        productInfo.merchant_attributes = merchant.merchant_attributes;\n                        productInfo.src = merchant.merchant_icon;\n\n                        productInfo.merchant_type = merchant.merchant_type;\n                    }\n\n                    productInfo.inCart = false;\n                    if (container.is_on_sale) {\n\n                        productInfo.onsale = true;\n                        productInfo.subtotal = productInfo.price;\n                        productInfo.exsubtotal = productInfo.exprice;\n                    } else {\n                        productInfo.subtotal = productInfo.price;\n                        productInfo.onsale = false;\n                    }\n                    productInfo = updateProductVisual(container, productInfo);\n                    productInfo.item_id = null;\n                    productInfo.amount = container.min_quantity;\n                    productInfo.imgs = [];\n                    productInfo.variants = [];\n                    return productInfo;\n                };\n                var createVariant = function (container) {\n                    var variant = {};\n                            console.log(\"Variant\", container);\n                    //        console.log(\"Variant\", container.id)\n                    variant.id = container.id;\n                    variant.description = container.description;\n                    variant.type = container.type;\n                    if (container.attributes.length > 0) {\n                        variant.attributes = JSON.parse(container.attributes);\n                        if (variant.attributes.buyers) {\n                            variant.unitPrice = variant.price / variant.attributes.buyers;\n                        } else {\n                            variant.unitPrice = variant.price;\n                        }\n                    } else {\n                        variant.attributes = \"\";\n                    }\n                    if (container.is_on_sale) {\n                        variant.exprice = container.price;\n                        variant.price = container.sale;\n                    } else {\n                        variant.price = container.price;\n                    }\n                    variant.is_on_sale = container.is_on_sale;\n                    variant.min_quantity = container.min_quantity;\n                    return variant;\n                }\n                var getCategory = function (variant, arrayCategories) {\n                    for (var i in arrayCategories) {\n                        if (arrayCategories[i].id == variant['category_id']) {\n                            return arrayCategories[i];\n                        }\n                    }\n                    var activeCategory = {\n                        \"name\": variant['category_name'],\n                        \"id\": variant['category_id'],\n                        \"description\": variant['category_description'],\n                        \"products\": [],\n                        \"more\": false\n                    }\n                    arrayCategories.push(activeCategory);\n                    return activeCategory\n                }\n                var getProduct = function (variant, arrayCategories, merchant) {\n                    for (var i in arrayCategories) {\n                        for (var j in arrayCategories[i].products) {\n                            if (arrayCategories[i].products[j].id == variant['product_id']) {\n                                return arrayCategories[i].products[j];\n                            }\n                        }\n                    }\n                    var productInfo = buildProduct(variant, merchant);\n                    return productInfo;\n                }\n\n                var buildProductInformation = function (items) {\n                    if (items['products_variants'].length > 0) {\n                        var resultsCategory = [];\n                        var processedVariants = [];\n                        for (var i = 0; i < items['products_variants'].length; i++) {\n                            if (processedVariants.includes(items['products_variants'][i].id)) {\n                                continue;\n                            } else {\n                                processedVariants.push(items['products_variants'][i].id);\n                            }\n\n                            var category = getCategory(items['products_variants'][i], resultsCategory);\n                            console.log(\"Category found\", category);\n                            var product = getProduct(items['products_variants'][i], resultsCategory, items['merchant_products'][0]);\n                            console.log(\"product found\", product);\n                            if (!containsObject(product, category.products)) {\n                                category.products.push(product);\n                            }\n                            var variant = createVariant(items['products_variants'][i]);\n                            if (variant.price < product.price) {\n                                product = updateProductVisual(variant, product);\n                            }\n                            if (!containsObject(variant, product.variants)) {\n                                product.variants.push(variant);\n                            }\n                        }\n                        for (var j in items['products_files']) {\n                            for (var i$1 = 0; i$1 < resultsCategory.length; i$1++) {\n                                for (var k in resultsCategory[i$1].products) {\n                                    var imgInfo = {};\n                                    if (items['products_files'][j].trigger_id == resultsCategory[i$1].products[k].id) {\n                                        imgInfo.file = items['products_files'][j].file;\n                                        if(resultsCategory[i$1].products[k].imgs.length == 0){\n                                            resultsCategory[i$1].products[k].src = imgInfo.file;\n                                        }\n                                        resultsCategory[i$1].products[k].imgs.push(imgInfo);\n                                        break;\n                                    }\n                                }\n\n                            }\n                        }\n                        console.log('resultbuildCat', resultsCategory);\n                        return resultsCategory;\n                    }\n                    return null;\n                }\n                var containsObject = function (obj, list) {\n                    var x;\n                    for (x in list) {\n                        if (list[x].id == obj.id) {\n                            return true;\n                        }\n                    }\n                    return false;\n                }\n\n                var updateProductVisual = function (container, productInfo) {\n                    if (container.is_on_sale) {\n                        productInfo.price = container.price;\n                        productInfo.onsale = true;\n                        productInfo.exprice = container.exprice;\n                    } else {\n                        productInfo.price = container.price;\n                        productInfo.onsale = false;\n                    }\n\n                    productInfo.variant_id = container.id;\n                    if (container.attributes) {\n                        var attributes = container.attributes;\n                        if (attributes.buyers) {\n                            productInfo.unitPrice = productInfo.price / attributes.buyers;\n                            productInfo.unitLunches = attributes.buyers;\n                        } else {\n                            productInfo.unitPrice = productInfo.price;\n                            productInfo.unitLunches = 1;\n                        }\n\n                    } else {\n                        productInfo.unitPrice = productInfo.price;\n                        productInfo.unitLunches = 1;\n                    }\n                    //        console.log(\"Update Prod Vis3\", productInfo);\n                    return productInfo;\n                }\n\n                return {\n                    addRating:addRating,\n                    deleteFavorite:deleteFavorite,\n                    checkFavorite:checkFavorite,\n                    addFavorite:addFavorite,\n                    searchProducts:searchProducts,\n                    getProductsMerchant: getProductsMerchant,\n                    buildProductInformation: buildProductInformation\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wcm9kdWN0cy5qcz9kMjQ5Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuc2VydmljZSgnUHJvZHVjdHMnLCBbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGFkZFJhdGluZyA9IGZ1bmN0aW9uIChyYXRpbmcpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvcmF0aW5nc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogcmF0aW5nXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhZGRSYXRpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGFkZEZhdm9yaXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvZmF2b3JpdGVzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhZGRSYXRpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGRlbGV0ZUZhdm9yaXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvZmF2b3JpdGVzL2RlbGV0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkUmF0aW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBjaGVja0Zhdm9yaXRlID0gZnVuY3Rpb24gKHJhdGluZykge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9wcm9kdWN0cy9mYXZvcml0ZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJhdGluZ1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkUmF0aW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBnZXRQcm9kdWN0c01lcmNoYW50ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL21lcmNoYW50cy9wcm9kdWN0c1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFByb2R1Y3RzTWVyY2hhbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBzZWFyY2hQcm9kdWN0cyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9wcm9kdWN0cy9zZWFyY2hcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzZWFyY2hQcm9kdWN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGJ1aWxkUHJvZHVjdCA9IGZ1bmN0aW9uIChjb250YWluZXIsIG1lcmNoYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0SW5mbyA9IHt9O1xuXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmlkID0gY29udGFpbmVyLnByb2R1Y3RfaWQ7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm5hbWUgPSBjb250YWluZXIucHJvZF9uYW1lO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5kZXNjcmlwdGlvbiA9IGNvbnRhaW5lci5wcm9kX2Rlc2M7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmlzQWN0aXZlID0gY29udGFpbmVyLmlzQWN0aXZlO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5zbHVnID0gY29udGFpbmVyLnNsdWc7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmRlc2NyaXB0aW9uX21vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ubW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby50eXBlID0gY29udGFpbmVyLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm1lcmNoYW50X2Rlc2NyaXB0aW9uX21vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lcmNoYW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5tZXJjaGFudF9uYW1lID0gbWVyY2hhbnQubWVyY2hhbnRfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm1lcmNoYW50X2lkID0gbWVyY2hhbnQubWVyY2hhbnRfaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5tZXJjaGFudF9kZXNjcmlwdGlvbiA9IG1lcmNoYW50Lm1lcmNoYW50X2Rlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ubWVyY2hhbnRfYXR0cmlidXRlcyA9IG1lcmNoYW50Lm1lcmNoYW50X2F0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5zcmMgPSBtZXJjaGFudC5tZXJjaGFudF9pY29uO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5tZXJjaGFudF90eXBlID0gbWVyY2hhbnQubWVyY2hhbnRfdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmluQ2FydCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmlzX29uX3NhbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ub25zYWxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnN1YnRvdGFsID0gcHJvZHVjdEluZm8ucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5leHN1YnRvdGFsID0gcHJvZHVjdEluZm8uZXhwcmljZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnN1YnRvdGFsID0gcHJvZHVjdEluZm8ucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5vbnNhbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mbyA9IHVwZGF0ZVByb2R1Y3RWaXN1YWwoY29udGFpbmVyLCBwcm9kdWN0SW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLml0ZW1faWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5hbW91bnQgPSBjb250YWluZXIubWluX3F1YW50aXR5O1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5pbWdzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnZhcmlhbnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9kdWN0SW5mbztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVWYXJpYW50ID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFyaWFudCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVmFyaWFudFwiLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgY29uc29sZS5sb2coXCJWYXJpYW50XCIsIGNvbnRhaW5lci5pZClcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5pZCA9IGNvbnRhaW5lci5pZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5kZXNjcmlwdGlvbiA9IGNvbnRhaW5lci5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudC50eXBlID0gY29udGFpbmVyLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuYXR0cmlidXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50LmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGNvbnRhaW5lci5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYW50LmF0dHJpYnV0ZXMuYnV5ZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudC51bml0UHJpY2UgPSB2YXJpYW50LnByaWNlIC8gdmFyaWFudC5hdHRyaWJ1dGVzLmJ1eWVycztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudC51bml0UHJpY2UgPSB2YXJpYW50LnByaWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5hdHRyaWJ1dGVzID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmlzX29uX3NhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQuZXhwcmljZSA9IGNvbnRhaW5lci5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQucHJpY2UgPSBjb250YWluZXIuc2FsZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQucHJpY2UgPSBjb250YWluZXIucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5pc19vbl9zYWxlID0gY29udGFpbmVyLmlzX29uX3NhbGU7XG4gICAgICAgICAgICAgICAgICAgIHZhcmlhbnQubWluX3F1YW50aXR5ID0gY29udGFpbmVyLm1pbl9xdWFudGl0eTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhcmlhbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRDYXRlZ29yeSA9IGZ1bmN0aW9uICh2YXJpYW50LCBhcnJheUNhdGVnb3JpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiBhcnJheUNhdGVnb3JpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnJheUNhdGVnb3JpZXNbaV0uaWQgPT0gdmFyaWFudFsnY2F0ZWdvcnlfaWQnXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcnJheUNhdGVnb3JpZXNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZUNhdGVnb3J5ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IHZhcmlhbnRbJ2NhdGVnb3J5X25hbWUnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogdmFyaWFudFsnY2F0ZWdvcnlfaWQnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGVzY3JpcHRpb25cIjogdmFyaWFudFsnY2F0ZWdvcnlfZGVzY3JpcHRpb24nXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZHVjdHNcIjogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1vcmVcIjogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhcnJheUNhdGVnb3JpZXMucHVzaChhY3RpdmVDYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3RpdmVDYXRlZ29yeVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UHJvZHVjdCA9IGZ1bmN0aW9uICh2YXJpYW50LCBhcnJheUNhdGVnb3JpZXMsIG1lcmNoYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gYXJyYXlDYXRlZ29yaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluIGFycmF5Q2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnJheUNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0uaWQgPT0gdmFyaWFudFsncHJvZHVjdF9pZCddKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcnJheUNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0SW5mbyA9IGJ1aWxkUHJvZHVjdCh2YXJpYW50LCBtZXJjaGFudCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9kdWN0SW5mbztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYnVpbGRQcm9kdWN0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zWydwcm9kdWN0c192YXJpYW50cyddLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRzQ2F0ZWdvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwcm9jZXNzZWRWYXJpYW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtc1sncHJvZHVjdHNfdmFyaWFudHMnXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzZWRWYXJpYW50cy5pbmNsdWRlcyhpdGVtc1sncHJvZHVjdHNfdmFyaWFudHMnXVtpXS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkVmFyaWFudHMucHVzaChpdGVtc1sncHJvZHVjdHNfdmFyaWFudHMnXVtpXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNhdGVnb3J5ID0gZ2V0Q2F0ZWdvcnkoaXRlbXNbJ3Byb2R1Y3RzX3ZhcmlhbnRzJ11baV0sIHJlc3VsdHNDYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYXRlZ29yeSBmb3VuZFwiLCBjYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHByb2R1Y3QgPSBnZXRQcm9kdWN0KGl0ZW1zWydwcm9kdWN0c192YXJpYW50cyddW2ldLCByZXN1bHRzQ2F0ZWdvcnksIGl0ZW1zWydtZXJjaGFudF9wcm9kdWN0cyddWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInByb2R1Y3QgZm91bmRcIiwgcHJvZHVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250YWluc09iamVjdChwcm9kdWN0LCBjYXRlZ29yeS5wcm9kdWN0cykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnkucHJvZHVjdHMucHVzaChwcm9kdWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhcmlhbnQgPSBjcmVhdGVWYXJpYW50KGl0ZW1zWydwcm9kdWN0c192YXJpYW50cyddW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFudC5wcmljZSA8IHByb2R1Y3QucHJpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdCA9IHVwZGF0ZVByb2R1Y3RWaXN1YWwodmFyaWFudCwgcHJvZHVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29udGFpbnNPYmplY3QodmFyaWFudCwgcHJvZHVjdC52YXJpYW50cykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC52YXJpYW50cy5wdXNoKHZhcmlhbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogaW4gaXRlbXNbJ3Byb2R1Y3RzX2ZpbGVzJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdHNDYXRlZ29yeS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrIGluIHJlc3VsdHNDYXRlZ29yeVtpXS5wcm9kdWN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGltZ0luZm8gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1sncHJvZHVjdHNfZmlsZXMnXVtqXS50cmlnZ2VyX2lkID09IHJlc3VsdHNDYXRlZ29yeVtpXS5wcm9kdWN0c1trXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ0luZm8uZmlsZSA9IGl0ZW1zWydwcm9kdWN0c19maWxlcyddW2pdLmZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0c0NhdGVnb3J5W2ldLnByb2R1Y3RzW2tdLmltZ3MubGVuZ3RoID09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzQ2F0ZWdvcnlbaV0ucHJvZHVjdHNba10uc3JjID0gaW1nSW5mby5maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzQ2F0ZWdvcnlbaV0ucHJvZHVjdHNba10uaW1ncy5wdXNoKGltZ0luZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzdWx0YnVpbGRDYXQnLCByZXN1bHRzQ2F0ZWdvcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHNDYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5zT2JqZWN0ID0gZnVuY3Rpb24gKG9iaiwgbGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeDtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh4IGluIGxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0W3hdLmlkID09IG9iai5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlUHJvZHVjdFZpc3VhbCA9IGZ1bmN0aW9uIChjb250YWluZXIsIHByb2R1Y3RJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuaXNfb25fc2FsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ucHJpY2UgPSBjb250YWluZXIucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5vbnNhbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uZXhwcmljZSA9IGNvbnRhaW5lci5leHByaWNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ucHJpY2UgPSBjb250YWluZXIucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5vbnNhbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnZhcmlhbnRfaWQgPSBjb250YWluZXIuaWQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBjb250YWluZXIuYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmJ1eWVycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnVuaXRQcmljZSA9IHByb2R1Y3RJbmZvLnByaWNlIC8gYXR0cmlidXRlcy5idXllcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udW5pdEx1bmNoZXMgPSBhdHRyaWJ1dGVzLmJ1eWVycztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udW5pdFByaWNlID0gcHJvZHVjdEluZm8ucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udW5pdEx1bmNoZXMgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby51bml0UHJpY2UgPSBwcm9kdWN0SW5mby5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnVuaXRMdW5jaGVzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGUgUHJvZCBWaXMzXCIsIHByb2R1Y3RJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2R1Y3RJbmZvO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGFkZFJhdGluZzphZGRSYXRpbmcsXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZUZhdm9yaXRlOmRlbGV0ZUZhdm9yaXRlLFxuICAgICAgICAgICAgICAgICAgICBjaGVja0Zhdm9yaXRlOmNoZWNrRmF2b3JpdGUsXG4gICAgICAgICAgICAgICAgICAgIGFkZEZhdm9yaXRlOmFkZEZhdm9yaXRlLFxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hQcm9kdWN0czpzZWFyY2hQcm9kdWN0cyxcbiAgICAgICAgICAgICAgICAgICAgZ2V0UHJvZHVjdHNNZXJjaGFudDogZ2V0UHJvZHVjdHNNZXJjaGFudCxcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRQcm9kdWN0SW5mb3JtYXRpb246IGJ1aWxkUHJvZHVjdEluZm9ybWF0aW9uXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL3Byb2R1Y3RzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 48 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Routes',['$q', '$http', function ($q, $http) {\n\n            var getRoutes = function (where) {\n                var url = '/api/routes' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get routes\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deleteRoute = function (route_id) {\n                var url = '/api/routes/'+route_id ;\n                var def = $q.defer();\n                $http({\n                    method: 'delete',\n                    url: url \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to deleteRoute\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getKeyStatus = function (key) {\n                var url = '/api/rapigo/status/'+key ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to getKeyStatus\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteStop = function (stop_id) {\n                var url = '/api/stops/'+stop_id ;\n                var def = $q.defer();\n                $http({\n                    method: 'delete',\n                    url: url \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to deleteStop\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var buildRoute = function (route_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/routes/'+route_id+\"/build\",\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to buildRoute\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            var updateRouteStop = function (route_id,stop_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/routes/'+route_id+\"/stop/\"+stop_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateRouteStops\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var updateRouteDelivery = function (route_id,delivery_id,stop_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/routes/add_delivery',\n                        data: {\n                            \"route_id\":route_id,\n                            \"delivery_id\":delivery_id,\n                            \"stop_id\":stop_id\n                        }, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateRouteDelivery\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var sendStopToNewRoute = function (stop_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: \"/api/routes/stop/\"+stop_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to sendStopToNewRoute\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var addReturnStop = function (route_id,address_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: \"/api/routes/\"+route_id+\"/return\",\n                        data: {address_id:address_id}, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to sendStopToNewRoute\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getRoutes:getRoutes,\n                deleteStop:deleteStop,\n                getKeyStatus:getKeyStatus,\n                deleteRoute:deleteRoute,\n                sendStopToNewRoute:sendStopToNewRoute,\n                buildRoute:buildRoute,\n                addReturnStop:addReturnStop,\n                updateRouteStop:updateRouteStop,\n                updateRouteDelivery:updateRouteDelivery\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9yb3V0ZXMuanM/MDAwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgXG4gICAgICAgIC5zZXJ2aWNlKCdSb3V0ZXMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRSb3V0ZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvcm91dGVzJyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgcm91dGVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlUm91dGUgPSBmdW5jdGlvbiAocm91dGVfaWQpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvcm91dGVzLycrcm91dGVfaWQgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZVJvdXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldEtleVN0YXR1cyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvcmFwaWdvL3N0YXR1cy8nK2tleSA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0S2V5U3RhdHVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVTdG9wID0gZnVuY3Rpb24gKHN0b3BfaWQpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvc3RvcHMvJytzdG9wX2lkIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVTdG9wXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJ1aWxkUm91dGUgPSBmdW5jdGlvbiAocm91dGVfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvcm91dGVzLycrcm91dGVfaWQrXCIvYnVpbGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYnVpbGRSb3V0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB1cGRhdGVSb3V0ZVN0b3AgPSBmdW5jdGlvbiAocm91dGVfaWQsc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9yb3V0ZXMvJytyb3V0ZV9pZCtcIi9zdG9wL1wiK3N0b3BfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZVJvdXRlU3RvcHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHVwZGF0ZVJvdXRlRGVsaXZlcnkgPSBmdW5jdGlvbiAocm91dGVfaWQsZGVsaXZlcnlfaWQsc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9yb3V0ZXMvYWRkX2RlbGl2ZXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJvdXRlX2lkXCI6cm91dGVfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZWxpdmVyeV9pZFwiOmRlbGl2ZXJ5X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RvcF9pZFwiOnN0b3BfaWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byB1cGRhdGVSb3V0ZURlbGl2ZXJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzZW5kU3RvcFRvTmV3Um91dGUgPSBmdW5jdGlvbiAoc3RvcF9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvcm91dGVzL3N0b3AvXCIrc3RvcF9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2VuZFN0b3BUb05ld1JvdXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhZGRSZXR1cm5TdG9wID0gZnVuY3Rpb24gKHJvdXRlX2lkLGFkZHJlc3NfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3JvdXRlcy9cIityb3V0ZV9pZCtcIi9yZXR1cm5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHthZGRyZXNzX2lkOmFkZHJlc3NfaWR9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2VuZFN0b3BUb05ld1JvdXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnZXRSb3V0ZXM6Z2V0Um91dGVzLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVN0b3A6ZGVsZXRlU3RvcCxcbiAgICAgICAgICAgICAgICBnZXRLZXlTdGF0dXM6Z2V0S2V5U3RhdHVzLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVJvdXRlOmRlbGV0ZVJvdXRlLFxuICAgICAgICAgICAgICAgIHNlbmRTdG9wVG9OZXdSb3V0ZTpzZW5kU3RvcFRvTmV3Um91dGUsXG4gICAgICAgICAgICAgICAgYnVpbGRSb3V0ZTpidWlsZFJvdXRlLFxuICAgICAgICAgICAgICAgIGFkZFJldHVyblN0b3A6YWRkUmV0dXJuU3RvcCxcbiAgICAgICAgICAgICAgICB1cGRhdGVSb3V0ZVN0b3A6dXBkYXRlUm91dGVTdG9wLFxuICAgICAgICAgICAgICAgIHVwZGF0ZVJvdXRlRGVsaXZlcnk6dXBkYXRlUm91dGVEZWxpdmVyeVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvcm91dGVzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 49 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Users',['$q', '$http', function ($q, $http) {\n\n            var setAsBillingAddress = function (address_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/user/billingAddress/'+address_id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getAddresses = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/addresses' \n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveAddress = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/addresses',\n                        data: data, // pass in data as strings  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveUser = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/user',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to create user\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var updatePassword = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/user/change_password',\n                        data: data, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updatePassword\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getUser = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/user',\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to get user\");\n                        });\n                return def.promise;\n            }\n            var deleteAddress = function (address) {\n                var def = $q.defer();\n                $http({\n                    method: 'DELETE',\n                    url: '/api/addresses/' + address\n                })\n                        .success(function (data) {\n                            console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to Delete Address\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getContacts = function (text) {\n                var where = \"\";\n                if(text.length>0){\n                    where = \"?name=\\*\"+text+\"\\*\";\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/contacts' +where\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            return {\n                setAsBillingAddress: setAsBillingAddress,\n                getAddresses:getAddresses,\n                saveAddress:saveAddress,\n                deleteAddress:deleteAddress,\n                updatePassword:updatePassword,\n                saveUser:saveUser,\n                getContacts:getContacts,\n                getUser:getUser\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy91c2Vycy5qcz83MjdjIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1VzZXJzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgc2V0QXNCaWxsaW5nQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvdXNlci9iaWxsaW5nQWRkcmVzcy8nK2FkZHJlc3NfaWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMnIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2F2ZUFkZHJlc3MgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3MgIC8vIHNldCB0aGUgaGVhZGVycyBzbyBhbmd1bGFyIHBhc3NpbmcgaW5mbyBhcyBmb3JtIGRhdGEgKG5vdCByZXF1ZXN0IHBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2F2ZVVzZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS91c2VyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHVwZGF0ZVBhc3N3b3JkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvdXNlci9jaGFuZ2VfcGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZVBhc3N3b3JkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS91c2VyJyxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCB1c2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZUFkZHJlc3MgPSBmdW5jdGlvbiAoYWRkcmVzcykge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMvJyArIGFkZHJlc3NcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gRGVsZXRlIEFkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRDb250YWN0cyA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZih0ZXh0Lmxlbmd0aD4wKXtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmUgPSBcIj9uYW1lPVxcKlwiK3RleHQrXCJcXCpcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2NvbnRhY3RzJyArd2hlcmVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzZXRBc0JpbGxpbmdBZGRyZXNzOiBzZXRBc0JpbGxpbmdBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGdldEFkZHJlc3NlczpnZXRBZGRyZXNzZXMsXG4gICAgICAgICAgICAgICAgc2F2ZUFkZHJlc3M6c2F2ZUFkZHJlc3MsXG4gICAgICAgICAgICAgICAgZGVsZXRlQWRkcmVzczpkZWxldGVBZGRyZXNzLFxuICAgICAgICAgICAgICAgIHVwZGF0ZVBhc3N3b3JkOnVwZGF0ZVBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHNhdmVVc2VyOnNhdmVVc2VyLFxuICAgICAgICAgICAgICAgIGdldENvbnRhY3RzOmdldENvbnRhY3RzLFxuICAgICAgICAgICAgICAgIGdldFVzZXI6Z2V0VXNlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvdXNlcnMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 50 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Zones',['$q', '$http', function ($q, $http) {\n\n            var getZones = function (where) {\n                var url = '/api/admin/zones' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .success(function (data) {\n                            // console.log(data);\n                            def.resolve(data);\n                        })\n                        .error(function () {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            var updateZoneItem = function (item) {\n                console.log(\"Updating zone item\",item);\n                var def = $q.defer();\n                $http({\n                        method: 'PATCH',\n                        url: '/api/admin/zones/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to updateZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var createZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/admin/zones',\n                        data: item, // pass in data as strings\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to createZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/zones/'+item.id\n                    })\n                            .success(function (data) {\n                                def.resolve(data);\n                            })\n                        .error(function () {\n                            def.reject(\"Failed to deleteZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getZones:getZones,\n                updateZoneItem:updateZoneItem,\n                createZoneItem:createZoneItem,\n                deleteZoneItem:deleteZoneItem,\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy96b25lcy5qcz8zMjc0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1pvbmVzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0Wm9uZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYWRtaW4vem9uZXMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IGdldEFydGljbGVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHVwZGF0ZVpvbmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIHpvbmUgaXRlbVwiLGl0ZW0pO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vem9uZXMvJytpdGVtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZVpvbmVJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjcmVhdGVab25lSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3pvbmVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGl0ZW0sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjcmVhdGVab25lSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlWm9uZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3pvbmVzLycraXRlbS5pZFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlWm9uZUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdldFpvbmVzOmdldFpvbmVzLFxuICAgICAgICAgICAgICAgIHVwZGF0ZVpvbmVJdGVtOnVwZGF0ZVpvbmVJdGVtLFxuICAgICAgICAgICAgICAgIGNyZWF0ZVpvbmVJdGVtOmNyZWF0ZVpvbmVJdGVtLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVpvbmVJdGVtOmRlbGV0ZVpvbmVJdGVtLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvem9uZXMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 51 */
/***/ function(module, exports, __webpack_require__) {

__webpack_require__(0);
__webpack_require__(1);
__webpack_require__(27);
__webpack_require__(17);
__webpack_require__(22);
__webpack_require__(9);
__webpack_require__(10);
__webpack_require__(2);
__webpack_require__(8);
__webpack_require__(26);
__webpack_require__(25);
__webpack_require__(3);
__webpack_require__(24);
__webpack_require__(20);
__webpack_require__(12);
__webpack_require__(21);
__webpack_require__(15);
__webpack_require__(18);
__webpack_require__(19);
__webpack_require__(23);
__webpack_require__(16);
__webpack_require__(11);
__webpack_require__(6);
__webpack_require__(7);
__webpack_require__(5);
__webpack_require__(4);
__webpack_require__(13);
__webpack_require__(14);
__webpack_require__(28);
__webpack_require__(29);
__webpack_require__(39);
__webpack_require__(32);
__webpack_require__(41);
__webpack_require__(34);
__webpack_require__(33);
__webpack_require__(42);
__webpack_require__(40);
__webpack_require__(49);
__webpack_require__(38);
__webpack_require__(47);
__webpack_require__(31);
__webpack_require__(44);
__webpack_require__(36);
__webpack_require__(30);
__webpack_require__(48);
__webpack_require__(45);
__webpack_require__(43);
__webpack_require__(46);
__webpack_require__(35);
__webpack_require__(50);
module.exports = __webpack_require__(37);


/***/ }
/******/ ]);