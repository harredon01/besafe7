/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmory imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmory exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		Object.defineProperty(exports, name, {
/******/ 			configurable: false,
/******/ 			enumerable: true,
/******/ 			get: getter
/******/ 		});
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 52);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

"use strict";
eval("/* \r\n * To change this license header, choose License Headers in Project Properties.\r\n * To change this template file, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\n\r\n\r\n'use strict';\r\n// angular.js main app initialization\r\nvar app = angular.module('besafe', ['besafe.constants', 'ngCookies', 'ngMaterial', 'ngAnimate', 'ngAria']);\r\napp.config(function () {\r\n    /*$interpolateProvider.startSymbol('{{');\r\n     $interpolateProvider.endSymbol('}}');*/\r\n}).run([\"$http\", '$rootScope', '$cookies', 'Users', 'Modals', '$location', '$anchorScroll', function ($http, $rootScope, $cookies, Users, Modals, $location, $anchorScroll) {\r\n//    $http.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';\r\n//    $http.defaults.headers.common['X-XSRF-TOKEN'] = Laravel.csrfToken;\r\n        console.log(\"Searching for user\");\r\n        $rootScope.loader = false;\r\n        $rootScope.platform = \"Booking\";\r\n        $rootScope.modalProd = null;\r\n        var url = window.location.href;\r\n        if(url.includes(\"pets.lonchis.com.co\")){\r\n            \r\n        } else {\r\n            if(url.includes(\"lonchis.com.co\")){\r\n                $rootScope.platform = \"Food\";\r\n            }\r\n        }\r\n        angular.element(document).ready(function () {\r\n            var screenWidth = window.innerWidth;\r\n            console.log(\"Screen width: \", screenWidth);\r\n//            let url = window.location.href;\r\n            if (screenWidth > 500) {\r\n                $rootScope.showSearch()\r\n            }\r\n\r\n        });\r\n        handleCartCookie();\r\n        Users.getUser().then(function (data) {\r\n            console.log(\"user loaded\", data);\r\n            $rootScope.user = data.user;\r\n            $rootScope.hasSavedCard = data.savedCard;\r\n            if (data.merchants > 0) {\r\n                $rootScope.hasMerchants = true;\r\n            } else {\r\n                $rootScope.hasMerchants = false;\r\n            }\r\n            console.log(\"Has saved card\", $rootScope.hasSavedCard);\r\n            $rootScope.$broadcast('user_loaded');\r\n        },\r\n                function (data) {\r\n\r\n                });\r\n        getCart();\r\n        var shipping = $cookies.get(\"shippingAddress\");\r\n        if (shipping && shipping.length > 0) {\r\n            $rootScope.shippingAddress = JSON.parse(shipping);\r\n        }\r\n        var results = Modals.getAllUrlParams(null);\r\n        console.log(\"Checking params\", results);\r\n        if (results) {\r\n            if (results.merchant_id && results.merchant_id.length > 0) {\r\n                $rootScope.merchant_id = results.merchant_id;\r\n            }\r\n            if (results.lat && results.lat.length > 0) {\r\n                console.log(\"saving lat\");\r\n                $rootScope.lat = results.lat;\r\n            }\r\n        }\r\n\r\n        $http.defaults.headers.common['Accept'] = \"application/json\";\r\n        function handleCartCookie() {\r\n            var uuid = $cookies.get(\"cart-uuid\");\r\n            if (uuid && uuid.length > 0) {\r\n                console.log(\"Cart cookie found\");\r\n            } else {\r\n                var uuid$1 = generateUUID();\r\n                console.log(\"setting cart cookie\", uuid$1);\r\n                console.log(\"setting cart header\", $http.defaults.headers.common['X-device-id']);\r\n                $cookies.put(\"cart-uuid\", uuid$1, {path: \"/\"});\r\n                var path = window.location.pathname;\r\n                if (path.includes(\"product\")) {\r\n                    window.location.reload();\r\n                }\r\n            }\r\n            $rootScope.cookieHeader = uuid;\r\n            $http.defaults.headers.common['X-device-id'] = uuid;\r\n\r\n        }\r\n        function generateUUID() { // Public Domain/MIT\r\n            var d = new Date().getTime();//Timestamp\r\n            var d2 = (performance && performance.now && (performance.now() * 1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\r\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = Math.random() * 16;//random number between 0 and 16\r\n                if (d > 0) {//Use timestamp until depleted\r\n                    r = (d + r) % 16 | 0;\r\n                    d = Math.floor(d / 16);\r\n                } else {//Use microseconds since page-load if supported\r\n                    r = (d2 + r) % 16 | 0;\r\n                    d2 = Math.floor(d2 / 16);\r\n                }\r\n                return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n            });\r\n        }\r\n        function getCart() {\r\n            console.log(\"Get cart\");\r\n            $rootScope.$broadcast('updateHeadCart');\r\n        }\r\n        $rootScope.changeShippingHeader = function () {\r\n            console.log(\"changeShippingHeader\");\r\n            $rootScope.$broadcast('updateShippingAddress');\r\n        }\r\n        $rootScope.showSearch = function () {\r\n            console.log(\"showSearch\");\r\n            $rootScope.$broadcast('showSearch');\r\n        }\r\n\r\n\r\n\r\n\r\n    }]); //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2FwcF8xLmpzPzliNGIiXSwic291cmNlc0NvbnRlbnQiOlsiLyogXHJcbiAqIFRvIGNoYW5nZSB0aGlzIGxpY2Vuc2UgaGVhZGVyLCBjaG9vc2UgTGljZW5zZSBIZWFkZXJzIGluIFByb2plY3QgUHJvcGVydGllcy5cclxuICogVG8gY2hhbmdlIHRoaXMgdGVtcGxhdGUgZmlsZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxhdGVzXHJcbiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9yLlxyXG4gKi9cclxuXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcbi8vIGFuZ3VsYXIuanMgbWFpbiBhcHAgaW5pdGlhbGl6YXRpb25cclxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnLCBbJ2Jlc2FmZS5jb25zdGFudHMnLCAnbmdDb29raWVzJywgJ25nTWF0ZXJpYWwnLCAnbmdBbmltYXRlJywgJ25nQXJpYSddKTtcclxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoKSB7XHJcbiAgICAvKiRpbnRlcnBvbGF0ZVByb3ZpZGVyLnN0YXJ0U3ltYm9sKCd7eycpO1xyXG4gICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLmVuZFN5bWJvbCgnfX0nKTsqL1xyXG59KS5ydW4oW1wiJGh0dHBcIiwgJyRyb290U2NvcGUnLCAnJGNvb2tpZXMnLCAnVXNlcnMnLCAnTW9kYWxzJywgJyRsb2NhdGlvbicsICckYW5jaG9yU2Nyb2xsJywgZnVuY3Rpb24gKCRodHRwLCAkcm9vdFNjb3BlLCAkY29va2llcywgVXNlcnMsIE1vZGFscywgJGxvY2F0aW9uLCAkYW5jaG9yU2Nyb2xsKSB7XHJcbi8vICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLVJlcXVlc3RlZC1XaXRoJ10gPSAnWE1MSHR0cFJlcXVlc3QnO1xyXG4vLyAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1YU1JGLVRPS0VOJ10gPSBMYXJhdmVsLmNzcmZUb2tlbjtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlNlYXJjaGluZyBmb3IgdXNlclwiKTtcclxuICAgICAgICAkcm9vdFNjb3BlLmxvYWRlciA9IGZhbHNlO1xyXG4gICAgICAgICRyb290U2NvcGUucGxhdGZvcm0gPSBcIkJvb2tpbmdcIjtcclxuICAgICAgICAkcm9vdFNjb3BlLm1vZGFsUHJvZCA9IG51bGw7XHJcbiAgICAgICAgbGV0IHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gICAgICAgIGlmKHVybC5pbmNsdWRlcyhcInBldHMubG9uY2hpcy5jb20uY29cIikpe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZih1cmwuaW5jbHVkZXMoXCJsb25jaGlzLmNvbS5jb1wiKSl7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBsYXRmb3JtID0gXCJGb29kXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxldCBzY3JlZW5XaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNjcmVlbiB3aWR0aDogXCIsIHNjcmVlbldpZHRoKTtcclxuLy8gICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgIGlmIChzY3JlZW5XaWR0aCA+IDUwMCkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaG93U2VhcmNoKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgICAgICBoYW5kbGVDYXJ0Q29va2llKCk7XHJcbiAgICAgICAgVXNlcnMuZ2V0VXNlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIGxvYWRlZFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gZGF0YS51c2VyO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmhhc1NhdmVkQ2FyZCA9IGRhdGEuc2F2ZWRDYXJkO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5tZXJjaGFudHMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmhhc01lcmNoYW50cyA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmhhc01lcmNoYW50cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSGFzIHNhdmVkIGNhcmRcIiwgJHJvb3RTY29wZS5oYXNTYXZlZENhcmQpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VzZXJfbG9hZGVkJyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgZ2V0Q2FydCgpO1xyXG4gICAgICAgIGxldCBzaGlwcGluZyA9ICRjb29raWVzLmdldChcInNoaXBwaW5nQWRkcmVzc1wiKTtcclxuICAgICAgICBpZiAoc2hpcHBpbmcgJiYgc2hpcHBpbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyA9IEpTT04ucGFyc2Uoc2hpcHBpbmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcmVzdWx0cyA9IE1vZGFscy5nZXRBbGxVcmxQYXJhbXMobnVsbCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJDaGVja2luZyBwYXJhbXNcIiwgcmVzdWx0cyk7XHJcbiAgICAgICAgaWYgKHJlc3VsdHMpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdHMubWVyY2hhbnRfaWQgJiYgcmVzdWx0cy5tZXJjaGFudF9pZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1lcmNoYW50X2lkID0gcmVzdWx0cy5tZXJjaGFudF9pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocmVzdWx0cy5sYXQgJiYgcmVzdWx0cy5sYXQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzYXZpbmcgbGF0XCIpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5sYXQgPSByZXN1bHRzLmxhdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ0FjY2VwdCddID0gXCJhcHBsaWNhdGlvbi9qc29uXCI7XHJcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQ2FydENvb2tpZSgpIHtcclxuICAgICAgICAgICAgbGV0IHV1aWQgPSAkY29va2llcy5nZXQoXCJjYXJ0LXV1aWRcIik7XHJcbiAgICAgICAgICAgIGlmICh1dWlkICYmIHV1aWQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYXJ0IGNvb2tpZSBmb3VuZFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCB1dWlkID0gZ2VuZXJhdGVVVUlEKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNldHRpbmcgY2FydCBjb29raWVcIiwgdXVpZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNldHRpbmcgY2FydCBoZWFkZXJcIiwgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtZGV2aWNlLWlkJ10pO1xyXG4gICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwiY2FydC11dWlkXCIsIHV1aWQsIHtwYXRoOiBcIi9cIn0pO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhdGggPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAocGF0aC5pbmNsdWRlcyhcInByb2R1Y3RcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5jb29raWVIZWFkZXIgPSB1dWlkO1xyXG4gICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1kZXZpY2UtaWQnXSA9IHV1aWQ7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7IC8vIFB1YmxpYyBEb21haW4vTUlUXHJcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7Ly9UaW1lc3RhbXBcclxuICAgICAgICAgICAgdmFyIGQyID0gKHBlcmZvcm1hbmNlICYmIHBlcmZvcm1hbmNlLm5vdyAmJiAocGVyZm9ybWFuY2Uubm93KCkgKiAxMDAwKSkgfHwgMDsvL1RpbWUgaW4gbWljcm9zZWNvbmRzIHNpbmNlIHBhZ2UtbG9hZCBvciAwIGlmIHVuc3VwcG9ydGVkXHJcbiAgICAgICAgICAgIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNjsvL3JhbmRvbSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxNlxyXG4gICAgICAgICAgICAgICAgaWYgKGQgPiAwKSB7Ly9Vc2UgdGltZXN0YW1wIHVudGlsIGRlcGxldGVkXHJcbiAgICAgICAgICAgICAgICAgICAgciA9IChkICsgcikgJSAxNiB8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IE1hdGguZmxvb3IoZCAvIDE2KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly9Vc2UgbWljcm9zZWNvbmRzIHNpbmNlIHBhZ2UtbG9hZCBpZiBzdXBwb3J0ZWRcclxuICAgICAgICAgICAgICAgICAgICByID0gKGQyICsgcikgJSAxNiB8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZDIgPSBNYXRoLmZsb29yKGQyIC8gMTYpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChjID09PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpKS50b1N0cmluZygxNik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBnZXRDYXJ0KCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBjYXJ0XCIpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUhlYWRDYXJ0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICRyb290U2NvcGUuY2hhbmdlU2hpcHBpbmdIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlU2hpcHBpbmdIZWFkZXJcIik7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlU2hpcHBpbmdBZGRyZXNzJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICRyb290U2NvcGUuc2hvd1NlYXJjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJzaG93U2VhcmNoXCIpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3Nob3dTZWFyY2gnKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgfV0pOyBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9hcHBfMS5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFPQTs7QUFFQTtBQUNBOzs7QUFHQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 1 */
/***/ function(module, exports) {

eval("angular.module( 'besafe.constants', [] )\n.constant('API', {\n\taddress: 'http://lonchis.com.co/api',\n        website: 'http://lonchis.com.co',\n        avatar:'http://lonchis.com.co/avatars/avatar.jpg'\n})\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnN0YW50cy5qcz9iYTk3Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCAnYmVzYWZlLmNvbnN0YW50cycsIFtdIClcbi5jb25zdGFudCgnQVBJJywge1xuXHRhZGRyZXNzOiAnaHR0cDovL2xvbmNoaXMuY29tLmNvL2FwaScsXG4gICAgICAgIHdlYnNpdGU6ICdodHRwOi8vbG9uY2hpcy5jb20uY28nLFxuICAgICAgICBhdmF0YXI6J2h0dHA6Ly9sb25jaGlzLmNvbS5jby9hdmF0YXJzL2F2YXRhci5qcGcnXG59KVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29uc3RhbnRzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 2 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('PersonalTokensCtrl',['$scope', 'Passport', '$rootScope', function ($scope, Passport, $rootScope) {\n            $scope.data = {};\n            $scope.data.scopes = [];\n            $scope.personalAccessTokens;\n            $scope.showForm = false;\n            $scope.showToken = false;\n            angular.element(document).ready(function () {\n                $scope.getPersonalAccessTokens();\n            });\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                if (isvalid) {\n                    $scope.data.scopes = [\"\"];\n                    Passport.createPersonalAccessToken($.param($scope.data)).then(function (data) {\n                        $scope.token = data.accessToken;\n                        $scope.personalAccessTokens.push(data.token);\n                        $rootScope.$broadcast('getTokens');\n                        $scope.data = {};\n                        $scope.data.scopes = [];\n                        $scope.submitted = false;\n                        $scope.showToken = true;\n                        $scope.showForm = false;\n                    },\n                            function (data) {\n\n                            });\n                }\n            }\n            $scope.getPersonalAccessTokens = function () {\n                Passport.getPersonalAccessTokens().then(function (data) {\n                    $scope.personalAccessTokens = data;\n\n                },\n                        function (data) {\n\n                        });\n                Passport.getScopes().then(function (data) {\n                    $scope.scopes = data;\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deletePersonalToken = function (id) {\n                Passport.deletePersonalAccessTokens(id).then(function () {\n                    for (item in $scope.personalAccessTokens) {\n                        if ($scope.personalAccessTokens[item].id == id) {\n                            $scope.personalAccessTokens.splice(item, 1);\n                        }\n                    }\n                },\n                        function (data) {\n                        });\n            }\n            $scope.clean = function () {\n                $scope.data = {};\n            }\n            $scope.newPersonalAccessToken = function () {\n                $scope.showForm = true;\n                $scope.showToken = false;\n            }\n\n        }]).controller('OauthClientsCtrl',['$scope', 'Passport', 'Users', function ($scope, Passport, Users) {\n    $scope.data = {};\n    $scope.oauthClients;\n    $scope.showForm = false;\n\n    angular.element(document).ready(function () {\n        $scope.getOauthClients();\n    });\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            if ($scope.data.id) {\n                Passport.updateOauthClient($.param($scope.data), $scope.data.id).then(function (data) {\n                    $scope.updateOauthClient(data);\n                    $scope.showForm = false;\n\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            } else {\n                Passport.createOauthClient($.param($scope.data)).then(function (data) {\n                    $scope.oauthClients.push(data);\n                    $scope.showForm = false;\n\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }\n    }\n    $scope.updateOauthClient = function (oauthClient) {\n        for (item in $scope.oauthClients) {\n            if ($scope.oauthClients[item].id == oauthClient.id) {\n                $scope.oauthClients.splice(item, 1);\n                $scope.oauthClients.push(oauthClient);\n            }\n        }\n    }\n    $scope.getOauthClients = function () {\n        Passport.getOauthClients().then(function (data) {\n            $scope.oauthClients = data;\n\n        },\n                function (data) {\n\n                });\n    }\n    $scope.newOauthClient = function () {\n        $scope.showForm = true;\n    }\n    $scope.editOauthClient = function (id) {\n        $scope.showForm = true;\n        $scope.data.id = angular.element(document.querySelector('tr#oauthClient-' + id + ' span.id')).html();\n        $scope.data.name = angular.element(document.querySelector('tr#oauthClient-' + id + ' span.name')).html();\n        $scope.data.redirect = angular.element(document.querySelector('tr#oauthClient-' + id + ' span.redirect')).html();\n    }\n    $scope.deleteOauthClient = function (id) {\n        Passport.deleteOauthClient(id).then(function (data) {\n            for (item in $scope.oauthClients) {\n                if ($scope.oauthClients[item].id == id) {\n                    console.log(\"deleting oauthClient\", $scope.oauthClients[item]);\n                    $scope.oauthClients.splice(item, 1);\n                }\n            }\n        },\n                function (data) {\n                });\n    }\n    $scope.clean = function () {\n        $scope.data = {};\n    }\n\n}]).controller('TokensCtrl',['$scope', 'Passport', '$rootScope', function ($scope, Passport, $rootScope) {\n            $scope.tokens;\n            angular.element(document).ready(function () {\n                $scope.getTokens();\n            });\n            $rootScope.$on('getTokens', function (event, args) {\n                $scope.getTokens();\n            });\n            $scope.getTokens = function () {\n                Passport.getTokens().then(function (data) {\n                    $scope.tokens = data;\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteToken = function (id) {\n                Passport.deleteTokens(id).then(function () {\n                    for (item in $scope.tokens) {\n                        if ($scope.tokens[item].id == id) {\n                            $scope.tokens.splice(item, 1);\n                        }\n                    }\n                },\n                        function (data) {\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FjY2Vzc2N0cmwuanM/NDdjNSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignUGVyc29uYWxUb2tlbnNDdHJsJyxbJyRzY29wZScsICdQYXNzcG9ydCcsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgUGFzc3BvcnQsICRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5zY29wZXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5wZXJzb25hbEFjY2Vzc1Rva2VucztcbiAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLnNob3dUb2tlbiA9IGZhbHNlO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFBlcnNvbmFsQWNjZXNzVG9rZW5zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zY29wZXMgPSBbXCJcIl07XG4gICAgICAgICAgICAgICAgICAgIFBhc3Nwb3J0LmNyZWF0ZVBlcnNvbmFsQWNjZXNzVG9rZW4oJC5wYXJhbSgkc2NvcGUuZGF0YSkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50b2tlbiA9IGRhdGEuYWNjZXNzVG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyc29uYWxBY2Nlc3NUb2tlbnMucHVzaChkYXRhLnRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZ2V0VG9rZW5zJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc2NvcGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1Rva2VuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0UGVyc29uYWxBY2Nlc3NUb2tlbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZ2V0UGVyc29uYWxBY2Nlc3NUb2tlbnMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wZXJzb25hbEFjY2Vzc1Rva2VucyA9IGRhdGE7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZ2V0U2NvcGVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2NvcGVzID0gZGF0YTtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5kZWxldGVQZXJzb25hbFRva2VuID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZGVsZXRlUGVyc29uYWxBY2Nlc3NUb2tlbnMoaWQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLnBlcnNvbmFsQWNjZXNzVG9rZW5zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnBlcnNvbmFsQWNjZXNzVG9rZW5zW2l0ZW1dLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcnNvbmFsQWNjZXNzVG9rZW5zLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5uZXdQZXJzb25hbEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dUb2tlbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKS5jb250cm9sbGVyKCdPYXV0aENsaWVudHNDdHJsJyxbJyRzY29wZScsICdQYXNzcG9ydCcsICdVc2VycycsIGZ1bmN0aW9uICgkc2NvcGUsIFBhc3Nwb3J0LCBVc2Vycykge1xuICAgICRzY29wZS5kYXRhID0ge307XG4gICAgJHNjb3BlLm9hdXRoQ2xpZW50cztcbiAgICAkc2NvcGUuc2hvd0Zvcm0gPSBmYWxzZTtcblxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZ2V0T2F1dGhDbGllbnRzKCk7XG4gICAgfSk7XG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS5pZCkge1xuICAgICAgICAgICAgICAgIFBhc3Nwb3J0LnVwZGF0ZU9hdXRoQ2xpZW50KCQucGFyYW0oJHNjb3BlLmRhdGEpLCAkc2NvcGUuZGF0YS5pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlT2F1dGhDbGllbnQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93Rm9ybSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFBhc3Nwb3J0LmNyZWF0ZU9hdXRoQ2xpZW50KCQucGFyYW0oJHNjb3BlLmRhdGEpKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vYXV0aENsaWVudHMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dGb3JtID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS51cGRhdGVPYXV0aENsaWVudCA9IGZ1bmN0aW9uIChvYXV0aENsaWVudCkge1xuICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLm9hdXRoQ2xpZW50cykge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5vYXV0aENsaWVudHNbaXRlbV0uaWQgPT0gb2F1dGhDbGllbnQuaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2F1dGhDbGllbnRzLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2F1dGhDbGllbnRzLnB1c2gob2F1dGhDbGllbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5nZXRPYXV0aENsaWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFBhc3Nwb3J0LmdldE9hdXRoQ2xpZW50cygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5vYXV0aENsaWVudHMgPSBkYXRhO1xuXG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICAkc2NvcGUubmV3T2F1dGhDbGllbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5zaG93Rm9ybSA9IHRydWU7XG4gICAgfVxuICAgICRzY29wZS5lZGl0T2F1dGhDbGllbnQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgJHNjb3BlLnNob3dGb3JtID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmRhdGEuaWQgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndHIjb2F1dGhDbGllbnQtJyArIGlkICsgJyBzcGFuLmlkJykpLmh0bWwoKTtcbiAgICAgICAgJHNjb3BlLmRhdGEubmFtZSA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0ciNvYXV0aENsaWVudC0nICsgaWQgKyAnIHNwYW4ubmFtZScpKS5odG1sKCk7XG4gICAgICAgICRzY29wZS5kYXRhLnJlZGlyZWN0ID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RyI29hdXRoQ2xpZW50LScgKyBpZCArICcgc3Bhbi5yZWRpcmVjdCcpKS5odG1sKCk7XG4gICAgfVxuICAgICRzY29wZS5kZWxldGVPYXV0aENsaWVudCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICBQYXNzcG9ydC5kZWxldGVPYXV0aENsaWVudChpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS5vYXV0aENsaWVudHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm9hdXRoQ2xpZW50c1tpdGVtXS5pZCA9PSBpZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGV0aW5nIG9hdXRoQ2xpZW50XCIsICRzY29wZS5vYXV0aENsaWVudHNbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2F1dGhDbGllbnRzLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgIH1cblxufV0pLmNvbnRyb2xsZXIoJ1Rva2Vuc0N0cmwnLFsnJHNjb3BlJywgJ1Bhc3Nwb3J0JywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCBQYXNzcG9ydCwgJHJvb3RTY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLnRva2VucztcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRUb2tlbnMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2dldFRva2VucycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRUb2tlbnMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmdldFRva2VucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBQYXNzcG9ydC5nZXRUb2tlbnMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b2tlbnMgPSBkYXRhO1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZVRva2VuID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgUGFzc3BvcnQuZGVsZXRlVG9rZW5zKGlkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS50b2tlbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudG9rZW5zW2l0ZW1dLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRva2Vucy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FjY2Vzc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 3 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AddressesCtrl', ['$scope', '$rootScope', 'LocationService', 'Addresses', '$mdDialog', 'Modals', '$cookies',\n            function ($scope, $rootScope, LocationService, Addresses, $mdDialog, Modals, $cookies) {\n                $scope.data = {};\n                $scope.addresses;\n                $scope.regionVisible = false;\n                $scope.editAddress = false;\n                angular.element(document).ready(function () {\n                    $scope.getAddresses();\n                    var where = \"\";\n                    var checkAddress = $cookies.get(\"creating_address\");\n                    if (checkAddress) {\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        console.log(\"creat\", $cookies.get(\"creating_address\"));\n                        console.log(\"Loading address from cookie\", $rootScope.shippingAddress);\n                        $scope.editAddress = true;\n                        $scope.data = $rootScope.shippingAddress;\n                        $scope.data.address_id = $rootScope.shippingAddress.id;\n                        if ($scope.data.name && $scope.data.name.length > 0) {\n\n                        } else {\n                            $scope.data.name = $rootScope.user.name;\n                        }\n                        if ($scope.data.phone && $scope.data.phone.length > 0) {\n\n                        } else {\n                            $scope.data.phone = $rootScope.user.cellphone;\n                        }\n\n                        $scope.selectPlace($scope.data.country_id, $scope.data.region_id);\n                    }\n                    LocationService.getCountries(where).then(function (data) {\n                        $scope.countries = data.data;\n                    },\n                            function (data) {\n\n                            });\n                });\n                $scope.save = function (isvalid) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        var existing = false;\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        $cookies.remove(\"creating_address\", {path: \"/\"});\n                        if ($scope.data.address_id) {\n                            existing = true;\n                        }\n                        Addresses.saveAddress($scope.data).then(function (data) {\n                            if (data.status == \"success\") {\n                                Modals.showToast(\"Actualizacion exitosa\", $(\"#myaccountContent\"));\n                                if (existing) {\n                                    $scope.updateAddress(data.address);\n                                } else {\n                                    $scope.addresses.push(data.address);\n                                }\n\n                                $scope.data = {};\n                                $scope.editAddress = false;\n                                //$scope.data = data.user;\n                            } else {\n                                Modals.showToast(\"Hubo un error porfavor comunicate con soporte\", $(\"#myaccountContent\"));\n                            }\n\n                            $scope.submitted = false;\n\n                        },\n                                function (data) {\n\n                                });\n                    }\n                }\n                $scope.getAddresses = function () {\n                    Addresses.getAddresses().then(function (data) {\n                        $scope.addresses = data.addresses;\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.newAddress = function () {\n                    $mdDialog.show(Modals.getLocationPrompt()).then(function (answer) {\n                        if (answer == \"map\") {\n                            $cookies.put(\"locationRefferrer\", window.location.href, {path: \"/\"});\n                            $cookies.put(\"creating_address\", true, {path: \"/\"});\n                            window.location.href = \"/location\";\n                        } else if (answer == 'address') {\n                            showAdvanced();\n                        }\n\n                    }, function () {\n\n                    });\n                };\n                $scope.deleteAddress = function (address) {\n                    $cookies.remove(\"shippingAddress\", {path: \"/\"});\n                    Addresses.deleteAddress(address.id).then(function (data) {\n                        for (item in $scope.addresses) {\n                            console.log(\"a\", $scope.addresses[item].id);\n                            console.log(\"b\", address.id);\n                            console.log(\"c\", $scope.addresses[item].id == address.id);\n                            if ($scope.addresses[item].id == address.id) {\n                                console.log(\"deleting address\", $scope.addresses[item]);\n                                $scope.addresses.splice(item, 1);\n                            }\n                        }\n                    },\n                            function (data) {\n                            });\n                }\n                $scope.clean = function () {\n                    $scope.data = {};\n                    $scope.regionVisible = false;\n                    $scope.cityVisible = false;\n                }\n                $scope.updateAddress = function (address) {\n                    for (item in $scope.addresses) {\n                        if ($scope.addresses[item].id == address.id) {\n                            $scope.addresses.splice(item, 1);\n                            $scope.addresses.push(address);\n                        }\n                    }\n                }\n                $scope.selectCountry = function () {\n                    for (item in $scope.countries) {\n                        if ($scope.countries[item].id == $scope.data.country_id) {\n                            $scope.data.country = $scope.countries[item].country_iso;\n                        }\n                    }\n                    LocationService.getRegionsCountry($scope.data.country_id).then(function (data) {\n                        $scope.regions = data.data;\n                        $scope.regionVisible = true;\n                        $scope.cityVisible = false;\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.selectRegion = function () {\n                    for (item in $scope.regions) {\n                        if ($scope.countries[item].id == $scope.data.region_id) {\n                            $scope.data.region = $scope.countries[item].name;\n                        }\n                    }\n                    LocationService.getCitiesRegion($scope.data.region_id).then(function (data) {\n                        $scope.cities = data.data;\n                        $scope.cityVisible = true;\n                        console.log(\"Setting cities\", $scope.cities);\n                    },\n                            function (data) {\n                            });\n                }\n                $scope.selectPlace = function (country_id, region_id, city_id) {\n                    //$scope.$apply(function () {\n                    $scope.data.country_id = country_id;\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\n                        $scope.regions = data.data;\n                        $scope.regionVisible = true;\n                        $scope.cityVisible = false;\n                        console.log(\"Setting region\", $scope.data.region_id);\n                        $scope.data.region_id = region_id;\n                        LocationService.getCitiesRegion(region_id).then(function (data) {\n                            $scope.cities = data.data;\n                            $scope.cityVisible = true;\n                            console.log(\"Setting city_id\", $scope.data.city_id);\n                            console.log(\"Setting cities\", $scope.cities);\n                            $scope.data.city_id = city_id;\n                        },\n                                function (data) {\n                                });\n                    },\n                            function (data) {\n                            });\n                    //});\n                }\n                $scope.editAddressObj = function (address) {\n                    $scope.editAddress = true;\n                    if (address.lat) {\n                        $cookies.put(\"shippingAddress\", JSON.stringify(address), {path: \"/\"});\n                        $cookies.put(\"locationRefferrer\", window.location.href, {path: \"/\"});\n                        $cookies.put(\"creating_address\", true, {path: \"/\"});\n                        window.location.href = \"/location\";\n                    } else {\n                        for (item in $scope.addresses) {\n                            if ($scope.addresses[item].id == address.id) {\n                                $scope.data = $scope.addresses[item];\n                                $scope.data.address_id = address.id;\n                                $scope.selectPlace($scope.data.country_id, $scope.data.region_id);\n                            }\n                        }\n                    }\n                }\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkZHJlc3NjdHJsLmpzPzY3YzMiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0FkZHJlc3Nlc0N0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0xvY2F0aW9uU2VydmljZScsICdBZGRyZXNzZXMnLCAnJG1kRGlhbG9nJywgJ01vZGFscycsICckY29va2llcycsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBMb2NhdGlvblNlcnZpY2UsIEFkZHJlc3NlcywgJG1kRGlhbG9nLCBNb2RhbHMsICRjb29raWVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc2VzO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRBZGRyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoZWNrQWRkcmVzcyA9ICRjb29raWVzLmdldChcImNyZWF0aW5nX2FkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja0FkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnJlbW92ZShcImNyZWF0aW5nX2FkZHJlc3NcIiwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0XCIsICRjb29raWVzLmdldChcImNyZWF0aW5nX2FkZHJlc3NcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2FkaW5nIGFkZHJlc3MgZnJvbSBjb29raWVcIiwgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRBZGRyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5hZGRyZXNzX2lkID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGEubmFtZSAmJiAkc2NvcGUuZGF0YS5uYW1lLmxlbmd0aCA+IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5uYW1lID0gJHJvb3RTY29wZS51c2VyLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGEucGhvbmUgJiYgJHNjb3BlLmRhdGEucGhvbmUubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnBob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFBsYWNlKCRzY29wZS5kYXRhLmNvdW50cnlfaWQsICRzY29wZS5kYXRhLnJlZ2lvbl9pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENvdW50cmllcyh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cmllcyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGlzdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucmVtb3ZlKFwiY3JlYXRpbmdfYWRkcmVzc1wiLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnJlbW92ZShcImNyZWF0aW5nX2FkZHJlc3NcIiwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkY29va2llcy5yZW1vdmUoXCJjcmVhdGluZ19hZGRyZXNzXCIsIHtwYXRoOiBcIi9cIn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5kYXRhLmFkZHJlc3NfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBBZGRyZXNzZXMuc2F2ZUFkZHJlc3MoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkFjdHVhbGl6YWNpb24gZXhpdG9zYVwiLCAkKFwiI215YWNjb3VudENvbnRlbnRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVBZGRyZXNzKGRhdGEuYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc2VzLnB1c2goZGF0YS5hZGRyZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5kYXRhID0gZGF0YS51c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yIHBvcmZhdm9yIGNvbXVuaWNhdGUgY29uIHNvcG9ydGVcIiwgJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEFkZHJlc3NlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgQWRkcmVzc2VzLmdldEFkZHJlc3NlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBkYXRhLmFkZHJlc3NlcztcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5ld0FkZHJlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRMb2NhdGlvblByb21wdCgpKS50aGVuKGZ1bmN0aW9uIChhbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbnN3ZXIgPT0gXCJtYXBcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImxvY2F0aW9uUmVmZmVycmVyXCIsIHdpbmRvdy5sb2NhdGlvbi5ocmVmLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJjcmVhdGluZ19hZGRyZXNzXCIsIHRydWUsIHtwYXRoOiBcIi9cIn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9jYXRpb25cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5zd2VyID09ICdhZGRyZXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBZHZhbmNlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5kZWxldGVBZGRyZXNzID0gZnVuY3Rpb24gKGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucmVtb3ZlKFwic2hpcHBpbmdBZGRyZXNzXCIsIHtwYXRoOiBcIi9cIn0pO1xuICAgICAgICAgICAgICAgICAgICBBZGRyZXNzZXMuZGVsZXRlQWRkcmVzcyhhZGRyZXNzLmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmFkZHJlc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYVwiLCAkc2NvcGUuYWRkcmVzc2VzW2l0ZW1dLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImJcIiwgYWRkcmVzcy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjXCIsICRzY29wZS5hZGRyZXNzZXNbaXRlbV0uaWQgPT0gYWRkcmVzcy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hZGRyZXNzZXNbaXRlbV0uaWQgPT0gYWRkcmVzcy5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGV0aW5nIGFkZHJlc3NcIiwgJHNjb3BlLmFkZHJlc3Nlc1tpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuYWRkcmVzc2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFkZHJlc3Nlc1tpdGVtXS5pZCA9PSBhZGRyZXNzLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3Nlcy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3Nlcy5wdXNoKGFkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RDb3VudHJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmNvdW50cmllcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jb3VudHJpZXNbaXRlbV0uaWQgPT0gJHNjb3BlLmRhdGEuY291bnRyeV9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSAkc2NvcGUuY291bnRyaWVzW2l0ZW1dLmNvdW50cnlfaXNvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRSZWdpb25zQ291bnRyeSgkc2NvcGUuZGF0YS5jb3VudHJ5X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UmVnaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLnJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY291bnRyaWVzW2l0ZW1dLmlkID09ICRzY29wZS5kYXRhLnJlZ2lvbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnJlZ2lvbiA9ICRzY29wZS5jb3VudHJpZXNbaXRlbV0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKCRzY29wZS5kYXRhLnJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNldHRpbmcgY2l0aWVzXCIsICRzY29wZS5jaXRpZXMpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RQbGFjZSA9IGZ1bmN0aW9uIChjb3VudHJ5X2lkLCByZWdpb25faWQsIGNpdHlfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuY291bnRyeV9pZCA9IGNvdW50cnlfaWQ7XG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRSZWdpb25zQ291bnRyeShjb3VudHJ5X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIHJlZ2lvblwiLCAkc2NvcGUuZGF0YS5yZWdpb25faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVnaW9uX2lkID0gcmVnaW9uX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENpdGllc1JlZ2lvbihyZWdpb25faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIGNpdHlfaWRcIiwgJHNjb3BlLmRhdGEuY2l0eV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIGNpdGllc1wiLCAkc2NvcGUuY2l0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jaXR5X2lkID0gY2l0eV9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzc09iaiA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhZGRyZXNzLmxhdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwic2hpcHBpbmdBZGRyZXNzXCIsIEpTT04uc3RyaW5naWZ5KGFkZHJlc3MpLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImxvY2F0aW9uUmVmZmVycmVyXCIsIHdpbmRvdy5sb2NhdGlvbi5ocmVmLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImNyZWF0aW5nX2FkZHJlc3NcIiwgdHJ1ZSwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2xvY2F0aW9uXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmFkZHJlc3Nlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWRkcmVzc2VzW2l0ZW1dLmlkID09IGFkZHJlc3MuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSAkc2NvcGUuYWRkcmVzc2VzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5hZGRyZXNzX2lkID0gYWRkcmVzcy5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFBsYWNlKCRzY29wZS5kYXRhLmNvdW50cnlfaWQsICRzY29wZS5kYXRhLnJlZ2lvbl9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYWRkcmVzc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 4 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AdminCategoriesCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page;\n                ProductImport.getCategories(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateCategoryItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteCategoryItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLWNhdGVnb3JpZXNjdHJsLmpzP2NlYjEiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0FkbWluQ2F0ZWdvcmllc0N0cmwnLFsnJHNjb3BlJywgJ1Byb2R1Y3RJbXBvcnQnLCBmdW5jdGlvbiAoJHNjb3BlLCBQcm9kdWN0SW1wb3J0KSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJvcmRlcl9ieT1pZCxkZXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZTtcbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmdldENhdGVnb3JpZXModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbXNcIixkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LnVwZGF0ZUNhdGVnb3J5SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmRlbGV0ZUNhdGVnb3J5SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYWRtaW4vc3RvcmUvYWRtaW4tc3RvcmUtY2F0ZWdvcmllc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 5 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AdminMerchantsCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page;\n                ProductImport.getMerchants(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateMerchantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteMerchantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLW1lcmNoYW50c2N0cmwuanM/MTVmYyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignQWRtaW5NZXJjaGFudHNDdHJsJyxbJyRzY29wZScsICdQcm9kdWN0SW1wb3J0JywgZnVuY3Rpb24gKCRzY29wZSwgUHJvZHVjdEltcG9ydCkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gdHJ1ZSxcbiAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRzY29wZS5idWlsZEl0ZW1EYXRhID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAvL2l0ZW0uYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoaXRlbS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwib3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XG4gICAgICAgICAgICAgICAgUHJvZHVjdEltcG9ydC5nZXRNZXJjaGFudHModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbXNcIixkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LnVwZGF0ZU1lcmNoYW50SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmRlbGV0ZU1lcmNoYW50SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvYWRtaW4vc3RvcmUvYWRtaW4tc3RvcmUtbWVyY2hhbnRzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 6 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('AdminProductsCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&includes=productVariants,categories&page=\" + $scope.page;\n                ProductImport.getProducts(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateProductItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteProductItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLXByb2R1Y3RzY3RybC5qcz81YTU0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdBZG1pblByb2R1Y3RzQ3RybCcsWyckc2NvcGUnLCAnUHJvZHVjdEltcG9ydCcsIGZ1bmN0aW9uICgkc2NvcGUsIFByb2R1Y3RJbXBvcnQpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRJdGVtRGF0YSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgLy9pdGVtLmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGl0ZW0uYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIm9yZGVyX2J5PWlkLGRlc2MmaW5jbHVkZXM9cHJvZHVjdFZhcmlhbnRzLGNhdGVnb3JpZXMmcGFnZT1cIiArICRzY29wZS5wYWdlO1xuICAgICAgICAgICAgICAgIFByb2R1Y3RJbXBvcnQuZ2V0UHJvZHVjdHModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbXNcIixkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LnVwZGF0ZVByb2R1Y3RJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5kZWxldGVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICAgICAgICAgIFByb2R1Y3RJbXBvcnQuZGVsZXRlUHJvZHVjdEl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLXByb2R1Y3RzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 7 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .controller('AdminVariantsCtrl',['$scope', 'ProductImport', function ($scope, ProductImport) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&includes=product.merchants&page=\" + $scope.page;\n                ProductImport.getVariants(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\",data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                ProductImport.updateVariantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                ProductImport.deleteVariantItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2FkbWluL3N0b3JlL2FkbWluLXN0b3JlLXZhcmlhbnRzY3RybC5qcz9hMjBkIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuY29udHJvbGxlcignQWRtaW5WYXJpYW50c0N0cmwnLFsnJHNjb3BlJywgJ1Byb2R1Y3RJbXBvcnQnLCBmdW5jdGlvbiAoJHNjb3BlLCBQcm9kdWN0SW1wb3J0KSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJvcmRlcl9ieT1pZCxkZXNjJmluY2x1ZGVzPXByb2R1Y3QubWVyY2hhbnRzJnBhZ2U9XCIgKyAkc2NvcGUucGFnZTtcbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmdldFZhcmlhbnRzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW1zQ29udCA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGl0ZW1zQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNDb250W2l0ZW1dID0gJHNjb3BlLmJ1aWxkSXRlbURhdGEoaXRlbXNDb250W2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSAkc2NvcGUuaXRlbXMuY29uY2F0KGl0ZW1zQ29udCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgUHJvZHVjdEltcG9ydC51cGRhdGVWYXJpYW50SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBQcm9kdWN0SW1wb3J0LmRlbGV0ZVZhcmlhbnRJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9hZG1pbi9zdG9yZS9hZG1pbi1zdG9yZS12YXJpYW50c2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 8 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('BookingCtrl', ['$scope', '$rootScope', 'getParams', 'Booking', 'Modals', 'Cart', '$mdDialog', function ($scope, $rootScope, getParams, Booking, Modals, Cart, $mdDialog) {\n                $scope.availableDays = [];\n                $scope.availableDates = [];\n                $scope.selectedSpots = [];\n                $scope.questions = [];\n                $scope.meetingType;\n                $scope.variant;\n                $scope.availabilities = [];\n                $scope.appointmentOptions = [];\n                $scope.months = [];\n                $scope.newVisit = true;\n                $scope.dateSelected = false;\n                $scope.virtualMeeting = 'physical';\n                $scope.timeSelected = false;\n                $scope.availabilitiesDate = [];\n                $scope.weekday = [];\n                $scope.weekday2 = [];\n                $scope.typeObj;\n                $scope.bookingObj = null;\n                $scope.requiresAuth;\n                $scope.dayName;\n                $scope.atributesCont;\n                $scope.product_variant_id = null;\n                $scope.item_id = null;\n                $scope.quantity = null;\n                $scope.location = null;\n                $scope.duration = null;\n                $scope.objectId;\n                $scope.objectName;\n                $scope.objectDescription;\n                $scope.objectIcon;\n                $scope.startDate;\n                $scope.endDate;\n                $scope.startDateS;\n                $scope.expectedPrice;\n                $scope.activeBooking;\n                $scope.amount = \"1\";\n                $scope.submitted = false;\n                $scope.constructor = function () {\n\n                    $scope.atributesCont = {};\n                    $scope.weekday = new Array(7);\n                    $scope.weekday[0] = \"sunday\";\n                    $scope.weekday[1] = \"monday\";\n                    $scope.weekday[2] = \"tuesday\";\n                    $scope.weekday[3] = \"wednesday\";\n                    $scope.weekday[4] = \"thursday\";\n                    $scope.weekday[5] = \"friday\";\n                    $scope.weekday[6] = \"saturday\";\n                    $scope.weekday2 = new Array(7);\n                    $scope.weekday2[0] = \"Domingo\";\n                    $scope.weekday2[1] = \"Lunes\";\n                    $scope.weekday2[2] = \"Martes\";\n                    $scope.weekday2[3] = \"Miercoles\";\n                    $scope.weekday2[4] = \"Jueves\";\n                    $scope.weekday2[5] = \"Viernes\";\n                    $scope.weekday2[6] = \"Sabado\";\n                    $scope.questions = []\n\n                    console.log(\"Get availableDates\", $scope.availableDates);\n                }\n                $scope.ngOnInit = function () {\n                    $scope.loadData();\n                }\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                $scope.keytab = function (event, maxlength) {\n                    var nextInput = event.srcElement.nextElementSibling; // get the sibling element\n                    console.log('nextInput', nextInput);\n                    var target = event.target || event.srcElement;\n                    console.log('target', target);\n                    console.log('targetvalue', target.value);\n                    console.log('targettype', target.nodeType);\n                    if (target.value.length < maxlength) {\n                        return;\n                    }\n                    if (nextInput == null)  // check the maxLength from here\n                        return;\n                    else\n                        nextInput.focus();   // focus if not null\n                }\n                $scope.onError = function () {\n                    console.log(\"IMG ERROR\");\n                    $scope.objectIcon = \"/assets/avatar/Bentley.png\";\n                }\n                $scope.loadData = function () {\n                    var paramsArrived = getParams;\n                    console.log(\"Params arrived: \", paramsArrived);\n                    if (paramsArrived) {\n                        $scope.typeObj = paramsArrived.type;\n                        $scope.objectId = paramsArrived.objectId;\n                        $scope.objectName = paramsArrived.objectName;\n                        $scope.objectDescription = paramsArrived.objectDescription;\n                        $scope.objectIcon = paramsArrived.objectIcon;\n                        if (paramsArrived.expectedPrice) {\n                            $scope.expectedPrice = paramsArrived.expectedPrice;\n                        }\n                        if (paramsArrived.questions) {\n                            $scope.questions = paramsArrived.questions;\n                        }\n                        if (paramsArrived.variant) {\n                            $scope.variant = paramsArrived.variant;\n                        }\n\n                        if (paramsArrived.duration) {\n                            $scope.duration = paramsArrived.duration;\n                        }\n                        if (paramsArrived.location) {\n                            $scope.location = paramsArrived.location;\n                            if ($scope.location == \"zoom\") {\n                                $scope.virtualMeeting = \"virtual\";\n                            }\n                        }\n                        if (paramsArrived.product_variant_id) {\n                            $scope.product_variant_id = paramsArrived.product_variant_id;\n                        }\n                        if (paramsArrived.item_id) {\n                            $scope.item_id = paramsArrived.item_id;\n                        }\n                        if (paramsArrived.quantity) {\n                            $scope.quantity = paramsArrived.quantity;\n                        }\n                        if (paramsArrived.booking) {\n                            $scope.bookingObj = paramsArrived.booking;\n                            $scope.dateSelected = true;\n                            $scope.timeSelected = true;\n                            var container = {date: $scope.bookingObj.starts_at, status: 'active'};\n                            $scope.selectDate(container);\n                            $scope.expectedPrice = $scope.bookingObj.price;\n                            $scope.atributesCont = $scope.bookingObj.options;\n                            if ($scope.atributesCont) {\n                                if ($scope.atributesCont.questions) {\n                                    $scope.questions = $scope.atributesCont.questions;\n                                }\n                            }\n                            console.log(\"Date\", $scope.bookingObj.starts_at.toISOString());\n                            $scope.startDateS = $scope.bookingObj.starts_at.toISOString();\n                            $scope.selectStart();\n                        }\n                        if (paramsArrived.availabilities) {\n                            $scope.dateSelected = false;\n                            $scope.availabilities = paramsArrived.availabilities;\n                            console.log(\"Availabilities\", $scope.availabilities);\n                            $scope.getAvailableDates($scope.availabilities);\n                            $scope.getDates();\n                            console.log(\"Get availableDays\", $scope.availableDays);\n                        } else {\n                            $scope.getItems();\n                        }\n                        console.log(\"expectedPrice\", $scope.expectedPrice);\n                    } else {\n                        $scope.getItems();\n                    }\n\n                    console.log(\"Get availableDays\", $scope.dateSelected);\n                }\n                $scope.setOrder = function (item) {\n                    var dateBase = new Date(\"1970-01-01 00:00:00\");\n                    var date = new Date(\"1970-01-01 \" + item.from);\n                    var orderAdd = (date.getTime() - dateBase.getTime()) / 1000000;\n                    console.log(\"Date: \", orderAdd);\n                    if (item.range == 'sunday') {\n                        item.order = 0;\n                    }\n                    if (item.range == 'monday') {\n                        item.order = 100;\n                    }\n                    if (item.range == 'tuesday') {\n                        item.order = 200;\n                    }\n                    if (item.range == 'wednesday') {\n                        item.order = 300;\n                    }\n                    if (item.range == 'thursday') {\n                        item.order = 400;\n                    }\n                    if (item.range == 'friday') {\n                        item.order = 500;\n                    }\n                    if (item.range == 'saturday') {\n                        item.order = 600;\n                    }\n                    item.order += orderAdd;\n                    return item;\n                }\n\n                $scope.getItems = function () {\n                    var availabilities = [];\n                    //        Modals.showLoader();\n                    var where = {\"type\": \"Merchant\", \"object_id\": $scope.objectId};\n                    Booking.getAvailabilitiesObject(where).then(function (data) {\n                        //            Modals.hideLoader();\n                        console.log(\"after getItems\", data);\n                        var results = data.data;\n                        for (var one in results) {\n                            results[one] = $scope.setOrder(results[one]);\n                            availabilities.push(results[one]);\n                        }\n                        availabilities.sort(function (a, b) { return (a.order > b.order) ? 1 : -1; });\n                        $scope.availabilities = availabilities;\n                        console.log(\"Availabilities\", $scope.availabilities);\n                        $scope.getAvailableDates($scope.availabilities);\n                        $scope.getDates();\n                        console.log(\"in get items\", $scope.bookingObj);\n                        if ($scope.bookingObj) {\n                            var container = {date: $scope.bookingObj.starts_at, status: 'active'};\n                            $scope.selectDate(container);\n                        }\n                        console.log(\"Get availableDays\", $scope.availableDays);\n                        console.log(JSON.stringify(data));\n                    }, function (data) {\n                        //            Modals.hideLoader();\n                        // Unable to log in\n                        Modals.showToast('BOOKING.ERROR_GET_AVAILABILITIES');\n                    });\n                }\n                $scope.goBack = function () {\n                    console.log(\"goBack\", $scope.dateSelected)\n                    if ($scope.dateSelected) {\n                        $scope.dateSelected = false;\n                    } else {\n                        $scope.navCtrl.back();\n                    }\n\n                }\n                $scope.addBookingToCart = function (booking) {\n                    if ($rootScope.items) {\n                        var items = $rootScope.items;\n                        for (var i in items) {\n                            var attrs = items[i].attributes;\n                            if (attrs.type == \"Booking\") {\n                                if (attrs.id == booking.id) {\n                                    Modals.showToast(\"Carrito actualizado\");\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                    $scope.addBookingToCartServer(booking);\n                }\n                $scope.addBookingToCartServer = function (booking) {\n                    var extras = {\n                        \"type\": \"Booking\",\n                        \"id\": booking.id,\n                        \"name\": \"Reserva con: \" + booking.bookable.name,\n                        \"from\": booking.starts_at\n                    }\n                    var item = {\n                        \"name\": \"Reserva con: \" + booking.bookable.name,\n                        \"price\": booking.price,\n                        \"quantity\": booking.quantity,\n                        \"tax\": 0,\n                        \"merchant_id\": $scope.objectId,\n                        \"cost\": 0,\n                        \"extras\": extras\n                    };\n                    console.log(\"addBookingToCartServer\", item);\n                    if ($scope.product_variant_id) {\n                        var container = {\n                            product_variant_id: $scope.product_variant_id,\n                            quantity: $scope.quantity,\n                            item_id: null,\n                            merchant_id: $scope.objectId,\n                            \"extras\": extras\n                        };\n                        Cart.postToServer(container).then(function (data) {\n                            if (data.status == \"success\") {\n                                $rootScope.$broadcast('loadHeadCart', data.cart);\n                                $rootScope.cartMessage = \"Carrito actualizado\";\n                            } else {\n                                $rootScope.cartMessage = data.message;\n                            }\n                        }, function (data) {\n                            console.log(\"Error addCustomCartItem\");\n                        });\n                    } else if ($scope.item_id) {\n                        var container$1 = {\n                            quantity: $scope.quantity,\n                            item_id: $scope.item_id,\n                            merchant_id: $scope.objectId,\n                            \"extras\": extras\n                        };\n                        Cart.updateCartItem(container$1).then(function (data) {\n                            if (data.status == \"success\") {\n                                $rootScope.$broadcast('loadHeadCart', data.cart);\n                                $rootScope.cartMessage = \"Carrito actualizado\";\n                            } else {\n                                $rootScope.cartMessage = data.message;\n                            }\n                        }, function (data) {\n                            console.log(\"Error addCustomCartItem\");\n                        });\n                    } else {\n                        Cart.addCustomCartItem(item).then(function (data) {\n                            if (data.status == \"success\") {\n                                $rootScope.$broadcast('loadHeadCart', data.cart);\n                                $rootScope.cartMessage = \"Carrito actualizado\";\n                            } else {\n                                $rootScope.cartMessage = data.message;\n                            }\n                        }, function (data) {\n                            console.log(\"Error addCustomCartItem\");\n                        });\n                    }\n                }\n                $scope.selectRadio = function (event) {\n                    $scope.virtualMeeting = event.detail.value;\n                    console.log(\"Virtual meeting radio \", event);\n                    console.log(\"Virtual meeting radio \", $scope.virtualMeeting);\n                }\n                $scope.createBooking = function () {\n                    if ($scope.submitted) {\n                        return true;\n                    }\n                    $scope.submitted = true;\n                    //Modals.showLoader();\n                    var startDate = new Date($scope.startDate.getTime() - $scope.startDate.getTimezoneOffset() * 60000);\n                    var strDate = startDate.toISOString();\n                    var endDate = new Date($scope.endDate.getTime() - $scope.endDate.getTimezoneOffset() * 60000);\n                    var ndDate = endDate.toISOString();\n                    var virtual = false;\n                    console.log(\"Virtual meeting\", $scope.virtualMeeting);\n                    if ($scope.virtualMeeting == 'virtual') {\n                        virtual = true;\n                        $scope.atributesCont.virtual_provider = \"zoom\";\n                        $scope.atributesCont.virtual_meeting = true;\n                    }\n                    var data = {\n                        \"type\": $scope.typeObj,\n                        \"object_id\": $scope.objectId,\n                        \"from\": strDate,\n                        \"to\": ndDate,\n                        \"attributes\": $scope.atributesCont,\n                        \"virtual_meeting\": virtual\n                    };\n                    console.log(\"Start\", $scope.startDate);\n                    console.log(\"data\", data);\n                    Booking.addBookingObject(data).then(function (resp) {\n                        Modals.hideLoader();\n                        console.log(\"addBookingObject\", resp);\n                        $scope.submitted = false;\n                        //$scope.presentAlertConfirm(data);\n                        if (resp.status == \"success\") {\n                            if (resp.requires_auth) {\n                                $scope.presentAlertConfirm($scope.requiresAuth);\n                            } else {\n                                $scope.addBookingToCart(resp.booking);\n                            }\n                        } else {\n                            $scope.showAlertTranslation(\"BOOKING.\" + resp.message);\n                        }\n                    }, function (data) {\n                        $scope.submitted = false;\n                        console.log(\"Error addBookingObject\");\n                        Modals.hideLoader();\n                    });\n                }\n                $scope.saveOrCreateBooking = function () {\n                    $scope.atributesCont.questions = $scope.questions;\n                    if ($scope.bookingObj) {\n                        $scope.editBooking()\n                    } else {\n                        $scope.createBooking();\n                    }\n                }\n                $scope.editBooking = function () {\n                    //        if ($scope.submitted) {\n                    //            return true;\n                    //        }\n                    //        $scope.submitted = true; \n                    Modals.showLoader();\n                    console.log(\"offset\", $scope.startDate.getTimezoneOffset() * 60000);\n                    var startDate = new Date($scope.startDate.getTime() - $scope.startDate.getTimezoneOffset() * 60000);\n                    var strDate = startDate.toISOString();\n                    var endDate = new Date($scope.endDate.getTime() - $scope.endDate.getTimezoneOffset() * 60000);\n                    var ndDate = endDate.toISOString();\n                    var virtual = false;\n                    console.log(\"Virtual meeting\", $scope.virtualMeeting);\n                    if ($scope.virtualMeeting == 'virtual') {\n                        virtual = true;\n                        $scope.atributesCont.virtual_provider = \"zoom\";\n                        $scope.atributesCont.virtual_meeting = true;\n                    }\n                    var data = {\n                        \"booking_id\": $scope.bookingObj.id,\n                        \"type\": $scope.typeObj,\n                        \"object_id\": $scope.objectId,\n                        \"from\": strDate,\n                        \"to\": ndDate,\n                        \"attributes\": $scope.atributesCont\n                    };\n                    console.log(\"Start\", $scope.startDate);\n                    console.log(\"data\", data);\n                    Booking.editBookingObject(data).then(function (resp) {\n                        Modals.hideLoader();\n                        console.log(\"editBookingObject\", resp);\n                        $scope.submitted = false;\n                        //$scope.presentAlertConfirm(data);\n                        if (resp.status == \"success\") {\n                            var container = $scope.params.getParams();\n                            container.booking = new Booking(resp.booking);\n                            $scope.params.setParams(container);\n                            $scope.navCtrl.back();\n                        } else {\n                            $scope.showAlertTranslation(\"BOOKING.\" + resp.message);\n                        }\n                    }, function (data) {\n                        console.log(\"Error editBookingObject\");\n                        Modals.hideLoader();\n                    });\n                }\n\n                $scope.showAlertTranslation = function (alert) {\n                    Modals.showToast(alert);\n                }\n\n                $scope.presentAlertConfirm = function (message) {\n                    console.log(\"Present alert\", message);\n//        let button = {\n//            text: 'Ok',\n//            handler: () => {\n//                console.log('Confirm Okay');\n//                if (message == $scope.requiresAuth) {\n//                    $scope.navCtrl.back();\n//                }\n//            }\n//        }\n//        const alert = await $scope.alertsCtrl.create({\n//            message: message,\n//            buttons: [\n//                button\n//            ]\n//        });\n//        await alert.present();\n                }\n\n                $scope.getAvailableDates = function (availabilities) {\n                    for (var item in availabilities) {\n                        var container = availabilities[item];\n                        if (!$scope.checkAvailableDays(container.range)) {\n                            $scope.availableDays.push(container.range);\n                        }\n                    }\n                }\n\n                $scope.checkAvailableDays = function (day) {\n                    for (var item in $scope.availableDays) {\n                        if ($scope.availableDays[item] == day) {\n                            return true;\n                        }\n                    }\n                    return false;\n                }\n\n                $scope.getDates = function () {\n                    console.log(\"Get dates\");\n                    var myDate = new Date();\n                    if ($scope.variant && $scope.variant.is_shippable) {\n                        myDate.setDate(myDate.getDate() + 1);\n                    }\n                    var month = myDate.getMonth();\n                    var monthcont = {month: month, days: [], title: Booking.getMonthName(month)};\n                    for (var i = 0; i < 61; i++) {\n                        var day = myDate.getDay();\n                        var container = {date: new Date(myDate.getTime()), status: \"closed\"};\n                        if ($scope.checkAvailableDays($scope.weekday[day])) {\n                            container.status = \"active\"\n                        }\n\n                        if (myDate.getMonth() != monthcont.month) {\n                            $scope.months.push(monthcont);\n                            var month$1 = myDate.getMonth();\n                            monthcont = {month: month$1, days: [], title: Booking.getMonthName(month$1)};\n                        }\n                        monthcont.days.push(container);\n                        $scope.availableDates.push(container);\n                        myDate.setDate(myDate.getDate() + 1);\n                    }\n                    console.log(\"Get dates months\", $scope.months);\n                }\n                $scope.returnDates = function () {\n                    $scope.dateSelected = false;\n                }\n                $scope.selectStart = function () {\n                    $scope.startDate = new Date($scope.startDateS);\n                    $scope.endDate = new Date($scope.startDate.getTime() + (parseInt($scope.amount) * 50) * 60000);\n                    $scope.timeSelected = true;\n                }\n                $scope.filterAvailabilities = function (day) {\n                    $scope.availabilitiesDate = [];\n                    for (var item in $scope.availabilities) {\n                        if ($scope.availabilities[item].range == $scope.weekday[day]) {\n                            $scope.availabilitiesDate.push(($scope.availabilities[item]));\n                        }\n                    }\n                }\n                $scope.selectSlot = function (item) {\n                    $scope.startDate = item.start;\n                    $scope.endDate = $scope.addMinutes(item.end, -5);\n                    $scope.timeSelected = true;\n                }\n                $scope.getBookingsDay = function (selectedDate) {\n                    var strDate = selectedDate.getFullYear() + \"-\" + (selectedDate.getMonth() + 1) + \"-\" + selectedDate.getDate();\n                    var params = {\n                        \"from\": strDate,\n                        \"query\": \"day\",\n                        \"type\": $scope.typeObj,\n                        \"object_id\": $scope.objectId,\n                    };\n                    Booking.getBookingsObject(params).then(function (data) {\n                        console.log(\"getBookingsObject\", data);\n                        var results = data.data;\n                        for (var i in results) {\n                            var bookitem = new Booking(results[i]);\n                            $scope.selectedSpots.push(bookitem);\n                        }\n                        $scope.buildSlots();\n                    }, function (data) {\n                        console.log(\"Error getBookingsObject\");\n                    });\n                }\n\n                $scope.selectDate = function (item) {\n                    if (item.status == 'active') {\n                        var selectedDate = item.date;\n                        var day = selectedDate.getDay();\n                        $scope.dateSelected = true;\n                        $scope.timeSelected = false;\n                        console.log(\"select date\", selectedDate);\n//                        Modals.showLoader();\n                        $scope.dayName = $scope.weekday2[day];\n                        $scope.startDate = selectedDate;\n                        $scope.startDateS = selectedDate.toISOString();\n                        Modals.showToast('Buscando horarios disponibles');\n                        $scope.filterAvailabilities(day);\n                        $scope.getBookingsDay(selectedDate);\n                        console.log(\"Availabilities\", $scope.availabilitiesDate);\n                    } else {\n                        Modals.showToast('BOOKING.NOT_AVAILABLE');\n                    }\n\n                }\n                $scope.addMinutes = function (date, minutes) {\n                    return new Date(date.getTime() + minutes * 60000);\n                }\n                $scope.buildSlots = function () {\n                    $scope.appointmentOptions = [];\n                    var appointmentLength = 30;\n                    if ($scope.duration) {\n                        appointmentLength = $scope.duration;\n                    } else {\n                        if ($scope.variant && $scope.variant.is_shippable) {\n                            appointmentLength = 60;\n                        }\n                    }\n                    var current = new Date();\n                    var scheduleBuffer = 150;\n                    current = $scope.addMinutes(current, appointmentLength + scheduleBuffer);\n                    for (var item in $scope.availabilitiesDate) {\n                        var container = $scope.availabilitiesDate[item];\n                        var open = true;\n                        console.log(\"Building date \" + $scope.startDate.getFullYear() + \"/\" + ($scope.startDate.getMonth() + 1) + \"/\" + $scope.startDate.getDate() + \" \" + container.from.replace(\" \", \":00 \"))\n                        var start = new Date($scope.startDate.getFullYear() + \"/\" + ($scope.startDate.getMonth() + 1) + \"/\" + $scope.startDate.getDate() + \" \" + container.from.replace(\" \", \":00 \"));\n                        var end = new Date($scope.startDate.getFullYear() + \"/\" + ($scope.startDate.getMonth() + 1) + \"/\" + $scope.startDate.getDate() + \" \" + container.to.replace(\" \", \":00 \"));\n                        while (open) {\n                            var endApp = $scope.addMinutes(start, appointmentLength);\n                            if (endApp <= end) {\n                                var containerSlot = {start: start, end: endApp};\n                                if (start > current) {\n                                    if (!$scope.checkFilledDate(containerSlot)) {\n                                        $scope.appointmentOptions.push(containerSlot);\n                                    }\n                                }\n                                start = $scope.addMinutes(start, appointmentLength)\n                            } else {\n                                open = false;\n                            }\n                        }\n                    }\n                    if ($scope.bookingObj) {\n                        console.log(\"Loaded booking obj\", $scope.bookingObj);\n                        var container$1 = {start: $scope.bookingObj.starts_at, end: $scope.bookingObj.ends_at}\n                        $scope.selectSlot(container$1);\n                    }\n                }\n                $scope.checkFilledDate = function (container) {\n                    for (var item in $scope.selectedSpots) {\n                        var checking = $scope.selectedSpots[item];\n                        console.log(\"Test\")\n                        console.log(\"comparing: \", container.start.getTime(), \" \", container.end.getTime())\n                        console.log(\"comparing: \", checking.starts_at.getTime(), \" \", checking.ends_at.getTime())\n                        console.log(\"difference: \", container.start.getTime() - checking.starts_at.getTime(), \" \", container.end.getTime() - checking.ends_at.getTime())\n                        if ((container.start.getTime() == checking.starts_at.getTime()) ||\n                                (container.start.getTime() > checking.starts_at.getTime() && container.start.getTime() < checking.ends_at.getTime()) ||\n                                (container.start.getTime() < checking.starts_at.getTime() && container.end.getTime() > checking.starts_at.getTime())) {\n                            console.log(\"True\");\n                            return true;\n                        }\n                    }\n                    return false;\n\n                }\n                $scope.changeDate = function () {\n                    $scope.dateSelected = false;\n                    $scope.timeSelected = false;\n                }\n                $scope.changeTime = function () {\n                    $scope.timeSelected = false;\n                }\n                $scope.constructor();\n                $scope.ngOnInit();\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2Jvb2tpbmdjdHJsLmpzP2QwMDYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Jvb2tpbmdDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdnZXRQYXJhbXMnLCAnQm9va2luZycsICdNb2RhbHMnLCAnQ2FydCcsICckbWREaWFsb2cnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBnZXRQYXJhbXMsIEJvb2tpbmcsIE1vZGFscywgQ2FydCwgJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmF2YWlsYWJsZURheXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmxlRGF0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRTcG90cyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVldGluZ1R5cGU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZhcmlhbnQ7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmF2YWlsYWJpbGl0aWVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFwcG9pbnRtZW50T3B0aW9ucyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5tb250aHMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubmV3VmlzaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRlU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUudmlydHVhbE1lZXRpbmcgPSAncGh5c2ljYWwnO1xuICAgICAgICAgICAgICAgICRzY29wZS50aW1lU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmlsaXRpZXNEYXRlID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTIgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUudHlwZU9iajtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm9va2luZ09iaiA9IG51bGw7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlcXVpcmVzQXV0aDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF5TmFtZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXRyaWJ1dGVzQ29udDtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdF92YXJpYW50X2lkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbV9pZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnF1YW50aXR5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9jYXRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICRzY29wZS5kdXJhdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9iamVjdElkO1xuICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3ROYW1lO1xuICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3REZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0SWNvbjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnREYXRlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lbmREYXRlO1xuICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGVTO1xuICAgICAgICAgICAgICAgICRzY29wZS5leHBlY3RlZFByaWNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVCb29raW5nO1xuICAgICAgICAgICAgICAgICRzY29wZS5hbW91bnQgPSBcIjFcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250ID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5ID0gbmV3IEFycmF5KDcpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheVswXSA9IFwic3VuZGF5XCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS53ZWVrZGF5WzFdID0gXCJtb25kYXlcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXlbMl0gPSBcInR1ZXNkYXlcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXlbM10gPSBcIndlZG5lc2RheVwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheVs0XSA9IFwidGh1cnNkYXlcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXlbNV0gPSBcImZyaWRheVwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheVs2XSA9IFwic2F0dXJkYXlcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkyID0gbmV3IEFycmF5KDcpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbMF0gPSBcIkRvbWluZ29cIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkyWzFdID0gXCJMdW5lc1wiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbMl0gPSBcIk1hcnRlc1wiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbM10gPSBcIk1pZXJjb2xlc1wiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbNF0gPSBcIkp1ZXZlc1wiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUud2Vla2RheTJbNV0gPSBcIlZpZXJuZXNcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLndlZWtkYXkyWzZdID0gXCJTYWJhZG9cIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXN0aW9ucyA9IFtdXG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgYXZhaWxhYmxlRGF0ZXNcIiwgJHNjb3BlLmF2YWlsYWJsZURhdGVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5nT25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZERhdGEoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLmtleXRhYiA9IGZ1bmN0aW9uIChldmVudCwgbWF4bGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBuZXh0SW5wdXQgPSBldmVudC5zcmNFbGVtZW50Lm5leHRFbGVtZW50U2libGluZzsgLy8gZ2V0IHRoZSBzaWJsaW5nIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25leHRJbnB1dCcsIG5leHRJbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQgfHwgZXZlbnQuc3JjRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3RhcmdldCcsIHRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXR2YWx1ZScsIHRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXR0eXBlJywgdGFyZ2V0Lm5vZGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldC52YWx1ZS5sZW5ndGggPCBtYXhsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dElucHV0ID09IG51bGwpICAvLyBjaGVjayB0aGUgbWF4TGVuZ3RoIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0SW5wdXQuZm9jdXMoKTsgICAvLyBmb2N1cyBpZiBub3QgbnVsbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUub25FcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJTUcgRVJST1JcIik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3RJY29uID0gXCIvYXNzZXRzL2F2YXRhci9CZW50bGV5LnBuZ1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXNBcnJpdmVkID0gZ2V0UGFyYW1zO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBhcmFtcyBhcnJpdmVkOiBcIiwgcGFyYW1zQXJyaXZlZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHlwZU9iaiA9IHBhcmFtc0Fycml2ZWQudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3RJZCA9IHBhcmFtc0Fycml2ZWQub2JqZWN0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0TmFtZSA9IHBhcmFtc0Fycml2ZWQub2JqZWN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vYmplY3REZXNjcmlwdGlvbiA9IHBhcmFtc0Fycml2ZWQub2JqZWN0RGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0SWNvbiA9IHBhcmFtc0Fycml2ZWQub2JqZWN0SWNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLmV4cGVjdGVkUHJpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhwZWN0ZWRQcmljZSA9IHBhcmFtc0Fycml2ZWQuZXhwZWN0ZWRQcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLnF1ZXN0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbnMgPSBwYXJhbXNBcnJpdmVkLnF1ZXN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLnZhcmlhbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudmFyaWFudCA9IHBhcmFtc0Fycml2ZWQudmFyaWFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQuZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZHVyYXRpb24gPSBwYXJhbXNBcnJpdmVkLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9jYXRpb24gPSBwYXJhbXNBcnJpdmVkLmxvY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubG9jYXRpb24gPT0gXCJ6b29tXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZpcnR1YWxNZWV0aW5nID0gXCJ2aXJ0dWFsXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQucHJvZHVjdF92YXJpYW50X2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3RfdmFyaWFudF9pZCA9IHBhcmFtc0Fycml2ZWQucHJvZHVjdF92YXJpYW50X2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQuaXRlbV9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtX2lkID0gcGFyYW1zQXJyaXZlZC5pdGVtX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQucXVhbnRpdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVhbnRpdHkgPSBwYXJhbXNBcnJpdmVkLnF1YW50aXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtc0Fycml2ZWQuYm9va2luZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ib29raW5nT2JqID0gcGFyYW1zQXJyaXZlZC5ib29raW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRlU2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50aW1lU2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7ZGF0ZTogJHNjb3BlLmJvb2tpbmdPYmouc3RhcnRzX2F0LCBzdGF0dXM6ICdhY3RpdmUnfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0RGF0ZShjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5leHBlY3RlZFByaWNlID0gJHNjb3BlLmJvb2tpbmdPYmoucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmF0cmlidXRlc0NvbnQgPSAkc2NvcGUuYm9va2luZ09iai5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXRyaWJ1dGVzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmF0cmlidXRlc0NvbnQucXVlc3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlc3Rpb25zID0gJHNjb3BlLmF0cmlidXRlc0NvbnQucXVlc3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZVwiLCAkc2NvcGUuYm9va2luZ09iai5zdGFydHNfYXQudG9JU09TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0YXJ0RGF0ZVMgPSAkc2NvcGUuYm9va2luZ09iai5zdGFydHNfYXQudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0U3RhcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXNBcnJpdmVkLmF2YWlsYWJpbGl0aWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFiaWxpdGllcyA9IHBhcmFtc0Fycml2ZWQuYXZhaWxhYmlsaXRpZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBdmFpbGFiaWxpdGllc1wiLCAkc2NvcGUuYXZhaWxhYmlsaXRpZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBdmFpbGFibGVEYXRlcygkc2NvcGUuYXZhaWxhYmlsaXRpZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXREYXRlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGF2YWlsYWJsZURheXNcIiwgJHNjb3BlLmF2YWlsYWJsZURheXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXhwZWN0ZWRQcmljZVwiLCAkc2NvcGUuZXhwZWN0ZWRQcmljZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGF2YWlsYWJsZURheXNcIiwgJHNjb3BlLmRhdGVTZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZXRPcmRlciA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRlQmFzZSA9IG5ldyBEYXRlKFwiMTk3MC0wMS0wMSAwMDowMDowMFwiKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZShcIjE5NzAtMDEtMDEgXCIgKyBpdGVtLmZyb20pO1xuICAgICAgICAgICAgICAgICAgICBsZXQgb3JkZXJBZGQgPSAoZGF0ZS5nZXRUaW1lKCkgLSBkYXRlQmFzZS5nZXRUaW1lKCkpIC8gMTAwMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRlOiBcIiwgb3JkZXJBZGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5yYW5nZSA9PSAnc3VuZGF5Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5vcmRlciA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmFuZ2UgPT0gJ21vbmRheScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub3JkZXIgPSAxMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmFuZ2UgPT0gJ3R1ZXNkYXknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9yZGVyID0gMjAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJhbmdlID09ICd3ZWRuZXNkYXknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9yZGVyID0gMzAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJhbmdlID09ICd0aHVyc2RheScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub3JkZXIgPSA0MDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmFuZ2UgPT0gJ2ZyaWRheScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub3JkZXIgPSA1MDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmFuZ2UgPT0gJ3NhdHVyZGF5Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5vcmRlciA9IDYwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpdGVtLm9yZGVyICs9IG9yZGVyQWRkO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhdmFpbGFiaWxpdGllcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHdoZXJlID0ge1widHlwZVwiOiBcIk1lcmNoYW50XCIsIFwib2JqZWN0X2lkXCI6ICRzY29wZS5vYmplY3RJZH07XG4gICAgICAgICAgICAgICAgICAgIEJvb2tpbmcuZ2V0QXZhaWxhYmlsaXRpZXNPYmplY3Qod2hlcmUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWZ0ZXIgZ2V0SXRlbXNcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG9uZSBpbiByZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1tvbmVdID0gJHNjb3BlLnNldE9yZGVyKHJlc3VsdHNbb25lXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmlsaXRpZXMucHVzaChyZXN1bHRzW29uZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmlsaXRpZXMuc29ydCgoYSwgYikgPT4gKGEub3JkZXIgPiBiLm9yZGVyKSA/IDEgOiAtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmlsaXRpZXMgPSBhdmFpbGFiaWxpdGllcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQXZhaWxhYmlsaXRpZXNcIiwgJHNjb3BlLmF2YWlsYWJpbGl0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBdmFpbGFibGVEYXRlcygkc2NvcGUuYXZhaWxhYmlsaXRpZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldERhdGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImluIGdldCBpdGVtc1wiLCAkc2NvcGUuYm9va2luZ09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmJvb2tpbmdPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge2RhdGU6ICRzY29wZS5ib29raW5nT2JqLnN0YXJ0c19hdCwgc3RhdHVzOiAnYWN0aXZlJ307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdERhdGUoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGF2YWlsYWJsZURheXNcIiwgJHNjb3BlLmF2YWlsYWJsZURheXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVW5hYmxlIHRvIGxvZyBpblxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdCgnQk9PS0lORy5FUlJPUl9HRVRfQVZBSUxBQklMSVRJRVMnKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nb0JhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ29CYWNrXCIsICRzY29wZS5kYXRlU2VsZWN0ZWQpXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0ZVNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0ZVNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmF2Q3RybC5iYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQm9va2luZ1RvQ2FydCA9IGZ1bmN0aW9uIChib29raW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXMgPSAkcm9vdFNjb3BlLml0ZW1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiBpdGVtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhdHRycyA9IGl0ZW1zW2ldLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLnR5cGUgPT0gXCJCb29raW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLmlkID09IGJvb2tpbmcuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRCb29raW5nVG9DYXJ0U2VydmVyKGJvb2tpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQm9va2luZ1RvQ2FydFNlcnZlciA9IGZ1bmN0aW9uIChib29raW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBleHRyYXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJCb29raW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IGJvb2tpbmcuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJSZXNlcnZhIGNvbjogXCIgKyBib29raW5nLmJvb2thYmxlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyb21cIjogYm9va2luZy5zdGFydHNfYXRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlJlc2VydmEgY29uOiBcIiArIGJvb2tpbmcuYm9va2FibGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpY2VcIjogYm9va2luZy5wcmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicXVhbnRpdHlcIjogYm9va2luZy5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGF4XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lcmNoYW50X2lkXCI6ICRzY29wZS5vYmplY3RJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29zdFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogZXh0cmFzXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWRkQm9va2luZ1RvQ2FydFNlcnZlclwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5wcm9kdWN0X3ZhcmlhbnRfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF92YXJpYW50X2lkOiAkc2NvcGUucHJvZHVjdF92YXJpYW50X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAkc2NvcGUucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogJHNjb3BlLm9iamVjdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IGV4dHJhc1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQucG9zdFRvU2VydmVyKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRIZWFkQ2FydCcsIGRhdGEuY2FydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY2FydE1lc3NhZ2UgPSBcIkNhcnJpdG8gYWN0dWFsaXphZG9cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNhcnRNZXNzYWdlID0gZGF0YS5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBhZGRDdXN0b21DYXJ0SXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5pdGVtX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAkc2NvcGUucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogJHNjb3BlLml0ZW1faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyY2hhbnRfaWQ6ICRzY29wZS5vYmplY3RJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV4dHJhc1wiOiBleHRyYXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRIZWFkQ2FydCcsIGRhdGEuY2FydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY2FydE1lc3NhZ2UgPSBcIkNhcnJpdG8gYWN0dWFsaXphZG9cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNhcnRNZXNzYWdlID0gZGF0YS5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBhZGRDdXN0b21DYXJ0SXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgQ2FydC5hZGRDdXN0b21DYXJ0SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jYXJ0TWVzc2FnZSA9IFwiQ2Fycml0byBhY3R1YWxpemFkb1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY2FydE1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGFkZEN1c3RvbUNhcnRJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFJhZGlvID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52aXJ0dWFsTWVldGluZyA9IGV2ZW50LmRldGFpbC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJWaXJ0dWFsIG1lZXRpbmcgcmFkaW8gXCIsIGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJWaXJ0dWFsIG1lZXRpbmcgcmFkaW8gXCIsICRzY29wZS52aXJ0dWFsTWVldGluZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVCb29raW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnN1Ym1pdHRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5zdGFydERhdGUuZ2V0VGltZSgpIC0gJHNjb3BlLnN0YXJ0RGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyRGF0ZSA9IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kRGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5lbmREYXRlLmdldFRpbWUoKSAtICRzY29wZS5lbmREYXRlLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBuZERhdGUgPSBlbmREYXRlLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2aXJ0dWFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVmlydHVhbCBtZWV0aW5nXCIsICRzY29wZS52aXJ0dWFsTWVldGluZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudmlydHVhbE1lZXRpbmcgPT0gJ3ZpcnR1YWwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250LnZpcnR1YWxfcHJvdmlkZXIgPSBcInpvb21cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250LnZpcnR1YWxfbWVldGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnR5cGVPYmosXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdF9pZFwiOiAkc2NvcGUub2JqZWN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyb21cIjogc3RyRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9cIjogbmREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhdHRyaWJ1dGVzXCI6ICRzY29wZS5hdHJpYnV0ZXNDb250LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2aXJ0dWFsX21lZXRpbmdcIjogdmlydHVhbFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0XCIsICRzY29wZS5zdGFydERhdGUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIEJvb2tpbmcuYWRkQm9va2luZ09iamVjdChkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJhZGRCb29raW5nT2JqZWN0XCIsIHJlc3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUucHJlc2VudEFsZXJ0Q29uZmlybShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnJlcXVpcmVzX2F1dGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByZXNlbnRBbGVydENvbmZpcm0oJHNjb3BlLnJlcXVpcmVzQXV0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZEJvb2tpbmdUb0NhcnQocmVzcC5ib29raW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWxlcnRUcmFuc2xhdGlvbihcIkJPT0tJTkcuXCIgKyByZXNwLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBhZGRCb29raW5nT2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zYXZlT3JDcmVhdGVCb29raW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXRyaWJ1dGVzQ29udC5xdWVzdGlvbnMgPSAkc2NvcGUucXVlc3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmJvb2tpbmdPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0Qm9va2luZygpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlQm9va2luZygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0Qm9va2luZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIGlmICgkc2NvcGUuc3VibWl0dGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTsgXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib2Zmc2V0XCIsICRzY29wZS5zdGFydERhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5zdGFydERhdGUuZ2V0VGltZSgpIC0gJHNjb3BlLnN0YXJ0RGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyRGF0ZSA9IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kRGF0ZSA9IG5ldyBEYXRlKCRzY29wZS5lbmREYXRlLmdldFRpbWUoKSAtICRzY29wZS5lbmREYXRlLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBuZERhdGUgPSBlbmREYXRlLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2aXJ0dWFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVmlydHVhbCBtZWV0aW5nXCIsICRzY29wZS52aXJ0dWFsTWVldGluZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudmlydHVhbE1lZXRpbmcgPT0gJ3ZpcnR1YWwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250LnZpcnR1YWxfcHJvdmlkZXIgPSBcInpvb21cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdHJpYnV0ZXNDb250LnZpcnR1YWxfbWVldGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImJvb2tpbmdfaWRcIjogJHNjb3BlLmJvb2tpbmdPYmouaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnR5cGVPYmosXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdF9pZFwiOiAkc2NvcGUub2JqZWN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyb21cIjogc3RyRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG9cIjogbmREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhdHRyaWJ1dGVzXCI6ICRzY29wZS5hdHJpYnV0ZXNDb250XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRcIiwgJHNjb3BlLnN0YXJ0RGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGF0YVwiLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgQm9va2luZy5lZGl0Qm9va2luZ09iamVjdChkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlZGl0Qm9va2luZ09iamVjdFwiLCByZXNwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLnByZXNlbnRBbGVydENvbmZpcm0oZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gJHNjb3BlLnBhcmFtcy5nZXRQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYm9va2luZyA9IG5ldyBCb29raW5nKHJlc3AuYm9va2luZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcy5zZXRQYXJhbXMoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmF2Q3RybC5iYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWxlcnRUcmFuc2xhdGlvbihcIkJPT0tJTkcuXCIgKyByZXNwLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBlZGl0Qm9va2luZ09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93QWxlcnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uIChhbGVydCkge1xuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KGFsZXJ0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUucHJlc2VudEFsZXJ0Q29uZmlybSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUHJlc2VudCBhbGVydFwiLCBtZXNzYWdlKTtcbi8vICAgICAgICBsZXQgYnV0dG9uID0ge1xuLy8gICAgICAgICAgICB0ZXh0OiAnT2snLFxuLy8gICAgICAgICAgICBoYW5kbGVyOiAoKSA9PiB7XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ29uZmlybSBPa2F5Jyk7XG4vLyAgICAgICAgICAgICAgICBpZiAobWVzc2FnZSA9PSAkc2NvcGUucmVxdWlyZXNBdXRoKSB7XG4vLyAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5hdkN0cmwuYmFjaygpO1xuLy8gICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICB9XG4vLyAgICAgICAgfVxuLy8gICAgICAgIGNvbnN0IGFsZXJ0ID0gYXdhaXQgJHNjb3BlLmFsZXJ0c0N0cmwuY3JlYXRlKHtcbi8vICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbi8vICAgICAgICAgICAgYnV0dG9uczogW1xuLy8gICAgICAgICAgICAgICAgYnV0dG9uXG4vLyAgICAgICAgICAgIF1cbi8vICAgICAgICB9KTtcbi8vICAgICAgICBhd2FpdCBhbGVydC5wcmVzZW50KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEF2YWlsYWJsZURhdGVzID0gZnVuY3Rpb24gKGF2YWlsYWJpbGl0aWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gYXZhaWxhYmlsaXRpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBhdmFpbGFiaWxpdGllc1tpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLmNoZWNrQXZhaWxhYmxlRGF5cyhjb250YWluZXIucmFuZ2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmF2YWlsYWJsZURheXMucHVzaChjb250YWluZXIucmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrQXZhaWxhYmxlRGF5cyA9IGZ1bmN0aW9uIChkYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuYXZhaWxhYmxlRGF5cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hdmFpbGFibGVEYXlzW2l0ZW1dID09IGRheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGRhdGVzXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbXlEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS52YXJpYW50ICYmICRzY29wZS52YXJpYW50LmlzX3NoaXBwYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXlEYXRlLnNldERhdGUobXlEYXRlLmdldERhdGUoKSArIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBtb250aCA9IG15RGF0ZS5nZXRNb250aCgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW9udGhjb250ID0ge21vbnRoOiBtb250aCwgZGF5czogW10sIHRpdGxlOiBCb29raW5nLmdldE1vbnRoTmFtZShtb250aCl9O1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDYxOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXkgPSBteURhdGUuZ2V0RGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge2RhdGU6IG5ldyBEYXRlKG15RGF0ZS5nZXRUaW1lKCkpLCBzdGF0dXM6IFwiY2xvc2VkXCJ9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jaGVja0F2YWlsYWJsZURheXMoJHNjb3BlLndlZWtkYXlbZGF5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc3RhdHVzID0gXCJhY3RpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXlEYXRlLmdldE1vbnRoKCkgIT0gbW9udGhjb250Lm1vbnRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vbnRocy5wdXNoKG1vbnRoY29udCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vbnRoID0gbXlEYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGhjb250ID0ge21vbnRoOiBtb250aCwgZGF5czogW10sIHRpdGxlOiBCb29raW5nLmdldE1vbnRoTmFtZShtb250aCl9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9udGhjb250LmRheXMucHVzaChjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmF2YWlsYWJsZURhdGVzLnB1c2goY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG15RGF0ZS5zZXREYXRlKG15RGF0ZS5nZXREYXRlKCkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlcyBtb250aHNcIiwgJHNjb3BlLm1vbnRocyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5yZXR1cm5EYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0U3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuc3RhcnREYXRlUyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lbmREYXRlID0gbmV3IERhdGUoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRUaW1lKCkgKyAocGFyc2VJbnQoJHNjb3BlLmFtb3VudCkgKiA1MCkgKiA2MDAwMCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50aW1lU2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyQXZhaWxhYmlsaXRpZXMgPSBmdW5jdGlvbiAoZGF5KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFiaWxpdGllc0RhdGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuYXZhaWxhYmlsaXRpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXZhaWxhYmlsaXRpZXNbaXRlbV0ucmFuZ2UgPT0gJHNjb3BlLndlZWtkYXlbZGF5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdmFpbGFiaWxpdGllc0RhdGUucHVzaCgoJHNjb3BlLmF2YWlsYWJpbGl0aWVzW2l0ZW1dKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFNsb3QgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnREYXRlID0gaXRlbS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVuZERhdGUgPSAkc2NvcGUuYWRkTWludXRlcyhpdGVtLmVuZCwgLTUpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGltZVNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEJvb2tpbmdzRGF5ID0gZnVuY3Rpb24gKHNlbGVjdGVkRGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyRGF0ZSA9IHNlbGVjdGVkRGF0ZS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyAoc2VsZWN0ZWREYXRlLmdldE1vbnRoKCkgKyAxKSArIFwiLVwiICsgc2VsZWN0ZWREYXRlLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJvbVwiOiBzdHJEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJxdWVyeVwiOiBcImRheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6ICRzY29wZS50eXBlT2JqLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3RfaWRcIjogJHNjb3BlLm9iamVjdElkLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBCb29raW5nLmdldEJvb2tpbmdzT2JqZWN0KHBhcmFtcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXRCb29raW5nc09iamVjdFwiLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiByZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJvb2tpdGVtID0gbmV3IEJvb2tpbmcocmVzdWx0c1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkU3BvdHMucHVzaChib29raXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRTbG90cygpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBnZXRCb29raW5nc09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdERhdGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5zdGF0dXMgPT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZERhdGUgPSBpdGVtLmRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF5ID0gc2VsZWN0ZWREYXRlLmdldERheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGVTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGltZVNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNlbGVjdCBkYXRlXCIsIHNlbGVjdGVkRGF0ZSk7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF5TmFtZSA9ICRzY29wZS53ZWVrZGF5MltkYXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0YXJ0RGF0ZSA9IHNlbGVjdGVkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGFydERhdGVTID0gc2VsZWN0ZWREYXRlLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KCdCdXNjYW5kbyBob3JhcmlvcyBkaXNwb25pYmxlcycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlckF2YWlsYWJpbGl0aWVzKGRheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Qm9va2luZ3NEYXkoc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQXZhaWxhYmlsaXRpZXNcIiwgJHNjb3BlLmF2YWlsYWJpbGl0aWVzRGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KCdCT09LSU5HLk5PVF9BVkFJTEFCTEUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRNaW51dGVzID0gZnVuY3Rpb24gKGRhdGUsIG1pbnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpICsgbWludXRlcyAqIDYwMDAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkU2xvdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBvaW50bWVudE9wdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFwcG9pbnRtZW50TGVuZ3RoID0gMzA7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcG9pbnRtZW50TGVuZ3RoID0gJHNjb3BlLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS52YXJpYW50ICYmICRzY29wZS52YXJpYW50LmlzX3NoaXBwYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcG9pbnRtZW50TGVuZ3RoID0gNjA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IGN1cnJlbnQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2NoZWR1bGVCdWZmZXIgPSAxNTA7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSAkc2NvcGUuYWRkTWludXRlcyhjdXJyZW50LCBhcHBvaW50bWVudExlbmd0aCArIHNjaGVkdWxlQnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuYXZhaWxhYmlsaXRpZXNEYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gJHNjb3BlLmF2YWlsYWJpbGl0aWVzRGF0ZVtpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnVpbGRpbmcgZGF0ZSBcIiArICRzY29wZS5zdGFydERhdGUuZ2V0RnVsbFllYXIoKSArIFwiL1wiICsgKCRzY29wZS5zdGFydERhdGUuZ2V0TW9udGgoKSArIDEpICsgXCIvXCIgKyAkc2NvcGUuc3RhcnREYXRlLmdldERhdGUoKSArIFwiIFwiICsgY29udGFpbmVyLmZyb20ucmVwbGFjZShcIiBcIiwgXCI6MDAgXCIpKVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0ID0gbmV3IERhdGUoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRGdWxsWWVhcigpICsgXCIvXCIgKyAoJHNjb3BlLnN0YXJ0RGF0ZS5nZXRNb250aCgpICsgMSkgKyBcIi9cIiArICRzY29wZS5zdGFydERhdGUuZ2V0RGF0ZSgpICsgXCIgXCIgKyBjb250YWluZXIuZnJvbS5yZXBsYWNlKFwiIFwiLCBcIjowMCBcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZCA9IG5ldyBEYXRlKCRzY29wZS5zdGFydERhdGUuZ2V0RnVsbFllYXIoKSArIFwiL1wiICsgKCRzY29wZS5zdGFydERhdGUuZ2V0TW9udGgoKSArIDEpICsgXCIvXCIgKyAkc2NvcGUuc3RhcnREYXRlLmdldERhdGUoKSArIFwiIFwiICsgY29udGFpbmVyLnRvLnJlcGxhY2UoXCIgXCIsIFwiOjAwIFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAob3Blbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRBcHAgPSAkc2NvcGUuYWRkTWludXRlcyhzdGFydCwgYXBwb2ludG1lbnRMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmRBcHAgPD0gZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXJTbG90ID0ge3N0YXJ0OiBzdGFydCwgZW5kOiBlbmRBcHB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPiBjdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5jaGVja0ZpbGxlZERhdGUoY29udGFpbmVyU2xvdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBwb2ludG1lbnRPcHRpb25zLnB1c2goY29udGFpbmVyU2xvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSAkc2NvcGUuYWRkTWludXRlcyhzdGFydCwgYXBwb2ludG1lbnRMZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmJvb2tpbmdPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGVkIGJvb2tpbmcgb2JqXCIsICRzY29wZS5ib29raW5nT2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7c3RhcnQ6ICRzY29wZS5ib29raW5nT2JqLnN0YXJ0c19hdCwgZW5kOiAkc2NvcGUuYm9va2luZ09iai5lbmRzX2F0fVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFNsb3QoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hlY2tGaWxsZWREYXRlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRzY29wZS5zZWxlY3RlZFNwb3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2hlY2tpbmcgPSAkc2NvcGUuc2VsZWN0ZWRTcG90c1tpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGVzdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb21wYXJpbmc6IFwiLCBjb250YWluZXIuc3RhcnQuZ2V0VGltZSgpLCBcIiBcIiwgY29udGFpbmVyLmVuZC5nZXRUaW1lKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbXBhcmluZzogXCIsIGNoZWNraW5nLnN0YXJ0c19hdC5nZXRUaW1lKCksIFwiIFwiLCBjaGVja2luZy5lbmRzX2F0LmdldFRpbWUoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGlmZmVyZW5jZTogXCIsIGNvbnRhaW5lci5zdGFydC5nZXRUaW1lKCkgLSBjaGVja2luZy5zdGFydHNfYXQuZ2V0VGltZSgpLCBcIiBcIiwgY29udGFpbmVyLmVuZC5nZXRUaW1lKCkgLSBjaGVja2luZy5lbmRzX2F0LmdldFRpbWUoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY29udGFpbmVyLnN0YXJ0LmdldFRpbWUoKSA9PSBjaGVja2luZy5zdGFydHNfYXQuZ2V0VGltZSgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29udGFpbmVyLnN0YXJ0LmdldFRpbWUoKSA+IGNoZWNraW5nLnN0YXJ0c19hdC5nZXRUaW1lKCkgJiYgY29udGFpbmVyLnN0YXJ0LmdldFRpbWUoKSA8IGNoZWNraW5nLmVuZHNfYXQuZ2V0VGltZSgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29udGFpbmVyLnN0YXJ0LmdldFRpbWUoKSA8IGNoZWNraW5nLnN0YXJ0c19hdC5nZXRUaW1lKCkgJiYgY29udGFpbmVyLmVuZC5nZXRUaW1lKCkgPiBjaGVja2luZy5zdGFydHNfYXQuZ2V0VGltZSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHJ1ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZURhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRlU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRpbWVTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlVGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRpbWVTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY29uc3RydWN0b3IoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubmdPbkluaXQoKTtcbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2Jvb2tpbmdjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 9 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .controller('CartCtrl', ['$scope', 'Cart', '$rootScope', function ($scope, Cart, $rootScope) {\n                $scope.subtotal = 0;\n                $scope.total = 0\n                angular.element(document).ready(function () {\n                    setTimeout(function () {\n                        var url = window.location.href;\n                        if(!url.includes(\"checkout\")){\n                            $scope.getCart();\n                        }\n                    }, 300);\n                });\n                $scope.clean = function () {\n                    angular.forEach(angular.element(\".item-attributes\"), function (value, key) {\n                        var a = angular.element(value);\n                        var obj = JSON.parse(a.html());\n                        var html = \"\";\n                        for (x in obj) {\n                            html += x + \": \" + obj[x] + \" <br/>\";\n                        }\n                        a.html(html)\n                        a.css(\"display\", \"block\");\n                    });\n                }\n                $rootScope.$on('updateHeadCart', function () {\n                    console.log(\"Get cart\");\n                    $scope.getCart();\n                });\n                $rootScope.$on('loadHeadCart', function (event, args) {\n                    console.log(\"Loading cart\", args);\n                    $scope.loadCart(args);\n                });\n                $scope.getCart = function () {\n                    Cart.getCart().then(function (data) {\n                        console.log(\"Get Cart\", data);\n                        if (data.status == 'error') {\n                            alert(data.message);\n                        } else {\n                            $scope.loadCart(data);\n                            $rootScope.$broadcast('loadCartVariants', data);\n                        }\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.loadCart = function (data) {\n                    $rootScope.items = data.items;\n                    $scope.totalItems = data.totalItems;\n                    $scope.subtotal = data.subtotal;\n                    $scope.total = data.total;\n                }\n                $scope.updateCartItem = function (product_variant_id) {\n                    var quantity = angular.element(document.querySelector('input[name=quantity-' + product_variant_id + ']')).val();\n                    console.log(\"da qty: \" + quantity);\n                    var container = {\n                        quantity: quantity,\n                        product_variant_id: $scope.product_variant_id,\n                        \"extras\": []\n                    };\n                    Cart.updateCartItem(container).then(function (data) {\n                        if (data.status == 'error') {\n                            alert(data.message);\n                        }\n                        $scope.getCart();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.clearCart = function () {\n                    Cart.clearCart().then(function (data) {\n                        $scope.getCart();\n                        $rootScope.$broadcast('clearCart');\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteCartItem = function (item_id) {\n                    var container = {\n                        quantity: 0,\n                        item_id: item_id,\n                        \"extras\": []\n                    };\n\n                    Cart.updateCartItem(container).then(function (data) {\n                        console.log(\"delete\", data);\n                        if (data.status == 'error') {\n                            alert(data.message);\n                        } else {\n                            $scope.loadCart(data.cart);\n                            $rootScope.$broadcast('deleteItem', item_id);\n                        }\n                        //$scope.getCart();\n                    },\n                            function (data) {\n\n                            });\n                }\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2NhcnRjdHJsLmpzPzk3YjYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdDYXJ0Q3RybCcsIFsnJHNjb3BlJywgJ0NhcnQnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsIENhcnQsICRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VidG90YWwgPSAwO1xuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDBcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZighdXJsLmluY2x1ZGVzKFwiY2hlY2tvdXRcIikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goYW5ndWxhci5lbGVtZW50KFwiLml0ZW0tYXR0cmlidXRlc1wiKSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gYW5ndWxhci5lbGVtZW50KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGEuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeCBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IHggKyBcIjogXCIgKyBvYmpbeF0gKyBcIiA8YnIvPlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYS5odG1sKGh0bWwpXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCd1cGRhdGVIZWFkQ2FydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgY2FydFwiKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignbG9hZEhlYWRDYXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBjYXJ0XCIsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZENhcnQoYXJncyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIENhcnQuZ2V0Q2FydCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IENhcnRcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkQ2FydChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRDYXJ0VmFyaWFudHMnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkQ2FydCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXRlbXMgPSBkYXRhLml0ZW1zO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWxJdGVtcyA9IGRhdGEudG90YWxJdGVtcztcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1YnRvdGFsID0gZGF0YS5zdWJ0b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gZGF0YS50b3RhbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZUNhcnRJdGVtID0gZnVuY3Rpb24gKHByb2R1Y3RfdmFyaWFudF9pZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcXVhbnRpdHkgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1xdWFudGl0eS0nICsgcHJvZHVjdF92YXJpYW50X2lkICsgJ10nKSkudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGEgcXR5OiBcIiArIHF1YW50aXR5KTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfdmFyaWFudF9pZDogJHNjb3BlLnByb2R1Y3RfdmFyaWFudF9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIENhcnQudXBkYXRlQ2FydEl0ZW0oY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCgpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyQ2FydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5jbGVhckNhcnQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdjbGVhckNhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5kZWxldGVDYXJ0SXRlbSA9IGZ1bmN0aW9uIChpdGVtX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IGl0ZW1faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImV4dHJhc1wiOiBbXVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIENhcnQudXBkYXRlQ2FydEl0ZW0oY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGV0ZVwiLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRDYXJ0KGRhdGEuY2FydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdkZWxldGVJdGVtJywgaXRlbV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5nZXRDYXJ0KCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvY2FydGN0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 10 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('CheckoutCartCtrl', ['$scope', '$rootScope', 'Cart', 'Orders', 'Modals', '$q', function ($scope, $rootScope, Cart, Orders, Modals, $q) {\r\n                $scope.data = {};\r\n                $scope.coupon = \"\";\r\n                $scope.accept = false;\r\n                $scope.acceptError = false;\r\n                $scope.couponVisible = false;\r\n                $scope.conditions = [];\r\n                $rootScope.isDigital = false;\r\n                $rootScope.bookingSet = true;\r\n                $scope.hasTransactionCost = false;\r\n                $scope.transactionCost = 0;\r\n                $scope.totalTransaction = 0;\r\n                angular.element(document).ready(function () {\r\n                    setTimeout(function () {\r\n                        $scope.getCart(true);\r\n                    }, 300);\r\n                });\r\n                $scope.cleanJson = function () {\r\n                    angular.forEach(angular.element(\".item-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $scope.getCart = function (init) {\r\n                    Cart.getCheckoutCart().then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $scope.loadCart(data, init)\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.AcceptTerms = function () {\r\n                    if ($scope.accept) {\r\n                        $scope.acceptError = false;\r\n                    }\r\n                }\r\n                $scope.getOrder = function (init) {\r\n                    var def = $q.defer();\r\n                    Orders.getOrder().then(function (data) {\r\n                        $rootScope.isDigital = true;\r\n                        $rootScope.activeOrder = data.data;\r\n                        def.resolve(\"Done\")\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                    return def.promise;\r\n                }\r\n                $scope.updateCartItem = function (item_id) {\r\n                    var quantity = angular.element(document.querySelector('input[name=check-quantity-' + item_id + ']')).val();\r\n                    var container = {\r\n                        quantity: quantity,\r\n                        item_id: item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        }\r\n                        $scope.getCart(false);\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.clearCart = function () {\r\n                    Cart.clearCart().then(function (data) {\r\n                        $scope.getCart();\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.loadCart = function (data, init) {\r\n                    if (data.items.length > 0) {\r\n                        var items = data.items;\r\n                        var shippable = false;\r\n                        for (var i in items) {\r\n                            var item = items[i];\r\n                            console.log(\"Item: \", item.attributes);\r\n                            if (item.attributes.is_shippable || (item.attributes.shipping && item.attributes.shipping > 0)) {\r\n                                shippable = true;\r\n                            }\r\n                        }\r\n                        $scope.conditions = data.conditions;\r\n                        $rootScope.items = data.items;\r\n                        $scope.totalItems = data.totalItems;\r\n                        $scope.subtotal = data.subtotal;\r\n                        $scope.shipping = data.shipping;\r\n                        $scope.tax = data.tax;\r\n                        $scope.sale = data.sale;\r\n                        $scope.coupon = data.coupon;\r\n                        $scope.discount = data.sale + data.coupon;\r\n                        $scope.total = data.total;\r\n                        console.log(\"Broadcasting shippable: \", shippable);\r\n                        if (init) {\r\n                            if (shippable) {\r\n                                $rootScope.$broadcast('Shippable');\r\n                            } else {\r\n\r\n                                $scope.getOrder().then(function (data) {\r\n                                    $rootScope.$broadcast('NotShippable');\r\n                                },\r\n                                        function (data) {\r\n\r\n                                        });\r\n\r\n                            }\r\n                        }\r\n                    } else {\r\n                        window.location.href = '/';\r\n                    }\r\n                }\r\n                $scope.prepareOrder = function () {\r\n                    console.log(\"Accept\", $scope.accept);\r\n                    if ($scope.accept) {\r\n                        $rootScope.$broadcast('prepareOrder');\r\n                    } else {\r\n                        $scope.acceptError = true;\r\n                    }\r\n                }\r\n\r\n                $scope.deleteCartItem = function (item_id) {\r\n                    var container = {\r\n                        quantity: 0,\r\n                        item_id: item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == 'error') {\r\n                            alert(data.message);\r\n                        }\r\n                        $scope.getCart();\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.setCoupon = function () {\r\n                    //setTimeout(function(){ Modals.hideLoader(); }, 2000);\r\n                    if ($scope.coupon && $scope.coupon.length > 0) {\r\n                        Modals.showLoader();\r\n                        Orders.setCoupon($scope.coupon).then(function (resp) {\r\n                            Modals.hideLoader();\r\n                            if (resp) {\r\n                                if (resp.status == \"success\") {\r\n                                    $scope.getCart(false);\r\n                                    $scope.coupon = \"\";\r\n                                    Modals.showToast('Cupon agregado exitosamente', $(\"#final-submit\"));\r\n                                } else {\r\n                                    Modals.showToast('No puedes usar ese cupon', $(\"#final-submit\"));\r\n                                }\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                }); \r\n                    } else {\r\n                        Modals.showToast('Ingresa un cupon', $(\"#final-submit\"));\r\n                    }\r\n                }\r\n                $rootScope.$on('updateCheckoutCart', function (event, args) {\r\n                    $scope.getCart(false);\r\n\r\n                });\r\n                $rootScope.$on('addTransactionCost', function (event, args) {\r\n                    console.log(\"Adding transaction cost\");\r\n                    $scope.hasTransactionCost = true;\r\n                    $scope.transactionCost = $rootScope.activeOrder.total*(0.05);\r\n                    $scope.totalTransaction = $rootScope.activeOrder.total+$scope.transactionCost;\r\n                });\r\n                $rootScope.$on('removeTransactionCost', function (event, args) {\r\n                    $scope.hasTransactionCost = false;\r\n                    $scope.transactionCost = 0;\r\n                    $scope.totalTransaction = 0;\r\n                });\r\n                $rootScope.$on('updateLoadedCart', function (event, args) {\r\n                    console.log(\"updateLoadedCart\", args);\r\n                    $scope.loadCart(args);\r\n                });\r\n            }])\r\n        .controller('CheckoutShippingCtrl', ['$scope', '$rootScope', 'LocationService', 'Users', '$q',\r\n            'Cart', '$cookies', 'Orders', 'Modals', 'Billing', '$location', '$anchorScroll', '$mdDialog',\r\n            function ($scope, $rootScope, LocationService, Users, $q, Cart, $cookies, Orders, Modals, Billing, $location, $anchorScroll, $mdDialog) {\r\n                $scope.data = {};\r\n                $scope.addressSet = {};\r\n                $scope.shipping = [];\r\n                $scope.regionVisible = false;\r\n                $scope.addressesFetched = false;\r\n                $scope.cityVisible = false;\r\n                $scope.addAddress = false;\r\n                $scope.visible = false;\r\n                $rootScope.shippingAddressSet = true;\r\n                $rootScope.shippingCondition = true;\r\n                $rootScope.shippingConditionSet = false;\r\n                $rootScope.billingAddressSet = false;\r\n                $rootScope.paymentMethodSet = false;\r\n\r\n                $rootScope.$on('Shippable', function (event, args) {\r\n                    $rootScope.shippingAddressSet = false;\r\n                    $rootScope.shippingCondition = false;\r\n                    $rootScope.billingAddressSet = false;\r\n                    $rootScope.paymentMethodSet = false;\r\n                    $scope.visible = true;\r\n                    var strAddress = $cookies.get(\"shippingAddress\");\r\n                    var address = null;\r\n                    if (strAddress && strAddress.length > 0) {\r\n                        address = JSON.parse(strAddress);\r\n                    }\r\n                    console.log(\"Shipping address: \", address);\r\n                    console.log(\"$rootScope.user: \", $rootScope.user);\r\n                    if (address) {\r\n                        if (!address.name) {\r\n                            $scope.addAddress = true;\r\n                            $scope.data = address;\r\n\r\n                            if ($rootScope.user) {\r\n                                $scope.data.name = $rootScope.user.name;\r\n                                $scope.data.phone = $rootScope.user.cellphone;\r\n                            }\r\n                            $scope.selectPlace($scope.data.country_id, $scope.data.region_id, $scope.data.city_id);\r\n                        }\r\n                        if (address.id) {\r\n                            $scope.selectAddress(address);\r\n                        }\r\n                    } else {\r\n                        $scope.getAddresses().then(function (data) {\r\n                            if ($rootScope.addresses.length == 0) {\r\n                                $scope.newAddress();\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                });\r\n                $scope.countries = [{name: \"Colombia\", id: 1}, {name: \"Colombia2\", id: 2}]\r\n\r\n                angular.element(document).ready(function () {\r\n\r\n                });\r\n                $scope.newAddress = function () {\r\n                    var url = window.location.href;\r\n                    $cookies.put(\"shippingAddress\", \"\", {path: \"/\"});\r\n                    $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\r\n                    window.location.href = \"/location\";\r\n                }\r\n                $scope.getCoveragePrompt = function () {\r\n                    $mdDialog.show(Modals.getCoveragePrompt()).then(function (answer) {\r\n                        if (answer == \"new\") {\r\n                            $scope.newAddress();\r\n                        } else if (answer == 'clear') {\r\n                            Cart.clearCart().then(function (answer) {\r\n                                window.location.href = \"/\";\r\n                            }, function () {\r\n\r\n                            });\r\n                        }\r\n                    }, function () {\r\n\r\n                    });\r\n                };\r\n                $rootScope.$on('prepareOrder', function (event, args) {\r\n                    $scope.prepareOrder();\r\n                });\r\n                $rootScope.$on('buildOrder', function (event, args) {\r\n                    $scope.buildOrder($rootScope.activeOrder);\r\n                });\r\n                $rootScope.$on('NotShippable', function (event, args) {\r\n                    $scope.visible = false;\r\n                });\r\n                $rootScope.$on('getAddresses', function (event, args) {\r\n                    $scope.getAddresses();\r\n                });\r\n                $scope.cleanJson = function () {\r\n                    angular.forEach(angular.element(\".item-attributes\"), function (value, key) {\r\n                        var a = angular.element(value);\r\n                        var obj = JSON.parse(a.html());\r\n                        var html = \"\";\r\n                        for (x in obj) {\r\n                            html += x + \": \" + obj[x] + \" <br/>\";\r\n                        }\r\n                        a.html(html)\r\n                        a.css(\"display\", \"block\");\r\n                    });\r\n                }\r\n                $scope.save = function (isvalid) {\r\n                    $scope.submitted = true;\r\n                    if (isvalid) {\r\n                        Modals.showLoader();\r\n                        Users.saveAddress($scope.data).then(function (data) {\r\n                            Modals.hideLoader();\r\n                            if (data.status == \"success\") {\r\n                                $scope.selectAddress(data.address);\r\n                                $scope.data = {};\r\n                                $scope.submitted = false;\r\n                                $scope.hideAddressForm();\r\n                            } else {\r\n\r\n                            }\r\n\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    }\r\n                }\r\n                $scope.getAddresses = function () {\r\n                    var def = $q.defer();\r\n                    Users.getAddresses().then(function (data) {\r\n                        $rootScope.addresses = data.addresses;\r\n                        def.resolve(\"done\");\r\n                    },\r\n                            function (data) {\r\n                                def.resolve(\"error\");\r\n                            });\r\n                    return def.promise;\r\n                }\r\n                $scope.clean = function () {\r\n                    $scope.data = {};\r\n                    $scope.regionVisible = false;\r\n                    $scope.cityVisible = false;\r\n                }\r\n                $scope.selectCountry = function (country_id) {\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectRegion = function (region_id) {\r\n                    LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                        $scope.cities = data.data;\r\n                        $scope.cityVisible = true;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectPlace = function (country_id, region_id, city_id) {\r\n                    //$scope.$apply(function () {\r\n                    $scope.data.country_id = country_id;\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n                        console.log(\"Setting region\", $scope.data.region_id);\r\n                        $scope.data.region_id = region_id;\r\n                        LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                            $scope.cities = data.data;\r\n                            $scope.cityVisible = true;\r\n                            console.log(\"Setting city_id\", $scope.data.city_id);\r\n                            console.log(\"Setting cities\", $scope.cities);\r\n                            $scope.data.city_id = city_id;\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                    //});\r\n                }\r\n\r\n                $scope.selectAddress = function (address) {\r\n                    $scope.addressSet = address;\r\n                    var data = {address_id: address.id};\r\n                    Modals.showLoader();\r\n                    Orders.setShippingAddress(data).then(function (data) {\r\n                        console.log(\"Set shipping address\", data);\r\n                        if (data.status == \"success\") {\r\n                            $rootScope.shippingAddressSet = true;\r\n                            $rootScope.shippingAddress = address;\r\n                            $cookies.put(\"shippingAddress\", JSON.stringify($rootScope.shippingAddress), {path: \"/\"});\r\n                            var order = data.order;\r\n                            var attributes = JSON.parse(order.attributes);\r\n                            order.attributes = attributes;\r\n                            $rootScope.activeOrder = order;\r\n                            var providers = attributes.providers;\r\n                            for (var i in providers) {\r\n                                console.log(\"Providers: \", providers[i]);\r\n                            }\r\n                            console.log(\"Setting discounts\", $rootScope.shippingAddressSet);\r\n                            $scope.buildOrder(order);\r\n                        } else {\r\n                            Modals.hideLoader();\r\n                            Modals.showToast(\"Fuera de cobertura para esta orden\", $(\"#checkout-shipping\"));\r\n                        }\r\n\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.scrollTo = function (id) {\r\n                    setTimeout(function () {\r\n                        var old = $location.hash();\r\n                        $location.hash(id);\r\n                        $anchorScroll();\r\n                        $location.hash(old);\r\n                    }, 500);\r\n                }\r\n                $scope.buildOrder = function (order) {\r\n                    Orders.setDiscounts(order.id, $rootScope.platform).then(function (data) {\r\n                        console.log(\"Discounts set\", data);\r\n                        var dataS = {\"payers\": [$rootScope.user.id], \"platform\": $rootScope.platform};\r\n                        Orders.checkOrder(order.id, dataS).then(function (resp) {\r\n                            console.log(\"Check Order Result\", resp);\r\n                            Modals.hideLoader();\r\n                            var order = resp.order;\r\n                            if (resp.status == \"success\") {\r\n                                if ($rootScope.platform == \"Food\") {\r\n                                    $rootScope.shippingConditionSet = true;\r\n                                } else {\r\n                                    if ($rootScope.isDigital) {\r\n                                        //$scope.prepareOrder();\r\n                                    } else {\r\n                                        Modals.showToast(\"Direccion guardada\", $(\"#checkout-shipping\"));\r\n                                        $rootScope.$broadcast('updateCheckoutCart');\r\n                                        $scope.scrollTo(\"checkout-shipping-methods\");\r\n                                        console.log(\"Finished scrolling2222\");\r\n                                    }\r\n                                }\r\n\r\n\r\n                            } else {\r\n                                $scope.handleCheckError(resp, order);\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.addCartItem = function (product_variant, extras) {\r\n                    product_variant.extras = extras\r\n                    Cart.postToServer(product_variant).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $rootScope.$broadcast('updateCheckoutCart');\r\n                            $scope.buildOrder($rootScope.activeOrder);\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.setShippingCondition = function (item) {\r\n                    Modals.showLoader();\r\n                    console.log(\"Set Shipping\", item);\r\n                    var container = {\"provider\": item.class, \"provider_id\": item.id};\r\n                    Orders.setPlatformShippingCondition($rootScope.activeOrder.id, container).then(function (data) {\r\n                        Modals.hideLoader();\r\n                        console.log(\"setPlatformShippingPrice Result\", data);\r\n                        if (data.status == \"success\") {\r\n                            $rootScope.$broadcast('updateLoadedCart', data.cart);\r\n                            $rootScope.activeOrder = data.order;\r\n                            for (var i = 0; i < $scope.shipping.length; i++) {\r\n                                $scope.shipping[i].selected = false;\r\n                            }\r\n                            $rootScope.shippingConditionSet = true;\r\n                            item.price = data.cart.shipping;\r\n                            item.selected = true;\r\n                            $scope.scrollTo(\"checkout-cart\");\r\n                            Modals.showToast(\"Envio agregado exitosamente\", $(\"#checkout-shipping\"));\r\n                        } else {\r\n                            Modals.showToast(\"Hubo un error con ese metodo de envio\", $(\"#checkout-shipping\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                                Modals.showToast(\"Hubo un error con ese metodo de envio\", $(\"#checkout-shipping\"));\r\n                            });\r\n                }\r\n                $scope.handleCheckError = function (resp, order) {\r\n                    if (resp.type == \"credits\") {\r\n                        var missing = parseInt(resp.required_credits);\r\n                        console.log(\"Required credits\", missing);\r\n                        console.log(\"creditItem\", resp.creditItem);\r\n                        Modals.showToast(\"Hemos agregado un item obligatorio\", $(\"#checkout-shipping\"));\r\n                        console.log(\"creditItemMerchant\", resp.creditItemMerchant);\r\n                        var container = {\r\n                            order_id: order.id,\r\n                            product_variant_id: resp.creditItem.id,\r\n                            quantity: missing,\r\n                            item_id: null,\r\n                            merchant_id: resp.creditItemMerchant\r\n                        };\r\n                        $scope.addCartItem(container, []);\r\n                    } else if (resp.type == \"buyers\") {\r\n                        //\r\n                    } else if (resp.type == \"shipping\") {\r\n                        //this.api.toast('CHECKOUT_PREPARE.REQUIRES_SHIPPING');\r\n                        $scope.scrollTo(\"checkout-shipping-methods\");\r\n                        Modals.showToast(\"Debes seleccionar proveedor de envio\", $(\"#checkout-shipping-methods\"));\r\n                        if ($scope.shipping.length == 0) {\r\n                            $scope.expectedProviders = 0;\r\n                            var attributes = JSON.parse(order.attributes);\r\n                            if (attributes.providers) {\r\n                                for (var item in attributes.providers) {\r\n                                    $scope.expectedProviders++;\r\n                                    $scope.getPlatformShippingPrice(resp.order.id, attributes.providers[item]);\r\n                                }\r\n                            }\r\n                        }\r\n                    } else if (resp.type == \"delivery\") {\r\n                        /*this.api.toast('CHECKOUT_PREPARE.REQUIRES_DELIVERY');\r\n                         this.api.dismissLoader();\r\n                         let endDate = new Date();\r\n                         if (this.currentItems.length == 0) {\r\n                         this.getCart();\r\n                         }\r\n                         endDate.setDate(endDate.getDate() + 1);\r\n                         //this.delivery = endDate.toISOString();\r\n                         console.log(\"delivery\", this.delivery);\r\n                         this.requiresDelivery = true;*/\r\n                    }\r\n                }\r\n                $scope.getPlatformShippingPrice = function (order_id, platform) {\r\n                    var description = platform.desc;\r\n                    delete platform.desc;\r\n                    Orders.getPlatformShippingPrice(order_id, platform).then(function (data) {\r\n                        console.log(\"getPlatformShippingPrice Result\", data);\r\n                        $scope.expectedProviders--;\r\n                        if (data.status == \"success\") {\r\n                            var name = platform.provider;\r\n                            if (platform.provider == \"MerchantShipping\") {\r\n                                name = \"Domicilio del Establecimiento\"\r\n                            }\r\n                            var container = {platform: name, class: platform.provider, price: data.price, desc: description, id: platform.provider_id, selected: false};\r\n                            var add = true;\r\n                            for (var i = 0; i < $scope.shipping.length; i++) {\r\n                                var cont = $scope.shipping[i];\r\n                                if (cont.platform == container.platform) {\r\n                                    if (cont.price <= container.price) {\r\n                                        console.log(\"Not adding\", container)\r\n                                        add = false;\r\n                                    } else {\r\n                                        console.log(\"Removing\", cont)\r\n                                        $scope.shipping.splice(i, 1);\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (add) {\r\n                                $scope.shipping.push(container);\r\n                            }\r\n\r\n\r\n                        }\r\n                        if ($scope.expectedProviders == 0 && !$rootScope.shippingConditionSet) {\r\n                            if ($scope.shipping.length > 0) {\r\n                                $scope.setShippingCondition($scope.shipping[0]);\r\n                                console.log(\"Auto select\", $scope.shipping)\r\n                            } else {\r\n                                $scope.getCoveragePrompt();\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                                $scope.expectedProviders--;\r\n                            });\r\n                }\r\n                $scope.showAddressForm = function () {\r\n                    $cookies.put(\"locationRefferrer\", window.location.href, {path: \"/\"});\r\n                    window.location.href = \"/location\";\r\n                }\r\n                $scope.hideAddressForm = function () {\r\n                    $scope.addAddress = false;\r\n                }\r\n                $scope.changeAddress = function () {\r\n                    console.log(\"Change address\")\r\n                    $rootScope.shippingAddressSet = false;\r\n                    $rootScope.shippingConditionSet = false;\r\n                    $scope.addAddress = false;\r\n                    if ($rootScope.addresses && $rootScope.addresses.length > 0) {\r\n\r\n                    } else {\r\n                        $scope.getAddresses().then(function (data) {\r\n                            if ($rootScope.addresses.length == 0) {\r\n                                $scope.newAddress();\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                        ;\r\n                    }\r\n                }\r\n                $scope.changeShipping = function () {\r\n                    $rootScope.shippingConditionSet = false;\r\n                }\r\n                $scope.prepareOrder = function () {\r\n                    Modals.showLoader();\r\n                    $scope.showPayment = false;\r\n                    $scope.shippingError = false;\r\n                    var payers = [$rootScope.user.id];\r\n                    var recurring_type = \"limit\";\r\n                    var recurring_value = 3;\r\n                    var container = {\r\n                        \"order_id\": $rootScope.activeOrder.id,\r\n                        \"payers\": payers,\r\n                        \"delivery_date\": null,\r\n                        \"split_order\": false,\r\n                        \"platform\": $rootScope.platform,\r\n                        \"recurring\": false,\r\n                        \"recurring_type\": recurring_type,\r\n                        \"recurring_value\": recurring_value,\r\n                        \"merchant_id\": $rootScope.activeOrder.merchant_id\r\n                    };\r\n                    Orders.prepareOrder(container, $rootScope.platform).then(function (resp) {\r\n                        Modals.hideLoader();\r\n                        if (resp) {\r\n                            if (resp.status == \"success\") {\r\n                                Modals.showToast(\"Selecciona método de envío\", $(\"#checkout-cart\"));\r\n                                console.log(\"orderProvider\", resp);\r\n                                $rootScope.activePayment = resp.payment;\r\n                                $rootScope.activeOrder = resp.order;\r\n                                if ($rootScope.activePayment.total == $rootScope.activePayment.transaction_cost) {\r\n                                    var container = {\r\n                                        \"payment_id\": $rootScope.activePayment.id\r\n                                    }\r\n                                    Modals.showLoader();\r\n                                    Billing.completePaidOrder(container).then(function (resp) {\r\n                                        Modals.hideLoader();\r\n                                        if (resp.status == \"success\") {\r\n                                            resp.transaction = {};\r\n                                            resp.transaction.reference_sale = \"Pago Interno\";\r\n                                            resp.transaction.payment_method = \"Pago Interno\";\r\n                                            resp.transaction.description = \"Pago Interno\";\r\n                                            resp.transaction.transaction_id = resp.payment.id;\r\n                                            resp.transaction.transaction_state = \"APPROVED\";\r\n                                            $rootScope.$broadcast('transactionResponse', resp);\r\n                                        } else {\r\n                                            $scope.showPayment = true;\r\n                                            //this.scrollToTop();\r\n                                        }\r\n                                    }, function (err) {\r\n                                        $scope.showPayment = true;\r\n                                        //this.scrollToTop();\r\n                                        console.log(\"completePaidOrderError\", err);\r\n                                    });\r\n                                } else {\r\n                                    $rootScope.$broadcast('activatePayment');\r\n                                }\r\n                            } else {\r\n                                $scope.handleCheckError(resp);\r\n                            }\r\n\r\n                        }\r\n                    }, function (err) {\r\n                        Modals.hideLoader();\r\n                        console.log(\"getCartError\", err);\r\n                        Modals.showToast(\"Hubo un error porfavor comunicate mas tarde\", $(\"#checkout-cart\"));\r\n                    });\r\n                }\r\n            }])\r\n        .controller('CheckoutBillingCtrl', ['$scope', '$rootScope', 'LocationService', 'Users', 'Billing', '$location', '$anchorScroll', 'Modals', '$mdDialog', 'Cart',\r\n            function ($scope, $rootScope, LocationService, Users, Billing, $location, $anchorScroll, Modals, $mdDialog, Cart) {\r\n                $scope.data = {};\r\n                $scope.data2 = {};\r\n                $scope.data3 = {};\r\n                $scope.data4 = {};\r\n                $scope.data5 = {};\r\n                $scope.transaction = {};\r\n                $scope.banks = [];\r\n                $rootScope.paymentActive = false;\r\n                $scope.creditCardVisible = false;\r\n                $scope.creditPayerVisible = false;\r\n                $scope.creditBuyerVisible = false;\r\n                $scope.credito = false;\r\n                $scope.bank = false;\r\n                $scope.showResult = false;\r\n                $scope.resultHeader = \"\";\r\n                $scope.resultBody = \"\";\r\n                $scope.cash = false;\r\n                $scope.debito = false;\r\n                angular.element(document).ready(function () {\r\n                    var d = new Date();\r\n                    $scope.years = [];\r\n                    $scope.months = [];\r\n                    var year = d.getFullYear()\r\n                    for (i = 0; i < 12; i++) {\r\n                        if (i < 9) {\r\n                            $scope.months.push(\"0\" + (i + 1));\r\n                        } else {\r\n                            $scope.months.push(i + 1);\r\n                        }\r\n\r\n                    }\r\n                    for (i = 0; i < 13; i++) {\r\n                        $scope.years.push(year + i);\r\n                    }\r\n                });\r\n                $scope.scrollTo = function (id) {\r\n                    setTimeout(function () {\r\n                        var old = $location.hash();\r\n                        $location.hash(id);\r\n                        $anchorScroll();\r\n                        $location.hash(old);\r\n                    }, 500);\r\n                }\r\n                $rootScope.$on('activatePayment', function (event, args) {\r\n                    $rootScope.paymentActive = true;\r\n                    $scope.scrollTo(\"checkout-payment\");\r\n                    // call $anchorScroll()\r\n                });\r\n                $rootScope.$on('transactionResponse', function (event, args) {\r\n                    console.log(\"updateLoadedCart\", args);\r\n                    $scope.transactionResponse(args);\r\n                });\r\n                $scope.keytab = function (event, maxlength) {\r\n                    console.log(\"Event\", event)\r\n                    var target = event.target || event.srcElement;\r\n                    var nextInput = target.nextElementSibling; // get the sibling element\r\n                    console.log('nextInput', nextInput);\r\n\r\n                    console.log('target', target);\r\n                    console.log('targetvalue', target.value);\r\n                    console.log('targettype', target.nodeType);\r\n                    if (target.value.length < maxlength) {\r\n                        return;\r\n                    }\r\n                    if (nextInput == null)  // check the maxLength from here\r\n                        return;\r\n                    else\r\n                        nextInput.focus();   // focus if not null\r\n                }\r\n                $scope.creditTab = function (event) {\r\n                    var target = event.target || event.srcElement;\r\n                    var value = target.value;\r\n                    var branch = (/^(?:5[1-5][0-9]{2}|222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}$/.test(value)) ? \"MASTERCARD\"\r\n                            : (/^(4[0-9]{12}(?:[0-9]{3})?$)|(^606374[0-9]{10}$)/.test(value)) ? \"VISA\"\r\n                            : (/^3[47][0-9]{13}$/.test(value)) ? 'AMEX'\r\n                            : (/^[35](?:0[0-5]|[68][0-9])[0-9]{11}$|^30[0-5]{11}$|^3095[0-9]{10}$|^36[0-9]{12}$|^3[89][0-9]{12}$/.test(value)) ? 'DINERS'\r\n                            : (/^6(?:011|5[0-9]{2}|4[4-9][0-9])[0-9]{12}$/.test(value)) ? 'DISCOVER'\r\n                            : (/^589562[0-9]{10}$/.test(value)) ? 'NARANJA'\r\n                            : (/^603488[0-9]{10}$|^2799[0-9]{9}$/.test(value)) ? 'SHOPPING'\r\n                            : (/^604(([23][0-9]{2})|(400))[0-9]{10}$|^589657[0-9]{10}$/.test(value)) ? 'CABAL'\r\n                            : (/^603493[0-9]{10}$/.test(value)) ? 'ARGENCARD'\r\n                            : (/^590712[0-9]{10}$/.test(value)) ? 'CODENSA'\r\n                            : (/^627180[0-9]{10}$/.test(value)) ? 'CMR'\r\n                            : \"\";\r\n\r\n                    console.log(\"Credit branch\", branch);\r\n                    $scope.data2.cc_branch = branch;\r\n                }\r\n                $scope.transactionResponse = function (data) {\r\n                    Modals.hideLoader();\r\n                    console.log(\"Response payu\", data)\r\n                    Cart.clearCart();\r\n                    $scope.scrollTo(\"checkout-payment\");\r\n                    if (data.message != \"error\") {\r\n                        $scope.showResult = true;\r\n                        if (data.transaction) {\r\n                            $scope.transaction = data.transaction;\r\n                            if (data.transaction.transaction_state == \"APPROVED\") {\r\n                                $scope.resultHeader = \"Pago aprobado\";\r\n                                $scope.resultBody = \"Tu pago ha sido completado, revisa tu correo para recibir tu compra\";\r\n                            } else if (data.transaction.transaction_state == \"PENDING\") {\r\n                                $scope.resultHeader = \"Pago pendiente\";\r\n                                $scope.resultBody = \"Tu transaccion esta siendo verificada, cuando complete la verificacion recibiras un correo con el resultado\";\r\n                            } else {\r\n                                $scope.resultHeader = \"Pago negado\";\r\n                                $scope.resultBody = \"Tu transaccion ha sido negada. Porfavor intenta otro metodo u otra tarjeta. En Mi cuenta > Mis Pagos puedes reintentar el pago\";\r\n                            }\r\n                        } else {\r\n                            if(data.payment && data.payment.status && data.payment.status==\"payment_in_bank\"){\r\n                                $scope.resultHeader = \"Pago Pendiente\";\r\n                                $scope.resultBody = \"!Gracias por tu compra! Para activar tu plan por favor realiza la consignación o la transferencia a la cuenta Davivienda No 005000343144 a nombre de Hoovert Arredondo SAS NIT 901.0219.085. Al finalizar el proceso de pago no olvides enviar el soporte al correo servicioalcliente@lonchis.com.co o a whatsapp al 310 3418432.\";\r\n                                $scope.transaction.description = \"Tu pago es el # \"+data.payment.id;\r\n                                $scope.transaction.transaction_state = \"Esperando consignación\";\r\n                                $scope.transaction.reference_sale = \"Orden # \"+$rootScope.activeOrder.id;\r\n                            }\r\n                        }\r\n\r\n                    } else {\r\n                        Modals.showToast(\"Hubo un error. Porfavor verifica tus datos\", $(\"#checkout-payment\"));\r\n                    }\r\n                }\r\n                $scope.payCreditCard = function (isvalid) {\r\n                    $scope.data2.buyer_address = $scope.data2.payer_address;\r\n                    $scope.data2.buyer_postal = $scope.data2.payer_postal;\r\n                    $scope.data2.buyer_city = $scope.data2.payer_city;\r\n                    $scope.data2.buyer_state = $scope.data2.payer_state;\r\n                    $scope.data2.buyer_country = $scope.data2.payer_country;\r\n                    $scope.data2.buyer_phone = $scope.data2.payer_phone;\r\n                    $scope.submitted2 = true;\r\n                    if (isvalid) {\r\n                        $scope.data2.platform = $rootScope.platform;\r\n                        $scope.data2.email = true;\r\n                        $scope.data2.payment_id = $rootScope.activePayment.id;\r\n                        Modals.showLoader();\r\n                        Billing.payCreditCard($scope.data2, \"PayU\").then(function (data) {\r\n                            $scope.transactionResponse(data);\r\n                            //$scope.data2 = {};\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    }\r\n                }\r\n                $scope.payInBank = function () {\r\n                    $scope.data4.platform = $rootScope.platform;\r\n                    $scope.data4.email = true;\r\n                    $scope.data4.payment_id = $rootScope.activePayment.id;\r\n                    Modals.showLoader();\r\n                    Billing.payInBank($scope.data4, \"PayU\").then(function (data) {\r\n                        $scope.transactionResponse(data);\r\n                        //$scope.data2 = {};\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.quickPay = function () {\r\n                    var container = {\r\n                        quick: true,\r\n                        payment_id: $rootScope.activePayment.id,\r\n                        platform: $rootScope.platform\r\n                    };\r\n                    Modals.showLoader();\r\n                    Billing.payCreditCard(container, \"PayU\").then(function (data) {\r\n                        $scope.transactionResponse(data);\r\n                        //$scope.data2 = {};\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectOption = function (option) {\r\n                    $scope.data4.payment_method = option;\r\n                    $scope.scrollTo(\"cash-form\")\r\n                }\r\n                $scope.populatePayer = function () {\r\n                    if ($scope.data2.payer_name) {\r\n                        if ($scope.data2.payer_name.length == 0) {\r\n                            $scope.data2.payer_name = $scope.data2.cc_name;\r\n                        }\r\n                    } else {\r\n                        $scope.data2.payer_name = $scope.data2.cc_name;\r\n                    }\r\n                }\r\n                $scope.payDebitCard = function (isvalid) {\r\n                    $scope.submitted3 = true;\r\n                    if (isvalid) {\r\n                        $scope.data3.platform = $rootScope.platform;\r\n                        $scope.data3.email = true;\r\n                        $scope.data3.payment_id = $rootScope.activePayment.id;\r\n                        Modals.showLoader();\r\n                        Billing.payDebit($scope.data3, \"PayU\").then(function (data) {\r\n                            if (data.code == \"SUCCESS\") {\r\n                                if (data.transactionResponse.state == \"PENDING\") {\r\n                                    //this.showPrompt();\r\n                                    Cart.clearCart().then(function (resp) {\r\n                                        window.location.href = data.transactionResponse.extraParameters.BANK_URL;\r\n                                    },\r\n                                            function (data) {\r\n                                                Modals.hideLoader();\r\n                                            });\r\n                                } else {\r\n                                    Modals.hideLoader();\r\n                                    Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                                }\r\n                            } else {\r\n                                Modals.hideLoader();\r\n                                Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                    Modals.hideLoader();\r\n                                });\r\n                    }\r\n                }\r\n                $scope.payCash = function (isvalid) {\r\n                    $scope.submitted4 = true;\r\n                    if (isvalid) {\r\n                        Modals.showLoader();\r\n                        $scope.data4.platform = $rootScope.platform;\r\n                        $scope.data4.email = true;\r\n                        $scope.data4.payment_id = $rootScope.activePayment.id;\r\n                        Billing.payCash($scope.data4, \"PayU\").then(function (data) {\r\n                            Modals.hideLoader();\r\n                            console.log(\"after payCash\");\r\n                            console.log(JSON.stringify(data));\r\n                            if (data.code == \"SUCCESS\") {\r\n                                Cart.clearCart().then(function (resp) {\r\n                                    if (data.transactionResponse.extraParameters.URL_PAYMENT_RECEIPT_HTML) {\r\n                                        window.location.href = data.transactionResponse.extraParameters.URL_PAYMENT_RECEIPT_HTML;\r\n                                    } else {\r\n                                        Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                                    }\r\n                                },\r\n                                        function (data) {\r\n                                        });\r\n                            } else {\r\n                                Modals.showToast(\"Hubo un problema. Porfavor intenta otro medio. \", $(\"#checkout-payment\"));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                }\r\n\r\n                $scope.clean = function () {\r\n                    $scope.data = {};\r\n                    $scope.regionVisible = false;\r\n                    $scope.cityVisible = false;\r\n                }\r\n                $scope.clean2 = function () {\r\n                    $scope.data2 = {};\r\n                }\r\n                $scope.fill = function () {\r\n                    $scope.data2.cc_branch = \"VISA\";\r\n                    $scope.data2.cc_name = \"APPROVED\";\r\n                    $scope.data2.cc_number = \"4111111111111111\";\r\n                    $scope.data2.cc_security_code = \"123\";\r\n                    $scope.data2.cc_expiration_month = \"09\";\r\n                    $scope.data2.cc_expiration_year = \"2017\";\r\n                    $scope.data2.payer_email = \"harredon01@gmail.com\";\r\n                    $scope.data2.payer_id = \"321321321\";\r\n\r\n                }\r\n                $scope.fill2 = function () {\r\n                    $scope.data3.user_type = \"N\";\r\n                    $scope.data3.pse_reference2 = \"CC\";\r\n                    $scope.data3.pse_reference3 = \"1020716535\";\r\n                    $scope.data3.payer_email = \"harredon01@gmail.com\";\r\n\r\n                }\r\n                $scope.fill3 = function () {\r\n                    $scope.data4.payer_email = \"harredon01@gmail.com\";\r\n\r\n                }\r\n                $scope.selectCountry = function (country_id) {\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectRegion = function (region_id) {\r\n                    LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                        $scope.cities = data.data;\r\n                        $scope.cityVisible = true;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.selectPlace = function (country_id, region_id, city_id) {\r\n                    $scope.data.country_id = country_id;\r\n                    LocationService.getRegionsCountry(country_id).then(function (data) {\r\n                        $scope.regions = data.data;\r\n                        $scope.regionVisible = true;\r\n                        $scope.cityVisible = false;\r\n                        $scope.data.region_id = region_id;\r\n                        LocationService.getCitiesRegion(region_id).then(function (data) {\r\n                            $scope.cities = data.data;\r\n                            $scope.cityVisible = true;\r\n                            $scope.data.city_id = city_id;\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n                $scope.showAddressForm = function () {\r\n                    $scope.addAddress = true;\r\n                    $scope.data.type = \"billing\";\r\n                }\r\n                $scope.hideAddressForm = function () {\r\n                    $scope.addAddress = false;\r\n                }\r\n                $scope.useUserDebit = function () {\r\n                    $scope.data3.user_type = \"N\";\r\n                    $scope.data3.doc_type = \"N\";\r\n                    $scope.data3.payer_name = $rootScope.user.name;\r\n                    $scope.data3.payer_id = $rootScope.user.docNum;\r\n                    $scope.data3.payer_phone = $rootScope.user.cellphone;\r\n                    $scope.data3.payer_email = $rootScope.user.email;\r\n                }\r\n                $scope.useUserCredit = function () {\r\n                    $scope.data2.cc_name = $rootScope.user.name;\r\n                    $scope.data2.payer_name = $rootScope.user.name;\r\n                    $scope.data2.payer_id = $rootScope.user.docNum;\r\n                    $scope.data2.payer_phone = $rootScope.user.cellphone;\r\n                    $scope.data2.payer_email = $rootScope.user.email;\r\n                    $scope.addAddress = false;\r\n                }\r\n                $scope.useUserCash = function () {\r\n                    $scope.data4.payer_email = $rootScope.user.email;\r\n                    $scope.data4.payer_id = $rootScope.user.docNum;\r\n                }\r\n                $scope.fetchAddressForUse = function (typeFetch, typeUse) {\r\n                    if (typeFetch == 'shipping') {\r\n                        if($rootScope.activeOrder.order_addresses){\r\n                            $scope.setAddressInfields(typeUse, $rootScope.activeOrder.order_addresses[0]);\r\n                        } else {\r\n                            $scope.setAddressInfields(typeUse, $rootScope.shippingAddress);\r\n                        }\r\n                        \r\n                    } else if (typeFetch == 'other') {\r\n                        $mdDialog.show(Modals.getAddressesPopup()).then(function (address) {\r\n                            console.log(\"Got address\", address);\r\n                            $scope.setAddressInfields(typeUse, address);\r\n                        }, function () {\r\n                            console.log(\"Got nothing\");\r\n                        });\r\n                    }\r\n                }\r\n                $scope.setAddressInfields = function (type, address) {\r\n                    if (!address.phone) {\r\n                        address.phone = $rootScope.user.cellphone;\r\n                    }\r\n                    if (type == \"payer\") {\r\n                        $scope.data2.payer_address = address.address;\r\n                        $scope.data2.payer_postal = address.postal;\r\n                        $scope.data2.payer_city = address.cityName;\r\n                        $scope.data2.payer_state = address.regionName;\r\n                        $scope.data2.payer_country = address.countryCode;\r\n                        $scope.data2.payer_phone = address.phone;\r\n                    } else if (type == \"buyer\") {\r\n                        $scope.data2.buyer_address = address.address;\r\n                        $scope.data2.buyer_postal = address.postal;\r\n                        $scope.data2.buyer_city = address.cityName;\r\n                        $scope.data2.buyer_state = address.regionName;\r\n                        $scope.data2.buyer_country = address.countryCode;\r\n                        $scope.data2.buyer_phone = address.phone;\r\n                    }\r\n                }\r\n\r\n                $scope.showMethod = function (method) {\r\n                    $scope.credito = false;\r\n                    $scope.cash = false;\r\n                    $scope.debito = false;\r\n                    $scope.bank = false;\r\n                    if (method == \"PSE\") {\r\n                        $rootScope.$broadcast('addTransactionCost');\r\n                        $scope.debito = true;\r\n                        Billing.getBanks().then(function (data) {\r\n                            $scope.banks = data.banks;\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    }\r\n                    if (method == \"CC\") {\r\n                        $scope.data2.buyer_country = \"CO\";\r\n                        $scope.data2.payer_country = \"CO\";\r\n                        $rootScope.$broadcast('addTransactionCost');\r\n                        if ($rootScope.addresses && $rootScope.addresses.length > 0) {\r\n                        } else {\r\n                            $rootScope.$broadcast('getAddresses');\r\n                        }\r\n                        $scope.credito = true;\r\n                    }\r\n                    if (method == \"BALOTO\") {\r\n                        $scope.cash = true;\r\n                        $rootScope.$broadcast('addTransactionCost');\r\n                    }\r\n                    if (method == \"BANK\") {\r\n                        $scope.bank = true;\r\n                        $rootScope.$broadcast('removeTransactionCost');\r\n                    }\r\n                }\r\n            }])\r\n\r\n        .controller('CheckoutBookCtrl', ['$scope', '$rootScope', 'Cart', function ($scope, $rootScope, Cart) {\r\n                $scope.appointments = [];\r\n                $scope.visibleBooking = false;\r\n                $scope.loadPendingItems = function () {\r\n                    console.log(\"loadPendingItems\", $rootScope.items)\r\n                    var pending = false;\r\n                    for (var item in $rootScope.items) {\r\n                        var container = $rootScope.items[item];\r\n                        console.log(\"item\", container);\r\n                        if (container.attributes.type == \"Booking\") {\r\n                            if (!container.attributes.id) {\r\n                                container.pending = true;\r\n                                pending = true;\r\n                            } else {\r\n                                container.pending = false;\r\n                            }\r\n                            $scope.appointments.push(container);\r\n\r\n                            $scope.visibleBooking = true;\r\n                        }\r\n                    }\r\n                    if (pending) {\r\n                        $rootScope.bookingSet = false;\r\n                    } else {\r\n                        $rootScope.bookingSet = true;\r\n                    }\r\n                }\r\n                $scope.programItem = function (item) {\r\n                    var params = {\r\n                        \"availabilities\": null,\r\n                        \"type\": \"Merchant\",\r\n                        \"objectId\": item.attributes.merchant_id,\r\n                        \"objectName\": item.name,\r\n                        \"objectDescription\": item.null,\r\n                        \"objectIcon\": null,\r\n                        \"expectedPrice\": item.price,\r\n                        \"questions\": item.attributes.questions,\r\n                        \"item_id\": item.id,\r\n                        \"quantity\": item.quantity,\r\n                        \"purpose\": \"external_book\",\r\n                        \"alert\": \"#checkout-booking\"\r\n                    }\r\n                    if (item.attributes.location) {\r\n                        params.location = item.attributes.location;\r\n                    }\r\n                    if (item.attributes.duration) {\r\n                        params.duration = item.attributes.duration;\r\n                    }\r\n                    console.log(\"Sending paramsparamsparams\", params);\r\n                    Cart.showBooking(params).then(function (result) {\r\n                        console.log(\"Got result\", result);\r\n                        if (result && result == \"Carrito actualizado\") {\r\n                            item.pending = false;\r\n                            var missing = false;\r\n                            for (var i = 0; i < $scope.appointments.length; i++) {\r\n                                if ($scope.appointments[i].pending) {\r\n                                    missing = true;\r\n                                }\r\n                            }\r\n                            if (!missing) {\r\n                                $rootScope.bookingSet = true;\r\n                                $rootScope.$broadcast('buildOrder');\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                $rootScope.$on('Shippable', function (event, args) {\r\n                    console.log(\"Booking shippable\");\r\n                    $scope.loadPendingItems()\r\n                });\r\n                $rootScope.$on('NotShippable', function (event, args) {\r\n                    $scope.loadPendingItems();\r\n                    $rootScope.$broadcast('buildOrder');\r\n                });\r\n            }]).controller('CheckoutGatewaysCtrl', function () {\r\n\r\n})\r\n        //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9jaGVja291dGN0cmwuanM/YTYwNiJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcclxuXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NoZWNrb3V0Q2FydEN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NhcnQnLCAnT3JkZXJzJywgJ01vZGFscycsICckcScsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIENhcnQsIE9yZGVycywgTW9kYWxzLCAkcSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3Vwb24gPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjY2VwdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjY2VwdEVycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291cG9uVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbmRpdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNEaWdpdGFsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmJvb2tpbmdTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhhc1RyYW5zYWN0aW9uQ29zdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRyYW5zYWN0aW9uQ29zdCA9IDA7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudG90YWxUcmFuc2FjdGlvbiA9IDA7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuSnNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goYW5ndWxhci5lbGVtZW50KFwiLml0ZW0tYXR0cmlidXRlc1wiKSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBhbmd1bGFyLmVsZW1lbnQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShhLmh0bWwoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh4IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSB4ICsgXCI6IFwiICsgb2JqW3hdICsgXCIgPGJyLz5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmh0bWwoaHRtbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCA9IGZ1bmN0aW9uIChpbml0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5nZXRDaGVja291dENhcnQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnZXJyb3InKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRDYXJ0KGRhdGEsIGluaXQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5BY2NlcHRUZXJtcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFjY2VwdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWNjZXB0RXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0T3JkZXIgPSBmdW5jdGlvbiAoaW5pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIE9yZGVycy5nZXRPcmRlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc0RpZ2l0YWwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShcIkRvbmVcIilcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlQ2FydEl0ZW0gPSBmdW5jdGlvbiAoaXRlbV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWFudGl0eSA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPWNoZWNrLXF1YW50aXR5LScgKyBpdGVtX2lkICsgJ10nKSkudmFsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBpdGVtX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImV4dHJhc1wiOiBbXVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC51cGRhdGVDYXJ0SXRlbShjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdlcnJvcicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJDYXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIENhcnQuY2xlYXJDYXJ0KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q2FydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZENhcnQgPSBmdW5jdGlvbiAoZGF0YSwgaW5pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLml0ZW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW1zID0gZGF0YS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNoaXBwYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIGl0ZW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IGl0ZW1zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJdGVtOiBcIiwgaXRlbS5hdHRyaWJ1dGVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmF0dHJpYnV0ZXMuaXNfc2hpcHBhYmxlIHx8IChpdGVtLmF0dHJpYnV0ZXMuc2hpcHBpbmcgJiYgaXRlbS5hdHRyaWJ1dGVzLnNoaXBwaW5nID4gMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGlwcGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb25kaXRpb25zID0gZGF0YS5jb25kaXRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLml0ZW1zID0gZGF0YS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsSXRlbXMgPSBkYXRhLnRvdGFsSXRlbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJ0b3RhbCA9IGRhdGEuc3VidG90YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaGlwcGluZyA9IGRhdGEuc2hpcHBpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50YXggPSBkYXRhLnRheDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNhbGUgPSBkYXRhLnNhbGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3Vwb24gPSBkYXRhLmNvdXBvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRpc2NvdW50ID0gZGF0YS5zYWxlICsgZGF0YS5jb3Vwb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGRhdGEudG90YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQnJvYWRjYXN0aW5nIHNoaXBwYWJsZTogXCIsIHNoaXBwYWJsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbml0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcHBhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdTaGlwcGFibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRPcmRlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdOb3RTaGlwcGFibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJlcGFyZU9yZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWNjZXB0XCIsICRzY29wZS5hY2NlcHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWNjZXB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgncHJlcGFyZU9yZGVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjY2VwdEVycm9yID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUNhcnRJdGVtID0gZnVuY3Rpb24gKGl0ZW1faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogaXRlbV9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogW11cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIENhcnQudXBkYXRlQ2FydEl0ZW0oY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnZXJyb3InKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2V0Q291cG9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vc2V0VGltZW91dChmdW5jdGlvbigpeyBNb2RhbHMuaGlkZUxvYWRlcigpOyB9LCAyMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNvdXBvbiAmJiAkc2NvcGUuY291cG9uLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgT3JkZXJzLnNldENvdXBvbigkc2NvcGUuY291cG9uKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY291cG9uID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdCgnQ3Vwb24gYWdyZWdhZG8gZXhpdG9zYW1lbnRlJywgJChcIiNmaW5hbC1zdWJtaXRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoJ05vIHB1ZWRlcyB1c2FyIGVzZSBjdXBvbicsICQoXCIjZmluYWwtc3VibWl0XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdCgnSW5ncmVzYSB1biBjdXBvbicsICQoXCIjZmluYWwtc3VibWl0XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigndXBkYXRlQ2hlY2tvdXRDYXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENhcnQoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2FkZFRyYW5zYWN0aW9uQ29zdCcsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkaW5nIHRyYW5zYWN0aW9uIGNvc3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhhc1RyYW5zYWN0aW9uQ29zdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRyYW5zYWN0aW9uQ29zdCA9ICRyb290U2NvcGUuYWN0aXZlT3JkZXIudG90YWwqKDAuMDUpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbFRyYW5zYWN0aW9uID0gJHJvb3RTY29wZS5hY3RpdmVPcmRlci50b3RhbCskc2NvcGUudHJhbnNhY3Rpb25Db3N0O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigncmVtb3ZlVHJhbnNhY3Rpb25Db3N0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhhc1RyYW5zYWN0aW9uQ29zdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvbkNvc3QgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbFRyYW5zYWN0aW9uID0gMDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ3VwZGF0ZUxvYWRlZENhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZUxvYWRlZENhcnRcIiwgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRDYXJ0KGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja291dFNoaXBwaW5nQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnTG9jYXRpb25TZXJ2aWNlJywgJ1VzZXJzJywgJyRxJyxcclxuICAgICAgICAgICAgJ0NhcnQnLCAnJGNvb2tpZXMnLCAnT3JkZXJzJywgJ01vZGFscycsICdCaWxsaW5nJywgJyRsb2NhdGlvbicsICckYW5jaG9yU2Nyb2xsJywgJyRtZERpYWxvZycsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIExvY2F0aW9uU2VydmljZSwgVXNlcnMsICRxLCBDYXJ0LCAkY29va2llcywgT3JkZXJzLCBNb2RhbHMsIEJpbGxpbmcsICRsb2NhdGlvbiwgJGFuY2hvclNjcm9sbCwgJG1kRGlhbG9nKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NTZXQgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zaGlwcGluZyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXNGZXRjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3NTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0NvbmRpdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQ29uZGl0aW9uU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmJpbGxpbmdBZGRyZXNzU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBheW1lbnRNZXRob2RTZXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignU2hpcHBhYmxlJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3NTZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQ29uZGl0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5iaWxsaW5nQWRkcmVzc1NldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucGF5bWVudE1ldGhvZFNldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RyQWRkcmVzcyA9ICRjb29raWVzLmdldChcInNoaXBwaW5nQWRkcmVzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYWRkcmVzcyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ckFkZHJlc3MgJiYgc3RyQWRkcmVzcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgPSBKU09OLnBhcnNlKHN0ckFkZHJlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNoaXBwaW5nIGFkZHJlc3M6IFwiLCBhZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIiRyb290U2NvcGUudXNlcjogXCIsICRyb290U2NvcGUudXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHJlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZGRyZXNzLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0gYWRkcmVzcztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEubmFtZSA9ICRyb290U2NvcGUudXNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnBob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RQbGFjZSgkc2NvcGUuZGF0YS5jb3VudHJ5X2lkLCAkc2NvcGUuZGF0YS5yZWdpb25faWQsICRzY29wZS5kYXRhLmNpdHlfaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRyZXNzLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0QWRkcmVzcyhhZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5hZGRyZXNzZXMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubmV3QWRkcmVzcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyaWVzID0gW3tuYW1lOiBcIkNvbG9tYmlhXCIsIGlkOiAxfSwge25hbWU6IFwiQ29sb21iaWEyXCIsIGlkOiAyfV1cclxuXHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5uZXdBZGRyZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJzaGlwcGluZ0FkZHJlc3NcIiwgXCJcIiwge3BhdGg6IFwiL1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgdXJsLCB7cGF0aDogXCIvXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2xvY2F0aW9uXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q292ZXJhZ2VQcm9tcHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldENvdmVyYWdlUHJvbXB0KCkpLnRoZW4oZnVuY3Rpb24gKGFuc3dlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5zd2VyID09IFwibmV3XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5uZXdBZGRyZXNzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5zd2VyID09ICdjbGVhcicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuY2xlYXJDYXJ0KCkudGhlbihmdW5jdGlvbiAoYW5zd2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ3ByZXBhcmVPcmRlcicsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcmVwYXJlT3JkZXIoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2J1aWxkT3JkZXInLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRPcmRlcigkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ05vdFNoaXBwYWJsZScsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdnZXRBZGRyZXNzZXMnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jbGVhbkpzb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGFuZ3VsYXIuZWxlbWVudChcIi5pdGVtLWF0dHJpYnV0ZXNcIiksIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gYW5ndWxhci5lbGVtZW50KHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2UoYS5odG1sKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeCBpbiBvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0geCArIFwiOiBcIiArIG9ialt4XSArIFwiIDxici8+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5odG1sKGh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnNhdmVBZGRyZXNzKCRzY29wZS5kYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdEFkZHJlc3MoZGF0YS5hZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZUFkZHJlc3NGb3JtKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEFkZHJlc3NlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBVc2Vycy5nZXRBZGRyZXNzZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWRkcmVzc2VzID0gZGF0YS5hZGRyZXNzZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKFwiZG9uZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShcImVycm9yXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RDb3VudHJ5ID0gZnVuY3Rpb24gKGNvdW50cnlfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0UmVnaW9uc0NvdW50cnkoY291bnRyeV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UmVnaW9uID0gZnVuY3Rpb24gKHJlZ2lvbl9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRDaXRpZXNSZWdpb24ocmVnaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXRpZXMgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFBsYWNlID0gZnVuY3Rpb24gKGNvdW50cnlfaWQsIHJlZ2lvbl9pZCwgY2l0eV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuY291bnRyeV9pZCA9IGNvdW50cnlfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldFJlZ2lvbnNDb3VudHJ5KGNvdW50cnlfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvbnMgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyByZWdpb25cIiwgJHNjb3BlLmRhdGEucmVnaW9uX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVnaW9uX2lkID0gcmVnaW9uX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKHJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNldHRpbmcgY2l0eV9pZFwiLCAkc2NvcGUuZGF0YS5jaXR5X2lkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBjaXRpZXNcIiwgJHNjb3BlLmNpdGllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jaXR5X2lkID0gY2l0eV9pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy99KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0QWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NTZXQgPSBhZGRyZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0ge2FkZHJlc3NfaWQ6IGFkZHJlc3MuaWR9O1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgT3JkZXJzLnNldFNoaXBwaW5nQWRkcmVzcyhkYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0IHNoaXBwaW5nIGFkZHJlc3NcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3NTZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MgPSBhZGRyZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwic2hpcHBpbmdBZGRyZXNzXCIsIEpTT04uc3RyaW5naWZ5KCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSwge3BhdGg6IFwiL1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3JkZXIgPSBkYXRhLm9yZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKG9yZGVyLmF0dHJpYnV0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyID0gb3JkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHJvdmlkZXJzID0gYXR0cmlidXRlcy5wcm92aWRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIHByb3ZpZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUHJvdmlkZXJzOiBcIiwgcHJvdmlkZXJzW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBkaXNjb3VudHNcIiwgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3NTZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkT3JkZXIob3JkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJGdWVyYSBkZSBjb2JlcnR1cmEgcGFyYSBlc3RhIG9yZGVuXCIsICQoXCIjY2hlY2tvdXQtc2hpcHBpbmdcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2Nyb2xsVG8gPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9sZCA9ICRsb2NhdGlvbi5oYXNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5oYXNoKGlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGFuY2hvclNjcm9sbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24uaGFzaChvbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRPcmRlciA9IGZ1bmN0aW9uIChvcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIE9yZGVycy5zZXREaXNjb3VudHMob3JkZXIuaWQsICRyb290U2NvcGUucGxhdGZvcm0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEaXNjb3VudHMgc2V0XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YVMgPSB7XCJwYXllcnNcIjogWyRyb290U2NvcGUudXNlci5pZF0sIFwicGxhdGZvcm1cIjogJHJvb3RTY29wZS5wbGF0Zm9ybX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9yZGVycy5jaGVja09yZGVyKG9yZGVyLmlkLCBkYXRhUykudGhlbihmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVjayBPcmRlciBSZXN1bHRcIiwgcmVzcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9yZGVyID0gcmVzcC5vcmRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBsYXRmb3JtID09IFwiRm9vZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdDb25kaXRpb25TZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmlzRGlnaXRhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUucHJlcGFyZU9yZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiRGlyZWNjaW9uIGd1YXJkYWRhXCIsICQoXCIjY2hlY2tvdXQtc2hpcHBpbmdcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVDaGVja291dENhcnQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY3JvbGxUbyhcImNoZWNrb3V0LXNoaXBwaW5nLW1ldGhvZHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZpbmlzaGVkIHNjcm9sbGluZzIyMjJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhhbmRsZUNoZWNrRXJyb3IocmVzcCwgb3JkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRDYXJ0SXRlbSA9IGZ1bmN0aW9uIChwcm9kdWN0X3ZhcmlhbnQsIGV4dHJhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfdmFyaWFudC5leHRyYXMgPSBleHRyYXNcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnBvc3RUb1NlcnZlcihwcm9kdWN0X3ZhcmlhbnQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwiZXJyb3JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlQ2hlY2tvdXRDYXJ0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRPcmRlcigkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNldFNoaXBwaW5nQ29uZGl0aW9uID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0IFNoaXBwaW5nXCIsIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XCJwcm92aWRlclwiOiBpdGVtLmNsYXNzLCBcInByb3ZpZGVyX2lkXCI6IGl0ZW0uaWR9O1xyXG4gICAgICAgICAgICAgICAgICAgIE9yZGVycy5zZXRQbGF0Zm9ybVNoaXBwaW5nQ29uZGl0aW9uKCRyb290U2NvcGUuYWN0aXZlT3JkZXIuaWQsIGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNldFBsYXRmb3JtU2hpcHBpbmdQcmljZSBSZXN1bHRcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVMb2FkZWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT3JkZXIgPSBkYXRhLm9yZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAkc2NvcGUuc2hpcHBpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hpcHBpbmdbaV0uc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdDb25kaXRpb25TZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wcmljZSA9IGRhdGEuY2FydC5zaGlwcGluZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtY2FydFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJFbnZpbyBhZ3JlZ2FkbyBleGl0b3NhbWVudGVcIiwgJChcIiNjaGVja291dC1zaGlwcGluZ1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciBjb24gZXNlIG1ldG9kbyBkZSBlbnZpb1wiLCAkKFwiI2NoZWNrb3V0LXNoaXBwaW5nXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yIGNvbiBlc2UgbWV0b2RvIGRlIGVudmlvXCIsICQoXCIjY2hlY2tvdXQtc2hpcHBpbmdcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGFuZGxlQ2hlY2tFcnJvciA9IGZ1bmN0aW9uIChyZXNwLCBvcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnR5cGUgPT0gXCJjcmVkaXRzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1pc3NpbmcgPSBwYXJzZUludChyZXNwLnJlcXVpcmVkX2NyZWRpdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlcXVpcmVkIGNyZWRpdHNcIiwgbWlzc2luZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlZGl0SXRlbVwiLCByZXNwLmNyZWRpdEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSGVtb3MgYWdyZWdhZG8gdW4gaXRlbSBvYmxpZ2F0b3Jpb1wiLCAkKFwiI2NoZWNrb3V0LXNoaXBwaW5nXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjcmVkaXRJdGVtTWVyY2hhbnRcIiwgcmVzcC5jcmVkaXRJdGVtTWVyY2hhbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJfaWQ6IG9yZGVyLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF92YXJpYW50X2lkOiByZXNwLmNyZWRpdEl0ZW0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogbWlzc2luZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogcmVzcC5jcmVkaXRJdGVtTWVyY2hhbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZENhcnRJdGVtKGNvbnRhaW5lciwgW10pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcC50eXBlID09IFwiYnV5ZXJzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3AudHlwZSA9PSBcInNoaXBwaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmFwaS50b2FzdCgnQ0hFQ0tPVVRfUFJFUEFSRS5SRVFVSVJFU19TSElQUElORycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2Nyb2xsVG8oXCJjaGVja291dC1zaGlwcGluZy1tZXRob2RzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiRGViZXMgc2VsZWNjaW9uYXIgcHJvdmVlZG9yIGRlIGVudmlvXCIsICQoXCIjY2hlY2tvdXQtc2hpcHBpbmctbWV0aG9kc1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2hpcHBpbmcubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5leHBlY3RlZFByb3ZpZGVycyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXR0cmlidXRlcyA9IEpTT04ucGFyc2Uob3JkZXIuYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5wcm92aWRlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIGF0dHJpYnV0ZXMucHJvdmlkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5leHBlY3RlZFByb3ZpZGVycysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0UGxhdGZvcm1TaGlwcGluZ1ByaWNlKHJlc3Aub3JkZXIuaWQsIGF0dHJpYnV0ZXMucHJvdmlkZXJzW2l0ZW1dKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3AudHlwZSA9PSBcImRlbGl2ZXJ5XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLyp0aGlzLmFwaS50b2FzdCgnQ0hFQ0tPVVRfUFJFUEFSRS5SRVFVSVJFU19ERUxJVkVSWScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcGkuZGlzbWlzc0xvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEl0ZW1zLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENhcnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGUuc2V0RGF0ZShlbmREYXRlLmdldERhdGUoKSArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmRlbGl2ZXJ5ID0gZW5kRGF0ZS50b0lTT1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkZWxpdmVyeVwiLCB0aGlzLmRlbGl2ZXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVxdWlyZXNEZWxpdmVyeSA9IHRydWU7Ki9cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0UGxhdGZvcm1TaGlwcGluZ1ByaWNlID0gZnVuY3Rpb24gKG9yZGVyX2lkLCBwbGF0Zm9ybSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IHBsYXRmb3JtLmRlc2M7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHBsYXRmb3JtLmRlc2M7XHJcbiAgICAgICAgICAgICAgICAgICAgT3JkZXJzLmdldFBsYXRmb3JtU2hpcHBpbmdQcmljZShvcmRlcl9pZCwgcGxhdGZvcm0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXRQbGF0Zm9ybVNoaXBwaW5nUHJpY2UgUmVzdWx0XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhwZWN0ZWRQcm92aWRlcnMtLTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmFtZSA9IHBsYXRmb3JtLnByb3ZpZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsYXRmb3JtLnByb3ZpZGVyID09IFwiTWVyY2hhbnRTaGlwcGluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IFwiRG9taWNpbGlvIGRlbCBFc3RhYmxlY2ltaWVudG9cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtwbGF0Zm9ybTogbmFtZSwgY2xhc3M6IHBsYXRmb3JtLnByb3ZpZGVyLCBwcmljZTogZGF0YS5wcmljZSwgZGVzYzogZGVzY3JpcHRpb24sIGlkOiBwbGF0Zm9ybS5wcm92aWRlcl9pZCwgc2VsZWN0ZWQ6IGZhbHNlfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhZGQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAkc2NvcGUuc2hpcHBpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udCA9ICRzY29wZS5zaGlwcGluZ1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udC5wbGF0Zm9ybSA9PSBjb250YWluZXIucGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnQucHJpY2UgPD0gY29udGFpbmVyLnByaWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdCBhZGRpbmdcIiwgY29udGFpbmVyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92aW5nXCIsIGNvbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hpcHBpbmcuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaGlwcGluZy5wdXNoKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmV4cGVjdGVkUHJvdmlkZXJzID09IDAgJiYgISRyb290U2NvcGUuc2hpcHBpbmdDb25kaXRpb25TZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2hpcHBpbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRTaGlwcGluZ0NvbmRpdGlvbigkc2NvcGUuc2hpcHBpbmdbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQXV0byBzZWxlY3RcIiwgJHNjb3BlLnNoaXBwaW5nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0Q292ZXJhZ2VQcm9tcHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhwZWN0ZWRQcm92aWRlcnMtLTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBZGRyZXNzRm9ybSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJsb2NhdGlvblJlZmZlcnJlclwiLCB3aW5kb3cubG9jYXRpb24uaHJlZiwge3BhdGg6IFwiL1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9sb2NhdGlvblwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBZGRyZXNzRm9ybSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQWRkcmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUFkZHJlc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGFuZ2UgYWRkcmVzc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0NvbmRpdGlvblNldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuYWRkcmVzc2VzICYmICRyb290U2NvcGUuYWRkcmVzc2VzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEFkZHJlc3NlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmFkZHJlc3Nlcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5uZXdBZGRyZXNzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTaGlwcGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQ29uZGl0aW9uU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJlcGFyZU9yZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dQYXltZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNoaXBwaW5nRXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcGF5ZXJzID0gWyRyb290U2NvcGUudXNlci5pZF07XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlY3VycmluZ190eXBlID0gXCJsaW1pdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCByZWN1cnJpbmdfdmFsdWUgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib3JkZXJfaWRcIjogJHJvb3RTY29wZS5hY3RpdmVPcmRlci5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXllcnNcIjogcGF5ZXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImRlbGl2ZXJ5X2RhdGVcIjogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcGxpdF9vcmRlclwiOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwbGF0Zm9ybVwiOiAkcm9vdFNjb3BlLnBsYXRmb3JtLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY3VycmluZ1wiOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWN1cnJpbmdfdHlwZVwiOiByZWN1cnJpbmdfdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWN1cnJpbmdfdmFsdWVcIjogcmVjdXJyaW5nX3ZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lcmNoYW50X2lkXCI6ICRyb290U2NvcGUuYWN0aXZlT3JkZXIubWVyY2hhbnRfaWRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIE9yZGVycy5wcmVwYXJlT3JkZXIoY29udGFpbmVyLCAkcm9vdFNjb3BlLnBsYXRmb3JtKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiU2VsZWNjaW9uYSBtw6l0b2RvIGRlIGVudsOtb1wiLCAkKFwiI2NoZWNrb3V0LWNhcnRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib3JkZXJQcm92aWRlclwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQgPSByZXNwLnBheW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPcmRlciA9IHJlc3Aub3JkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGF5bWVudC50b3RhbCA9PSAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQudHJhbnNhY3Rpb25fY29zdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXltZW50X2lkXCI6ICRyb290U2NvcGUuYWN0aXZlUGF5bWVudC5pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJpbGxpbmcuY29tcGxldGVQYWlkT3JkZXIoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC50cmFuc2FjdGlvbiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24ucmVmZXJlbmNlX3NhbGUgPSBcIlBhZ28gSW50ZXJub1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24ucGF5bWVudF9tZXRob2QgPSBcIlBhZ28gSW50ZXJub1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24uZGVzY3JpcHRpb24gPSBcIlBhZ28gSW50ZXJub1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25faWQgPSByZXNwLnBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC50cmFuc2FjdGlvbi50cmFuc2FjdGlvbl9zdGF0ZSA9IFwiQVBQUk9WRURcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3RyYW5zYWN0aW9uUmVzcG9uc2UnLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dQYXltZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dQYXltZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5zY3JvbGxUb1RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb21wbGV0ZVBhaWRPcmRlckVycm9yXCIsIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnYWN0aXZhdGVQYXltZW50Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFuZGxlQ2hlY2tFcnJvcihyZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0Q2FydEVycm9yXCIsIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yIHBvcmZhdm9yIGNvbXVuaWNhdGUgbWFzIHRhcmRlXCIsICQoXCIjY2hlY2tvdXQtY2FydFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja291dEJpbGxpbmdDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdMb2NhdGlvblNlcnZpY2UnLCAnVXNlcnMnLCAnQmlsbGluZycsICckbG9jYXRpb24nLCAnJGFuY2hvclNjcm9sbCcsICdNb2RhbHMnLCAnJG1kRGlhbG9nJywgJ0NhcnQnLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBMb2NhdGlvblNlcnZpY2UsIFVzZXJzLCBCaWxsaW5nLCAkbG9jYXRpb24sICRhbmNob3JTY3JvbGwsIE1vZGFscywgJG1kRGlhbG9nLCBDYXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMgPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE1ID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb24gPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5iYW5rcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5wYXltZW50QWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlZGl0Q2FyZFZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVkaXRQYXllclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVkaXRCdXllclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVkaXRvID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYmFuayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dSZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHRIZWFkZXIgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEJvZHkgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhc2ggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kZWJpdG8gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUueWVhcnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9udGhzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkLmdldEZ1bGxZZWFyKClcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IDkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tb250aHMucHVzaChcIjBcIiArIChpICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vbnRocy5wdXNoKGkgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnllYXJzLnB1c2goeWVhciArIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGQgPSAkbG9jYXRpb24uaGFzaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24uaGFzaChpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhbmNob3JTY3JvbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2gob2xkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ2FjdGl2YXRlUGF5bWVudCcsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucGF5bWVudEFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtcGF5bWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYWxsICRhbmNob3JTY3JvbGwoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigndHJhbnNhY3Rpb25SZXNwb25zZScsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlTG9hZGVkQ2FydFwiLCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb25SZXNwb25zZShhcmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmtleXRhYiA9IGZ1bmN0aW9uIChldmVudCwgbWF4bGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFdmVudFwiLCBldmVudClcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRJbnB1dCA9IHRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmc7IC8vIGdldCB0aGUgc2libGluZyBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25leHRJbnB1dCcsIG5leHRJbnB1dCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXQnLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YXJnZXR2YWx1ZScsIHRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3RhcmdldHR5cGUnLCB0YXJnZXQubm9kZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQudmFsdWUubGVuZ3RoIDwgbWF4bGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRJbnB1dCA9PSBudWxsKSAgLy8gY2hlY2sgdGhlIG1heExlbmd0aCBmcm9tIGhlcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dElucHV0LmZvY3VzKCk7ICAgLy8gZm9jdXMgaWYgbm90IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVkaXRUYWIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gdGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBicmFuY2ggPSAoL14oPzo1WzEtNV1bMC05XXsyfXwyMjJbMS05XXwyMlszLTldWzAtOV18MlszLTZdWzAtOV17Mn18MjdbMDFdWzAtOV18MjcyMClbMC05XXsxMn0kLy50ZXN0KHZhbHVlKSkgPyBcIk1BU1RFUkNBUkRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL14oNFswLTldezEyfSg/OlswLTldezN9KT8kKXwoXjYwNjM3NFswLTldezEwfSQpLy50ZXN0KHZhbHVlKSkgPyBcIlZJU0FcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL14zWzQ3XVswLTldezEzfSQvLnRlc3QodmFsdWUpKSA/ICdBTUVYJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL15bMzVdKD86MFswLTVdfFs2OF1bMC05XSlbMC05XXsxMX0kfF4zMFswLTVdezExfSR8XjMwOTVbMC05XXsxMH0kfF4zNlswLTldezEyfSR8XjNbODldWzAtOV17MTJ9JC8udGVzdCh2YWx1ZSkpID8gJ0RJTkVSUydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKC9eNig/OjAxMXw1WzAtOV17Mn18NFs0LTldWzAtOV0pWzAtOV17MTJ9JC8udGVzdCh2YWx1ZSkpID8gJ0RJU0NPVkVSJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL141ODk1NjJbMC05XXsxMH0kLy50ZXN0KHZhbHVlKSkgPyAnTkFSQU5KQSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKC9eNjAzNDg4WzAtOV17MTB9JHxeMjc5OVswLTldezl9JC8udGVzdCh2YWx1ZSkpID8gJ1NIT1BQSU5HJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL142MDQoKFsyM11bMC05XXsyfSl8KDQwMCkpWzAtOV17MTB9JHxeNTg5NjU3WzAtOV17MTB9JC8udGVzdCh2YWx1ZSkpID8gJ0NBQkFMJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL142MDM0OTNbMC05XXsxMH0kLy50ZXN0KHZhbHVlKSkgPyAnQVJHRU5DQVJEJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoL141OTA3MTJbMC05XXsxMH0kLy50ZXN0KHZhbHVlKSkgPyAnQ09ERU5TQSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKC9eNjI3MTgwWzAtOV17MTB9JC8udGVzdCh2YWx1ZSkpID8gJ0NNUidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVkaXQgYnJhbmNoXCIsIGJyYW5jaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmNjX2JyYW5jaCA9IGJyYW5jaDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvblJlc3BvbnNlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uc2UgcGF5dVwiLCBkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIENhcnQuY2xlYXJDYXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2hlY2tvdXQtcGF5bWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5tZXNzYWdlICE9IFwiZXJyb3JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1Jlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb24gPSBkYXRhLnRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25fc3RhdGUgPT0gXCJBUFBST1ZFRFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEhlYWRlciA9IFwiUGFnbyBhcHJvYmFkb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHRCb2R5ID0gXCJUdSBwYWdvIGhhIHNpZG8gY29tcGxldGFkbywgcmV2aXNhIHR1IGNvcnJlbyBwYXJhIHJlY2liaXIgdHUgY29tcHJhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25fc3RhdGUgPT0gXCJQRU5ESU5HXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0SGVhZGVyID0gXCJQYWdvIHBlbmRpZW50ZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHRCb2R5ID0gXCJUdSB0cmFuc2FjY2lvbiBlc3RhIHNpZW5kbyB2ZXJpZmljYWRhLCBjdWFuZG8gY29tcGxldGUgbGEgdmVyaWZpY2FjaW9uIHJlY2liaXJhcyB1biBjb3JyZW8gY29uIGVsIHJlc3VsdGFkb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0SGVhZGVyID0gXCJQYWdvIG5lZ2Fkb1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHRCb2R5ID0gXCJUdSB0cmFuc2FjY2lvbiBoYSBzaWRvIG5lZ2FkYS4gUG9yZmF2b3IgaW50ZW50YSBvdHJvIG1ldG9kbyB1IG90cmEgdGFyamV0YS4gRW4gTWkgY3VlbnRhID4gTWlzIFBhZ29zIHB1ZWRlcyByZWludGVudGFyIGVsIHBhZ29cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEucGF5bWVudCAmJiBkYXRhLnBheW1lbnQuc3RhdHVzICYmIGRhdGEucGF5bWVudC5zdGF0dXM9PVwicGF5bWVudF9pbl9iYW5rXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHRIZWFkZXIgPSBcIlBhZ28gUGVuZGllbnRlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdEJvZHkgPSBcIiFHcmFjaWFzIHBvciB0dSBjb21wcmEhIFBhcmEgYWN0aXZhciB0dSBwbGFuIHBvciBmYXZvciByZWFsaXphIGxhIGNvbnNpZ25hY2nDs24gbyBsYSB0cmFuc2ZlcmVuY2lhIGEgbGEgY3VlbnRhIERhdml2aWVuZGEgTm8gMDA1MDAwMzQzMTQ0IGEgbm9tYnJlIGRlIEhvb3ZlcnQgQXJyZWRvbmRvIFNBUyBOSVQgOTAxLjAyMTkuMDg1LiBBbCBmaW5hbGl6YXIgZWwgcHJvY2VzbyBkZSBwYWdvIG5vIG9sdmlkZXMgZW52aWFyIGVsIHNvcG9ydGUgYWwgY29ycmVvIHNlcnZpY2lvYWxjbGllbnRlQGxvbmNoaXMuY29tLmNvIG8gYSB3aGF0c2FwcCBhbCAzMTAgMzQxODQzMi5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb24uZGVzY3JpcHRpb24gPSBcIlR1IHBhZ28gZXMgZWwgIyBcIitkYXRhLnBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uX3N0YXRlID0gXCJFc3BlcmFuZG8gY29uc2lnbmFjacOzblwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvbi5yZWZlcmVuY2Vfc2FsZSA9IFwiT3JkZW4gIyBcIiskcm9vdFNjb3BlLmFjdGl2ZU9yZGVyLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJIdWJvIHVuIGVycm9yLiBQb3JmYXZvciB2ZXJpZmljYSB0dXMgZGF0b3NcIiwgJChcIiNjaGVja291dC1wYXltZW50XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGF5Q3JlZGl0Q2FyZCA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX2FkZHJlc3MgPSAkc2NvcGUuZGF0YTIucGF5ZXJfYWRkcmVzcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfcG9zdGFsID0gJHNjb3BlLmRhdGEyLnBheWVyX3Bvc3RhbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfY2l0eSA9ICRzY29wZS5kYXRhMi5wYXllcl9jaXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9zdGF0ZSA9ICRzY29wZS5kYXRhMi5wYXllcl9zdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfY291bnRyeSA9ICRzY29wZS5kYXRhMi5wYXllcl9jb3VudHJ5O1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9waG9uZSA9ICRzY29wZS5kYXRhMi5wYXllcl9waG9uZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkMiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBsYXRmb3JtID0gJHJvb3RTY29wZS5wbGF0Zm9ybTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmVtYWlsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheW1lbnRfaWQgPSAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJpbGxpbmcucGF5Q3JlZGl0Q2FyZCgkc2NvcGUuZGF0YTIsIFwiUGF5VVwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJhbnNhY3Rpb25SZXNwb25zZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmRhdGEyID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBheUluQmFuayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTQucGxhdGZvcm0gPSAkcm9vdFNjb3BlLnBsYXRmb3JtO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5lbWFpbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE0LnBheW1lbnRfaWQgPSAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBCaWxsaW5nLnBheUluQmFuaygkc2NvcGUuZGF0YTQsIFwiUGF5VVwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvblJlc3BvbnNlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5kYXRhMiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnF1aWNrUGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1aWNrOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50X2lkOiAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtOiAkcm9vdFNjb3BlLnBsYXRmb3JtXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIEJpbGxpbmcucGF5Q3JlZGl0Q2FyZChjb250YWluZXIsIFwiUGF5VVwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50cmFuc2FjdGlvblJlc3BvbnNlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5kYXRhMiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdE9wdGlvbiA9IGZ1bmN0aW9uIChvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTQucGF5bWVudF9tZXRob2QgPSBvcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjcm9sbFRvKFwiY2FzaC1mb3JtXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucG9wdWxhdGVQYXllciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmRhdGEyLnBheWVyX25hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5kYXRhMi5wYXllcl9uYW1lLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfbmFtZSA9ICRzY29wZS5kYXRhMi5jY19uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX25hbWUgPSAkc2NvcGUuZGF0YTIuY2NfbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGF5RGViaXRDYXJkID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkMyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLnBsYXRmb3JtID0gJHJvb3RTY29wZS5wbGF0Zm9ybTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLmVtYWlsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLnBheW1lbnRfaWQgPSAkcm9vdFNjb3BlLmFjdGl2ZVBheW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJpbGxpbmcucGF5RGViaXQoJHNjb3BlLmRhdGEzLCBcIlBheVVcIikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PSBcIlNVQ0NFU1NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uUmVzcG9uc2Uuc3RhdGUgPT0gXCJQRU5ESU5HXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLnNob3dQcm9tcHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FydC5jbGVhckNhcnQoKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEudHJhbnNhY3Rpb25SZXNwb25zZS5leHRyYVBhcmFtZXRlcnMuQkFOS19VUkw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBwcm9ibGVtYS4gUG9yZmF2b3IgaW50ZW50YSBvdHJvIG1lZGlvLiBcIiwgJChcIiNjaGVja291dC1wYXltZW50XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gcHJvYmxlbWEuIFBvcmZhdm9yIGludGVudGEgb3RybyBtZWRpby4gXCIsICQoXCIjY2hlY2tvdXQtcGF5bWVudFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGF5Q2FzaCA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZDQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wbGF0Zm9ybSA9ICRyb290U2NvcGUucGxhdGZvcm07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5lbWFpbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wYXltZW50X2lkID0gJHJvb3RTY29wZS5hY3RpdmVQYXltZW50LmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaWxsaW5nLnBheUNhc2goJHNjb3BlLmRhdGE0LCBcIlBheVVcIikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWZ0ZXIgcGF5Q2FzaFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvZGUgPT0gXCJTVUNDRVNTXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LmNsZWFyQ2FydCgpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25SZXNwb25zZS5leHRyYVBhcmFtZXRlcnMuVVJMX1BBWU1FTlRfUkVDRUlQVF9IVE1MKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEudHJhbnNhY3Rpb25SZXNwb25zZS5leHRyYVBhcmFtZXRlcnMuVVJMX1BBWU1FTlRfUkVDRUlQVF9IVE1MO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gcHJvYmxlbWEuIFBvcmZhdm9yIGludGVudGEgb3RybyBtZWRpby4gXCIsICQoXCIjY2hlY2tvdXQtcGF5bWVudFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBwcm9ibGVtYS4gUG9yZmF2b3IgaW50ZW50YSBvdHJvIG1lZGlvLiBcIiwgJChcIiNjaGVja291dC1wYXltZW50XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuMiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5maWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5jY19icmFuY2ggPSBcIlZJU0FcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuY2NfbmFtZSA9IFwiQVBQUk9WRURcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuY2NfbnVtYmVyID0gXCI0MTExMTExMTExMTExMTExXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmNjX3NlY3VyaXR5X2NvZGUgPSBcIjEyM1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5jY19leHBpcmF0aW9uX21vbnRoID0gXCIwOVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5jY19leHBpcmF0aW9uX3llYXIgPSBcIjIwMTdcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfZW1haWwgPSBcImhhcnJlZG9uMDFAZ21haWwuY29tXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX2lkID0gXCIzMjEzMjEzMjFcIjtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsbDIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLnVzZXJfdHlwZSA9IFwiTlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy5wc2VfcmVmZXJlbmNlMiA9IFwiQ0NcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucHNlX3JlZmVyZW5jZTMgPSBcIjEwMjA3MTY1MzVcIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5ZXJfZW1haWwgPSBcImhhcnJlZG9uMDFAZ21haWwuY29tXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbGwzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wYXllcl9lbWFpbCA9IFwiaGFycmVkb24wMUBnbWFpbC5jb21cIjtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0Q291bnRyeSA9IGZ1bmN0aW9uIChjb3VudHJ5X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldFJlZ2lvbnNDb3VudHJ5KGNvdW50cnlfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvbnMgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFJlZ2lvbiA9IGZ1bmN0aW9uIChyZWdpb25faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKHJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RQbGFjZSA9IGZ1bmN0aW9uIChjb3VudHJ5X2lkLCByZWdpb25faWQsIGNpdHlfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jb3VudHJ5X2lkID0gY291bnRyeV9pZDtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0UmVnaW9uc0NvdW50cnkoY291bnRyeV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9ucyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucmVnaW9uX2lkID0gcmVnaW9uX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q2l0aWVzUmVnaW9uKHJlZ2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5jaXR5X2lkID0gY2l0eV9pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FkZHJlc3NGb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlID0gXCJiaWxsaW5nXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZUFkZHJlc3NGb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRBZGRyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlVXNlckRlYml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy51c2VyX3R5cGUgPSBcIk5cIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMuZG9jX3R5cGUgPSBcIk5cIjtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5ZXJfbmFtZSA9ICRyb290U2NvcGUudXNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMy5wYXllcl9pZCA9ICRyb290U2NvcGUudXNlci5kb2NOdW07XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEzLnBheWVyX3Bob25lID0gJHJvb3RTY29wZS51c2VyLmNlbGxwaG9uZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTMucGF5ZXJfZW1haWwgPSAkcm9vdFNjb3BlLnVzZXIuZW1haWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlVXNlckNyZWRpdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuY2NfbmFtZSA9ICRyb290U2NvcGUudXNlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9uYW1lID0gJHJvb3RTY29wZS51c2VyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX2lkID0gJHJvb3RTY29wZS51c2VyLmRvY051bTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfcGhvbmUgPSAkcm9vdFNjb3BlLnVzZXIuY2VsbHBob25lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9lbWFpbCA9ICRyb290U2NvcGUudXNlci5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQWRkcmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZVVzZXJDYXNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhNC5wYXllcl9lbWFpbCA9ICRyb290U2NvcGUudXNlci5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTQucGF5ZXJfaWQgPSAkcm9vdFNjb3BlLnVzZXIuZG9jTnVtO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZldGNoQWRkcmVzc0ZvclVzZSA9IGZ1bmN0aW9uICh0eXBlRmV0Y2gsIHR5cGVVc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZUZldGNoID09ICdzaGlwcGluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHJvb3RTY29wZS5hY3RpdmVPcmRlci5vcmRlcl9hZGRyZXNzZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldEFkZHJlc3NJbmZpZWxkcyh0eXBlVXNlLCAkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyLm9yZGVyX2FkZHJlc3Nlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0QWRkcmVzc0luZmllbGRzKHR5cGVVc2UsICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVGZXRjaCA9PSAnb3RoZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRBZGRyZXNzZXNQb3B1cCgpKS50aGVuKGZ1bmN0aW9uIChhZGRyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBhZGRyZXNzXCIsIGFkZHJlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldEFkZHJlc3NJbmZpZWxkcyh0eXBlVXNlLCBhZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3Qgbm90aGluZ1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNldEFkZHJlc3NJbmZpZWxkcyA9IGZ1bmN0aW9uICh0eXBlLCBhZGRyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhZGRyZXNzLnBob25lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MucGhvbmUgPSAkcm9vdFNjb3BlLnVzZXIuY2VsbHBob25lO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSBcInBheWVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX2FkZHJlc3MgPSBhZGRyZXNzLmFkZHJlc3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9wb3N0YWwgPSBhZGRyZXNzLnBvc3RhbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX2NpdHkgPSBhZGRyZXNzLmNpdHlOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfc3RhdGUgPSBhZGRyZXNzLnJlZ2lvbk5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5wYXllcl9jb3VudHJ5ID0gYWRkcmVzcy5jb3VudHJ5Q29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLnBheWVyX3Bob25lID0gYWRkcmVzcy5waG9uZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJidXllclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9hZGRyZXNzID0gYWRkcmVzcy5hZGRyZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfcG9zdGFsID0gYWRkcmVzcy5wb3N0YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9jaXR5ID0gYWRkcmVzcy5jaXR5TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEyLmJ1eWVyX3N0YXRlID0gYWRkcmVzcy5yZWdpb25OYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIuYnV5ZXJfY291bnRyeSA9IGFkZHJlc3MuY291bnRyeUNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9waG9uZSA9IGFkZHJlc3MucGhvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93TWV0aG9kID0gZnVuY3Rpb24gKG1ldGhvZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jcmVkaXRvID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhc2ggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGViaXRvID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJhbmsgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWV0aG9kID09IFwiUFNFXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhZGRUcmFuc2FjdGlvbkNvc3QnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlYml0byA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJpbGxpbmcuZ2V0QmFua3MoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYmFua3MgPSBkYXRhLmJhbmtzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXRob2QgPT0gXCJDQ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhMi5idXllcl9jb3VudHJ5ID0gXCJDT1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTIucGF5ZXJfY291bnRyeSA9IFwiQ09cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhZGRUcmFuc2FjdGlvbkNvc3QnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuYWRkcmVzc2VzICYmICRyb290U2NvcGUuYWRkcmVzc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZ2V0QWRkcmVzc2VzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWRpdG8gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobWV0aG9kID09IFwiQkFMT1RPXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhc2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2FkZFRyYW5zYWN0aW9uQ29zdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobWV0aG9kID09IFwiQkFOS1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5iYW5rID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdyZW1vdmVUcmFuc2FjdGlvbkNvc3QnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1dKVxyXG5cclxuICAgICAgICAuY29udHJvbGxlcignQ2hlY2tvdXRCb29rQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnQ2FydCcsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIENhcnQpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hcHBvaW50bWVudHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS52aXNpYmxlQm9va2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRQZW5kaW5nSXRlbXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJsb2FkUGVuZGluZ0l0ZW1zXCIsICRyb290U2NvcGUuaXRlbXMpXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBlbmRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRyb290U2NvcGUuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9ICRyb290U2NvcGUuaXRlbXNbaXRlbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaXRlbVwiLCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmF0dHJpYnV0ZXMudHlwZSA9PSBcIkJvb2tpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250YWluZXIuYXR0cmlidXRlcy5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5wZW5kaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnBlbmRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcHBvaW50bWVudHMucHVzaChjb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS52aXNpYmxlQm9va2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5ib29raW5nU2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5ib29raW5nU2V0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvZ3JhbUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXZhaWxhYmlsaXRpZXNcIjogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiTWVyY2hhbnRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3RJZFwiOiBpdGVtLmF0dHJpYnV0ZXMubWVyY2hhbnRfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0TmFtZVwiOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0RGVzY3JpcHRpb25cIjogaXRlbS5udWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdEljb25cIjogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHBlY3RlZFByaWNlXCI6IGl0ZW0ucHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicXVlc3Rpb25zXCI6IGl0ZW0uYXR0cmlidXRlcy5xdWVzdGlvbnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXRlbV9pZFwiOiBpdGVtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IGl0ZW0ucXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHVycG9zZVwiOiBcImV4dGVybmFsX2Jvb2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhbGVydFwiOiBcIiNjaGVja291dC1ib29raW5nXCJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uYXR0cmlidXRlcy5sb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMubG9jYXRpb24gPSBpdGVtLmF0dHJpYnV0ZXMubG9jYXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmF0dHJpYnV0ZXMuZHVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmR1cmF0aW9uID0gaXRlbS5hdHRyaWJ1dGVzLmR1cmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbmRpbmcgcGFyYW1zcGFyYW1zcGFyYW1zXCIsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5zaG93Qm9va2luZyhwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCByZXN1bHRcIiwgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQgPT0gXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ucGVuZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1pc3NpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmFwcG9pbnRtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYXBwb2ludG1lbnRzW2ldLnBlbmRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlzc2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtaXNzaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5ib29raW5nU2V0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2J1aWxkT3JkZXInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJ1NoaXBwYWJsZScsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQm9va2luZyBzaGlwcGFibGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRQZW5kaW5nSXRlbXMoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignTm90U2hpcHBhYmxlJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRQZW5kaW5nSXRlbXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2J1aWxkT3JkZXInKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XSkuY29udHJvbGxlcignQ2hlY2tvdXRHYXRld2F5c0N0cmwnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG59KVxyXG4gICAgICAgIFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2NoZWNrb3V0Y3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 11 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('DeliveriesCtrl',['$scope', '$rootScope', 'Food', 'MapService', function ($scope, $rootScope, Food, MapService) {\n            $scope.data = {};\n            $scope.listArticles = {};\n            $scope.deliveries = [];\n            $scope.page = 0;\n            $scope.loadMore = true;\n            $scope.status = 'enqueue';\n            $scope.activeDate = '';\n            $scope.regionVisible = false;\n            $scope.editAddress = false;\n            $scope.mapActive = false;\n            angular.element(document).ready(function () {\n\n                var date = new Date();\n                var day = date.getDay();\n                if (day < 6) {\n                    date.setDate(date.getDate() + 1);\n                } else if (day == 6) {\n                    date.setDate(date.getDate() + 2);\n                }\n                $scope.activeDate = date.getFullYear() + '-' + (date.getMonth() + 1) + \"-\" + date.getDate();\n                $scope.getArticles();\n                $scope.buildDatePicker();\n\n            });\n            $scope.buildDatePicker = function () {\n                var dateFormat = \"yy-mm-dd\",\n                        from = $(\"#from\")\n                        .datepicker({\n                            defaultDate: \"+1d\",\n                            changeMonth: true,\n                            numberOfMonths: 2,\n                            dateFormat: dateFormat\n                        })\n                        .on(\"change\", function () {\n                            console.log(\"date1\", $scope.activeDate);\n                            var date = $scope.getDate(this);\n                            $scope.activeDate = date.getFullYear() + '-' + (date.getMonth() + 1) + \"-\" + date.getDate();\n                            console.log(\"date\", $scope.activeDate);\n                        });\n\n            }\n            $scope.getDate = function (element) {\n                console.log(\"Get date\", element.value);\n                var date;\n                try {\n                    date = $.datepicker.parseDate(\"yy-mm-dd\", element.value);\n                } catch (error) {\n                    date = null;\n                }\n\n                return date;\n            }\n            $scope.updateDels = function () {\n                $scope.page =0;\n                $scope.deliveries = [];\n                $scope.getArticles();\n            }\n            $scope.activateMap = function () {\n                $scope.mapActive = true;\n                console.log(\"Creating map data\")\n                MapService.createMap(4.685419, -74.064161);\n                $scope.createMapData();\n            }\n            $scope.changeScenario = function () {\n                $scope.getDeliveries();\n            }\n            $scope.createMapData = function () {\n                console.log(\"Creating map data\")\n                var firstdelivery = $scope.deliveries[0];\n                var count = 0;\n                var i = 0;\n                for (var item in $scope.deliveries) {\n                    i++;\n                    if ($scope.deliveries[item].address_id == firstdelivery.address_id) {\n                        count++;\n                    } else {\n                        firstdelivery.icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + count + '|FE6256|000000'\n                        MapService.createStop(firstdelivery);\n                        firstdelivery = $scope.deliveries[item];\n                        count = 1;\n                    }\n                    if (i == $scope.deliveries.length) {\n                        firstdelivery.icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + count + '|FE6256|000000'\n                        MapService.createStop(firstdelivery);\n                    }\n                }\n            }\n            $scope.getDeliveries = function () {\n                console.log(\"Status\", $scope.status);\n                $scope.page++;\n                var url = \"includes=user,address&limit=50&order_by=address_id,asc&page=\" + $scope.page + \"&status=\" + $scope.status + \"&delivery=\" + $scope.activeDate + \" 12:00:00\";\n                Food.getDeliveries(url).then(function (data) {\n                    var deliveriesCont = data.data;\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    if (deliveriesCont.length > 0) {\n                        for (item in deliveriesCont) {\n                            var delivery = deliveriesCont[item];\n                            delivery.details = JSON.parse(delivery.details);\n                            delivery.name = delivery.address.address;\n                            delivery.lat = delivery.address.lat;\n                            delivery.delivery = new Date(delivery.delivery);\n                            delivery.long = delivery.address.long;\n                            $scope.deliveries.push(delivery);\n                        }\n                    }\n                    console.log(\"Deliveries\", $scope.deliveries);\n                    $scope.replaceFood();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.clean = function () {\n                $scope.data = {};\n                $scope.regionVisible = false;\n                $scope.cityVisible = false;\n            }\n            $scope.sendReminder = function () {\n                Food.sendReminder().then(function (data) {\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.sendNewsletter = function () {\n                Food.sendNewsletter();\n            }\n            $scope.showAll = function () {\n                console.log(\"Creating map data\")\n                for (item in $scope.deliveries) {\n                    $scope.deliveries[item].marker.setMap($rootScope.map);\n                }\n            }\n            $scope.hideAll = function () {\n                for (item in $scope.deliveries) {\n                    $scope.deliveries[item].marker.setMap(null);\n                }\n            }\n            $scope.showDelivery = function (delivery) {\n                $scope.hideAll();\n                delivery.marker.setMap($rootScope.map);\n            }\n\n            $scope.clean = function () {\n                $scope.data = {};\n                $scope.regionVisible = false;\n                $scope.cityVisible = false;\n            }\n            $scope.updateDeliveryAddress = function (user, address) {\n\n                Food.updateDeliveryAddress(user, address).then(function (data) {\n                    window.location.reload();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getPurchaseOrder = function () {\n                Food.getPurchaseOrder().then(function (data) {\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getArticle = function (id) {\n                console.log(\"getArticle\", id);\n                for (var item in $scope.listArticles) {\n                    if ($scope.listArticles[item].id == id) {\n                        console.log(\"getArticleres\", $scope.listArticles[item]);\n                        return $scope.listArticles[item];\n                    }\n                }\n            }\n            $scope.replaceFood = function () {\n                console.log(\"articles\", $scope.listArticles);\n                for (var item in $scope.deliveries) {\n                    console.log(\"delivery\", $scope.deliveries[item].id);\n                    var attributes = $scope.deliveries[item].details;\n                    if (attributes.dish) {\n                        $scope.deliveries[item].build = false;\n                        $scope.deliveries[item].type_id = attributes.dish.type_id;\n                        var article = $scope.getArticle(attributes.dish.type_id);\n                        if (article) {\n                            attributes.tipoAlmuerzo = article.name;\n                            for (item2 in article.attributes.entradas) {\n                                if (article.attributes.entradas[item2].codigo == attributes.dish.starter_id) {\n                                    attributes.entrada = article.attributes.entradas[item2].valor;\n                                    $scope.deliveries[item].starter_id = attributes.dish.starter_id;\n                                }\n                            }\n                            for (item3 in article.attributes.plato) {\n                                if (article.attributes.plato[item3].codigo == attributes.dish.main_id) {\n                                    attributes.plato = article.attributes.plato[item3].valor;\n                                    $scope.deliveries[item].main_id = attributes.dish.main_id;\n                                }\n                            }\n                            delete attributes.dish;\n                            delete attributes.products;\n                            delete attributes.merchant_id;\n                            $scope.deliveries[item].details = attributes;\n                        }\n                        console.log(\"deliveryDone\", $scope.deliveries[item].id);\n                    } else {\n                        $scope.deliveries[item].type_id = null;\n                        $scope.deliveries[item].starter_id = null;\n                        $scope.deliveries[item].main_id = null;\n                        $scope.deliveries[item].build = true;\n                    }\n                }\n            }\n            $scope.selectMissingType = function (item) {\n                var article = $scope.getArticle(item.type_id);\n                item.starters = article.attributes.entradas;\n                item.mains = article.attributes.plato;\n            }\n            $scope.selectDish = function (item) {\n                var attributes = item.details;\n                var article = $scope.getArticle(item.type_id);\n                attributes.tipoAlmuerzo = article.name;\n                for (item2 in article.attributes.entradas) {\n                    if (article.attributes.entradas[item2].codigo == item.starter_id) {\n                        attributes.entrada = article.attributes.entradas[item2].valor;\n                    }\n                }\n                for (item3 in article.attributes.plato) {\n                    if (article.attributes.plato[item3].codigo == item.main_id) {\n                        attributes.plato = article.attributes.plato[item3].valor;\n                    }\n                }\n                item.details = attributes;\n                var container = {\n                    \"delivery_id\": item.id,\n                    \"type_id\": item.type_id,\n                    \"main_id\": item.main_id\n                };\n                if (item.starter_id) {\n                    container.starter_id = item.starter_id;\n                }\n                item.build = false;\n                console.log(\"Updating dish: \", container);\n                Food.updateMissingDish(container);\n            }\n            $scope.getArticles = function () {\n                Food.getArticlesByDate($scope.activeDate).then(function (data) {\n                    $scope.listArticles = data.data;\n                    for (var item in $scope.listArticles) {\n                        $scope.listArticles[item].attributes = JSON.parse($scope.listArticles[item].attributes);\n                    }\n                    $scope.getDeliveries();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.regenerateDeliveries = function () {\n                Food.regenerateDeliveries().then(function (data) {\n                },\n                        function (data) {\n\n                        });\n            }\n\n            $scope.getInputs = function () {\n                var data;\n                if ($scope.status == \"enqueue\") {\n                    data = {\n                        \"status\": \"enqueue\"\n                    };\n                } else {\n                    data = {\n                        \"status\": $scope.status,\n                        \"provider\": $scope.provider,\n                        \"type\": $scope.scenario\n                    };\n                }\n                return data;\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9kZWxpdmVyaWVzY3RybC5qcz9jMmRhIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdEZWxpdmVyaWVzQ3RybCcsWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdGb29kJywgJ01hcFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBGb29kLCBNYXBTZXJ2aWNlKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmxpc3RBcnRpY2xlcyA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gJ2VucXVldWUnO1xuICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGUgPSAnJztcbiAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEFkZHJlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIGxldCBkYXkgPSBkYXRlLmdldERheSgpO1xuICAgICAgICAgICAgICAgIGlmIChkYXkgPCA2KSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF5ID09IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVEYXRlID0gZGF0ZS5nZXRGdWxsWWVhcigpICsgJy0nICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpICsgXCItXCIgKyBkYXRlLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QXJ0aWNsZXMoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGREYXRlUGlja2VyKCk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkRGF0ZVBpY2tlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IFwieXktbW0tZGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gPSAkKFwiI2Zyb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRlcGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCIrMWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNb250aDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGUxXCIsICRzY29wZS5hY3RpdmVEYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0ZSA9ICRzY29wZS5nZXREYXRlKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVEYXRlID0gZGF0ZS5nZXRGdWxsWWVhcigpICsgJy0nICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpICsgXCItXCIgKyBkYXRlLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGVcIiwgJHNjb3BlLmFjdGl2ZURhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXREYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlXCIsIGVsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRlO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSAkLmRhdGVwaWNrZXIucGFyc2VEYXRlKFwieXktbW0tZGRcIiwgZWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlRGVscyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9MDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRBcnRpY2xlcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmFjdGl2YXRlTWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY4NTQxOSwgLTc0LjA2NDE2MSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTY2VuYXJpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0RGVsaXZlcmllcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgIGxldCBmaXJzdGRlbGl2ZXJ5ID0gJHNjb3BlLmRlbGl2ZXJpZXNbMF07XG4gICAgICAgICAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuZGVsaXZlcmllcykge1xuICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5hZGRyZXNzX2lkID09IGZpcnN0ZGVsaXZlcnkuYWRkcmVzc19pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ZGVsaXZlcnkuaWNvbiA9ICdodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9tYXBfcGluX2xldHRlciZjaGxkPScgKyBjb3VudCArICd8RkU2MjU2fDAwMDAwMCdcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlU3RvcChmaXJzdGRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ZGVsaXZlcnkgPSAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAkc2NvcGUuZGVsaXZlcmllcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0ZGVsaXZlcnkuaWNvbiA9ICdodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9tYXBfcGluX2xldHRlciZjaGxkPScgKyBjb3VudCArICd8RkU2MjU2fDAwMDAwMCdcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlU3RvcChmaXJzdGRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXREZWxpdmVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhdHVzXCIsICRzY29wZS5zdGF0dXMpO1xuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiaW5jbHVkZXM9dXNlcixhZGRyZXNzJmxpbWl0PTUwJm9yZGVyX2J5PWFkZHJlc3NfaWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJnN0YXR1cz1cIiArICRzY29wZS5zdGF0dXMgKyBcIiZkZWxpdmVyeT1cIiArICRzY29wZS5hY3RpdmVEYXRlICsgXCIgMTI6MDA6MDBcIjtcbiAgICAgICAgICAgICAgICBGb29kLmdldERlbGl2ZXJpZXModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkZWxpdmVyaWVzQ29udCA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA9PSBkYXRhLmxhc3RfcGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGl2ZXJpZXNDb250Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBkZWxpdmVyaWVzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWxpdmVyeSA9IGRlbGl2ZXJpZXNDb250W2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGl2ZXJ5LmRldGFpbHMgPSBKU09OLnBhcnNlKGRlbGl2ZXJ5LmRldGFpbHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGl2ZXJ5Lm5hbWUgPSBkZWxpdmVyeS5hZGRyZXNzLmFkZHJlc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnkubGF0ID0gZGVsaXZlcnkuYWRkcmVzcy5sYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnkuZGVsaXZlcnkgPSBuZXcgRGF0ZShkZWxpdmVyeS5kZWxpdmVyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnkubG9uZyA9IGRlbGl2ZXJ5LmFkZHJlc3MubG9uZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllcy5wdXNoKGRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRlbGl2ZXJpZXNcIiwgJHNjb3BlLmRlbGl2ZXJpZXMpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwbGFjZUZvb2QoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jaXR5VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNlbmRSZW1pbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBGb29kLnNlbmRSZW1pbmRlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VuZE5ld3NsZXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgRm9vZC5zZW5kTmV3c2xldHRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNob3dBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuZGVsaXZlcmllcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5tYXJrZXIuc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuaGlkZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLmRlbGl2ZXJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0ubWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2hvd0RlbGl2ZXJ5ID0gZnVuY3Rpb24gKGRlbGl2ZXJ5KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBbGwoKTtcbiAgICAgICAgICAgICAgICBkZWxpdmVyeS5tYXJrZXIuc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVEZWxpdmVyeUFkZHJlc3MgPSBmdW5jdGlvbiAodXNlciwgYWRkcmVzcykge1xuXG4gICAgICAgICAgICAgICAgRm9vZC51cGRhdGVEZWxpdmVyeUFkZHJlc3ModXNlciwgYWRkcmVzcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdldFB1cmNoYXNlT3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgRm9vZC5nZXRQdXJjaGFzZU9yZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXRBcnRpY2xlID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXRBcnRpY2xlXCIsIGlkKTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluICRzY29wZS5saXN0QXJ0aWNsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5saXN0QXJ0aWNsZXNbaXRlbV0uaWQgPT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0QXJ0aWNsZXJlc1wiLCAkc2NvcGUubGlzdEFydGljbGVzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUubGlzdEFydGljbGVzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnJlcGxhY2VGb29kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYXJ0aWNsZXNcIiwgJHNjb3BlLmxpc3RBcnRpY2xlcyk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuZGVsaXZlcmllcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGl2ZXJ5XCIsICRzY29wZS5kZWxpdmVyaWVzW2l0ZW1dLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5kZXRhaWxzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5kaXNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5idWlsZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0udHlwZV9pZCA9IGF0dHJpYnV0ZXMuZGlzaC50eXBlX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFydGljbGUgPSAkc2NvcGUuZ2V0QXJ0aWNsZShhdHRyaWJ1dGVzLmRpc2gudHlwZV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGlwb0FsbXVlcnpvID0gYXJ0aWNsZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbTIgaW4gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnRpY2xlLmF0dHJpYnV0ZXMuZW50cmFkYXNbaXRlbTJdLmNvZGlnbyA9PSBhdHRyaWJ1dGVzLmRpc2guc3RhcnRlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5lbnRyYWRhID0gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzW2l0ZW0yXS52YWxvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyaWVzW2l0ZW1dLnN0YXJ0ZXJfaWQgPSBhdHRyaWJ1dGVzLmRpc2guc3RhcnRlcl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0zIGluIGFydGljbGUuYXR0cmlidXRlcy5wbGF0bykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZS5hdHRyaWJ1dGVzLnBsYXRvW2l0ZW0zXS5jb2RpZ28gPT0gYXR0cmlidXRlcy5kaXNoLm1haW5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucGxhdG8gPSBhcnRpY2xlLmF0dHJpYnV0ZXMucGxhdG9baXRlbTNdLnZhbG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0ubWFpbl9pZCA9IGF0dHJpYnV0ZXMuZGlzaC5tYWluX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhdHRyaWJ1dGVzLmRpc2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXMucHJvZHVjdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXMubWVyY2hhbnRfaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0uZGV0YWlscyA9IGF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbGl2ZXJ5RG9uZVwiLCAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS50eXBlX2lkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kZWxpdmVyaWVzW2l0ZW1dLnN0YXJ0ZXJfaWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRlbGl2ZXJpZXNbaXRlbV0ubWFpbl9pZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGVsaXZlcmllc1tpdGVtXS5idWlsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0TWlzc2luZ1R5cGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGxldCBhcnRpY2xlID0gJHNjb3BlLmdldEFydGljbGUoaXRlbS50eXBlX2lkKTtcbiAgICAgICAgICAgICAgICBpdGVtLnN0YXJ0ZXJzID0gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzO1xuICAgICAgICAgICAgICAgIGl0ZW0ubWFpbnMgPSBhcnRpY2xlLmF0dHJpYnV0ZXMucGxhdG87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0RGlzaCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBpdGVtLmRldGFpbHM7XG4gICAgICAgICAgICAgICAgbGV0IGFydGljbGUgPSAkc2NvcGUuZ2V0QXJ0aWNsZShpdGVtLnR5cGVfaWQpO1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGlwb0FsbXVlcnpvID0gYXJ0aWNsZS5uYW1lO1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbTIgaW4gYXJ0aWNsZS5hdHRyaWJ1dGVzLmVudHJhZGFzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnRpY2xlLmF0dHJpYnV0ZXMuZW50cmFkYXNbaXRlbTJdLmNvZGlnbyA9PSBpdGVtLnN0YXJ0ZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuZW50cmFkYSA9IGFydGljbGUuYXR0cmlidXRlcy5lbnRyYWRhc1tpdGVtMl0udmFsb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpdGVtMyBpbiBhcnRpY2xlLmF0dHJpYnV0ZXMucGxhdG8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFydGljbGUuYXR0cmlidXRlcy5wbGF0b1tpdGVtM10uY29kaWdvID09IGl0ZW0ubWFpbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wbGF0byA9IGFydGljbGUuYXR0cmlidXRlcy5wbGF0b1tpdGVtM10udmFsb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaXRlbS5kZXRhaWxzID0gYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICBcImRlbGl2ZXJ5X2lkXCI6IGl0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgIFwidHlwZV9pZFwiOiBpdGVtLnR5cGVfaWQsXG4gICAgICAgICAgICAgICAgICAgIFwibWFpbl9pZFwiOiBpdGVtLm1haW5faWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLnN0YXJ0ZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnN0YXJ0ZXJfaWQgPSBpdGVtLnN0YXJ0ZXJfaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGl0ZW0uYnVpbGQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIGRpc2g6IFwiLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgIEZvb2QudXBkYXRlTWlzc2luZ0Rpc2goY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXRBcnRpY2xlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBGb29kLmdldEFydGljbGVzQnlEYXRlKCRzY29wZS5hY3RpdmVEYXRlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5saXN0QXJ0aWNsZXMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gJHNjb3BlLmxpc3RBcnRpY2xlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpc3RBcnRpY2xlc1tpdGVtXS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZSgkc2NvcGUubGlzdEFydGljbGVzW2l0ZW1dLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXREZWxpdmVyaWVzKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnJlZ2VuZXJhdGVEZWxpdmVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIEZvb2QucmVnZW5lcmF0ZURlbGl2ZXJpZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SW5wdXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCBkYXRhO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3RhdHVzID09IFwiZW5xdWV1ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiBcImVucXVldWVcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiAkc2NvcGUuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlclwiOiAkc2NvcGUucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnNjZW5hcmlvXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2RlbGl2ZXJpZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 12 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ExportsCtrl', ['$scope','Merchants','$mdDialog','Modals', function ($scope, Merchants,$mdDialog,Modals) {\n                $scope.data = {};\n                $scope.orders;\n                $scope.from;\n                $scope.to;\n                $scope.user;\n                $scope.activeMerchant = null;\n                $scope.activeMerchantObject;\n                $scope.changeMerchant = true;\n                $scope.showSearch = false;\n                $scope.showError = false;\n                $scope.datPickerBuilt = false;\n                $scope.loadMore = true,\n                        $scope.page = 0;\n                angular.element(document).ready(function () {\n\n                    $scope.getMerchantsPrivate()\n                    //$scope.getMerchantsPrivate();\n                });\n                $scope.getMerchants = function () {\n                    $scope.page++;\n                    Merchants.searchMerchants($scope.searchTerms).then(function (data) {\n                        console.log(\"Items\", data.data);\n                        $scope.merchants = data.data;\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getMerchantsPrivate = function () {\n                    Merchants.getMerchantsUser().then(function (data) {\n                        if (data.status == \"success\") {\n                            $scope.merchants = data.data;\n                        }\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.changeActiveMerchant = function () {\n                    $scope.changeMerchant = true;\n                }\n                $scope.cancelChangeMerchant = function () {\n                    $scope.changeMerchant = false;\n                }\n                $scope.selectMerchant = function (item) {\n\n                    $scope.page = 0;\n                    $scope.items = [];\n                    $scope.activeMerchantObject = item;\n                    $scope.activeMerchant = item.id + \"\";\n                    $scope.changeMerchant = false;\n                    if (!$scope.datPickerBuilt) {\n                        setTimeout(function () {\n                            $scope.buildDatePicker();\n                        }, 800);\n\n                    }\n                }\n\n                $scope.buildDatePicker = function () {\n                    $scope.datPickerBuilt = true;\n                    var dateFormat = \"yy-mm-dd\",\n                            from = $(\"#from\")\n                            .datepicker({\n                                defaultDate: \"-1m\",\n                                changeMonth: true,\n                                numberOfMonths: 2,\n                                dateFormat: dateFormat\n                            })\n                            .on(\"change\", function () {\n                                to.datepicker(\"option\", \"minDate\", $scope.getDate(this));\n                                $scope.from = $scope.getDate(this);\n                            }),\n                            to = $(\"#to\").datepicker({\n                        defaultDate: \"+1w\",\n                        changeMonth: true,\n                        numberOfMonths: 2,\n                        dateFormat: dateFormat\n                    })\n                            .on(\"change\", function () {\n                                from.datepicker(\"option\", \"maxDate\", $scope.getDate(this));\n                                $scope.to = $scope.getDate(this);\n                            });\n                }\n                $scope.getDate = function (element) {\n                    console.log(\"Get date\", element.value);\n                    var date;\n                    try {\n                        date = $.datepicker.parseDate(\"yy-mm-dd\", element.value);\n                    } catch (error) {\n                        date = null;\n                    }\n\n                    return date;\n                }\n                $scope.startExport = function (typeEx) {\n                    $scope.showError = false;\n                    if(!$scope.activeMerchant){\n                        $scope.showError = true;\n                        return;\n                    }\n                    if (typeEx == 'orders') {\n                        $scope.getStoreExport()\n                    } else {\n                        $scope.getContentExport(typeEx)\n                    }\n                }\n\n\n                $scope.getStoreExport = function () {\n                    console.log(\"Date\", $scope.from, $scope.to);\n                    var container = {\"from\": $scope.from, \"to\": $scope.to, \"merchant_id\": $scope.activeMerchant, \"type\": 'products'}\n                    Merchants.getStoreExport(container).then(function (data) {\n                        if (data.status == 'success') {\n                            $mdDialog.show(Modals.getExportPopup());\n                        } else {\n                            Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\");\n                        }\n                    },\n                            function (data) {\n                                Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\");\n                            });\n                }\n                $scope.getContentExport = function (typeCont) {\n                    var container = {\"merchant_id\": $scope.activeMerchant, \"type\": typeCont}\n                    Merchants.getStoreContent(container).then(function (data) {\n                        if (data.status == 'success') {\n                            $mdDialog.show(Modals.getExportPopup());\n                        } else {\n                            Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\")\n                        }\n                    },\n                            function (data) {\n                                Modals.showToast(\"Hubo un error, porfavor comunicate con soporte\");\n                            });\n                }\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9leHBvcnRzY3RybC5qcz9mYWYyIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdFeHBvcnRzQ3RybCcsIFsnJHNjb3BlJywnTWVyY2hhbnRzJywnJG1kRGlhbG9nJywnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgTWVyY2hhbnRzLCRtZERpYWxvZyxNb2RhbHMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5vcmRlcnM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZyb207XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvO1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VyO1xuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNZXJjaGFudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dTZWFyY2ggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdFBpY2tlckJ1aWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzUHJpdmF0ZSgpXG4gICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmdldE1lcmNoYW50c1ByaXZhdGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuc2VhcmNoTWVyY2hhbnRzKCRzY29wZS5zZWFyY2hUZXJtcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJdGVtc1wiLCBkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRNZXJjaGFudHNQcml2YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0TWVyY2hhbnRzVXNlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlQWN0aXZlTWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWxDaGFuZ2VNZXJjaGFudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZU1lcmNoYW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RNZXJjaGFudCA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50T2JqZWN0ID0gaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50ID0gaXRlbS5pZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5kYXRQaWNrZXJCdWlsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkRGF0ZVBpY2tlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgODAwKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkRGF0ZVBpY2tlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdFBpY2tlckJ1aWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGVGb3JtYXQgPSBcInl5LW1tLWRkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSA9ICQoXCIjZnJvbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRlcGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdERhdGU6IFwiLTFtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1vbnRoOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUZvcm1hdDogZGF0ZUZvcm1hdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZGF0ZXBpY2tlcihcIm9wdGlvblwiLCBcIm1pbkRhdGVcIiwgJHNjb3BlLmdldERhdGUodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZnJvbSA9ICRzY29wZS5nZXREYXRlKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvID0gJChcIiN0b1wiKS5kYXRlcGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHREYXRlOiBcIisxd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlTW9udGg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQ6IGRhdGVGb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tLmRhdGVwaWNrZXIoXCJvcHRpb25cIiwgXCJtYXhEYXRlXCIsICRzY29wZS5nZXREYXRlKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvID0gJHNjb3BlLmdldERhdGUodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXREYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHZXQgZGF0ZVwiLCBlbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGU7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlID0gJC5kYXRlcGlja2VyLnBhcnNlRGF0ZShcInl5LW1tLWRkXCIsIGVsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXJ0RXhwb3J0ID0gZnVuY3Rpb24gKHR5cGVFeCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmKCEkc2NvcGUuYWN0aXZlTWVyY2hhbnQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVFeCA9PSAnb3JkZXJzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFN0b3JlRXhwb3J0KClcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRDb250ZW50RXhwb3J0KHR5cGVFeClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFN0b3JlRXhwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGVcIiwgJHNjb3BlLmZyb20sICRzY29wZS50byk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XCJmcm9tXCI6ICRzY29wZS5mcm9tLCBcInRvXCI6ICRzY29wZS50bywgXCJtZXJjaGFudF9pZFwiOiAkc2NvcGUuYWN0aXZlTWVyY2hhbnQsIFwidHlwZVwiOiAncHJvZHVjdHMnfVxuICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0U3RvcmVFeHBvcnQoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldEV4cG9ydFBvcHVwKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciwgcG9yZmF2b3IgY29tdW5pY2F0ZSBjb24gc29wb3J0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciwgcG9yZmF2b3IgY29tdW5pY2F0ZSBjb24gc29wb3J0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldENvbnRlbnRFeHBvcnQgPSBmdW5jdGlvbiAodHlwZUNvbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcIm1lcmNoYW50X2lkXCI6ICRzY29wZS5hY3RpdmVNZXJjaGFudCwgXCJ0eXBlXCI6IHR5cGVDb250fVxuICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0U3RvcmVDb250ZW50KGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRFeHBvcnRQb3B1cCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkh1Ym8gdW4gZXJyb3IsIHBvcmZhdm9yIGNvbXVuaWNhdGUgY29uIHNvcG9ydGVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciwgcG9yZmF2b3IgY29tdW5pY2F0ZSBjb24gc29wb3J0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2V4cG9ydHNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 13 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('FoodAddressesCtrl',['$scope','Food', function ($scope,Food) {\n            $scope.data = {};\n            $scope.addresses;\n            $scope.regionVisible = false;\n            $scope.editAddress = false;\n            $scope.mapActive = false;\n            angular.element(document).ready(function () {\n                $scope.getAddresses();\n            });\n            $scope.delegateAddress = function (address,complete ) {\n                var provider = \"\";\n                if(address.provider == \"Rapigo\"){\n                    provider = \"Basilikum\";\n                } else {\n                    provider = \"Rapigo\";\n                }\n                var theDate = new Date(address.delivery);\n                var container = {\n                    \"address\":address.address,\n                    \"provider\":provider,\n                    \"complete\":complete,\n                    \"merchant_id\":address.merchant_id\n                };\n                Food.delegateDeliveriesAddress(container).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n            }\n\n            $scope.buildAddressData = function (address) {\n                return address;\n            }\n            $scope.getAddresses = function () {\n                Food.getLargestAddresses().then(function (data) {\n                    var addressesCont = data.data;\n                    for (item in addressesCont) {\n                        addressesCont[item] = $scope.buildAddressData(addressesCont[item]);\n                    }\n                    $scope.addresses = addressesCont;\n                },\n                        function (data) {\n\n                        });\n            }\n\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9mb29kYWRkcmVzc2VzY3RybC5qcz83OGY5Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdGb29kQWRkcmVzc2VzQ3RybCcsWyckc2NvcGUnLCdGb29kJywgZnVuY3Rpb24gKCRzY29wZSxGb29kKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NlcztcbiAgICAgICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEFkZHJlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRBZGRyZXNzZXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmRlbGVnYXRlQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzLGNvbXBsZXRlICkge1xuICAgICAgICAgICAgICAgIGxldCBwcm92aWRlciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYoYWRkcmVzcy5wcm92aWRlciA9PSBcIlJhcGlnb1wiKXtcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXIgPSBcIkJhc2lsaWt1bVwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gXCJSYXBpZ29cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IHRoZURhdGUgPSBuZXcgRGF0ZShhZGRyZXNzLmRlbGl2ZXJ5KTtcbiAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NcIjphZGRyZXNzLmFkZHJlc3MsXG4gICAgICAgICAgICAgICAgICAgIFwicHJvdmlkZXJcIjpwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgXCJjb21wbGV0ZVwiOmNvbXBsZXRlLFxuICAgICAgICAgICAgICAgICAgICBcIm1lcmNoYW50X2lkXCI6YWRkcmVzcy5tZXJjaGFudF9pZFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgRm9vZC5kZWxlZ2F0ZURlbGl2ZXJpZXNBZGRyZXNzKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRBZGRyZXNzRGF0YSA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFkZHJlc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIEZvb2QuZ2V0TGFyZ2VzdEFkZHJlc3NlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFkZHJlc3Nlc0NvbnQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBhZGRyZXNzZXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzZXNDb250W2l0ZW1dID0gJHNjb3BlLmJ1aWxkQWRkcmVzc0RhdGEoYWRkcmVzc2VzQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZHJlc3NlcyA9IGFkZHJlc3Nlc0NvbnQ7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvZm9vZGFkZHJlc3Nlc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 14 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('FoodMessagesCtrl',['$scope', 'Food', function ($scope, Food) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n            });\n            \n            $scope.buildItemData = function (item) {\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page;\n                Food.getMessages(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                    console.log(\"Load more\",$scope.loadMore);\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                Food.updateMessageItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                Food.deleteMessageItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9mb29kbWVzc2FnZXNjdHJsLmpzPzhjOTgiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Zvb2RNZXNzYWdlc0N0cmwnLFsnJHNjb3BlJywgJ0Zvb2QnLCBmdW5jdGlvbiAoJHNjb3BlLCBGb29kKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCJvcmRlcl9ieT1pZCxkZXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZTtcbiAgICAgICAgICAgICAgICBGb29kLmdldE1lc3NhZ2VzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2FkIG1vcmVcIiwkc2NvcGUubG9hZE1vcmUpO1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgRm9vZC51cGRhdGVNZXNzYWdlSXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgICAgICAgICBGb29kLmRlbGV0ZU1lc3NhZ2VJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9mb29kbWVzc2FnZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 15 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('GroupsSelectionCtrl',['$scope', 'Groups', '$rootScope', 'Users', function ($scope, Groups, $rootScope, Users) {\n            $scope.data = {};\n            $scope.invites = [];\n\n            $scope.groups = [];\n            $scope.contacts = [];\n            $scope.chosen = [];\n            $scope.searchText = \"\";\n            $scope.objectSelected = false;\n            $scope.editGroup = false;\n            $scope.isActive = false;\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                console.log(\"Saving: \" + isvalid);\n                if (isvalid) {\n                    $scope.saveGroup();\n                }\n            }\n            $scope.groupToggle = function () {\n                if ($scope.editGroup) {\n                    $scope.editGroup = false;\n                } else {\n                    $scope.editGroup = true;\n                    if ($scope.contacts.length == 0) {\n                        $scope.getContacts();\n                    }\n                }\n            }\n            $scope.activation = function () {\n                if ($scope.isActive) {\n                    $scope.isActive = false;\n                } else {\n                    $scope.isActive = true;\n                }\n            }\n\n            $scope.saveGroup = function () {\n                console.log(\"Data sent\");\n                console.log(JSON.stringify($scope.data));\n                console.log(JSON.stringify($.param($scope.data)));\n                var formData = {name: $scope.data.name, is_public: true, contacts: $scope.invites, completeData: $scope.chosen};\n                Groups.saveGroup($.param(formData)).then(function (data) {\n                    console.log(\"Return group\");\n                    console.log(JSON.stringify(data));\n                    if (data.status == \"success\") {\n                        $scope.selectGroup(data.group);\n                        $scope.groups.push(data.group);\n                    }\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getGroups = function () {\n\n                Groups.getGroups().then(function (data) {\n\n                    var groups = data.data;\n                    for (item in groups) {\n                        var group = groups[item];\n                        group.is_selected = false;\n                        $scope.groups.push(group);\n                    }\n                    if (groups.length == 0) {\n                        $scope.editGroup = true;\n                    }\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getContacts = function () {\n\n                Users.getContacts($scope.searchText).then(function (data) {\n                    $scope.contacts = [];\n                    $scope.contacts = data.data;\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.selectContact = function (contact) {\n                $scope.invites.push(contact.contact_id);\n                $scope.chosen.push(contact);\n                for(item in $scope.contacts){\n                    if($scope.contacts[item].contact_id == contact.contact_id){\n                        $scope.contacts.splice(item, 1);\n                    }\n                }\n            }\n            $scope.deleteContact = function (contact) {\n                for(item in $scope.chosen){\n                    if($scope.chosen[item].contact_id == contact.contact_id){\n                        $scope.chosen.splice(item, 1);\n                    }\n                }\n                for(item in $scope.invites){\n                    if($scope.invites[item] == contact.contact_id){\n                        $scope.chosen.splice(item, 1);\n                    }\n                }\n            }\n\n            $scope.selectGroup = function (group) {\n                group.is_selected = true\n                $scope.isActive = false;\n                $rootScope.$broadcast('ObjectSelected', {object_id: group.id});\n            }\n            $rootScope.$on('PlanSelected', function (event, args) {\n                $scope.isActive = true;\n                if ($scope.groups.length == 0) {\n                    $scope.getGroups();\n                }\n            });\n\n            $scope.clean = function () {\n                $scope.data = {};\n                $scope.invites = [];\n            }\n\n        }])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9ncm91cHNjdHJsLmpzP2FlN2YiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ0dyb3Vwc1NlbGVjdGlvbkN0cmwnLFsnJHNjb3BlJywgJ0dyb3VwcycsICckcm9vdFNjb3BlJywgJ1VzZXJzJywgZnVuY3Rpb24gKCRzY29wZSwgR3JvdXBzLCAkcm9vdFNjb3BlLCBVc2Vycykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5pbnZpdGVzID0gW107XG5cbiAgICAgICAgICAgICRzY29wZS5ncm91cHMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5jb250YWN0cyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmNob3NlbiA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLm9iamVjdFNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEdyb3VwID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNhdmluZzogXCIgKyBpc3ZhbGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZUdyb3VwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdyb3VwVG9nZ2xlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZWRpdEdyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0R3JvdXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdEdyb3VwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jb250YWN0cy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldENvbnRhY3RzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2F2ZUdyb3VwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YSBzZW50XCIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCRzY29wZS5kYXRhKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJC5wYXJhbSgkc2NvcGUuZGF0YSkpKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSB7bmFtZTogJHNjb3BlLmRhdGEubmFtZSwgaXNfcHVibGljOiB0cnVlLCBjb250YWN0czogJHNjb3BlLmludml0ZXMsIGNvbXBsZXRlRGF0YTogJHNjb3BlLmNob3Nlbn07XG4gICAgICAgICAgICAgICAgR3JvdXBzLnNhdmVHcm91cCgkLnBhcmFtKGZvcm1EYXRhKSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHVybiBncm91cFwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RHcm91cChkYXRhLmdyb3VwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ncm91cHMucHVzaChkYXRhLmdyb3VwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdldEdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIEdyb3Vwcy5nZXRHcm91cHMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwcyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGdyb3Vwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuaXNfc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ncm91cHMucHVzaChncm91cCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3Vwcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRHcm91cCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0Q29udGFjdHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBVc2Vycy5nZXRDb250YWN0cygkc2NvcGUuc2VhcmNoVGV4dCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGFjdHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRhY3RzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RDb250YWN0ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW52aXRlcy5wdXNoKGNvbnRhY3QuY29udGFjdF9pZCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNob3Nlbi5wdXNoKGNvbnRhY3QpO1xuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluICRzY29wZS5jb250YWN0cyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5jb250YWN0c1tpdGVtXS5jb250YWN0X2lkID09IGNvbnRhY3QuY29udGFjdF9pZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29udGFjdHMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbnRhY3QgPSBmdW5jdGlvbiAoY29udGFjdCkge1xuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluICRzY29wZS5jaG9zZW4pe1xuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuY2hvc2VuW2l0ZW1dLmNvbnRhY3RfaWQgPT0gY29udGFjdC5jb250YWN0X2lkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaG9zZW4uc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluICRzY29wZS5pbnZpdGVzKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLmludml0ZXNbaXRlbV0gPT0gY29udGFjdC5jb250YWN0X2lkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaG9zZW4uc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0R3JvdXAgPSBmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgICAgICBncm91cC5pc19zZWxlY3RlZCA9IHRydWVcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ09iamVjdFNlbGVjdGVkJywge29iamVjdF9pZDogZ3JvdXAuaWR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdQbGFuU2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZ3JvdXBzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRHcm91cHMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmludml0ZXMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XSlcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL2dyb3Vwc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 16 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('LeadCtrl', ['$scope', 'Leads', 'Modals', function ($scope, Leads, Modals) {\n                $scope.data = {};\n                $scope.key = \"\";\n                $scope.submitted = false;\n                $scope.category;\n                angular.element(document).ready(function () {\n                    var res = viewData;\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n                    $scope.key = container.key;\n                });\n\n                $scope.send = function (isvalid) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        grecaptcha.ready(function () {\n                            grecaptcha.execute($scope.key, {action: 'submit'}).then(function (token) {\n                                $scope.data.captcha = token;\n                                Modals.showLoader();\n                                Leads.sendLead($scope.data).then(function (data) {\n                                    Modals.hideLoader();\n                                    $scope.data = {};\n                                    Modals.showToast(\"Mensaje enviado\",$(\"#contact-form\"));\n                                },\n                                        function (data) {\n                                        });\n                            });\n                        });\n                    }\n                }\n                $scope.lead = function (isvalid,type) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        grecaptcha.ready(function () {\n                            grecaptcha.execute($scope.key, {action: 'submit'}).then(function (token) {\n                                $scope.data.captcha = token;\n                                $scope.data.type = type;\n                                Modals.showLoader();\n                                Leads.sendLead($scope.data).then(function (data) {\n                                    Modals.hideLoader();\n                                    $scope.data = {};\n                                    $scope.submitted = false;\n                                    Modals.showToast(\"Mensaje enviado\",$(\"#contact-form\"));\n                                },\n                                        function (data) {\n                                        });\n                            });\n                        });\n                    }\n                }\n            }])\n       //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9sZWFkc2N0cmwuanM/ZTM5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignTGVhZEN0cmwnLCBbJyRzY29wZScsICdMZWFkcycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBMZWFkcywgTW9kYWxzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUua2V5ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGE7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5rZXkgPSBjb250YWluZXIua2V5O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbmQgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyZWNhcHRjaGEucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyZWNhcHRjaGEuZXhlY3V0ZSgkc2NvcGUua2V5LCB7YWN0aW9uOiAnc3VibWl0J30pLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNhcHRjaGEgPSB0b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGVhZHMuc2VuZExlYWQoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIk1lbnNhamUgZW52aWFkb1wiLCQoXCIjY29udGFjdC1mb3JtXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxlYWQgPSBmdW5jdGlvbiAoaXN2YWxpZCx0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5leGVjdXRlKCRzY29wZS5rZXksIHthY3Rpb246ICdzdWJtaXQnfSkudGhlbihmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuY2FwdGNoYSA9IHRva2VuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS50eXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGVhZHMuc2VuZExlYWQoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIk1lbnNhamUgZW52aWFkb1wiLCQoXCIjY29udGFjdC1mb3JtXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSlcbiAgICAgICBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9sZWFkc2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 17 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n        .controller('LonchisCtrl', ['$scope', 'Cart', '$rootScope', '$sce', 'Products', 'Modals', function ($scope, Cart, $rootScope, $sce, Products, Modals) {\r\n                $scope.products = [\r\n                    {\r\n                        id: 80,\r\n                        name: \"Prueba\",\r\n                        activeVariant: {\r\n                            id: 220,\r\n                            price: 12000,\r\n                            merchant_id: 1299,\r\n                            quantity: 1\r\n                        }\r\n                    },\r\n                    {\r\n                        id: 80,\r\n                        name: \"Eco Friendly\",\r\n                        activeVariant: {\r\n                            id: 220,\r\n                            price: 12000,\r\n                            merchant_id: 1299,\r\n                            quantity: 1\r\n                        }\r\n                    },\r\n                    {\r\n                        id: 81,\r\n                        name: \"Envase Desechable\",\r\n                        activeVariant: {\r\n                            id: 220,\r\n                            price: 12000,\r\n                            merchant_id: 1299,\r\n                            quantity: 1\r\n                        }\r\n                    }\r\n                ];\r\n                $scope.options = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22];\r\n                $scope.hasLocation = false;\r\n                $scope.hasMerchant = false;\r\n                $scope.isSearch = false;\r\n                $scope.merchantObj = {};\r\n                $scope.current = 1;\r\n                $scope.last = 1;\r\n                $scope.range;\r\n                $scope.params = {}\r\n                $scope.per_page = 1\r\n                $scope.category_id = null;\r\n                $scope.total = 1;\r\n                $scope.local_total = 0;\r\n                $scope.cantidad1 = 11;\r\n                $scope.cantidad2 = 11;\r\n                $scope.precio1 = 14200;\r\n                $scope.precio1D = 150000;\r\n                $scope.precio2 = 14200;\r\n                $scope.precio2D = 150000;\r\n\r\n\r\n                angular.element(document).ready(function () {\r\n\r\n                });\r\n                $rootScope.$on('loadCartVariants', function (event, args) {\r\n                    $scope.updateProductsCart(args, false);\r\n                    if ($rootScope.user) {\r\n                        $scope.checkFavorites();\r\n                    }\r\n                });\r\n                $rootScope.$on('clearCart', function (event, args) {\r\n                    console.log(\"Cart cleared resetting items\")\r\n                    $scope.cartCleared();\r\n\r\n                });\r\n                $rootScope.$on('deleteItem', function (event, args) {\r\n                    console.log(\"item removed resetting items: \", args)\r\n                    $scope.cartDeletedItem(args);\r\n                });\r\n                $scope.changeAmount = function (id) {\r\n                    var discountFactor = 0;\r\n                    if (id == 1) {\r\n                        discountFactor = Math.floor($scope.cantidad1 / 11);\r\n                    } else {\r\n                        discountFactor = Math.floor($scope.cantidad2 / 11);\r\n                    }\r\n                    if (id == 1) {\r\n                        $scope.precio1D = ($scope.precio1 * $scope.cantidad1 - (discountFactor * 11000));\r\n                    } else {\r\n                        $scope.precio2D = ($scope.precio2 * $scope.cantidad2 - (discountFactor * 11000));\r\n                    }\r\n\r\n\r\n                }\r\n                $scope.changeStore = function () {\r\n                    Cart.changeMerchant()\r\n                }\r\n                $scope.addCatFilter = function (category) {\r\n                    $scope.params.category_id = category;\r\n                    $scope.goTo(1);\r\n                }\r\n                $scope.addToCart = function (id) {\r\n                    var postData = {};\r\n                    if (id == 1) {\r\n                        postData = {\r\n                            product_variant_id: 220,\r\n                            merchant_id: 1299,\r\n                            quantity: 1,\r\n                            item_id: null,\r\n                            extras: {}\r\n                        };\r\n                    } else if (id == 2) {\r\n                        postData = {\r\n                            product_variant_id: 210,\r\n                            merchant_id: 1299,\r\n                            quantity: $scope.cantidad1,\r\n                            item_id: null,\r\n                            extras: {}\r\n                        };\r\n                    } else {\r\n                        postData = {\r\n                            product_variant_id: 220,\r\n                            merchant_id: 1299,\r\n                            quantity: $scope.cantidad2,\r\n                            item_id: null,\r\n                            extras: {}\r\n                        };\r\n                    }\r\n\r\n                    Cart.postToServer(postData).then(function (data) {\r\n                        $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                        window.location.href = \"/checkout\";\r\n                    }, function () {\r\n\r\n                    });\r\n\r\n                }\r\n                $scope.checkFavorites = function () {\r\n                    var container = {\r\n                        product_ids: $scope.prodIds\r\n                    }\r\n                    Products.checkFavorite(container).then(function (data) {\r\n                        console.log(\"checkFavorites res\", data);\r\n                        if (data.status == \"success\") {\r\n                            var results = data.data;\r\n                            for (var k in results) {\r\n                                for (var i in $scope.categories) {\r\n                                    for (var j in $scope.categories[i].products) {\r\n                                        if ($scope.categories[i].products[j].id == results[k].favoritable_id) {\r\n                                            $scope.categories[i].products[j].isFavorite = true;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.addFavorite = function (product) {\r\n                    if ($rootScope.user) {\r\n                        var container = {\r\n                            object_id: product.id,\r\n                            type: \"Product\"\r\n                        }\r\n                        Products.addFavorite(container).then(function (data) {\r\n                            console.log(\"Add addFavorite\", data);\r\n                            if (data.status == \"success\") {\r\n                                product.isFavorite = true;\r\n                                Modals.showToast(\"Agregado\", $(\"#prod-cont-\" + product.id));\r\n                            } else {\r\n                                Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    } else {\r\n                        Modals.showToast(\"Debes estar logueado para guardar productos\", $(\"#prod-cont-\" + product.id));\r\n                    }\r\n\r\n                }\r\n                $scope.deleteFavorite = function (product) {\r\n                    var container = {\r\n                        object_id: product.id,\r\n                        type: \"Product\"\r\n                    }\r\n                    Products.deleteFavorite(container).then(function (data) {\r\n                        console.log(\"Add addFavorite\", data);\r\n                        if (data.status == \"success\") {\r\n                            Modals.showToast(\"Agregado\", $(\"#prod-cont-\" + product.id));\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.cartCleared = function () {\r\n                    for (var i in $scope.categories) {\r\n                        for (var j in $scope.categories[i].products) {\r\n                            $scope.categories[i].products[j].item_id = null;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.cartDeletedItem = function (item_id) {\r\n                    for (var i in $scope.categories) {\r\n                        for (var j in $scope.categories[i].products) {\r\n                            if ($scope.categories[i].products[j].item_id == item_id) {\r\n                                $scope.categories[i].products[j].item_id = null;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                $scope.updateProductsCart = function (cart, total) {\r\n                    cart:\r\n                            for (var m in cart.items) {\r\n                        for (var i in $scope.categories) {\r\n                            for (var j in $scope.categories[i].products) {\r\n                                $scope.categories[i].products[j].item_id = null;\r\n                                for (var k in $scope.categories[i].products[j].variants) {\r\n                                    var container = cart.items[m];\r\n                                    var variant = $scope.categories[i].products[j].variants[k];\r\n                                    if (container.attributes.product_variant_id == variant.id) {\r\n                                        $scope.categories[i].products[j].item_id = container.id;\r\n                                        $scope.categories[i].products[j].quantity = container.quantity;\r\n                                        if (total) {\r\n                                            continue cart;\r\n                                        }\r\n\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n                $scope.changeCartQuantity = function (product, change) {\r\n                    if (change == \"+\") {\r\n                        product.quantity++;\r\n                    } else {\r\n                        product.quantity--;\r\n                    }\r\n                    var container = {\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            Modals.showToast(\"Error Actualizando\", $(\"#prod-cont-\" + product.id));\r\n                            alert(data.message);\r\n                        } else {\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n            }])\r\n        //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9sb25jaGlzY3RybC5qcz8yYjdkIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdMb25jaGlzQ3RybCcsIFsnJHNjb3BlJywgJ0NhcnQnLCAnJHJvb3RTY29wZScsICckc2NlJywgJ1Byb2R1Y3RzJywgJ01vZGFscycsIGZ1bmN0aW9uICgkc2NvcGUsIENhcnQsICRyb290U2NvcGUsICRzY2UsIFByb2R1Y3RzLCBNb2RhbHMpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0cyA9IFtcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiA4MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJQcnVlYmFcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVmFyaWFudDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IDIyMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiAxMjAwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmNoYW50X2lkOiAxMjk5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogODAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRWNvIEZyaWVuZGx5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVZhcmlhbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAyMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZTogMTIwMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogMTI5OSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IDgxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVudmFzZSBEZXNlY2hhYmxlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVZhcmlhbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAyMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZTogMTIwMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogMTI5OSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9wdGlvbnMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjJdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhhc0xvY2F0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGFzTWVyY2hhbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pc1NlYXJjaCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50T2JqID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudCA9IDE7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFzdCA9IDE7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmFuZ2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zID0ge31cclxuICAgICAgICAgICAgICAgICRzY29wZS5wZXJfcGFnZSA9IDFcclxuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeV9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvY2FsX3RvdGFsID0gMDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jYW50aWRhZDEgPSAxMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jYW50aWRhZDIgPSAxMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wcmVjaW8xID0gMTQyMDA7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJlY2lvMUQgPSAxNTAwMDA7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJlY2lvMiA9IDE0MjAwO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByZWNpbzJEID0gMTUwMDAwO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdsb2FkQ2FydFZhcmlhbnRzJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVByb2R1Y3RzQ2FydChhcmdzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2hlY2tGYXZvcml0ZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdjbGVhckNhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhcnQgY2xlYXJlZCByZXNldHRpbmcgaXRlbXNcIilcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FydENsZWFyZWQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdkZWxldGVJdGVtJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpdGVtIHJlbW92ZWQgcmVzZXR0aW5nIGl0ZW1zOiBcIiwgYXJncylcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FydERlbGV0ZWRJdGVtKGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlQW1vdW50ID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRpc2NvdW50RmFjdG9yID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNjb3VudEZhY3RvciA9IE1hdGguZmxvb3IoJHNjb3BlLmNhbnRpZGFkMSAvIDExKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNjb3VudEZhY3RvciA9IE1hdGguZmxvb3IoJHNjb3BlLmNhbnRpZGFkMiAvIDExKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByZWNpbzFEID0gKCRzY29wZS5wcmVjaW8xICogJHNjb3BlLmNhbnRpZGFkMSAtIChkaXNjb3VudEZhY3RvciAqIDExMDAwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByZWNpbzJEID0gKCRzY29wZS5wcmVjaW8yICogJHNjb3BlLmNhbnRpZGFkMiAtIChkaXNjb3VudEZhY3RvciAqIDExMDAwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlU3RvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5jaGFuZ2VNZXJjaGFudCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkQ2F0RmlsdGVyID0gZnVuY3Rpb24gKGNhdGVnb3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcy5jYXRlZ29yeV9pZCA9IGNhdGVnb3J5O1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nb1RvKDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZFRvQ2FydCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwb3N0RGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3REYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF92YXJpYW50X2lkOiAyMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogMTI5OSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhczoge31cclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zdERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3ZhcmlhbnRfaWQ6IDIxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmNoYW50X2lkOiAxMjk5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6ICRzY29wZS5jYW50aWRhZDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFzOiB7fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3REYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF92YXJpYW50X2lkOiAyMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogMTI5OSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAkc2NvcGUuY2FudGlkYWQyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhczoge31cclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIENhcnQucG9zdFRvU2VydmVyKHBvc3REYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9jaGVja291dFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrRmF2b3JpdGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfaWRzOiAkc2NvcGUucHJvZElkc1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5jaGVja0Zhdm9yaXRlKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNoZWNrRmF2b3JpdGVzIHJlc1wiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gcmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLmlkID09IHJlc3VsdHNba10uZmF2b3JpdGFibGVfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pc0Zhdm9yaXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRGYXZvcml0ZSA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X2lkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQcm9kdWN0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5hZGRGYXZvcml0ZShjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGFkZEZhdm9yaXRlXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5pc0Zhdm9yaXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQWdyZWdhZG9cIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoZGF0YS5tZXNzYWdlLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJEZWJlcyBlc3RhciBsb2d1ZWFkbyBwYXJhIGd1YXJkYXIgcHJvZHVjdG9zXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlRmF2b3JpdGUgPSBmdW5jdGlvbiAocHJvZHVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF9pZDogcHJvZHVjdC5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQcm9kdWN0XCJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgUHJvZHVjdHMuZGVsZXRlRmF2b3JpdGUoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGFkZEZhdm9yaXRlXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2Fkb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoZGF0YS5tZXNzYWdlLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FydENsZWFyZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiAkc2NvcGUuY2F0ZWdvcmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pdGVtX2lkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jYXJ0RGVsZXRlZEl0ZW0gPSBmdW5jdGlvbiAoaXRlbV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPT0gaXRlbV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVByb2R1Y3RzQ2FydCA9IGZ1bmN0aW9uIChjYXJ0LCB0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBtIGluIGNhcnQuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiAkc2NvcGUuY2F0ZWdvcmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0udmFyaWFudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGNhcnQuaXRlbXNbbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YXJpYW50ID0gJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0udmFyaWFudHNba107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuYXR0cmlidXRlcy5wcm9kdWN0X3ZhcmlhbnRfaWQgPT0gdmFyaWFudC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0uaXRlbV9pZCA9IGNvbnRhaW5lci5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLnF1YW50aXR5ID0gY29udGFpbmVyLnF1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUgY2FydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUNhcnRRdWFudGl0eSA9IGZ1bmN0aW9uIChwcm9kdWN0LCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlID09IFwiK1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucXVhbnRpdHkrKztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5LS07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBwcm9kdWN0LnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBwcm9kdWN0Lml0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJlcnJvclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiRXJyb3IgQWN0dWFsaXphbmRvXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XSlcclxuICAgICAgICBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9sb25jaGlzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 18 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .controller('MapLocationCtrl', ['$scope', '$rootScope', 'MapService', '$cookies', function ($scope, $rootScope, MapService, $cookies) {\n                $scope.map = {center: {latitude: 4.653450, longitude: -74.049605}, zoom: 8};\n                $rootScope.markers = [];\n                $rootScope.mapLoaded = false;\n                $scope.error = \"nada\";\n                var url = window.location.href;\n                var res = url.split(\"/map/\");\n                console.log(\"url\");\n                console.log(JSON.stringify(res));\n                MapService.createMap(4.653450, -74.049605);\n                MapService.postMapLocation();\n                $scope.activeMarker = MapService.createLocationMarker(4.653450, -74.049605, true);\n                console.log(navigator.geolocation);\n                if ($rootScope.shippingAddress && $rootScope.shippingAddress.lat) {\n                    console.log(\"Loading address from cookie\", $rootScope.shippingAddress);\n                    $scope.activeMarker.setPosition(new google.maps.LatLng($rootScope.shippingAddress.lat, $rootScope.shippingAddress.long))\n                    google.maps.event.trigger($scope.activeMarker, 'dragend');\n                } else {\n                    if (navigator.geolocation) {\n                        navigator.geolocation.getCurrentPosition(function (position) {\n                            $scope.$apply(function () {\n                                console.log(\"Position\", position);\n                                $scope.position = position;\n                                $scope.activeMarker.setPosition(new google.maps.LatLng(position.coords.latitude, position.coords.longitude))\n                                google.maps.event.trigger($scope.activeMarker, 'dragend');\n                            });\n                        });\n                    } \n                }\n                $scope.selectCity = function (latitude,longitude) {\n                    console.log(\"Select city: \",latitude,longitude);\n                    $scope.activeMarker.setPosition(new google.maps.LatLng(latitude, longitude));\n                    google.maps.event.trigger($scope.activeMarker, 'dragend'); \n                }\n\n                $scope.default = function () {\n                    MapService.createLocationMarker(4.653450, -74.049605, false);\n                }\n                $scope.cancel = function () {\n                    window.history.back();\n                }\n                $scope.saveLocation = function () {\n                    console.log(\"Loading address to cookie\", $rootScope.shippingAddress);\n                    $cookies.put(\"shippingAddress\", JSON.stringify($rootScope.shippingAddress), {path: \"/\"});\n                    console.log(\"shippingAddress\", JSON.stringify($rootScope.shippingAddress));\n                    var locationS = $cookies.get('locationRefferrer');\n                    $cookies.remove('locationRefferrer');\n                    var url = \"\";\n                    if (locationS && locationS.length > 0) {\n                        url = \"\";\n                        console.log(\"location\", locationS);\n                        if (locationS.includes('?')) {\n                            url = locationS + \"&lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long\n                        } else {\n                            url = locationS + \"?lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long\n                        }\n                        console.log(\"url\", url);\n                        //url = locationS;\n                    } else {\n                        url = \"/?lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long\n                    }\n                    $scope.error = \"la url es: \"+url;\n                    console.log(\"url\", url);\n                    window.location.href = url;\n                }\n\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9tYXBjdHJsLmpzP2JjZDYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdNYXBMb2NhdGlvbkN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ01hcFNlcnZpY2UnLCAnJGNvb2tpZXMnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBNYXBTZXJ2aWNlLCAkY29va2llcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXAgPSB7Y2VudGVyOiB7bGF0aXR1ZGU6IDQuNjUzNDUwLCBsb25naXR1ZGU6IC03NC4wNDk2MDV9LCB6b29tOiA4fTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcExvYWRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvciA9IFwibmFkYVwiO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gdXJsLnNwbGl0KFwiL21hcC9cIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cmxcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzKSk7XG4gICAgICAgICAgICAgICAgTWFwU2VydmljZS5jcmVhdGVNYXAoNC42NTM0NTAsIC03NC4wNDk2MDUpO1xuICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UucG9zdE1hcExvY2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1hcmtlciA9IE1hcFNlcnZpY2UuY3JlYXRlTG9jYXRpb25NYXJrZXIoNC42NTM0NTAsIC03NC4wNDk2MDUsIHRydWUpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG5hdmlnYXRvci5nZW9sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzICYmICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvYWRpbmcgYWRkcmVzcyBmcm9tIGNvb2tpZVwiLCAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNYXJrZXIuc2V0UG9zaXRpb24obmV3IGdvb2dsZS5tYXBzLkxhdExuZygkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQsICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcpKVxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5hY3RpdmVNYXJrZXIsICdkcmFnZW5kJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5nZW9sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJQb3NpdGlvblwiLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWFya2VyLnNldFBvc2l0aW9uKG5ldyBnb29nbGUubWFwcy5MYXRMbmcocG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLCBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkc2NvcGUuYWN0aXZlTWFya2VyLCAnZHJhZ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RDaXR5ID0gZnVuY3Rpb24gKGxhdGl0dWRlLGxvbmdpdHVkZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdCBjaXR5OiBcIixsYXRpdHVkZSxsb25naXR1ZGUpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWFya2VyLnNldFBvc2l0aW9uKG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0aXR1ZGUsIGxvbmdpdHVkZSkpO1xuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5hY3RpdmVNYXJrZXIsICdkcmFnZW5kJyk7IFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5kZWZhdWx0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZUxvY2F0aW9uTWFya2VyKDQuNjUzNDUwLCAtNzQuMDQ5NjA1LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmVMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2FkaW5nIGFkZHJlc3MgdG8gY29va2llXCIsICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwic2hpcHBpbmdBZGRyZXNzXCIsIEpTT04uc3RyaW5naWZ5KCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2hpcHBpbmdBZGRyZXNzXCIsIEpTT04uc3RyaW5naWZ5KCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBsb2NhdGlvblMgPSAkY29va2llcy5nZXQoJ2xvY2F0aW9uUmVmZmVycmVyJyk7XG4gICAgICAgICAgICAgICAgICAgICRjb29raWVzLnJlbW92ZSgnbG9jYXRpb25SZWZmZXJyZXInKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvblMgJiYgbG9jYXRpb25TLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImxvY2F0aW9uXCIsIGxvY2F0aW9uUyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb25TLmluY2x1ZGVzKCc/JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBsb2NhdGlvblMgKyBcIiZsYXQ9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQgKyBcIiZsb25nPVwiICsgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBsb2NhdGlvblMgKyBcIj9sYXQ9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQgKyBcIiZsb25nPVwiICsgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cmxcIiwgdXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdXJsID0gbG9jYXRpb25TO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gXCIvP2xhdD1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCArIFwiJmxvbmc9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sb25nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9yID0gXCJsYSB1cmwgZXM6IFwiK3VybDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cmxcIiwgdXJsKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL21hcGN0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 19 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('MenuCtrl',['$scope', 'Food', function ($scope, Food) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.loadMore = true,\n            $scope.page = 0;\n            $scope.contentType = \"\";\n            $scope.config = {};\n            angular.element(document).ready(function () {\n                $scope.getItems();\n                $scope.contentType = $scope.config.content;\n            });\n\n            $scope.buildItemData = function (item) {\n                item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"type=lunch&order_by=id,desc&page=\" + $scope.page;\n                Food.getMenu(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (item) {\n\n                Food.updateMenuItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n\n                Food.deleteMenuItem(item).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9tZW51Y3RybC5qcz9hNTQ0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdNZW51Q3RybCcsWyckc2NvcGUnLCAnRm9vZCcsIGZ1bmN0aW9uICgkc2NvcGUsIEZvb2QpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICAkc2NvcGUuY29udGVudFR5cGUgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLmNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnRUeXBlID0gJHNjb3BlLmNvbmZpZy5jb250ZW50O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS5idWlsZEl0ZW1EYXRhID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGl0ZW0uYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcInR5cGU9bHVuY2gmb3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XG4gICAgICAgICAgICAgICAgRm9vZC5nZXRNZW51KHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gaXRlbXNDb250KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRJdGVtRGF0YShpdGVtc0NvbnRbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5pdGVtcy5jb25jYXQoaXRlbXNDb250KTtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICAgICAgICAgICAgICAgIEZvb2QudXBkYXRlTWVudUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuXG4gICAgICAgICAgICAgICAgRm9vZC5kZWxldGVNZW51SXRlbShpdGVtKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvbWVudWN0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 20 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('MerchantsCtrl', ['$scope', 'Merchants', 'Modals', function ($scope, Merchants, Modals) {\n                $scope.data = {};\n                $scope.user = {};\n                $scope.current = 1;\n                $scope.last = 1;\n                $scope.total = 1;\n                $scope.per_page = 1;\n                $scope.merchants = [];\n                $scope.categories = [];\n                $scope.regionVisible = false;\n                $scope.editMerchant = false;\n                $scope.showAddress = true;\n                $scope.showStore = true;\n                $scope.submitted = false;\n                $scope.category;\n                angular.element(document).ready(function () {\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\n//                    res = res.replace(/\"\"{/g, '\"\\\"{');\n//                    res = res.replace(/}\"\"/g, '}\\\"\"');\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n                    var url = window.location.href;\n                    if(url.includes(\"urgencias\")){\n                        $scope.showStore = false;\n                    }\n\n                    $scope.category = container.category;\n                    $scope.merchants = container.data;\n                    for(var item in $scope.merchants){\n                        for(var k in $scope.merchants[item].attributes.categories){\n                            if($scope.merchants[item].attributes.categories[k].id == $scope.category.id){\n                                $scope.merchants[item].activeCategory = $scope.merchants[item].attributes.categories[k];\n                                break;\n                            }\n                        }\n                    }\n                    if($scope.merchants.length == 1){\n                        $scope.openItem($scope.merchants[0]);\n                    }\n                    console.log(\"Data\", $scope.merchants);\n                    $scope.current = container.page;\n                    $scope.per_page = container.per_page;\n                    $scope.last = container.last_page;\n                    $scope.total = container.total;\n                    document.getElementById(\"dissapear\").remove();\n                });\n\n                $scope.goTo = function (page) {\n                    $scope.current = page;\n                    $scope.merchants = [];\n                    Modals.showLoader();\n                    var where = \"category_id=\" + $scope.category.id + \"&page=\" + $scope.current + \"&limit=\" + 2;\n                    if ($scope.category.type.includes(\"nearby\")) {\n                        Merchants.getMerchantsNearby(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    } else if ($scope.category.type.includes(\"coverage\")) {\n                        Merchants.getMerchantsCoverage(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    } else {\n                        Merchants.getMerchants(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    }\n                }\n\n                $scope.loadResults = function (data) {\n                    $scope.merchants = data.data;\n                    $scope.current = parseInt(data.page);\n                    $scope.per_page = parseInt(data.per_page);\n                    $scope.last = parseInt(data.last_page);\n                    $scope.total = parseInt(data.total);\n                    Modals.hideLoader();\n                }\n                $scope.openItem = function (merchant) {\n                    var url = \"\";\n                    var merchant_id = merchant.id;\n                    if (merchant.categorizable_id) {\n                        merchant_id = merchant.categorizable_id;\n                    }\n                    if ($scope.category) {\n                        url = \"/a/products/\" + $scope.category.url + \"?merchant_id=\" + merchant_id;\n                    } else {\n                        url = \"/a/merchant/\" + merchant.slug + \"/products\";\n                    }\n\n                    window.location.href = url;\n                }\n            }])\n        .controller('MerchantDetailCtrl', ['$scope','$rootScope', 'Merchants', 'Modals', '$mdDialog','Cart', function ($scope,$rootScope, Merchants, Modals, $mdDialog,Cart) {\n                $scope.data = {};\n                $scope.user = {};\n\n                $scope.merchant = {};\n                angular.element(document).ready(function () {\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\n//                    res = res.replace(/\"\"{/g, '\"\\\"{');\n//                    res = res.replace(/}\"\"/g, '}\\\"\"');\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n\n                    console.log(\"Data\", container);\n                    $scope.merchant = container;\n                    $scope.merchant.availabilities = $scope.merchant.availabilities2;\n                    console.log(\"$scope.merchant\", $scope.merchant);\n                    //document.getElementById(\"dissapear\").remove();\n                });\n                $scope.booking = function () {\n                    if ($rootScope.user) {\n                        var params = {\n                            \"availabilities\": $scope.merchant.availabilities,\n                            \"type\": \"Merchant\",\n                            \"objectId\": $scope.merchant.id,\n                            \"objectName\": $scope.merchant.name,\n                            \"objectDescription\": $scope.merchant.description,\n                            \"objectIcon\": $scope.merchant.icon,\n                            \"expectedPrice\": $scope.merchant.unit_cost,\n                            \"alert\":\"#book-button\"\n                        }\n                        Cart.showBooking(params);\n                    } else {\n                        Modals.showToast(\"Registrate o ingresa para reservar\",$(\"#book-button\"));\n                    }\n\n                    console.log(\"Booking\");\n\n//                    $mdDialog.show(Modals.getAppPopup()).then(function (platform) {\n//                        let url = \"\";\n//                        if (platform == \"ios\") {\n//                            url = \"\"\n//                        } else if (platform == 'android') {\n//                            url = \"\"\n//                        } else if (platform == 'web') {\n//                            url = \"\"\n//                        }\n//                        console.log(\"Url\", platform, url)\n//                        //window.location.href = url;\n//\n//                    }, function () {\n//\n//                    });\n                }\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9tZXJjaGFudHNjdHJsLmpzPzkwNjAiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ01lcmNoYW50c0N0cmwnLCBbJyRzY29wZScsICdNZXJjaGFudHMnLCAnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgTWVyY2hhbnRzLCBNb2RhbHMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSAxO1xuICAgICAgICAgICAgICAgICRzY29wZS5sYXN0ID0gMTtcbiAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSAxO1xuICAgICAgICAgICAgICAgICRzY29wZS5wZXJfcGFnZSA9IDE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1lcmNoYW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBZGRyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1N0b3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGEucmVwbGFjZSgvQXBwXFxcXE1vZGVsc1xcXFwvZywgXCJcIik7XG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1wiXCJ7L2csICdcIlxcXCJ7Jyk7XG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL31cIlwiL2csICd9XFxcIlwiJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgICAgICAgICAgICAgaWYodXJsLmluY2x1ZGVzKFwidXJnZW5jaWFzXCIpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93U3RvcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeSA9IGNvbnRhaW5lci5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGNvbnRhaW5lci5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGl0ZW0gaW4gJHNjb3BlLm1lcmNoYW50cyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgaW4gJHNjb3BlLm1lcmNoYW50c1tpdGVtXS5hdHRyaWJ1dGVzLmNhdGVnb3JpZXMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5tZXJjaGFudHNbaXRlbV0uYXR0cmlidXRlcy5jYXRlZ29yaWVzW2tdLmlkID09ICRzY29wZS5jYXRlZ29yeS5pZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHNbaXRlbV0uYWN0aXZlQ2F0ZWdvcnkgPSAkc2NvcGUubWVyY2hhbnRzW2l0ZW1dLmF0dHJpYnV0ZXMuY2F0ZWdvcmllc1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5tZXJjaGFudHMubGVuZ3RoID09IDEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5JdGVtKCRzY29wZS5tZXJjaGFudHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiLCAkc2NvcGUubWVyY2hhbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBjb250YWluZXIucGFnZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gY29udGFpbmVyLnBlcl9wYWdlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGFzdCA9IGNvbnRhaW5lci5sYXN0X3BhZ2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGNvbnRhaW5lci50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkaXNzYXBlYXJcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbyA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gcGFnZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBcImNhdGVnb3J5X2lkPVwiICsgJHNjb3BlLmNhdGVnb3J5LmlkICsgXCImcGFnZT1cIiArICRzY29wZS5jdXJyZW50ICsgXCImbGltaXQ9XCIgKyAyO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5LnR5cGUuaW5jbHVkZXMoXCJuZWFyYnlcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5nZXRNZXJjaGFudHNOZWFyYnkod2hlcmUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFJlc3VsdHMoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5jYXRlZ29yeS50eXBlLmluY2x1ZGVzKFwiY292ZXJhZ2VcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5nZXRNZXJjaGFudHNDb3ZlcmFnZSh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyhkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0TWVyY2hhbnRzKHdoZXJlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRSZXN1bHRzKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gcGFyc2VJbnQoZGF0YS5wYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gcGFyc2VJbnQoZGF0YS5wZXJfcGFnZSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sYXN0ID0gcGFyc2VJbnQoZGF0YS5sYXN0X3BhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSBwYXJzZUludChkYXRhLnRvdGFsKTtcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLmhpZGVMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5JdGVtID0gZnVuY3Rpb24gKG1lcmNoYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbWVyY2hhbnRfaWQgPSBtZXJjaGFudC5pZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lcmNoYW50LmNhdGVnb3JpemFibGVfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lcmNoYW50X2lkID0gbWVyY2hhbnQuY2F0ZWdvcml6YWJsZV9pZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIi9hL3Byb2R1Y3RzL1wiICsgJHNjb3BlLmNhdGVnb3J5LnVybCArIFwiP21lcmNoYW50X2lkPVwiICsgbWVyY2hhbnRfaWQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIi9hL21lcmNoYW50L1wiICsgbWVyY2hhbnQuc2x1ZyArIFwiL3Byb2R1Y3RzXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ01lcmNoYW50RGV0YWlsQ3RybCcsIFsnJHNjb3BlJywnJHJvb3RTY29wZScsICdNZXJjaGFudHMnLCAnTW9kYWxzJywgJyRtZERpYWxvZycsJ0NhcnQnLCBmdW5jdGlvbiAoJHNjb3BlLCRyb290U2NvcGUsIE1lcmNoYW50cywgTW9kYWxzLCAkbWREaWFsb2csQ2FydCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudCA9IHt9O1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGEucmVwbGFjZSgvQXBwXFxcXE1vZGVsc1xcXFwvZywgXCJcIik7XG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1wiXCJ7L2csICdcIlxcXCJ7Jyk7XG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL31cIlwiL2csICd9XFxcIlwiJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRhXCIsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudCA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50LmF2YWlsYWJpbGl0aWVzID0gJHNjb3BlLm1lcmNoYW50LmF2YWlsYWJpbGl0aWVzMjtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIkc2NvcGUubWVyY2hhbnRcIiwgJHNjb3BlLm1lcmNoYW50KTtcbiAgICAgICAgICAgICAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3NhcGVhclwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm9va2luZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImF2YWlsYWJpbGl0aWVzXCI6ICRzY29wZS5tZXJjaGFudC5hdmFpbGFiaWxpdGllcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJNZXJjaGFudFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0SWRcIjogJHNjb3BlLm1lcmNoYW50LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib2JqZWN0TmFtZVwiOiAkc2NvcGUubWVyY2hhbnQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdERlc2NyaXB0aW9uXCI6ICRzY29wZS5tZXJjaGFudC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdEljb25cIjogJHNjb3BlLm1lcmNoYW50Lmljb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJleHBlY3RlZFByaWNlXCI6ICRzY29wZS5tZXJjaGFudC51bml0X2Nvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbGVydFwiOlwiI2Jvb2stYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0Jvb2tpbmcocGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJSZWdpc3RyYXRlIG8gaW5ncmVzYSBwYXJhIHJlc2VydmFyXCIsJChcIiNib29rLWJ1dHRvblwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJvb2tpbmdcIik7XG5cbi8vICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0QXBwUG9wdXAoKSkudGhlbihmdW5jdGlvbiAocGxhdGZvcm0pIHtcbi8vICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiXCI7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF0Zm9ybSA9PSBcImlvc1wiKSB7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIlwiXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhdGZvcm0gPT0gJ2FuZHJvaWQnKSB7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcIlwiXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhdGZvcm0gPT0gJ3dlYicpIHtcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IFwiXCJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVybFwiLCBwbGF0Zm9ybSwgdXJsKVxuLy8gICAgICAgICAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsO1xuLy9cbi8vICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4vL1xuLy8gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL21lcmNoYW50c2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 21 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('OrdersCtrl',['$scope', 'Orders', function ($scope, Orders) {\n            $scope.data = {};\n            $scope.orders;\n            $scope.from;\n            $scope.to;\n            $scope.loadMore = true,\n                    $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.buildDatePicker();\n                $scope.getOrders();\n            });\n\n            $scope.buildDatePicker = function () {\n                var dateFormat = \"yy-mm-dd\",\n                        from = $(\"#from\")\n                        .datepicker({\n                            defaultDate: \"-1m\",\n                            changeMonth: true,\n                            numberOfMonths: 2,\n                            dateFormat: dateFormat\n                        })\n                        .on(\"change\", function () {\n                            to.datepicker(\"option\", \"minDate\", $scope.getDate(this));\n                            $scope.from = $scope.getDate(this);\n                        }),\n                        to = $(\"#to\").datepicker({\n                    defaultDate: \"+1w\",\n                    changeMonth: true,\n                    numberOfMonths: 2,\n                    dateFormat: dateFormat\n                })\n                        .on(\"change\", function () {\n                            from.datepicker(\"option\", \"maxDate\", $scope.getDate(this));\n                            $scope.to = $scope.getDate(this);\n                        });\n            }\n            $scope.getDate = function (element) {\n                console.log(\"Get date\",element.value);\n                var date;\n                try {\n                    date = $.datepicker.parseDate(\"yy-mm-dd\", element.value);\n                } catch (error) {\n                    date = null;\n                }\n\n                return date;\n            }\n\n            $scope.buildOrderData = function (order) {\n                var items = order.items;\n                for (item in items) {\n                    items[item].attributes = JSON.parse(items[item].attributes);\n                }\n                order.items = items;\n                return order;\n            }\n\n            $scope.getOrders = function () {\n                $scope.page++;\n                var url = \"includes=orderConditions,items,payments,user&order_by=id,desc&page=\" + $scope.page;\n                Orders.getOrders(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    var ordersCont = data.data;\n                    for (item in ordersCont) {\n                        ordersCont[item] = $scope.buildOrderData(ordersCont[item]);\n                    }\n                    $scope.orders = ordersCont;\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateOrderStatus = function (status, order_id) {\n\n                Orders.updateOrderStatus(status, order_id).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getStoreExport = function () {\n                console.log(\"Date\", $scope.from, $scope.to);\n                Orders.getStoreExport($scope.from, $scope.to).then(function (data) {\n\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.approveOrder = function (order) {\n                Orders.approveOrder(order.id).then(function (data) {\n                    order.status = \"scheduled\";\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9vcmRlcnNjdHJsLmpzPzNkZGUiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ09yZGVyc0N0cmwnLFsnJHNjb3BlJywgJ09yZGVycycsIGZ1bmN0aW9uICgkc2NvcGUsIE9yZGVycykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5vcmRlcnM7XG4gICAgICAgICAgICAkc2NvcGUuZnJvbTtcbiAgICAgICAgICAgICRzY29wZS50bztcbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZERhdGVQaWNrZXIoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0T3JkZXJzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkRGF0ZVBpY2tlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IFwieXktbW0tZGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gPSAkKFwiI2Zyb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRlcGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCItMW1cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNb250aDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZk1vbnRoczogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kYXRlcGlja2VyKFwib3B0aW9uXCIsIFwibWluRGF0ZVwiLCAkc2NvcGUuZ2V0RGF0ZSh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZyb20gPSAkc2NvcGUuZ2V0RGF0ZSh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG8gPSAkKFwiI3RvXCIpLmRhdGVwaWNrZXIoe1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGF0ZTogXCIrMXdcIixcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlTW9udGg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG51bWJlck9mTW9udGhzOiAyLFxuICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbS5kYXRlcGlja2VyKFwib3B0aW9uXCIsIFwibWF4RGF0ZVwiLCAkc2NvcGUuZ2V0RGF0ZSh0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvID0gJHNjb3BlLmdldERhdGUodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXREYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBkYXRlXCIsZWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9ICQuZGF0ZXBpY2tlci5wYXJzZURhdGUoXCJ5eS1tbS1kZFwiLCBlbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkYXRlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkT3JkZXJEYXRhID0gZnVuY3Rpb24gKG9yZGVyKSB7XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW1zID0gb3JkZXIuaXRlbXM7XG4gICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zW2l0ZW1dLmF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKGl0ZW1zW2l0ZW1dLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcmRlci5pdGVtcyA9IGl0ZW1zO1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmdldE9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPW9yZGVyQ29uZGl0aW9ucyxpdGVtcyxwYXltZW50cyx1c2VyJm9yZGVyX2J5PWlkLGRlc2MmcGFnZT1cIiArICRzY29wZS5wYWdlO1xuICAgICAgICAgICAgICAgIE9yZGVycy5nZXRPcmRlcnModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBvcmRlcnNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gb3JkZXJzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJzQ29udFtpdGVtXSA9ICRzY29wZS5idWlsZE9yZGVyRGF0YShvcmRlcnNDb250W2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JkZXJzID0gb3JkZXJzQ29udDtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS51cGRhdGVPcmRlclN0YXR1cyA9IGZ1bmN0aW9uIChzdGF0dXMsIG9yZGVyX2lkKSB7XG5cbiAgICAgICAgICAgICAgICBPcmRlcnMudXBkYXRlT3JkZXJTdGF0dXMoc3RhdHVzLCBvcmRlcl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmdldFN0b3JlRXhwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZVwiLCAkc2NvcGUuZnJvbSwgJHNjb3BlLnRvKTtcbiAgICAgICAgICAgICAgICBPcmRlcnMuZ2V0U3RvcmVFeHBvcnQoJHNjb3BlLmZyb20sICRzY29wZS50bykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmFwcHJvdmVPcmRlciA9IGZ1bmN0aW9uIChvcmRlcikge1xuICAgICAgICAgICAgICAgIE9yZGVycy5hcHByb3ZlT3JkZXIob3JkZXIuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXIuc3RhdHVzID0gXCJzY2hlZHVsZWRcIjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvb3JkZXJzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 22 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n\r\n        .controller('PaymentsCtrl', ['$scope', 'Payments', 'Merchants', function ($scope, Payments, Merchants) {\r\n                $scope.data = {};\r\n                $scope.payments;\r\n                $scope.loadMore = true,\r\n                        $scope.page = 0;\r\n                $scope.regionVisible = false;\r\n                $scope.editPayment = false;\r\n                angular.element(document).ready(function () {\r\n                    $scope.getPayments();\r\n                });\r\n\r\n                $scope.getPayments = function () {\r\n                    $scope.page++;\r\n                    var url = \"includes=order,user&order_by=id,desc&page=\" + $scope.page;\r\n                    Payments.getPayments(url).then(function (data) {\r\n                        if (data.page == data.last_page) {\r\n                            $scope.loadMore = false;\r\n                        }\r\n                        $scope.payments = data.data;\r\n\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n                $scope.approvePayment = function (payment) {\r\n                    Payments.approvePayment(payment.id).then(function (data) {\r\n                        payment.status = \"approved\";\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n            }]).controller('PaymentsUserCtrl', ['$scope', 'Payments', function ($scope, Payments) {\r\n        $scope.data = {};\r\n        $scope.payments;\r\n        $scope.loadMore = true,\r\n                $scope.page = 0;\r\n        $scope.regionVisible = false;\r\n        $scope.editPayment = false;\r\n        angular.element(document).ready(function () {\r\n            $scope.getPayments();\r\n        });\r\n\r\n        $scope.getPayments = function () {\r\n            $scope.page++;\r\n            var url = \"includes=order,user&order_by=id,desc&page=\" + $scope.page;\r\n            Payments.getPaymentsUser(url).then(function (data) {\r\n                if (data.page == data.last_page) {\r\n                    $scope.loadMore = false;\r\n                }\r\n                $scope.payments = data.data;\r\n\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n    }]).controller('PaymentsMerchantCtrl', ['$scope', 'Orders', 'Merchants', function ($scope, Orders, Merchants) {\r\n        $scope.data = {};\r\n        $scope.orders = [];\r\n        $scope.merchants = [];\r\n        $scope.merchant_id;\r\n        $scope.loadMore = true,\r\n                $scope.page = 0;\r\n        $scope.regionVisible = false;\r\n        $scope.editPayment = false;\r\n        $scope.status = \"pending\";\r\n        angular.element(document).ready(function () {\r\n            $scope.getMerchants();\r\n        });\r\n\r\n        $scope.getOrders = function (merchant) {\r\n            $scope.page++;\r\n            var url = \"includes=items,orderAddresses,orderConditions,user&order_by=id,asc&page=\" + $scope.page + \"&merchant_id=\" + merchant + \"&execution_status=\" + $scope.status;\r\n            Orders.getOrders(url).then(function (data) {\r\n                if (data.page == data.last_page) {\r\n                    $scope.loadMore = false;\r\n                }\r\n                $scope.orders = $scope.orders.concat(data.data);\r\n\r\n            },\r\n                    function (data) { \r\n\r\n                    });\r\n        }\r\n        $scope.loadMoreOrders = function () {\r\n            $scope.getOrders($scope.merchant_id);\r\n        }\r\n        $scope.selectMerchant = function () {\r\n            $scope.orders = [];\r\n            $scope.page = 0;\r\n            $scope.getOrders($scope.merchant_id);\r\n        }\r\n        $scope.getMerchants = function () {\r\n            Merchants.getMerchantsUser().then(function (data) {\r\n                if (data.status == \"success\") {\r\n                    $scope.merchants = data.data;\r\n                    if ($scope.orders.length == 0 && $scope.merchants.length > 0) {\r\n                        $scope.getOrders($scope.merchants[0].id);\r\n                    }\r\n                }\r\n\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n        $scope.fullfillOrder = function (order) {\r\n            var itemsArr = [];\r\n            for (var item in order.items) {\r\n                itemsArr.push(order.items[item].id);\r\n            }\r\n            var container = {\r\n                order_id: order.id,\r\n                items: itemsArr,\r\n                status:\"fullfill\"\r\n            }\r\n            Orders.fullfillOrder(container).then(function (data) {\r\n                if (data.status == \"success\") {\r\n                    order.execution_status = \"completed\";\r\n                    for (var item in order.items) {\r\n                        order.items[item].fulfillment = \"fulfilled\"; \r\n                    }\r\n                }\r\n\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n    }]).controller('PaymentsUserCtrl', ['$scope', 'Payments', function ($scope, Payments) {\r\n        $scope.data = {};\r\n        $scope.payments;\r\n        $scope.loadMore = true,\r\n                $scope.page = 0;\r\n        $scope.regionVisible = false;\r\n        $scope.editPayment = false;\r\n        angular.element(document).ready(function () {\r\n            $scope.getPayments();\r\n        });\r\n\r\n        $scope.getPayments = function () {\r\n            $scope.page++;\r\n            var url = \"includes=order,user&order_by=id,desc&page=\" + $scope.page;\r\n            Payments.getPaymentsUser(url).then(function (data) {\r\n                if (data.page == data.last_page) {\r\n                    $scope.loadMore = false;\r\n                }\r\n                $scope.payments = data.data;\r\n\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n    }]).controller('PaymentDetailCtrl', ['$scope', 'Payments', '$rootScope','LocationService', function ($scope, Payments, $rootScope,LocationService) {\r\n        $scope.data = {};\r\n        $scope.payment = {};\r\n        $scope.hasTransactionCost = false;\r\n        angular.element(document).ready(function () {\r\n            $scope.getPayments();\r\n        });\r\n        $rootScope.$on('removeTransactionCost', function (event, args) {\r\n                    $scope.hasTransactionCost = false;\r\n                });\r\n                $rootScope.$on('addTransactionCost', function (event, args) {\r\n                    $scope.hasTransactionCost = true;\r\n\r\n                });\r\n\r\n        $scope.getPayments = function () {\r\n            $scope.page++;\r\n            var url = window.location.href;\r\n            var segments = url.split(\"/\");\r\n            console.log(\"Payment id\", segments[segments.length - 1])\r\n            var url2 = \"id=\" + segments[segments.length - 1] + \"&includes=order.items,order.orderConditions,order.orderAddresses\";\r\n            Payments.getPaymentsUser(url2).then(function (data) {\r\n                if (data.total > 0) {\r\n                    var results = data.data;\r\n                    $scope.payment = results[0];\r\n                    for(var item in $scope.payment.order.items){\r\n                        $scope.payment.order.items[item].attributes = JSON.parse($scope.payment.order.items[item].attributes);\r\n                    }\r\n                    console.log(\"Payment\",$scope.payment);\r\n                    if($scope.payment.transaction_cost>0){\r\n                        $scope.hasTransactionCost = true;\r\n                    }\r\n                    $rootScope.activeOrder = $scope.payment.order;\r\n                    LocationService.getRegion($rootScope.activeOrder.order_addresses[0].region_id).then(function (data) {\r\n                        if(data.total && data.total == 1){\r\n                            console.log(\"Response\",data);\r\n                            $rootScope.activeOrder.order_addresses[0].regionName = data.data[0].name;\r\n                        }\r\n                    },\r\n                    function (data) {\r\n\r\n                    });\r\n                    LocationService.getCity($rootScope.activeOrder.order_addresses[0].city_id).then(function (data) {\r\n                        if(data.total && data.total == 1){\r\n                            console.log(\"Response\",data);\r\n                            $rootScope.activeOrder.order_addresses[0].cityName = data.data[0].name;\r\n                        }\r\n                    },\r\n                    function (data) {\r\n\r\n                    });\r\n                    LocationService.getCountry($rootScope.activeOrder.order_addresses[0].country_id).then(function (data) {\r\n                        if(data.total && data.total == 1){\r\n                            console.log(\"Response\",data);\r\n                            $rootScope.activeOrder.order_addresses[0].countryCode = data.data[0].code;\r\n                        }\r\n                    },\r\n                    function (data) {\r\n\r\n                    });\r\n                }\r\n\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n        $scope.addTransactionCosts = function () {\r\n            Payments.addTransactionCosts($scope.payment.id).then(function (data) {\r\n                if (data.status == \"success\") {\r\n                    console.log(\"after addTransactionCosts\");\r\n                    $scope.payment = data.payment;\r\n                } else {\r\n                    this.api.toast('PAYMENTS.ERROR_CHANGE');\r\n                }\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n        $scope.retryPayment = function () {\r\n            Payments.retryPayment($scope.payment.id).then(function (data) {\r\n                console.log(\"after addTransactionCosts\", data);\r\n                if (data.status == \"success\") {\r\n\r\n                    $rootScope.activePayment = data.payment;\r\n                    $rootScope.paymentActive = true;\r\n                } else {\r\n                    this.api.toast('PAYMENTS.ERROR_CHANGE');\r\n                }\r\n            },\r\n                    function (data) {\r\n\r\n                    });\r\n        }\r\n\r\n    }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9wYXltZW50c2N0cmwuanM/OWJkNSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcclxuXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1BheW1lbnRzQ3RybCcsIFsnJHNjb3BlJywgJ1BheW1lbnRzJywgJ01lcmNoYW50cycsIGZ1bmN0aW9uICgkc2NvcGUsIFBheW1lbnRzLCBNZXJjaGFudHMpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGF5bWVudHM7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRQYXltZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0UGF5bWVudHMoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRQYXltZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPW9yZGVyLHVzZXImb3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgUGF5bWVudHMuZ2V0UGF5bWVudHModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXltZW50cyA9IGRhdGEuZGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFwcHJvdmVQYXltZW50ID0gZnVuY3Rpb24gKHBheW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBQYXltZW50cy5hcHByb3ZlUGF5bWVudChwYXltZW50LmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnQuc3RhdHVzID0gXCJhcHByb3ZlZFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfV0pLmNvbnRyb2xsZXIoJ1BheW1lbnRzVXNlckN0cmwnLCBbJyRzY29wZScsICdQYXltZW50cycsIGZ1bmN0aW9uICgkc2NvcGUsIFBheW1lbnRzKSB7XHJcbiAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcclxuICAgICAgICAkc2NvcGUucGF5bWVudHM7XHJcbiAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gdHJ1ZSxcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcclxuICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5lZGl0UGF5bWVudCA9IGZhbHNlO1xyXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZ2V0UGF5bWVudHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldFBheW1lbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gXCJpbmNsdWRlcz1vcmRlcix1c2VyJm9yZGVyX2J5PWlkLGRlc2MmcGFnZT1cIiArICRzY29wZS5wYWdlO1xyXG4gICAgICAgICAgICBQYXltZW50cy5nZXRQYXltZW50c1VzZXIodXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGF5bWVudHMgPSBkYXRhLmRhdGE7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XSkuY29udHJvbGxlcignUGF5bWVudHNNZXJjaGFudEN0cmwnLCBbJyRzY29wZScsICdPcmRlcnMnLCAnTWVyY2hhbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgT3JkZXJzLCBNZXJjaGFudHMpIHtcclxuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICRzY29wZS5vcmRlcnMgPSBbXTtcclxuICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gW107XHJcbiAgICAgICAgJHNjb3BlLm1lcmNoYW50X2lkO1xyXG4gICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XHJcbiAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuZWRpdFBheW1lbnQgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuc3RhdHVzID0gXCJwZW5kaW5nXCI7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5nZXRNZXJjaGFudHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldE9yZGVycyA9IGZ1bmN0aW9uIChtZXJjaGFudCkge1xyXG4gICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gXCJpbmNsdWRlcz1pdGVtcyxvcmRlckFkZHJlc3NlcyxvcmRlckNvbmRpdGlvbnMsdXNlciZvcmRlcl9ieT1pZCxhc2MmcGFnZT1cIiArICRzY29wZS5wYWdlICsgXCImbWVyY2hhbnRfaWQ9XCIgKyBtZXJjaGFudCArIFwiJmV4ZWN1dGlvbl9zdGF0dXM9XCIgKyAkc2NvcGUuc3RhdHVzO1xyXG4gICAgICAgICAgICBPcmRlcnMuZ2V0T3JkZXJzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA9PSBkYXRhLmxhc3RfcGFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVycyA9ICRzY29wZS5vcmRlcnMuY29uY2F0KGRhdGEuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7IFxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJHNjb3BlLmxvYWRNb3JlT3JkZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZ2V0T3JkZXJzKCRzY29wZS5tZXJjaGFudF9pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICRzY29wZS5zZWxlY3RNZXJjaGFudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLm9yZGVycyA9IFtdO1xyXG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XHJcbiAgICAgICAgICAgICRzY29wZS5nZXRPcmRlcnMoJHNjb3BlLm1lcmNoYW50X2lkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJHNjb3BlLmdldE1lcmNoYW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgTWVyY2hhbnRzLmdldE1lcmNoYW50c1VzZXIoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUub3JkZXJzLmxlbmd0aCA9PSAwICYmICRzY29wZS5tZXJjaGFudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0T3JkZXJzKCRzY29wZS5tZXJjaGFudHNbMF0uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuZnVsbGZpbGxPcmRlciA9IGZ1bmN0aW9uIChvcmRlcikge1xyXG4gICAgICAgICAgICBsZXQgaXRlbXNBcnIgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiBvcmRlci5pdGVtcykge1xyXG4gICAgICAgICAgICAgICAgaXRlbXNBcnIucHVzaChvcmRlci5pdGVtc1tpdGVtXS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgIG9yZGVyX2lkOiBvcmRlci5pZCxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBpdGVtc0FycixcclxuICAgICAgICAgICAgICAgIHN0YXR1czpcImZ1bGxmaWxsXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBPcmRlcnMuZnVsbGZpbGxPcmRlcihjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLmV4ZWN1dGlvbl9zdGF0dXMgPSBcImNvbXBsZXRlZFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gb3JkZXIuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuaXRlbXNbaXRlbV0uZnVsZmlsbG1lbnQgPSBcImZ1bGZpbGxlZFwiOyBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XSkuY29udHJvbGxlcignUGF5bWVudHNVc2VyQ3RybCcsIFsnJHNjb3BlJywgJ1BheW1lbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgUGF5bWVudHMpIHtcclxuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICRzY29wZS5wYXltZW50cztcclxuICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xyXG4gICAgICAgICRzY29wZS5yZWdpb25WaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLmVkaXRQYXltZW50ID0gZmFsc2U7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5nZXRQYXltZW50cygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuZ2V0UGF5bWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wYWdlKys7XHJcbiAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPW9yZGVyLHVzZXImb3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2U7XHJcbiAgICAgICAgICAgIFBheW1lbnRzLmdldFBheW1lbnRzVXNlcih1cmwpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gZGF0YS5sYXN0X3BhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXltZW50cyA9IGRhdGEuZGF0YTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1dKS5jb250cm9sbGVyKCdQYXltZW50RGV0YWlsQ3RybCcsIFsnJHNjb3BlJywgJ1BheW1lbnRzJywgJyRyb290U2NvcGUnLCdMb2NhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCBQYXltZW50cywgJHJvb3RTY29wZSxMb2NhdGlvblNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xyXG4gICAgICAgICRzY29wZS5wYXltZW50ID0ge307XHJcbiAgICAgICAgJHNjb3BlLmhhc1RyYW5zYWN0aW9uQ29zdCA9IGZhbHNlO1xyXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZ2V0UGF5bWVudHMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkcm9vdFNjb3BlLiRvbigncmVtb3ZlVHJhbnNhY3Rpb25Db3N0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhhc1RyYW5zYWN0aW9uQ29zdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignYWRkVHJhbnNhY3Rpb25Db3N0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhhc1RyYW5zYWN0aW9uQ29zdCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRQYXltZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcclxuICAgICAgICAgICAgbGV0IHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gICAgICAgICAgICBsZXQgc2VnbWVudHMgPSB1cmwuc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBheW1lbnQgaWRcIiwgc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0gMV0pXHJcbiAgICAgICAgICAgIGxldCB1cmwyID0gXCJpZD1cIiArIHNlZ21lbnRzW3NlZ21lbnRzLmxlbmd0aCAtIDFdICsgXCImaW5jbHVkZXM9b3JkZXIuaXRlbXMsb3JkZXIub3JkZXJDb25kaXRpb25zLG9yZGVyLm9yZGVyQWRkcmVzc2VzXCI7XHJcbiAgICAgICAgICAgIFBheW1lbnRzLmdldFBheW1lbnRzVXNlcih1cmwyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS50b3RhbCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGF5bWVudCA9IHJlc3VsdHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpdGVtIGluICRzY29wZS5wYXltZW50Lm9yZGVyLml0ZW1zKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBheW1lbnQub3JkZXIuaXRlbXNbaXRlbV0uYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoJHNjb3BlLnBheW1lbnQub3JkZXIuaXRlbXNbaXRlbV0uYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUGF5bWVudFwiLCRzY29wZS5wYXltZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUucGF5bWVudC50cmFuc2FjdGlvbl9jb3N0PjApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzVHJhbnNhY3Rpb25Db3N0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPcmRlciA9ICRzY29wZS5wYXltZW50Lm9yZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRSZWdpb24oJHJvb3RTY29wZS5hY3RpdmVPcmRlci5vcmRlcl9hZGRyZXNzZXNbMF0ucmVnaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudG90YWwgJiYgZGF0YS50b3RhbCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uc2VcIixkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT3JkZXIub3JkZXJfYWRkcmVzc2VzWzBdLnJlZ2lvbk5hbWUgPSBkYXRhLmRhdGFbMF0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENpdHkoJHJvb3RTY29wZS5hY3RpdmVPcmRlci5vcmRlcl9hZGRyZXNzZXNbMF0uY2l0eV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnRvdGFsICYmIGRhdGEudG90YWwgPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BvbnNlXCIsZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyLm9yZGVyX2FkZHJlc3Nlc1swXS5jaXR5TmFtZSA9IGRhdGEuZGF0YVswXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0Q291bnRyeSgkcm9vdFNjb3BlLmFjdGl2ZU9yZGVyLm9yZGVyX2FkZHJlc3Nlc1swXS5jb3VudHJ5X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudG90YWwgJiYgZGF0YS50b3RhbCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcG9uc2VcIixkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT3JkZXIub3JkZXJfYWRkcmVzc2VzWzBdLmNvdW50cnlDb2RlID0gZGF0YS5kYXRhWzBdLmNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5hZGRUcmFuc2FjdGlvbkNvc3RzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBQYXltZW50cy5hZGRUcmFuc2FjdGlvbkNvc3RzKCRzY29wZS5wYXltZW50LmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFmdGVyIGFkZFRyYW5zYWN0aW9uQ29zdHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBheW1lbnQgPSBkYXRhLnBheW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpLnRvYXN0KCdQQVlNRU5UUy5FUlJPUl9DSEFOR0UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5yZXRyeVBheW1lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIFBheW1lbnRzLnJldHJ5UGF5bWVudCgkc2NvcGUucGF5bWVudC5pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJhZnRlciBhZGRUcmFuc2FjdGlvbkNvc3RzXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlUGF5bWVudCA9IGRhdGEucGF5bWVudDtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBheW1lbnRBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwaS50b2FzdCgnUEFZTUVOVFMuRVJST1JfQ0hBTkdFJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL3BheW1lbnRzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 23 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n        .controller('ProductsCtrl', ['$scope', 'Cart', '$rootScope', '$sce', 'Products', 'Modals', function ($scope, Cart, $rootScope, $sce, Products, Modals) {\r\n                $scope.categories = [];\r\n                $scope.prodIds = [];\r\n                $scope.hasLocation = false;\r\n                $scope.hasMerchant = false;\r\n                $scope.isSearch = false;\r\n                $scope.merchantObj = {};\r\n                $scope.current = 1;\r\n                $scope.last = 1;\r\n                $scope.range;\r\n                $scope.params = {}\r\n                $scope.per_page = 1\r\n                $scope.category_id = null;\r\n                $scope.total = 1;\r\n                $scope.local_total = 0;\r\n\r\n                angular.element(document).ready(function () {\r\n                    $scope.clean();\r\n\r\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\r\n                    console.log(\"viewData\", res);\r\n                    var container = JSON.parse(res);\r\n                    $scope.$apply(function () {\r\n                        $scope.buildProductsFromWhole(container);\r\n                    });\r\n                    console.log($scope.categories);\r\n                    document.getElementById(\"dissapear\").remove();\r\n                    var params = Modals.getAllUrlParams();\r\n                    console.log(\"Params\", params)\r\n                    if (params) {\r\n\r\n                    } else {\r\n                        params = {};\r\n                    }\r\n                    $scope.params = params;\r\n                    $scope.params.includes = \"files,merchant\";\r\n\r\n                    if ($scope.category_id) {\r\n                        $scope.params.category_id = $scope.category_id;\r\n                    }\r\n                    var url = window.location.href;\r\n                    if (url.includes(\"search\")) {\r\n                        $scope.isSearch = true;\r\n                    }\r\n                });\r\n                $rootScope.$on('loadCartVariants', function (event, args) {\r\n                    $scope.updateProductsCart(args, false);\r\n                    if ($rootScope.user) {\r\n                        $scope.checkFavorites();\r\n                    }\r\n                });\r\n                $rootScope.$on('clearCart', function (event, args) {\r\n                    console.log(\"Cart cleared resetting items\")\r\n                    $scope.cartCleared();\r\n\r\n                });\r\n                $rootScope.$on('deleteItem', function (event, args) {\r\n                    console.log(\"item removed resetting items: \", args)\r\n                    $scope.cartDeletedItem(args);\r\n                });\r\n                $scope.clean = function () {\r\n\r\n                }\r\n                $scope.changeStore = function () {\r\n                    Cart.changeMerchant()\r\n                }\r\n                $scope.addModal = function (product) {\r\n                    $rootScope.modalProd = product;\r\n                }\r\n                $scope.addCatFilter = function (category) {\r\n                    $scope.params.category_id = category;\r\n                    $scope.goTo(1);\r\n                }\r\n                $scope.buildProductsFromWhole = function (container) {\r\n                    $scope.categories = container.categories;\r\n                    $scope.current = container.page;\r\n                    $scope.last = container.last_page;\r\n                    $scope.current = container.page;\r\n                    $scope.per_page = container.per_page;\r\n                    $scope.total = container.total;\r\n                    if (container.category) {\r\n                        $scope.category_id = container.category.id;\r\n                    }\r\n\r\n                    console.log($scope.categories);\r\n                    for (var item in $scope.categories) {\r\n                        for (var k in $scope.categories[item].products) {\r\n                            $scope.prodIds.push($scope.categories[item].products[k].id);\r\n\r\n                            if (!$rootScope.merchant_id && $scope.categories[0].products[0].merchant_id) {\r\n                                $rootScope.merchant_id = $scope.categories[0].products[0].merchant_id;\r\n                            }\r\n                            if (!$scope.categories[item].products[k].merchant_id && $scope.categories[item].products[k].merchants.length > 0) {\r\n                                $scope.categories[item].products[k].merchant_id = $scope.categories[item].products[k].merchants[0].id\r\n                            }\r\n                            $scope.local_total++;\r\n                            if ($scope.categories[item].products[k].files && $scope.categories[item].products[k].files.length > 0) {\r\n                                $scope.categories[item].products[k].imgs = $scope.categories[item].products[k].files;\r\n                            }\r\n                            if ($scope.categories[item].products[k].imgs && $scope.categories[item].products[k].imgs.length > 0) {\r\n                                $scope.categories[item].products[k].src = $scope.categories[item].products[k].imgs[0].file;\r\n                            }\r\n                            $scope.categories[item].products[k].description = $sce.trustAsHtml($scope.categories[item].products[k].description);\r\n                            $scope.categories[item].products[k].activeVariant = $scope.categories[item].products[k].variants[0];\r\n                            $scope.categories[item].products[k].variant_id = $scope.categories[item].products[k].variants[0].id;\r\n                            $scope.categories[item].products[k].quantity = $scope.categories[item].products[k].variants[0].min_quantity;\r\n                            $scope.categories[item].products[k].item_id = null;\r\n                            $scope.categories[item].products[k].isFavorite = false;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.buildProducts = function (resp) {\r\n                    $scope.categories = Products.buildProductInformation(resp);\r\n                    console.log(\"Result build product\", $scope.categories);\r\n                    var attributes = $scope.categories[0].products[0].merchant_attributes;\r\n                    if (typeof attributes == \"string\") {\r\n                        attributes = JSON.parse(attributes);\r\n                    }\r\n\r\n                    if (attributes.store_active) {\r\n                        if (attributes.store_active == 1) {\r\n                            $scope.storeActive = true;\r\n                        }\r\n                    }\r\n                    $scope.merchantObj.merchant_name = $scope.categories[0].products[0].merchant_name;\r\n                    $scope.merchantObj.merchant_description = $scope.categories[0].products[0].merchant_description;\r\n                    $scope.merchantObj.src = $scope.categories[0].products[0].src;\r\n\r\n                    //this.openTutorials();  \r\n                    $scope.merchantObj.merchant_type = $scope.categories[0].products[0].merchant_type;\r\n                    if ($scope.categories.length > 0) {\r\n                        $scope.categories[0].more = true;\r\n                        if ($scope.categories[0].products.length > 0) {\r\n                            $scope.categories[0].products[0].more = true;\r\n                        }\r\n                        if ($scope.categories[0].products.length > 1) {\r\n                            $scope.categories[0].products[1].more = true;\r\n                        }\r\n                    }\r\n                    $scope.current = parseInt(resp.page);\r\n                    $scope.prodIds = [];\r\n                    $scope.last = parseInt(resp.last_page);\r\n                    $scope.current = parseInt(resp.page);\r\n                    $scope.per_page = parseInt(resp.per_page);\r\n                    $scope.total = parseInt(resp.total);\r\n                    $scope.local_total = 0;\r\n                    for (var item in $scope.categories) {\r\n                        for (var k in $scope.categories[item].products) {\r\n                            $scope.local_total++;\r\n                            $scope.prodIds.push($scope.categories[item].products[k].id);\r\n                            $scope.categories[item].products[k].description = $sce.trustAsHtml($scope.categories[item].products[k].description);\r\n                            $scope.categories[item].products[k].activeVariant = $scope.categories[item].products[k].variants[0];\r\n                            $scope.categories[item].products[k].variant_id = $scope.categories[item].products[k].variants[0].id;\r\n                            $scope.categories[item].products[k].quantity = $scope.categories[item].products[k].variants[0].min_quantity;\r\n                            $scope.categories[item].products[k].item_id = null;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.filterPrice = function () {\r\n                    console.log(\"Filtering\", $(\"#amount\").val())\r\n                    var str = $(\"#amount\").val();\r\n                    str = str.replace(\"$\", \"\");\r\n                    str = str.replace(\"$\", \"\");\r\n                    console.log(\"Filtering\", str)\r\n                    var res = str.split(\"-\");\r\n                    console.log(\"Filtering\", res)\r\n                    $scope.params.high = parseInt(res[1].trim());\r\n                    $scope.params.low = parseInt(res[0].trim());\r\n                    $scope.goTo(1);\r\n                }\r\n                $scope.goTo = function (page) {\r\n                    $scope.params.page = page;\r\n                    if ($rootScope.merchant_id) {\r\n                        $scope.params.merchant_id = $rootScope.merchant_id;\r\n                    }\r\n                    Modals.showLoader();\r\n                    $scope.categories = [];\r\n                    if ($scope.isSearch) {\r\n                        Products.searchProducts($scope.params).then(function (resp) {\r\n                            console.log(\"params\", $scope.params);\r\n                            console.log(\"response\", resp);\r\n                            if (resp.total > 0) {\r\n                                $scope.buildProductsFromWhole(resp);\r\n\r\n                                //this.createSlides();\r\n                            }\r\n                            Modals.hideLoader();\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    } else {\r\n                        Products.getProductsMerchant($scope.params).then(function (resp) {\r\n                            console.log(\"params\", $scope.params);\r\n                            console.log(\"response\", resp);\r\n                            if (resp.products_total > 0) {\r\n                                $scope.buildProducts(resp);\r\n\r\n                                //this.createSlides();\r\n                            }\r\n                            Modals.hideLoader();\r\n                        },\r\n                                function (data) {\r\n\r\n                                });\r\n                    }\r\n\r\n                }\r\n                $scope.selectVariant = function (product) {\r\n                    for (var item in product.variants) {\r\n                        if (product.variant_id == product.variants[item].id) {\r\n                            product.activeVariant = product.variants[item];\r\n                        }\r\n                    }\r\n                }\r\n                $scope.addCartItem = function (product) {\r\n                    var container = {\r\n                        id: product.activeVariant.id,\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        product: product,\r\n                        type: product.type\r\n                    }\r\n                    if((product.activeVariant.is_on_sale && product.activeVariant.sale <1)||(!product.activeVariant.is_on_sale && product.activeVariant.price <1)){\r\n                        Modals.showToast(\"Ese producto no esta a la venta\", $(\"#prod-cont-\" + product.id));\r\n                        return true;\r\n                    }\r\n                    Cart.addCartItem(container, []).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                            product.item_id = data.item.id;\r\n                            product.quantity = data.item.quantity;\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.checkFavorites = function () {\r\n                    var container = {\r\n                        product_ids: $scope.prodIds\r\n                    }\r\n                    Products.checkFavorite(container).then(function (data) {\r\n                        console.log(\"checkFavorites res\", data);\r\n                        if (data.status == \"success\") {\r\n                            var results = data.data;\r\n                            for (var k in results) {\r\n                                for (var i in $scope.categories) {\r\n                                    for (var j in $scope.categories[i].products) {\r\n                                        if ($scope.categories[i].products[j].id == results[k].favoritable_id) {\r\n                                            $scope.categories[i].products[j].isFavorite = true;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.addFavorite = function (product) {\r\n                    if ($rootScope.user) {\r\n                        var container = {\r\n                            object_id: product.id,\r\n                            type: \"Product\"\r\n                        }\r\n                        Products.addFavorite(container).then(function (data) {\r\n                            console.log(\"Add addFavorite\", data);\r\n                            if (data.status == \"success\") {\r\n                                product.isFavorite = true;\r\n                                Modals.showToast(\"Agregado\", $(\"#prod-cont-\" + product.id));\r\n                            } else {\r\n                                Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                            }\r\n                        },\r\n                                function (data) {\r\n                                });\r\n                    } else {\r\n                        Modals.showToast(\"Debes estar logueado para guardar productos\", $(\"#prod-cont-\" + product.id));\r\n                    }\r\n\r\n                }\r\n                $scope.deleteFavorite = function (product) {\r\n                    var container = {\r\n                        object_id: product.id,\r\n                        type: \"Product\"\r\n                    }\r\n                    Products.deleteFavorite(container).then(function (data) {\r\n                        console.log(\"Add addFavorite\", data);\r\n                        if (data.status == \"success\") {\r\n                            product.isFavorite = false;\r\n                            Modals.showToast(\"Removido\", $(\"#prod-cont-\" + product.id));\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n                $scope.cartCleared = function () {\r\n                    for (var i in $scope.categories) {\r\n                        for (var j in $scope.categories[i].products) {\r\n                            $scope.categories[i].products[j].item_id = null;\r\n                        }\r\n                    }\r\n                }\r\n                $scope.cartDeletedItem = function (item_id) {\r\n                    for (var i in $scope.categories) {\r\n                        for (var j in $scope.categories[i].products) {\r\n                            if ($scope.categories[i].products[j].item_id == item_id) {\r\n                                $scope.categories[i].products[j].item_id = null;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                $scope.updateProductsCart = function (cart, total) {\r\n                    cart:\r\n                            for (var m in cart.items) {\r\n                        for (var i in $scope.categories) {\r\n                            for (var j in $scope.categories[i].products) {\r\n                                $scope.categories[i].products[j].item_id = null;\r\n                                for (var k in $scope.categories[i].products[j].variants) {\r\n                                    var container = cart.items[m];\r\n                                    var variant = $scope.categories[i].products[j].variants[k];\r\n                                    if (container.attributes.product_variant_id == variant.id) {\r\n                                        $scope.categories[i].products[j].item_id = container.id;\r\n                                        $scope.categories[i].products[j].quantity = container.quantity;\r\n                                        if (total) {\r\n                                            continue cart;\r\n                                        }\r\n\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n                $scope.changeCartQuantity = function (product, change) {\r\n                    if (change == \"+\") {\r\n                        product.quantity++;\r\n                    } else {\r\n                        product.quantity--;\r\n                    }\r\n                    var container = {\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            Modals.showToast(\"Error Actualizando\", $(\"#prod-cont-\" + product.id));\r\n                            alert(data.message);\r\n                        } else {\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n            }])\r\n        .controller('ProductDetailCtrl', ['$scope', 'Cart', '$rootScope', '$sce', 'Products', '$mdDialog', 'Modals', function ($scope, Cart, $rootScope, $sce, Products, $mdDialog, Modals) {\r\n                $scope.hasLocation = false;\r\n                $scope.hasMerchant = false;\r\n                $scope.product = {};\r\n                $scope.related_products = [];\r\n                $scope.category_id = null;\r\n                $scope.rating = {};\r\n\r\n                angular.element(document).ready(function () {\r\n                    $scope.clean();\r\n\r\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\r\n                    console.log(\"viewData\", res);\r\n                    var container = JSON.parse(res);\r\n                    console.log(\"Data\", container);\r\n                    $scope.product = container.product;\r\n                    $scope.related_products = container.related_products[0].products;\r\n                    for (var i in $scope.related_products) {\r\n                        var activeVariant = $scope.related_products[i].variants[0];\r\n                        for (var j in $scope.related_products[i].variants) {\r\n                            if ($scope.related_products[i].variants[j].is_on_sale && activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].sale < activeVariant.sale) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            } else if (!$scope.related_products[i].variants[j].is_on_sale && activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].price < activeVariant.sale) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            } else if (!$scope.related_products[i].variants[j].is_on_sale && !activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].price < activeVariant.price) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            } else if ($scope.related_products[i].variants[j].is_on_sale && !activeVariant.is_on_sale) {\r\n                                if ($scope.related_products[i].variants[j].sale < activeVariant.price) {\r\n                                    activeVariant = $scope.related_products[i].variants[j]\r\n                                }\r\n                            }\r\n                        }\r\n                        $scope.related_products[i].activeVariant = activeVariant;\r\n                        $scope.related_products[i].variant_id = activeVariant.id;\r\n                    }\r\n                    $scope.rating.type = \"Product\";\r\n                    $scope.rating.object_id = $scope.product.id;\r\n                    $scope.rating.rating = '5';\r\n                    $scope.product.variants = $scope.product.product_variants;\r\n                    $scope.product.activeVariant = $scope.product.variants[0];\r\n                    $scope.product.quantity = $scope.product.activeVariant.min_quantity;\r\n                    $scope.product.variant_id = $scope.product.variants[0].id;\r\n                    $scope.product.merchant_id = $rootScope.merchant_id;\r\n                    $scope.product.type = $scope.product.variants[0].type;\r\n                    $scope.product.description = $sce.trustAsHtml($scope.product.description);\r\n                    document.getElementById(\"dissapear\").remove();\r\n                });\r\n                $rootScope.$on('loadCartVariants', function (event, args) {\r\n                    $scope.updateProductsCart(args, false);\r\n                });\r\n                $scope.clean = function () {\r\n                }\r\n                $scope.selectVariant = function (product) {\r\n                    for (var item in product.variants) {\r\n                        if (product.variant_id == product.variants[item].id) {\r\n                            product.activeVariant = product.variants[item];\r\n                        }\r\n                    }\r\n                }\r\n                $scope.addCartItem = function (product) {\r\n                    var container = {\r\n                        id: product.activeVariant.id,\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        product: product,\r\n                        type: product.type\r\n                    }\r\n                    if((product.activeVariant.is_on_sale && product.activeVariant.sale <1)||(!product.activeVariant.is_on_sale && product.activeVariant.price <1)){\r\n                        Modals.showToast(\"Ese producto no esta a la venta\", $(\"#prod-cont-\" + product.id));\r\n                        return true;\r\n                    }\r\n                    Cart.addCartItem(container, []).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            product.item_id = data.item.id;\r\n                            product.quantity = data.item.quantity;\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#add-cart-form\"));\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#add-cart-form\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.addRating = function () {\r\n                    console.log(\"Rating\", $scope.rating);\r\n                    if (!$rootScope.user) {\r\n                        console.log(\"Debes estar loguedo para comentar\");\r\n                        Modals.showToast(\"Debes estar loguedo para comentar\", $(\"#toast-container\"));\r\n                        return;\r\n                    }\r\n                    if ($scope.rating.rating.length > 0) {\r\n                        Modals.showToast(\"Agrega una calificacion\", $(\"#toast-container\"));\r\n                        return;\r\n                    }\r\n                    if ($scope.rating.comment.length > 0) {\r\n                        Modals.showToast(\"Agrega una observacion a tu calificacion\", $(\"#toast-container\"));\r\n                        return;\r\n                    }\r\n                    Products.addRating($scope.rating).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            Modals.showToast(\"Mensaje enviado. Si vuelves a enviar se anula el anterior\", $(\"#toast-container\"))\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#toast-container\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n                $scope.updateProductsCart = function (cart, total) {\r\n                    var products = $scope.related_products;\r\n                    for (var m in cart.items) {\r\n                        for (var j in products) {\r\n                            for (var k in products[j].variants) {\r\n                                var container = cart.items[m];\r\n                                var variant = products[j].variants[k];\r\n                                if (container.attributes.product_variant_id == variant.id) {\r\n                                    products[j].item_id = container.id;\r\n                                    products[j].quantity = container.quantity;\r\n                                    if (total) {\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $scope.changeCartQuantity = function (product, change) {\r\n                    if (change == \"+\") {\r\n                        product.quantity++;\r\n                    } else {\r\n                        product.quantity--;\r\n                    }\r\n                    var container = {\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n\r\n            }])\r\n        .controller('ProductModalCtrl', ['$scope', 'Cart', '$rootScope', '$sce', 'Products', '$mdDialog', 'Modals', function ($scope, Cart, $rootScope, $sce, Products, $mdDialog, Modals) {\r\n                $scope.hasLocation = false;\r\n                $scope.hasMerchant = false;\r\n                $scope.related_products = [];\r\n                $scope.category_id = null;\r\n                $scope.rating = {};\r\n\r\n                angular.element(document).ready(function () {\r\n\r\n                   \r\n                });\r\n                $scope.selectVariant = function (product) {\r\n                    for (var item in product.variants) {\r\n                        if (product.variant_id == product.variants[item].id) {\r\n                            product.activeVariant = product.variants[item];\r\n                        }\r\n                    }\r\n                }\r\n                $scope.addCartItem = function (product) {\r\n                    var container = {\r\n                        id: product.activeVariant.id,\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        product: product,\r\n                        type: product.type\r\n                    }\r\n                    if((product.activeVariant.is_on_sale && product.activeVariant.sale <1)||(!product.activeVariant.is_on_sale && product.activeVariant.price <1)){\r\n                        Modals.showToast(\"Ese producto no esta a la venta\", $(\"#prod-cont-\" + product.id));\r\n                        return true;\r\n                    }\r\n                    Cart.addCartItem(container, []).then(function (data) {\r\n                        console.log(\"Add cart\", data);\r\n                        if (data.status == \"success\") {\r\n                            product.item_id = data.item.id;\r\n                            product.quantity = data.item.quantity;\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#add-cart-form\"));\r\n\r\n                        } else {\r\n                            Modals.showToast(data.message, $(\"#add-cart-form\"));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n\r\n                            });\r\n                }\r\n\r\n\r\n                $scope.changeCartQuantity = function (product, change) {\r\n                    if (change == \"+\") {\r\n                        product.quantity++;\r\n                    } else {\r\n                        product.quantity--;\r\n                    }\r\n                    var container = {\r\n                        quantity: product.quantity,\r\n                        item_id: product.item_id,\r\n                        \"extras\": []\r\n                    };\r\n                    Cart.updateCartItem(container).then(function (data) {\r\n                        if (data.status == \"error\") {\r\n                            alert(data.message);\r\n                        } else {\r\n                            $rootScope.$broadcast('loadHeadCart', data.cart);\r\n                            Modals.showToast(\"Carrito actualizado\", $(\"#prod-cont-\" + product.id));\r\n                        }\r\n                    },\r\n                            function (data) {\r\n                            });\r\n                }\r\n\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9wcm9kdWN0Y3RybC5qcz9kN2ZhIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdQcm9kdWN0c0N0cmwnLCBbJyRzY29wZScsICdDYXJ0JywgJyRyb290U2NvcGUnLCAnJHNjZScsICdQcm9kdWN0cycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBDYXJ0LCAkcm9vdFNjb3BlLCAkc2NlLCBQcm9kdWN0cywgTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2RJZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5oYXNMb2NhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhhc01lcmNoYW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNTZWFyY2ggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudE9iaiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSAxO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJhbmdlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcyA9IHt9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSAxXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnlfaWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2NhbF90b3RhbCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB2aWV3RGF0YS5yZXBsYWNlKC9BcHBcXFxcTW9kZWxzXFxcXC9nLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInZpZXdEYXRhXCIsIHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IEpTT04ucGFyc2UocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkUHJvZHVjdHNGcm9tV2hvbGUoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuY2F0ZWdvcmllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkaXNzYXBlYXJcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IE1vZGFscy5nZXRBbGxVcmxQYXJhbXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBhcmFtc1wiLCBwYXJhbXMpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLmluY2x1ZGVzID0gXCJmaWxlcyxtZXJjaGFudFwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXJhbXMuY2F0ZWdvcnlfaWQgPSAkc2NvcGUuY2F0ZWdvcnlfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLmluY2x1ZGVzKFwic2VhcmNoXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1NlYXJjaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignbG9hZENhcnRWYXJpYW50cycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVQcm9kdWN0c0NhcnQoYXJncywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrRmF2b3JpdGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignY2xlYXJDYXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYXJ0IGNsZWFyZWQgcmVzZXR0aW5nIGl0ZW1zXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhcnRDbGVhcmVkKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignZGVsZXRlSXRlbScsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaXRlbSByZW1vdmVkIHJlc2V0dGluZyBpdGVtczogXCIsIGFyZ3MpXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhcnREZWxldGVkSXRlbShhcmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTdG9yZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LmNoYW5nZU1lcmNoYW50KClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRNb2RhbCA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tb2RhbFByb2QgPSBwcm9kdWN0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZENhdEZpbHRlciA9IGZ1bmN0aW9uIChjYXRlZ29yeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXJhbXMuY2F0ZWdvcnlfaWQgPSBjYXRlZ29yeTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbygxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZFByb2R1Y3RzRnJvbVdob2xlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gY29udGFpbmVyLmNhdGVnb3JpZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBjb250YWluZXIucGFnZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGFzdCA9IGNvbnRhaW5lci5sYXN0X3BhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBjb250YWluZXIucGFnZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSBjb250YWluZXIucGVyX3BhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gY29udGFpbmVyLnRvdGFsO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuY2F0ZWdvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5X2lkID0gY29udGFpbmVyLmNhdGVnb3J5LmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmNhdGVnb3JpZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2RJZHMucHVzaCgkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5pZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLm1lcmNoYW50X2lkICYmICRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzWzBdLm1lcmNoYW50X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZXJjaGFudF9pZCA9ICRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzWzBdLm1lcmNoYW50X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5tZXJjaGFudF9pZCAmJiAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5tZXJjaGFudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLm1lcmNoYW50X2lkID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10ubWVyY2hhbnRzWzBdLmlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9jYWxfdG90YWwrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5maWxlcyAmJiAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5maWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaW1ncyA9ICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmltZ3MgJiYgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaW1ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uc3JjID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaW1nc1swXS5maWxlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uZGVzY3JpcHRpb24gPSAkc2NlLnRydXN0QXNIdG1sKCRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmFjdGl2ZVZhcmlhbnQgPSAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS52YXJpYW50c1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnZhcmlhbnRfaWQgPSAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS52YXJpYW50c1swXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnF1YW50aXR5ID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10udmFyaWFudHNbMF0ubWluX3F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaXRlbV9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS5pc0Zhdm9yaXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRQcm9kdWN0cyA9IGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBQcm9kdWN0cy5idWlsZFByb2R1Y3RJbmZvcm1hdGlvbihyZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3VsdCBidWlsZCBwcm9kdWN0XCIsICRzY29wZS5jYXRlZ29yaWVzKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYXR0cmlidXRlcyA9ICRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzWzBdLm1lcmNoYW50X2F0dHJpYnV0ZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhdHRyaWJ1dGVzID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5zdG9yZV9hY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuc3RvcmVfYWN0aXZlID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yZUFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50T2JqLm1lcmNoYW50X25hbWUgPSAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tZXJjaGFudF9uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudE9iai5tZXJjaGFudF9kZXNjcmlwdGlvbiA9ICRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzWzBdLm1lcmNoYW50X2Rlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudE9iai5zcmMgPSAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5zcmM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5vcGVuVHV0b3JpYWxzKCk7ICBcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRPYmoubWVyY2hhbnRfdHlwZSA9ICRzY29wZS5jYXRlZ29yaWVzWzBdLnByb2R1Y3RzWzBdLm1lcmNoYW50X3R5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yaWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbMF0ubW9yZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1swXS5wcm9kdWN0c1swXS5tb3JlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3JpZXNbMF0ucHJvZHVjdHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbMF0ucHJvZHVjdHNbMV0ubW9yZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBwYXJzZUludChyZXNwLnBhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kSWRzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSBwYXJzZUludChyZXNwLmxhc3RfcGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBwYXJzZUludChyZXNwLnBhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wZXJfcGFnZSA9IHBhcnNlSW50KHJlc3AucGVyX3BhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IHBhcnNlSW50KHJlc3AudG90YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2NhbF90b3RhbCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiAkc2NvcGUuY2F0ZWdvcmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrIGluICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9jYWxfdG90YWwrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kSWRzLnB1c2goJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uZGVzY3JpcHRpb24gPSAkc2NlLnRydXN0QXNIdG1sKCRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLmFjdGl2ZVZhcmlhbnQgPSAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS52YXJpYW50c1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnZhcmlhbnRfaWQgPSAkc2NvcGUuY2F0ZWdvcmllc1tpdGVtXS5wcm9kdWN0c1trXS52YXJpYW50c1swXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2l0ZW1dLnByb2R1Y3RzW2tdLnF1YW50aXR5ID0gJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10udmFyaWFudHNbMF0ubWluX3F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaXRlbV0ucHJvZHVjdHNba10uaXRlbV9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyUHJpY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGaWx0ZXJpbmdcIiwgJChcIiNhbW91bnRcIikudmFsKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0ciA9ICQoXCIjYW1vdW50XCIpLnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKFwiJFwiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgPSBzdHIucmVwbGFjZShcIiRcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGaWx0ZXJpbmdcIiwgc3RyKVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBzdHIuc3BsaXQoXCItXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmlsdGVyaW5nXCIsIHJlcylcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLmhpZ2ggPSBwYXJzZUludChyZXNbMV0udHJpbSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFyYW1zLmxvdyA9IHBhcnNlSW50KHJlc1swXS50cmltKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nb1RvKDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdvVG8gPSBmdW5jdGlvbiAocGFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXJhbXMucGFnZSA9IHBhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWVyY2hhbnRfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhcmFtcy5tZXJjaGFudF9pZCA9ICRyb290U2NvcGUubWVyY2hhbnRfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93TG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmlzU2VhcmNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFByb2R1Y3RzLnNlYXJjaFByb2R1Y3RzKCRzY29wZS5wYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1zXCIsICRzY29wZS5wYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXNwb25zZVwiLCByZXNwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLnRvdGFsID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5idWlsZFByb2R1Y3RzRnJvbVdob2xlKHJlc3ApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuY3JlYXRlU2xpZGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFByb2R1Y3RzLmdldFByb2R1Y3RzTWVyY2hhbnQoJHNjb3BlLnBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJhbXNcIiwgJHNjb3BlLnBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3BvbnNlXCIsIHJlc3ApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AucHJvZHVjdHNfdG90YWwgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkUHJvZHVjdHMocmVzcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5jcmVhdGVTbGlkZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RWYXJpYW50ID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIHByb2R1Y3QudmFyaWFudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QudmFyaWFudF9pZCA9PSBwcm9kdWN0LnZhcmlhbnRzW2l0ZW1dLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQgPSBwcm9kdWN0LnZhcmlhbnRzW2l0ZW1dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZENhcnRJdGVtID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJvZHVjdC5hY3RpdmVWYXJpYW50LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogcHJvZHVjdC5pdGVtX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBwcm9kdWN0LnR5cGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoKHByb2R1Y3QuYWN0aXZlVmFyaWFudC5pc19vbl9zYWxlICYmIHByb2R1Y3QuYWN0aXZlVmFyaWFudC5zYWxlIDwxKXx8KCFwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSAmJiBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQucHJpY2UgPDEpKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkVzZSBwcm9kdWN0byBubyBlc3RhIGEgbGEgdmVudGFcIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LmFkZENhcnRJdGVtKGNvbnRhaW5lciwgW10pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZGQgY2FydFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQ2Fycml0byBhY3R1YWxpemFkb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QuaXRlbV9pZCA9IGRhdGEuaXRlbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucXVhbnRpdHkgPSBkYXRhLml0ZW0ucXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRIZWFkQ2FydCcsIGRhdGEuY2FydCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChkYXRhLm1lc3NhZ2UsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hlY2tGYXZvcml0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF9pZHM6ICRzY29wZS5wcm9kSWRzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFByb2R1Y3RzLmNoZWNrRmF2b3JpdGUoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2hlY2tGYXZvcml0ZXMgcmVzXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayBpbiByZXN1bHRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiAkc2NvcGUuY2F0ZWdvcmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0uaWQgPT0gcmVzdWx0c1trXS5mYXZvcml0YWJsZV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLmlzRmF2b3JpdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZEZhdm9yaXRlID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfaWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlByb2R1Y3RcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFByb2R1Y3RzLmFkZEZhdm9yaXRlKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZGQgYWRkRmF2b3JpdGVcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LmlzRmF2b3JpdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2Fkb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChkYXRhLm1lc3NhZ2UsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkRlYmVzIGVzdGFyIGxvZ3VlYWRvIHBhcmEgZ3VhcmRhciBwcm9kdWN0b3NcIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5kZWxldGVGYXZvcml0ZSA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X2lkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlByb2R1Y3RcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5kZWxldGVGYXZvcml0ZShjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZGQgYWRkRmF2b3JpdGVcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5pc0Zhdm9yaXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiUmVtb3ZpZG9cIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KGRhdGEubWVzc2FnZSwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhcnRDbGVhcmVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHNbal0uaXRlbV9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FydERlbGV0ZWRJdGVtID0gZnVuY3Rpb24gKGl0ZW1faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluICRzY29wZS5jYXRlZ29yaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogaW4gJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pdGVtX2lkID09IGl0ZW1faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pdGVtX2lkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVQcm9kdWN0c0NhcnQgPSBmdW5jdGlvbiAoY2FydCwgdG90YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXJ0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbSBpbiBjYXJ0Lml0ZW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gJHNjb3BlLmNhdGVnb3JpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogaW4gJHNjb3BlLmNhdGVnb3JpZXNbaV0ucHJvZHVjdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pdGVtX2lkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrIGluICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLnZhcmlhbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBjYXJ0Lml0ZW1zW21dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFyaWFudCA9ICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLnZhcmlhbnRzW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmF0dHJpYnV0ZXMucHJvZHVjdF92YXJpYW50X2lkID09IHZhcmlhbnQuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzW2ldLnByb2R1Y3RzW2pdLml0ZW1faWQgPSBjb250YWluZXIuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5xdWFudGl0eSA9IGNvbnRhaW5lci5xdWFudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGNhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VDYXJ0UXVhbnRpdHkgPSBmdW5jdGlvbiAocHJvZHVjdCwgY2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA9PSBcIitcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5xdWFudGl0eS0tO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogcHJvZHVjdC5pdGVtX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImV4dHJhc1wiOiBbXVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC51cGRhdGVDYXJ0SXRlbShjb250YWluZXIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwiZXJyb3JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkVycm9yIEFjdHVhbGl6YW5kb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQ2Fycml0byBhY3R1YWxpemFkb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfV0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2R1Y3REZXRhaWxDdHJsJywgWyckc2NvcGUnLCAnQ2FydCcsICckcm9vdFNjb3BlJywgJyRzY2UnLCAnUHJvZHVjdHMnLCAnJG1kRGlhbG9nJywgJ01vZGFscycsIGZ1bmN0aW9uICgkc2NvcGUsIENhcnQsICRyb290U2NvcGUsICRzY2UsIFByb2R1Y3RzLCAkbWREaWFsb2csIE1vZGFscykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmhhc0xvY2F0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGFzTWVyY2hhbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVsYXRlZF9wcm9kdWN0cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5X2lkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yYXRpbmcgPSB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHZpZXdEYXRhLnJlcGxhY2UoL0FwcFxcXFxNb2RlbHNcXFxcL2csIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidmlld0RhdGFcIiwgcmVzKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gSlNPTi5wYXJzZShyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiLCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0ID0gY29udGFpbmVyLnByb2R1Y3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHMgPSBjb250YWluZXIucmVsYXRlZF9wcm9kdWN0c1swXS5wcm9kdWN0cztcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVWYXJpYW50ID0gJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogaW4gJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXS5pc19vbl9zYWxlICYmIGFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXS5zYWxlIDwgYWN0aXZlVmFyaWFudC5zYWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVZhcmlhbnQgPSAkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoISRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLmlzX29uX3NhbGUgJiYgYWN0aXZlVmFyaWFudC5pc19vbl9zYWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLnByaWNlIDwgYWN0aXZlVmFyaWFudC5zYWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVZhcmlhbnQgPSAkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoISRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdLmlzX29uX3NhbGUgJiYgIWFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXS5wcmljZSA8IGFjdGl2ZVZhcmlhbnQucHJpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVmFyaWFudCA9ICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50c1tqXS5pc19vbl9zYWxlICYmICFhY3RpdmVWYXJpYW50LmlzX29uX3NhbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHNbaV0udmFyaWFudHNbal0uc2FsZSA8IGFjdGl2ZVZhcmlhbnQucHJpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVmFyaWFudCA9ICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLnZhcmlhbnRzW2pdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzW2ldLmFjdGl2ZVZhcmlhbnQgPSBhY3RpdmVWYXJpYW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVsYXRlZF9wcm9kdWN0c1tpXS52YXJpYW50X2lkID0gYWN0aXZlVmFyaWFudC5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJhdGluZy50eXBlID0gXCJQcm9kdWN0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJhdGluZy5vYmplY3RfaWQgPSAkc2NvcGUucHJvZHVjdC5pZDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmF0aW5nLnJhdGluZyA9ICc1JztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdC52YXJpYW50cyA9ICRzY29wZS5wcm9kdWN0LnByb2R1Y3RfdmFyaWFudHM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QuYWN0aXZlVmFyaWFudCA9ICRzY29wZS5wcm9kdWN0LnZhcmlhbnRzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0LnF1YW50aXR5ID0gJHNjb3BlLnByb2R1Y3QuYWN0aXZlVmFyaWFudC5taW5fcXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2R1Y3QudmFyaWFudF9pZCA9ICRzY29wZS5wcm9kdWN0LnZhcmlhbnRzWzBdLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9kdWN0Lm1lcmNoYW50X2lkID0gJHJvb3RTY29wZS5tZXJjaGFudF9pZDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdC50eXBlID0gJHNjb3BlLnByb2R1Y3QudmFyaWFudHNbMF0udHlwZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucHJvZHVjdC5kZXNjcmlwdGlvbiA9ICRzY2UudHJ1c3RBc0h0bWwoJHNjb3BlLnByb2R1Y3QuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGlzc2FwZWFyXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignbG9hZENhcnRWYXJpYW50cycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVQcm9kdWN0c0NhcnQoYXJncywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0VmFyaWFudCA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBpbiBwcm9kdWN0LnZhcmlhbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0LnZhcmlhbnRfaWQgPT0gcHJvZHVjdC52YXJpYW50c1tpdGVtXS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5hY3RpdmVWYXJpYW50ID0gcHJvZHVjdC52YXJpYW50c1tpdGVtXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRDYXJ0SXRlbSA9IGZ1bmN0aW9uIChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb2R1Y3QuYWN0aXZlVmFyaWFudC5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHByb2R1Y3QucXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IHByb2R1Y3QuaXRlbV9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdDogcHJvZHVjdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcHJvZHVjdC50eXBlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKChwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSAmJiBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuc2FsZSA8MSl8fCghcHJvZHVjdC5hY3RpdmVWYXJpYW50LmlzX29uX3NhbGUgJiYgcHJvZHVjdC5hY3RpdmVWYXJpYW50LnByaWNlIDwxKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJFc2UgcHJvZHVjdG8gbm8gZXN0YSBhIGxhIHZlbnRhXCIsICQoXCIjcHJvZC1jb250LVwiICsgcHJvZHVjdC5pZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgQ2FydC5hZGRDYXJ0SXRlbShjb250YWluZXIsIFtdKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkIGNhcnRcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5pdGVtX2lkID0gZGF0YS5pdGVtLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5xdWFudGl0eSA9IGRhdGEuaXRlbS5xdWFudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZEhlYWRDYXJ0JywgZGF0YS5jYXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDYXJyaXRvIGFjdHVhbGl6YWRvXCIsICQoXCIjYWRkLWNhcnQtZm9ybVwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChkYXRhLm1lc3NhZ2UsICQoXCIjYWRkLWNhcnQtZm9ybVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRSYXRpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSYXRpbmdcIiwgJHNjb3BlLnJhdGluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEZWJlcyBlc3RhciBsb2d1ZWRvIHBhcmEgY29tZW50YXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJEZWJlcyBlc3RhciBsb2d1ZWRvIHBhcmEgY29tZW50YXJcIiwgJChcIiN0b2FzdC1jb250YWluZXJcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmF0aW5nLnJhdGluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2EgdW5hIGNhbGlmaWNhY2lvblwiLCAkKFwiI3RvYXN0LWNvbnRhaW5lclwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yYXRpbmcuY29tbWVudC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBZ3JlZ2EgdW5hIG9ic2VydmFjaW9uIGEgdHUgY2FsaWZpY2FjaW9uXCIsICQoXCIjdG9hc3QtY29udGFpbmVyXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBQcm9kdWN0cy5hZGRSYXRpbmcoJHNjb3BlLnJhdGluZykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZCBjYXJ0XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJNZW5zYWplIGVudmlhZG8uIFNpIHZ1ZWx2ZXMgYSBlbnZpYXIgc2UgYW51bGEgZWwgYW50ZXJpb3JcIiwgJChcIiN0b2FzdC1jb250YWluZXJcIikpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChkYXRhLm1lc3NhZ2UsICQoXCIjdG9hc3QtY29udGFpbmVyXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVByb2R1Y3RzQ2FydCA9IGZ1bmN0aW9uIChjYXJ0LCB0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0cyA9ICRzY29wZS5yZWxhdGVkX3Byb2R1Y3RzO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG0gaW4gY2FydC5pdGVtcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrIGluIHByb2R1Y3RzW2pdLnZhcmlhbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGNhcnQuaXRlbXNbbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhcmlhbnQgPSBwcm9kdWN0c1tqXS52YXJpYW50c1trXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmF0dHJpYnV0ZXMucHJvZHVjdF92YXJpYW50X2lkID09IHZhcmlhbnQuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNbal0uaXRlbV9pZCA9IGNvbnRhaW5lci5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNbal0ucXVhbnRpdHkgPSBjb250YWluZXIucXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUNhcnRRdWFudGl0eSA9IGZ1bmN0aW9uIChwcm9kdWN0LCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlID09IFwiK1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucXVhbnRpdHkrKztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5LS07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBwcm9kdWN0LnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtX2lkOiBwcm9kdWN0Lml0ZW1faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXh0cmFzXCI6IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LnVwZGF0ZUNhcnRJdGVtKGNvbnRhaW5lcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJlcnJvclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkNhcnJpdG8gYWN0dWFsaXphZG9cIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfV0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2R1Y3RNb2RhbEN0cmwnLCBbJyRzY29wZScsICdDYXJ0JywgJyRyb290U2NvcGUnLCAnJHNjZScsICdQcm9kdWN0cycsICckbWREaWFsb2cnLCAnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgQ2FydCwgJHJvb3RTY29wZSwgJHNjZSwgUHJvZHVjdHMsICRtZERpYWxvZywgTW9kYWxzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGFzTG9jYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5oYXNNZXJjaGFudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlbGF0ZWRfcHJvZHVjdHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeV9pZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmF0aW5nID0ge307XHJcblxyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RWYXJpYW50ID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIHByb2R1Y3QudmFyaWFudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QudmFyaWFudF9pZCA9PSBwcm9kdWN0LnZhcmlhbnRzW2l0ZW1dLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQgPSBwcm9kdWN0LnZhcmlhbnRzW2l0ZW1dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZENhcnRJdGVtID0gZnVuY3Rpb24gKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJvZHVjdC5hY3RpdmVWYXJpYW50LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogcHJvZHVjdC5pdGVtX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBwcm9kdWN0LnR5cGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoKHByb2R1Y3QuYWN0aXZlVmFyaWFudC5pc19vbl9zYWxlICYmIHByb2R1Y3QuYWN0aXZlVmFyaWFudC5zYWxlIDwxKXx8KCFwcm9kdWN0LmFjdGl2ZVZhcmlhbnQuaXNfb25fc2FsZSAmJiBwcm9kdWN0LmFjdGl2ZVZhcmlhbnQucHJpY2UgPDEpKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkVzZSBwcm9kdWN0byBubyBlc3RhIGEgbGEgdmVudGFcIiwgJChcIiNwcm9kLWNvbnQtXCIgKyBwcm9kdWN0LmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBDYXJ0LmFkZENhcnRJdGVtKGNvbnRhaW5lciwgW10pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZGQgY2FydFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0Lml0ZW1faWQgPSBkYXRhLml0ZW0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnF1YW50aXR5ID0gZGF0YS5pdGVtLnF1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkSGVhZENhcnQnLCBkYXRhLmNhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dUb2FzdChcIkNhcnJpdG8gYWN0dWFsaXphZG9cIiwgJChcIiNhZGQtY2FydC1mb3JtXCIpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KGRhdGEubWVzc2FnZSwgJChcIiNhZGQtY2FydC1mb3JtXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlQ2FydFF1YW50aXR5ID0gZnVuY3Rpb24gKHByb2R1Y3QsIGNoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2UgPT0gXCIrXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5xdWFudGl0eSsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucXVhbnRpdHktLTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHByb2R1Y3QucXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IHByb2R1Y3QuaXRlbV9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJleHRyYXNcIjogW11cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIENhcnQudXBkYXRlQ2FydEl0ZW0oY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSBcImVycm9yXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRIZWFkQ2FydCcsIGRhdGEuY2FydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQ2Fycml0byBhY3R1YWxpemFkb1wiLCAkKFwiI3Byb2QtY29udC1cIiArIHByb2R1Y3QuaWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9wcm9kdWN0Y3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 24 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ReportsCtrl', ['$scope', 'Merchants', 'Modals', function ($scope, Merchants, Modals) {\n                $scope.data = {};\n                $scope.user = {};\n                $scope.current = 1;\n                $scope.last = 1;\n                $scope.total = 1;\n                $scope.per_page = 1;\n                $scope.reports = [];\n                $scope.categories = [];\n                $scope.regionVisible = false;\n                $scope.editMerchant = false;\n                $scope.submitted = false;\n                $scope.category;\n                angular.element(document).ready(function () {\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\n//                    res = res.replace(/\"{/g, \"'{\");\n//                    res = res.replace(/}\"/g, \"}'\");\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n\n                    console.log(\"Data\", container);\n                    $scope.category = container.category;\n                    $scope.reports = container.data;\n                    $scope.current = container.page;\n                    $scope.per_page = container.per_page;\n                    $scope.last = container.last_page;\n                    $scope.total = container.total;\n                    document.getElementById(\"dissapear\").remove();\n                });\n\n                $scope.goTo = function (page) {\n                    $scope.current = page;\n                    $scope.reports = [];\n                    Modals.showLoader();\n                    var where = \"category_id=\" + $scope.category.id + \"&page=\" + $scope.current + \"&limit=\" + 2;\n                    if ($scope.category.type.includes(\"nearby\")) {\n                        Merchants.getReportsNearby(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    } else {\n                        Merchants.getReports(where).then(function (data) {\n                            $scope.loadResults(data)\n                        },\n                                function (data) {\n                                });\n                    }\n                }\n\n                $scope.loadResults = function (data) {\n                    $scope.reports = data.data;\n                    $scope.current = parseInt(data.page);\n                    $scope.per_page = parseInt(data.per_page);\n                    $scope.last = parseInt(data.last_page);\n                    $scope.total = parseInt(data.total);\n                    Modals.hideLoader();\n                }\n            }])\n        .controller('ReportDetailCtrl', ['$scope', 'Merchants', 'Modals', function ($scope, Merchants, Modals) {\n                $scope.report = {};\n\n                angular.element(document).ready(function () {\n                    var res = viewData.replace(/App\\\\Models\\\\/g, \"\");\n//                    res = res.replace(/\"{/g, \"'{\");\n//                    res = res.replace(/}\"/g, \"}'\");\n                    console.log(\"res\", res);\n                    var container = JSON.parse(res);\n\n                    console.log(\"Data\", container);\n                    $scope.report = container;\n                    //document.getElementById(\"dissapear\").remove();\n                });\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9yZXBvcnRzY3RybC5qcz9kNGM5Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdSZXBvcnRzQ3RybCcsIFsnJHNjb3BlJywgJ01lcmNoYW50cycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBNZXJjaGFudHMsIE1vZGFscykge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudCA9IDE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSAxO1xuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gMTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0cyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1lcmNoYW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHZpZXdEYXRhLnJlcGxhY2UoL0FwcFxcXFxNb2RlbHNcXFxcL2csIFwiXCIpO1xuLy8gICAgICAgICAgICAgICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC9cInsvZywgXCIne1wiKTtcbi8vICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvfVwiL2csIFwifSdcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBKU09OLnBhcnNlKHJlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRhXCIsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeSA9IGNvbnRhaW5lci5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMgPSBjb250YWluZXIuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBjb250YWluZXIucGFnZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlcl9wYWdlID0gY29udGFpbmVyLnBlcl9wYWdlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGFzdCA9IGNvbnRhaW5lci5sYXN0X3BhZ2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IGNvbnRhaW5lci50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkaXNzYXBlYXJcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbyA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gcGFnZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCJjYXRlZ29yeV9pZD1cIiArICRzY29wZS5jYXRlZ29yeS5pZCArIFwiJnBhZ2U9XCIgKyAkc2NvcGUuY3VycmVudCArIFwiJmxpbWl0PVwiICsgMjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5jYXRlZ29yeS50eXBlLmluY2x1ZGVzKFwibmVhcmJ5XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0UmVwb3J0c05lYXJieSh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyhkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0UmVwb3J0cyh3aGVyZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkUmVzdWx0cyhkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFJlc3VsdHMgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSBwYXJzZUludChkYXRhLnBhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVyX3BhZ2UgPSBwYXJzZUludChkYXRhLnBlcl9wYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxhc3QgPSBwYXJzZUludChkYXRhLmxhc3RfcGFnZSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IHBhcnNlSW50KGRhdGEudG90YWwpO1xuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1dKVxuICAgICAgICAuY29udHJvbGxlcignUmVwb3J0RGV0YWlsQ3RybCcsIFsnJHNjb3BlJywgJ01lcmNoYW50cycsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBNZXJjaGFudHMsIE1vZGFscykge1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnQgPSB7fTtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gdmlld0RhdGEucmVwbGFjZSgvQXBwXFxcXE1vZGVsc1xcXFwvZywgXCJcIik7XG4vLyAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1wiey9nLCBcIid7XCIpO1xuLy8gICAgICAgICAgICAgICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC99XCIvZywgXCJ9J1wiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXNcIiwgcmVzKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IEpTT04ucGFyc2UocmVzKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGFcIiwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydCA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRpc3NhcGVhclwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvcmVwb3J0c2N0cmwuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 25 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('RoutesCtrl', ['$scope', '$rootScope', 'Routes', 'Food', 'MapService', function ($scope, $rootScope, Routes, Food, MapService) {\n                $scope.data = {};\n                $scope.routes;\n                $scope.page = 0;\n                $scope.returns = [{name: \"casa\", address_id: 17663}, {name: \"basilikum\", address_id: 17660}];\n                $scope.loadMore = true;\n                $scope.scenario = 'preorganize';\n                $scope.status = 'pending';\n                $scope.provider = 'Basilikum';\n                $scope.regionVisible = false;\n                $scope.editAddress = false;\n                $scope.mapActive = false;\n                angular.element(document).ready(function () {\n                    $scope.getRoutes();\n                });\n                $scope.save = function (isvalid) {\n                    $scope.submitted = true;\n                    if (isvalid) {\n                        var existing = false;\n                        if ($scope.data.address_id) {\n                            existing = true;\n                        }\n                        Routes.saveAddress($.param($scope.data)).then(function (data) {\n                            if (existing) {\n                                $scope.updateAddress(data.address);\n                            } else {\n                                $scope.routes.push(data.address);\n                            }\n\n                            $scope.data = {};\n                            $scope.submitted = false;\n                            $scope.editAddress = false;\n                        },\n                                function (data) {\n\n                                });\n                    }\n                }\n                $scope.changeScenario = function () {\n                    //$scope.provider= \"Basilikum\";\n                    console.log(\"provider\", $scope.provider);\n                    $scope.page = 0;\n                    $scope.hideAll();\n                    if ($scope.provider == \"Basilikum\") {\n                        $scope.scenario = \"preorganize\";\n                    }\n                    $scope.routes = [];\n                    $scope.getRoutes();\n                }\n                $scope.activateMap = function () {\n                    $scope.mapActive = true;\n                    console.log(\"Creating map data\")\n                    MapService.createMap(4.685419, -74.064161);\n                    $scope.createMapData();\n                }\n                $scope.createMapData = function () {\n                    console.log(\"Creating map data\")\n                    for (route in $scope.routes) {\n                        var stops = $scope.routes[route].stops;\n                        for (item in stops) {\n                            console.log(\"Creating map data stop\");\n                            stops[item].icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + stops[item].amount + '|FE6256|000000';\n                            stops[item].marker = MapService.createStop(stops[item]);\n                        }\n                        $scope.routes[route].stops = stops;\n                        console.log(\"Creating map data route\")\n                        var color = MapService.getColor();\n                        $scope.routes[route].polyline = MapService.createRoute($scope.routes[route], color);\n                    }\n                }\n                $scope.buildRouteData = function (route) {\n                    var stops = route.stops;\n                    var stopsLat = [];\n                    for (item in stops) {\n                        stops[item].details = JSON.parse(stops[item].details);\n                        var stopCord = {\"lat\": stops[item].address.lat, \"lng\": stops[item].address.long}\n                        stopsLat.push(stopCord);\n                        stops[item].name = stops[item].address.address;\n                        stops[item].lat = stops[item].address.lat;\n                        stops[item].long = stops[item].address.long;\n                        stops[item].moving_delivery = null;\n                        if ($scope.mapActive) {\n                            stops[item].marker = MapService.createStop(stops[item]);\n                        }\n\n                        /*let deliveries = stops[item].deliveries;\n                         for (item2 in deliveries) {\n                         deliveries[item2].details = JSON.parse(deliveries[item2].details);\n                         }\n                         stops[item].deliveries = deliveries;*/\n                    }\n                    route.stops = stops;\n                    route.stopsLat = stopsLat;\n                    if ($scope.mapActive) {\n                        var color = $scope.getRouteColor();\n                        route.polyline = MapService.createRoute(route, color);\n                    }\n                    setTimeout(function () {\n                        var el = document.getElementById('route-' + route.id + '-table');\n                        var sortable = new Sortable(el, {\n                            group: \"routes\",\n                            handle: '.handle',\n                            dataIdAttr: route.id,\n                            onAdd: function (/**Event*/evt) {\n                                console.log(\"On add\", evt);\n                                var attributes = evt.item.attributes;\n                                var routeString = evt.target.id;\n                                routeString = routeString.replace(\"route-\", \"\");\n                                routeString = routeString.replace(\"-table\", \"\");\n                                var route = parseInt(routeString);\n                                var stop = null;\n                                for (item in attributes) {\n                                    if (attributes[item].name == \"data-stop\") {\n                                        stop = attributes[item].value;\n                                    }\n                                }\n                                $scope.updateRouteLocation(route, stop, evt.newIndex, 1000);\n                            },\n                            onUpdate: function (/**Event*/evt) {\n                                // same properties as onEnd\n                                var attributes = evt.item.attributes;\n                                var route = null;\n                                var stop = null;\n                                for (item in attributes) {\n                                    if (attributes[item].name == \"data-route\") {\n                                        route = attributes[item].value;\n                                    }\n                                    if (attributes[item].name == \"data-stop\") {\n                                        stop = attributes[item].value;\n                                    }\n                                }\n                                if (route && stop) {\n                                    $scope.updateRouteLocation(route, stop, evt.newIndex, evt.oldIndex);\n                                }\n\n                            },\n                        });\n                        console.log(\"Setting sortable\");\n                    }, 1000);\n\n                    route.address_id = 17663;\n                    return route;\n                }\n                $scope.updateRouteLocation = function (route, stop, index, old) {\n                    console.log(\"Route\", route);\n                    console.log(\"stop\", stop);\n                    console.log(\"index\", index);\n                    var movingStop = null\n                    var displacedStops = [];\n                    for (item in $scope.routes) {\n                        if ($scope.routes[item].id == route) {\n                            var container = $scope.routes[item];\n                            var counter = 1;\n                            for (stopI in container.stops) {\n                                if (container.stops[stopI].id == stop) {\n                                    movingStop = container.stops[stopI];\n                                } else {\n                                    if (old > index) {\n                                        if (counter >= index) {\n                                            displacedStops.push(container.stops[stopI]);\n                                        }\n                                    } else {\n                                        if (counter > index) {\n                                            displacedStops.push(container.stops[stopI]);\n                                        }\n                                    }\n                                }\n                                counter++;\n                            }\n                        }\n                    }\n\n                    console.log(\"displacedStops\", displacedStops);\n                    if (!movingStop) {\n                        movingStop = {};\n                        movingStop.route_id = route;\n                        movingStop.id = stop;\n                    }\n                    console.log(\"Moving stop\", movingStop);\n                    $('.preloader').fadeIn('slow');\n                    $scope.updateRouteStop(movingStop);\n\n                    setTimeout(function () {\n                        var counter = 1;\n                        if (displacedStops.length > 0) {\n                            for (item in displacedStops) {\n                                $scope.updateSpeed(displacedStops[item], counter);\n                                counter++;\n                                console.log(\"displacing stop\", displacedStops[item]);\n                            }\n                            setTimeout(function () {\n                                window.location.reload();\n                            }, 300 * (counter + 1));\n                        } else {\n                            setTimeout(function () {\n                                window.location.reload();\n                            }, 300 * (counter + 1));\n                        }\n                    }, 1000);\n                }\n                $scope.updateSpeed = function (stop, counter) {\n                    setTimeout(function () {\n                        $scope.updateRouteStop(stop);\n                    }, 300 * (counter + 1));\n                }\n                $scope.getRoutes = function () {\n                    console.log(\"Status\", $scope.status);\n                    console.log(\"provider\", $scope.provider);\n                    $scope.page++;\n                    var url = \"includes=stops.address&order_by=id,asc&page=\" + $scope.page + \"&type=\" + $scope.scenario + \"&status=\" + $scope.status + \"&provider=\" + $scope.provider;\n                    if ($scope.status != \"pending\") {\n                        url = \"includes=stops.address&order_by=id,asc&page=\" + $scope.page + \"&status=\" + $scope.status;\n                    }\n\n                    Routes.getRoutes(url).then(function (data) {\n                        var routesCont = data.data;\n                        if (data.page == data.last_page) {\n                            $scope.loadMore = false;\n                        }\n                        for (item in routesCont) {\n                            routesCont[item] = $scope.buildRouteData(routesCont[item]);\n                        }\n                        $scope.routes = routesCont;\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.clean = function () {\n                    $scope.data = {};\n                    $scope.regionVisible = false;\n                    $scope.cityVisible = false;\n                }\n                $scope.sendReminder = function () {\n                    Food.sendReminder().then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.showAll = function () {\n                    console.log(\"Creating map data\")\n                    for (route in $scope.routes) {\n                        var stops = $scope.routes[route].stops;\n                        for (item in stops) {\n                            console.log(\"Creating map data stop\")\n                            stops[item].marker.setMap($rootScope.map);\n                        }\n                        $scope.routes[route].stops = stops;\n                        $scope.routes[route].polyline.setMap($rootScope.map);\n                    }\n                }\n                $scope.hideAll = function () {\n                    console.log(\"Creating map data\")\n                    for (route in $scope.routes) {\n                        var stops = $scope.routes[route].stops;\n                        for (item in stops) {\n                            console.log(\"Creating map data stop\")\n                            if (stops[item].marker) {\n                                stops[item].marker.setMap(null);\n                            }\n                        }\n                        $scope.routes[route].stops = stops;\n                        if ($scope.routes[route].polyline) {\n                            $scope.routes[route].polyline.setMap(null);\n                        }\n                    }\n                }\n                $scope.showRoute = function (route) {\n                    $scope.hideAll();\n                    console.log(\"Creating map data\")\n                    var stops = route.stops;\n                    for (item in stops) {\n                        console.log(\"Creating map data stop\")\n                        stops[item].marker.setMap($rootScope.map);\n                    }\n                    route.polyline.setMap($rootScope.map);\n                }\n\n                $scope.clean = function () {\n                    $scope.data = {};\n                    $scope.regionVisible = false;\n                    $scope.cityVisible = false;\n                }\n                $scope.updateRouteStop = function (stop) {\n                    Routes.updateRouteStop(stop.id, stop.route_id).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.updateRouteDelivery = function (stop) {\n                    Routes.updateRouteStop(stop.route_id, stop.moving_delivery, stop.id).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteRoute = function (route_id) {\n                    Routes.deleteRoute(route_id).then(function (data) {\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteStop = function (stop_id) {\n                    Routes.deleteStop(stop_id).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.sendStopToNewRoute = function (stop) {\n                    Routes.sendStopToNewRoute(stop).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.addReturnStop = function (route, address_id) {\n                    Routes.addReturnStop(route, address_id).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.buildRoute = function (route) {\n                    Food.buildScenarioRouteId(route.id).then(function (data) {\n                        route.status = \"scheduled\";\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getPurchaseOrder = function () {\n                    Food.getPurchaseOrder().then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.regenerateScenarios = function () {\n                    Food.regenerateScenarios().then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.regenerateDeliveries = function () {\n                    Food.regenerateDeliveries().then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getTotalShippingCosts = function () {\n                    Food.getSummaryShipping($scope.status).then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getScenarioOrganization = function () {\n                    var data = $scope.getInputs();\n                    Food.getScenarioOrganizationStructure(data).then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.buildScenarioLogistics = function () {\n                    var data = $scope.getInputs();\n                    Food.buildScenarioLogistics(data).then(function (data) {\n                        window.location.reload();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.getInputs = function () {\n                    var data;\n                    if ($scope.status == \"enqueue\") {\n                        data = {\n                            \"status\": \"enqueue\"\n                        };\n                    } else {\n                        data = {\n                            \"status\": $scope.status,\n                            \"provider\": $scope.provider,\n                            \"type\": $scope.scenario\n                        };\n                    }\n                    return data;\n                }\n                $scope.getScenarioEmails = function () {\n                    var data = $scope.getInputs();\n                    Food.getScenarioStructure(data).then(function (data) {\n                    },\n                            function (data) {\n\n                            });\n                }\n\n            }]).controller('RapigoCtrl', ['$scope', 'Payments', function ($scope, Routes) {\n        $scope.data = {};\n        $scope.key;\n        angular.element(document).ready(function () {\n            var str = window.location.href;\n            var res = str.split(\"/\");\n\n        });\n\n        $scope.getUpdate = function () {\n            Routes.getKeyStatus($scope.key).then(function (data) {\n\n            },\n                    function (data) {\n\n                    });\n        }\n\n    }])\n        .controller('RapigoCtrl', ['$scope', 'MapService', 'Routes', function ($scope, MapService, Routes) {\n                $scope.map = {center: {latitude: 4.653450, longitude: -74.049605}, zoom: 8};\n                $scope.activeMarker = null;\n                $scope.markerStatus = \"\";\n                MapService.createMap(4.653450, -74.049605);\n                angular.element(document).ready(function () {\n                    var str = window.location.href;\n                    var res = str.split(\"/\");\n                    $scope.key = res[res.length - 1];\n                    $scope.getUpdate();\n                });\n                $scope.getUpdate = function () {\n                    Routes.getKeyStatus($scope.key).then(function (data) {\n                        if (data.status == \"success\") {\n                            var results = data.result;\n                            if (results) {\n                                $scope.markerStatus = results.status;\n                                if (results.curier) {\n                                    if (results.curier.lat && !isNaN(results.curier.lat)) {\n                                        if ($scope.activeMarker) {\n                                            $scope.activeMarker.setPosition(new google.maps.LatLng(results.curier.lat, results.curier.lon));\n                                        } else {\n                                            $scope.activeMarker = MapService.createLocationMarker(results.curier.lat, results.curier.lon, true);\n                                        }\n                                        MapService.setCenterMap(results.curier.lat, results.curier.lon);\n                                    }\n                                }\n                                setTimeout(function () {\n                                    $scope.getUpdate();\n                                }, 5000);\n                            }\n\n                        }\n\n                    },\n                            function (data) {\n\n                            });\n                }\n\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9yb3V0ZXNjdHJsLmpzPzE2M2YiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JvdXRlc0N0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1JvdXRlcycsICdGb29kJywgJ01hcFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBSb3V0ZXMsIEZvb2QsIE1hcFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5yb3V0ZXM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZXR1cm5zID0gW3tuYW1lOiBcImNhc2FcIiwgYWRkcmVzc19pZDogMTc2NjN9LCB7bmFtZTogXCJiYXNpbGlrdW1cIiwgYWRkcmVzc19pZDogMTc2NjB9XTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5zY2VuYXJpbyA9ICdwcmVvcmdhbml6ZSc7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9ICdwZW5kaW5nJztcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvdmlkZXIgPSAnQmFzaWxpa3VtJztcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0QWRkcmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJvdXRlcygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZGF0YS5hZGRyZXNzX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgUm91dGVzLnNhdmVBZGRyZXNzKCQucGFyYW0oJHNjb3BlLmRhdGEpKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVBZGRyZXNzKGRhdGEuYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlcy5wdXNoKGRhdGEuYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRBZGRyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VTY2VuYXJpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUucHJvdmlkZXI9IFwiQmFzaWxpa3VtXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicHJvdmlkZXJcIiwgJHNjb3BlLnByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZUFsbCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnByb3ZpZGVyID09IFwiQmFzaWxpa3VtXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY2VuYXJpbyA9IFwicHJlb3JnYW5pemVcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSb3V0ZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2YXRlTWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWFwQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY4NTQxOSwgLTc0LjA2NDE2MSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVNYXBEYXRhKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVNYXBEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhXCIpXG4gICAgICAgICAgICAgICAgICAgIGZvciAocm91dGUgaW4gJHNjb3BlLnJvdXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0b3BzID0gJHNjb3BlLnJvdXRlc1tyb3V0ZV0uc3RvcHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc3RvcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhIHN0b3BcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0uaWNvbiA9ICdodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9tYXBfcGluX2xldHRlciZjaGxkPScgKyBzdG9wc1tpdGVtXS5hbW91bnQgKyAnfEZFNjI1NnwwMDAwMDAnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLm1hcmtlciA9IE1hcFNlcnZpY2UuY3JlYXRlU3RvcChzdG9wc1tpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcyA9IHN0b3BzO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSByb3V0ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gTWFwU2VydmljZS5nZXRDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlc1tyb3V0ZV0ucG9seWxpbmUgPSBNYXBTZXJ2aWNlLmNyZWF0ZVJvdXRlKCRzY29wZS5yb3V0ZXNbcm91dGVdLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkUm91dGVEYXRhID0gZnVuY3Rpb24gKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdG9wcyA9IHJvdXRlLnN0b3BzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHNMYXQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIHN0b3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wc1tpdGVtXS5kZXRhaWxzID0gSlNPTi5wYXJzZShzdG9wc1tpdGVtXS5kZXRhaWxzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdG9wQ29yZCA9IHtcImxhdFwiOiBzdG9wc1tpdGVtXS5hZGRyZXNzLmxhdCwgXCJsbmdcIjogc3RvcHNbaXRlbV0uYWRkcmVzcy5sb25nfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNMYXQucHVzaChzdG9wQ29yZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wc1tpdGVtXS5uYW1lID0gc3RvcHNbaXRlbV0uYWRkcmVzcy5hZGRyZXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubGF0ID0gc3RvcHNbaXRlbV0uYWRkcmVzcy5sYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wc1tpdGVtXS5sb25nID0gc3RvcHNbaXRlbV0uYWRkcmVzcy5sb25nO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubW92aW5nX2RlbGl2ZXJ5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubWFwQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubWFya2VyID0gTWFwU2VydmljZS5jcmVhdGVTdG9wKHN0b3BzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLypsZXQgZGVsaXZlcmllcyA9IHN0b3BzW2l0ZW1dLmRlbGl2ZXJpZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtMiBpbiBkZWxpdmVyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcmllc1tpdGVtMl0uZGV0YWlscyA9IEpTT04ucGFyc2UoZGVsaXZlcmllc1tpdGVtMl0uZGV0YWlscyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLmRlbGl2ZXJpZXMgPSBkZWxpdmVyaWVzOyovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcm91dGUuc3RvcHMgPSBzdG9wcztcbiAgICAgICAgICAgICAgICAgICAgcm91dGUuc3RvcHNMYXQgPSBzdG9wc0xhdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5tYXBBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb2xvciA9ICRzY29wZS5nZXRSb3V0ZUNvbG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3V0ZS5wb2x5bGluZSA9IE1hcFNlcnZpY2UuY3JlYXRlUm91dGUocm91dGUsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb3V0ZS0nICsgcm91dGUuaWQgKyAnLXRhYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc29ydGFibGUgPSBuZXcgU29ydGFibGUoZWwsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cDogXCJyb3V0ZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICcuaGFuZGxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhSWRBdHRyOiByb3V0ZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkFkZDogZnVuY3Rpb24gKC8qKkV2ZW50Ki9ldnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPbiBhZGRcIiwgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBldnQuaXRlbS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcm91dGVTdHJpbmcgPSBldnQudGFyZ2V0LmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVN0cmluZyA9IHJvdXRlU3RyaW5nLnJlcGxhY2UoXCJyb3V0ZS1cIiwgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlU3RyaW5nID0gcm91dGVTdHJpbmcucmVwbGFjZShcIi10YWJsZVwiLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlID0gcGFyc2VJbnQocm91dGVTdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpdGVtXS5uYW1lID09IFwiZGF0YS1zdG9wXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9wID0gYXR0cmlidXRlc1tpdGVtXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlUm91dGVMb2NhdGlvbihyb3V0ZSwgc3RvcCwgZXZ0Lm5ld0luZGV4LCAxMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVXBkYXRlOiBmdW5jdGlvbiAoLyoqRXZlbnQqL2V2dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzYW1lIHByb3BlcnRpZXMgYXMgb25FbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBldnQuaXRlbS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcm91dGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpdGVtXS5uYW1lID09IFwiZGF0YS1yb3V0ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGUgPSBhdHRyaWJ1dGVzW2l0ZW1dLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXNbaXRlbV0ubmFtZSA9PSBcImRhdGEtc3RvcFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcCA9IGF0dHJpYnV0ZXNbaXRlbV0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvdXRlICYmIHN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVSb3V0ZUxvY2F0aW9uKHJvdXRlLCBzdG9wLCBldnQubmV3SW5kZXgsIGV2dC5vbGRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBzb3J0YWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcm91dGUuYWRkcmVzc19pZCA9IDE3NjYzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm91dGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVSb3V0ZUxvY2F0aW9uID0gZnVuY3Rpb24gKHJvdXRlLCBzdG9wLCBpbmRleCwgb2xkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUm91dGVcIiwgcm91dGUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInN0b3BcIiwgc3RvcCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaW5kZXhcIiwgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW92aW5nU3RvcCA9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRpc3BsYWNlZFN0b3BzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUucm91dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnJvdXRlc1tpdGVtXS5pZCA9PSByb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSAkc2NvcGUucm91dGVzW2l0ZW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHN0b3BJIGluIGNvbnRhaW5lci5zdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnN0b3BzW3N0b3BJXS5pZCA9PSBzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wID0gY29udGFpbmVyLnN0b3BzW3N0b3BJXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbGQgPiBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudGVyID49IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYWNlZFN0b3BzLnB1c2goY29udGFpbmVyLnN0b3BzW3N0b3BJXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRlciA+IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYWNlZFN0b3BzLnB1c2goY29udGFpbmVyLnN0b3BzW3N0b3BJXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpc3BsYWNlZFN0b3BzXCIsIGRpc3BsYWNlZFN0b3BzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtb3ZpbmdTdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wLnJvdXRlX2lkID0gcm91dGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZpbmdTdG9wLmlkID0gc3RvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1vdmluZyBzdG9wXCIsIG1vdmluZ1N0b3ApO1xuICAgICAgICAgICAgICAgICAgICAkKCcucHJlbG9hZGVyJykuZmFkZUluKCdzbG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVSb3V0ZVN0b3AobW92aW5nU3RvcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY291bnRlciA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzcGxhY2VkU3RvcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBkaXNwbGFjZWRTdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlU3BlZWQoZGlzcGxhY2VkU3RvcHNbaXRlbV0sIGNvdW50ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGlzcGxhY2luZyBzdG9wXCIsIGRpc3BsYWNlZFN0b3BzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAgKiAoY291bnRlciArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAgKiAoY291bnRlciArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVTcGVlZCA9IGZ1bmN0aW9uIChzdG9wLCBjb3VudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVJvdXRlU3RvcChzdG9wKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwICogKGNvdW50ZXIgKyAxKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRSb3V0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhdHVzXCIsICRzY29wZS5zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInByb3ZpZGVyXCIsICRzY29wZS5wcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcImluY2x1ZGVzPXN0b3BzLmFkZHJlc3Mmb3JkZXJfYnk9aWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJnR5cGU9XCIgKyAkc2NvcGUuc2NlbmFyaW8gKyBcIiZzdGF0dXM9XCIgKyAkc2NvcGUuc3RhdHVzICsgXCImcHJvdmlkZXI9XCIgKyAkc2NvcGUucHJvdmlkZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3RhdHVzICE9IFwicGVuZGluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBcImluY2x1ZGVzPXN0b3BzLmFkZHJlc3Mmb3JkZXJfYnk9aWQsYXNjJnBhZ2U9XCIgKyAkc2NvcGUucGFnZSArIFwiJnN0YXR1cz1cIiArICRzY29wZS5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBSb3V0ZXMuZ2V0Um91dGVzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlc0NvbnQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gcm91dGVzQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlc0NvbnRbaXRlbV0gPSAkc2NvcGUuYnVpbGRSb3V0ZURhdGEocm91dGVzQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzID0gcm91dGVzQ29udDtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5jbGVhbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdHlWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZW5kUmVtaW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIEZvb2Quc2VuZFJlbWluZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICAgICAgZm9yIChyb3V0ZSBpbiAkc2NvcGUucm91dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHMgPSAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBzdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgc3RvcFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLm1hcmtlci5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlc1tyb3V0ZV0uc3RvcHMgPSBzdG9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yb3V0ZXNbcm91dGVdLnBvbHlsaW5lLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICAgICAgZm9yIChyb3V0ZSBpbiAkc2NvcGUucm91dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHMgPSAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBzdG9wcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgc3RvcFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdG9wc1tpdGVtXS5tYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcHNbaXRlbV0ubWFya2VyLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm91dGVzW3JvdXRlXS5zdG9wcyA9IHN0b3BzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yb3V0ZXNbcm91dGVdLnBvbHlsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvdXRlc1tyb3V0ZV0ucG9seWxpbmUuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zaG93Um91dGUgPSBmdW5jdGlvbiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVBbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcHMgPSByb3V0ZS5zdG9wcztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIHN0b3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhIHN0b3BcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzW2l0ZW1dLm1hcmtlci5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvdXRlLnBvbHlsaW5lLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVJvdXRlU3RvcCA9IGZ1bmN0aW9uIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy51cGRhdGVSb3V0ZVN0b3Aoc3RvcC5pZCwgc3RvcC5yb3V0ZV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlUm91dGVEZWxpdmVyeSA9IGZ1bmN0aW9uIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy51cGRhdGVSb3V0ZVN0b3Aoc3RvcC5yb3V0ZV9pZCwgc3RvcC5tb3ZpbmdfZGVsaXZlcnksIHN0b3AuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZVJvdXRlID0gZnVuY3Rpb24gKHJvdXRlX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy5kZWxldGVSb3V0ZShyb3V0ZV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcCA9IGZ1bmN0aW9uIChzdG9wX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy5kZWxldGVTdG9wKHN0b3BfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZW5kU3RvcFRvTmV3Um91dGUgPSBmdW5jdGlvbiAoc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBSb3V0ZXMuc2VuZFN0b3BUb05ld1JvdXRlKHN0b3ApLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRSZXR1cm5TdG9wID0gZnVuY3Rpb24gKHJvdXRlLCBhZGRyZXNzX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIFJvdXRlcy5hZGRSZXR1cm5TdG9wKHJvdXRlLCBhZGRyZXNzX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuYnVpbGRSb3V0ZSA9IGZ1bmN0aW9uIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBGb29kLmJ1aWxkU2NlbmFyaW9Sb3V0ZUlkKHJvdXRlLmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3V0ZS5zdGF0dXMgPSBcInNjaGVkdWxlZFwiO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFB1cmNoYXNlT3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIEZvb2QuZ2V0UHVyY2hhc2VPcmRlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5yZWdlbmVyYXRlU2NlbmFyaW9zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBGb29kLnJlZ2VuZXJhdGVTY2VuYXJpb3MoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnZW5lcmF0ZURlbGl2ZXJpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIEZvb2QucmVnZW5lcmF0ZURlbGl2ZXJpZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0VG90YWxTaGlwcGluZ0Nvc3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBGb29kLmdldFN1bW1hcnlTaGlwcGluZygkc2NvcGUuc3RhdHVzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U2NlbmFyaW9Pcmdhbml6YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gJHNjb3BlLmdldElucHV0cygpO1xuICAgICAgICAgICAgICAgICAgICBGb29kLmdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5idWlsZFNjZW5hcmlvTG9naXN0aWNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9ICRzY29wZS5nZXRJbnB1dHMoKTtcbiAgICAgICAgICAgICAgICAgICAgRm9vZC5idWlsZFNjZW5hcmlvTG9naXN0aWNzKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRJbnB1dHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnN0YXR1cyA9PSBcImVucXVldWVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiBcImVucXVldWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGF0dXNcIjogJHNjb3BlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb3ZpZGVyXCI6ICRzY29wZS5wcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogJHNjb3BlLnNjZW5hcmlvXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U2NlbmFyaW9FbWFpbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gJHNjb3BlLmdldElucHV0cygpO1xuICAgICAgICAgICAgICAgICAgICBGb29kLmdldFNjZW5hcmlvU3RydWN0dXJlKGRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XSkuY29udHJvbGxlcignUmFwaWdvQ3RybCcsIFsnJHNjb3BlJywgJ1BheW1lbnRzJywgZnVuY3Rpb24gKCRzY29wZSwgUm91dGVzKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICRzY29wZS5rZXk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHN0ciA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICAgICAgdmFyIHJlcyA9IHN0ci5zcGxpdChcIi9cIik7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLmdldFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFJvdXRlcy5nZXRLZXlTdGF0dXMoJHNjb3BlLmtleSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JhcGlnb0N0cmwnLCBbJyRzY29wZScsICdNYXBTZXJ2aWNlJywgJ1JvdXRlcycsIGZ1bmN0aW9uICgkc2NvcGUsIE1hcFNlcnZpY2UsIFJvdXRlcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5tYXAgPSB7Y2VudGVyOiB7bGF0aXR1ZGU6IDQuNjUzNDUwLCBsb25naXR1ZGU6IC03NC4wNDk2MDV9LCB6b29tOiA4fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWFya2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWFya2VyU3RhdHVzID0gXCJcIjtcbiAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY1MzQ1MCwgLTc0LjA0OTYwNSk7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHN0ci5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5rZXkgPSByZXNbcmVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0VXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgUm91dGVzLmdldEtleVN0YXR1cygkc2NvcGUua2V5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGRhdGEucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tYXJrZXJTdGF0dXMgPSByZXN1bHRzLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMuY3VyaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5jdXJpZXIubGF0ICYmICFpc05hTihyZXN1bHRzLmN1cmllci5sYXQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1hcmtlci5zZXRQb3NpdGlvbihuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHJlc3VsdHMuY3VyaWVyLmxhdCwgcmVzdWx0cy5jdXJpZXIubG9uKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1hcmtlciA9IE1hcFNlcnZpY2UuY3JlYXRlTG9jYXRpb25NYXJrZXIocmVzdWx0cy5jdXJpZXIubGF0LCByZXN1bHRzLmN1cmllci5sb24sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLnNldENlbnRlck1hcChyZXN1bHRzLmN1cmllci5sYXQsIHJlc3VsdHMuY3VyaWVyLmxvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0VXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9yb3V0ZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 26 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('SitemapCtrl', ['$scope', 'Cart', '$rootScope', 'Modals', function ($scope, Cart, $rootScope, Modals) {\n                $scope.data = {};\n                $scope.user = {};\n                $scope.current = 1;\n                $scope.last = 1;\n                $scope.total = 1;\n                $scope.per_page = 1;\n                $scope.merchants = [];\n                $scope.categories = [];\n                $scope.regionVisible = false;\n                $scope.editMerchant = false;\n                $scope.submitted = false;\n                $scope.category;\n                angular.element(document).ready(function () {\n                });\n                $rootScope.$on('updateShippingAddress', function () {\n                    if ($rootScope.user) {\n                        Cart.showConfirm(window.location.href);\n                    } else {\n                        Cart.showConfirmExt(window.location.href);\n                    }\n                });\n\n                $scope.goTo = function (type, $event) {\n                    if (type == \"merchant\" || type == \"report\") {\n                        //$event.preventDefault()\n                    }\n                    console.log(\"Going\");\n                    var url = $event.target.href;\n                    if (type.includes(\"nearby\") || type.includes(\"coverage\")) {\n\n                        if (type.includes(\"nearby\")) {\n                            url += \"/nearby\"\n                        } else if (type.includes(\"coverage\")) {\n                            url += \"/coverage\"\n                        }\n                        console.log(\"Type\", type);\n                        console.log(\"target\", $event.target.href);\n                        $event.preventDefault()\n\n                        if (!$rootScope.shippingAddress) {\n                            if ($rootScope.user) {\n                                Cart.showConfirm(url);\n                            } else {\n                                Cart.showConfirmExt(url);\n                            }\n\n                        } else {\n                            var params = Modals.getAllUrlParams();\n                            if (params) {\n\n                            } else {\n                                params = {};\n                            }\n                            params.lat = $rootScope.shippingAddress.lat;\n                            params.long = $rootScope.shippingAddress.long;\n                            console.log(\"params\", params);\n\n                            console.log(\"res\", Modals.turnObjectToUrl(params, url));\n                            window.location.href = Modals.turnObjectToUrl(params, url)\n                        }\n                    } else {\n                        window.location.href = url;\n                    }\n                }\n            }])\n        .controller('SearchCtrl', ['$scope', '$rootScope', '$cookies','Modals', function ($scope, $rootScope, $cookies,Modals) {\n                $scope.category = \"products|0|coverage\";\n                $scope.searchText = \"\";\n                $scope.showError = false;\n                $scope.searchVisible = false;\n                $rootScope.$on('showSearch', function () {\n                    if ($scope.searchVisible) {\n                        $scope.searchVisible = false;\n                    } else {\n                        $scope.searchVisible = true;\n                    }\n                });\n\n                angular.element(document).ready(function () {\n                    var params;\n//                    let url = window.location.href;\n//                    if(url.includes(\"merchant\")){\n//                        $scope.category = \"merchants|0|list\";\n//                    } else if(url.includes(\"report\")){\n//                        $scope.category = \"reports|0|list\";\n//                    }\n                    params = Modals.getAllUrlParams();\n                    if (params) {\n                        if(params.q){\n                            $scope.searchText = decodeURIComponent(params.q);\n                        }\n                    }\n                });\n                $scope.selectCat = function () {\n                    if ($scope.category.length > 0) {\n                        $scope.showError = false;\n                    }\n                }\n\n                $scope.search = function () {\n                    if ($scope.category.length > 0) {\n                        console.log(\"Search: \", $scope.searchText, \" Category: \", $scope.category);\n                        var results = $scope.category.split(\"|\");\n                        var url = \"\";\n                        if (results[0] == \"merchants\") {\n                            url = \"/a/merchant-search\";\n                        } else if (results[0] == \"reports\") {\n                            url = \"/a/report-search\";\n                        } else if (results[0] == \"products\") {\n                            url = \"/a/product-search\";\n                        }\n                        if (results[2] == \"nearby\" || results[2] == \"coverage\") {\n                            if ($rootScope.shippingAddress) {\n                                if (results[1] == \"0\") {\n                                    url += \"?lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long + \"&q=\" + $scope.searchText\n                                } else {\n                                    url += \"?categories=\" + results[1] + \"&lat=\" + $rootScope.shippingAddress.lat + \"&long=\" + $rootScope.shippingAddress.long + \"&q=\" + $scope.searchText\n                                }\n\n                            } else {\n                                if (results[1] == \"0\") {\n                                    url += \"?q=\" + $scope.searchText\n                                } else {\n                                    url += \"?categories=\" + results[1] + \"&q=\" + $scope.searchText\n                                }\n\n                                $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\n                                window.location.href = \"/location\";\n                                return;\n                            }\n                        } else {\n                            if (results[1] == \"0\") {\n                                url += \"?q=\" + $scope.searchText\n                            } else {\n                                url += \"?categories=\" + results[1] + \"&q=\" + $scope.searchText\n                            }\n                        }\n                        window.location.href = url;\n                        //console.log(\"Url\",url);\n                    } else {\n                        $scope.showError = true;\n                    }\n                }\n            }])\n        .controller('HomeCtrl', ['$scope', 'Cart', '$rootScope', 'Modals', function ($scope, Cart, $rootScope, Modals) {\n                $scope.data = {};\n                $scope.user = {};\n                $scope.category;\n\n\n                $scope.goTo = function (type, $event, isCat) {\n                    if (type.includes(\"nearby\") || type.includes(\"coverage\")) {\n                        var url = $event.currentTarget.href;\n                        if (isCat) {\n                            if (type.includes(\"nearby\")) {\n                                url += \"/nearby\"\n                            } else if (type.includes(\"coverage\")) {\n                                url += \"/coverage\"\n                            }\n                        }\n\n                        console.log(\"Type\", type);\n                        console.log(\"target\", $event.currentTarget.href);\n                        $event.preventDefault()\n\n                        if (!$rootScope.shippingAddress) {\n                            if ($rootScope.user) {\n                                Cart.showConfirm(url);\n                            } else {\n                                Cart.showConfirmExt(url);\n                            }\n\n                        } else {\n                            var params;\n                            params = Modals.getAllUrlParams(url);\n\n                            if (params) {\n\n                            } else {\n                                params = {};\n                            }\n                            params.lat = $rootScope.shippingAddress.lat;\n                            params.long = $rootScope.shippingAddress.long;\n                            console.log(\"params\", params);\n                            console.log(\"res\", Modals.turnObjectToUrl(params, url));\n                            window.location.href = Modals.turnObjectToUrl(params, url)\n                        }\n                    }\n                }\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zaXRlbWFwY3RybC5qcz9kYWRlIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdTaXRlbWFwQ3RybCcsIFsnJHNjb3BlJywgJ0NhcnQnLCAnJHJvb3RTY29wZScsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBDYXJ0LCAkcm9vdFNjb3BlLCBNb2RhbHMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnQgPSAxO1xuICAgICAgICAgICAgICAgICRzY29wZS5sYXN0ID0gMTtcbiAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSAxO1xuICAgICAgICAgICAgICAgICRzY29wZS5wZXJfcGFnZSA9IDE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1lcmNoYW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbigndXBkYXRlU2hpcHBpbmdBZGRyZXNzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dDb25maXJtKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0NvbmZpcm1FeHQod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbyA9IGZ1bmN0aW9uICh0eXBlLCAkZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJtZXJjaGFudFwiIHx8IHR5cGUgPT0gXCJyZXBvcnRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8kZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR29pbmdcIik7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSAkZXZlbnQudGFyZ2V0LmhyZWY7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlLmluY2x1ZGVzKFwibmVhcmJ5XCIpIHx8IHR5cGUuaW5jbHVkZXMoXCJjb3ZlcmFnZVwiKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZS5pbmNsdWRlcyhcIm5lYXJieVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCArPSBcIi9uZWFyYnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlLmluY2x1ZGVzKFwiY292ZXJhZ2VcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCIvY292ZXJhZ2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUeXBlXCIsIHR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0YXJnZXRcIiwgJGV2ZW50LnRhcmdldC5ocmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRldmVudC5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcnQuc2hvd0NvbmZpcm0odXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dDb25maXJtRXh0KHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSBNb2RhbHMuZ2V0QWxsVXJsUGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5sYXQgPSAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmxvbmcgPSAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sb25nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1zXCIsIHBhcmFtcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc1wiLCBNb2RhbHMudHVybk9iamVjdFRvVXJsKHBhcmFtcywgdXJsKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBNb2RhbHMudHVybk9iamVjdFRvVXJsKHBhcmFtcywgdXJsKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1NlYXJjaEN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRjb29raWVzJywnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgJGNvb2tpZXMsTW9kYWxzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5ID0gXCJwcm9kdWN0c3wwfGNvdmVyYWdlXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdzaG93U2VhcmNoJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnNlYXJjaFZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2hWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zO1xuLy8gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbi8vICAgICAgICAgICAgICAgICAgICBpZih1cmwuaW5jbHVkZXMoXCJtZXJjaGFudFwiKSl7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeSA9IFwibWVyY2hhbnRzfDB8bGlzdFwiO1xuLy8gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZih1cmwuaW5jbHVkZXMoXCJyZXBvcnRcIikpe1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2F0ZWdvcnkgPSBcInJlcG9ydHN8MHxsaXN0XCI7XG4vLyAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBNb2RhbHMuZ2V0QWxsVXJsUGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhcmFtcy5xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVGV4dCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXJhbXMucSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0Q2F0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNhdGVnb3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuY2F0ZWdvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWFyY2g6IFwiLCAkc2NvcGUuc2VhcmNoVGV4dCwgXCIgQ2F0ZWdvcnk6IFwiLCAkc2NvcGUuY2F0ZWdvcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSAkc2NvcGUuY2F0ZWdvcnkuc3BsaXQoXCJ8XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0c1swXSA9PSBcIm1lcmNoYW50c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gXCIvYS9tZXJjaGFudC1zZWFyY2hcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0c1swXSA9PSBcInJlcG9ydHNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IFwiL2EvcmVwb3J0LXNlYXJjaFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHRzWzBdID09IFwicHJvZHVjdHNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IFwiL2EvcHJvZHVjdC1zZWFyY2hcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzWzJdID09IFwibmVhcmJ5XCIgfHwgcmVzdWx0c1syXSA9PSBcImNvdmVyYWdlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMV0gPT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCArPSBcIj9sYXQ9XCIgKyAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQgKyBcIiZsb25nPVwiICsgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZyArIFwiJnE9XCIgKyAkc2NvcGUuc2VhcmNoVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiP2NhdGVnb3JpZXM9XCIgKyByZXN1bHRzWzFdICsgXCImbGF0PVwiICsgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0ICsgXCImbG9uZz1cIiArICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcgKyBcIiZxPVwiICsgJHNjb3BlLnNlYXJjaFRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMV0gPT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCArPSBcIj9xPVwiICsgJHNjb3BlLnNlYXJjaFRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCArPSBcIj9jYXRlZ29yaWVzPVwiICsgcmVzdWx0c1sxXSArIFwiJnE9XCIgKyAkc2NvcGUuc2VhcmNoVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgdXJsLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9sb2NhdGlvblwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0c1sxXSA9PSBcIjBcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCI/cT1cIiArICRzY29wZS5zZWFyY2hUZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICs9IFwiP2NhdGVnb3JpZXM9XCIgKyByZXN1bHRzWzFdICsgXCImcT1cIiArICRzY29wZS5zZWFyY2hUZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiVXJsXCIsdXJsKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV0pXG4gICAgICAgIC5jb250cm9sbGVyKCdIb21lQ3RybCcsIFsnJHNjb3BlJywgJ0NhcnQnLCAnJHJvb3RTY29wZScsICdNb2RhbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBDYXJ0LCAkcm9vdFNjb3BlLCBNb2RhbHMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VyID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3J5O1xuXG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ29UbyA9IGZ1bmN0aW9uICh0eXBlLCAkZXZlbnQsIGlzQ2F0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlLmluY2x1ZGVzKFwibmVhcmJ5XCIpIHx8IHR5cGUuaW5jbHVkZXMoXCJjb3ZlcmFnZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9ICRldmVudC5jdXJyZW50VGFyZ2V0LmhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDYXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZS5pbmNsdWRlcyhcIm5lYXJieVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCIvbmVhcmJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUuaW5jbHVkZXMoXCJjb3ZlcmFnZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gXCIvY292ZXJhZ2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUeXBlXCIsIHR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0YXJnZXRcIiwgJGV2ZW50LmN1cnJlbnRUYXJnZXQuaHJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudXNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJ0LnNob3dDb25maXJtKHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FydC5zaG93Q29uZmlybUV4dCh1cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYW1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyA9IE1vZGFscy5nZXRBbGxVcmxQYXJhbXModXJsKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMubGF0ID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5sb25nID0gJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhcmFtc1wiLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIsIE1vZGFscy50dXJuT2JqZWN0VG9VcmwocGFyYW1zLCB1cmwpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IE1vZGFscy50dXJuT2JqZWN0VG9VcmwocGFyYW1zLCB1cmwpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zaXRlbWFwY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 27 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('SourcesCtrl',['$scope', 'Billing', '$rootScope', function ($scope, Billing, $rootScope) {\n            $scope.data = {};\n            $scope.months = [];\n            $scope.years = [];\n            $scope.branches = [\n                {\"name\": \"Visa\", \"value\": \"VISA\"},\n                {\"name\": \"Mastercard\", \"value\": \"MASTERCARD\"},\n                {\"name\": \"Visa Debito\", \"value\": \"VISA_DEBIT\"},\n                {\"name\": \"Diners\", \"value\": \"DINERS\"},\n                {\"name\": \"American Express\", \"value\": \"AMEX\"}\n            ];\n            $scope.sources = [];\n            $scope.buying = false;\n            $scope.editSource = false;\n            $scope.showStripe = false;\n            $scope.hideDefault = false;\n            $scope.config = {};\n            angular.element(document).ready(function () {\n                $scope.localGateway = $scope.config.gateway;\n            });\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                console.log(\"Saving: \" + isvalid);\n                if (isvalid) {\n                    $scope.showStripe = true;\n                }\n            }\n            $scope.edit = function () {\n                if ($scope.editSource) {\n                    $scope.editSource = false;\n                } else {\n                    $scope.editSource = true;\n                }\n            }\n            // Create an instance of Elements\n            var elements = stripe.elements({locale: $translate.use()});\n\n            // Custom styling can be passed to options when creating an Element.\n            // (Note that this demo uses a wider set of styles than the guide below.)\n            var style = {\n                base: {\n                    color: '#32325d',\n                    lineHeight: '24px',\n                    fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n                    fontSmoothing: 'antialiased',\n                    fontSize: '16px',\n                    '::placeholder': {\n                        color: '#aab7c4'\n                    }\n                },\n                invalid: {\n                    color: '#fa755a',\n                    iconColor: '#fa755a'\n                }\n            };\n\n            // Create an instance of the card Element\n            var card = elements.create('card', {style: style});\n\n            // Add an instance of the card Element into the `card-element` <div>\n            card.mount('#card-element');\n\n            // Handle real-time validation errors from the card Element.\n            card.addEventListener('change', function (event) {\n                var displayError = document.getElementById('card-errors');\n                if (event.error) {\n                    displayError.textContent = event.error.message;\n                } else {\n                    displayError.textContent = '';\n                }\n            });\n\n            // Handle form submission\n            var form = document.getElementById('payment-form');\n            var ownerInfo = {\n                owner: {\n                    name: $scope.data.name,\n                    address: {\n                        line1: $scope.data.address,\n                        city: $scope.data.city,\n                        postal_code: $scope.data.postal,\n                        country: $scope.data.country,\n                    },\n                    email: $scope.data.email\n                },\n            };\n            form.addEventListener('submit', function (event) {\n                event.preventDefault();\n\n                stripe.createSource(card, ownerInfo).then(function (result) {\n                    if (result.error) {\n                        // Inform the user if there was an error\n                        var errorElement = document.getElementById('card-errors');\n                        errorElement.textContent = result.error.message;\n                    } else {\n                        // Send the source to your server\n                        stripeSourceHandler(result.source);\n                    }\n                });\n            });\n\n            $scope.stripeCreateToken = function () {\n                \n            }\n\n            function stripeSourceHandler(token) {\n                $scope.data.source = token;\n                $scope.saveSource();\n            }\n            $scope.loadMonths = function () {\n                console.log(\"Loading months\");\n                var date = new Date();\n                for (i = 0; i < 15; i++) {\n                    $scope.years.push(date.getFullYear() + i);\n                }\n                for (i = 0; i < 12; i++) {\n                    $scope.months.push(1 + i);\n                }\n            }\n            $scope.saveSource = function () {\n                delete $scope.data['cvc'];\n                delete $scope.data['expMonth'];\n                delete $scope.data['expYear'];\n                delete $scope.data['number'];\n                delete $scope.data['postal'];\n                console.log(\"Data sent\");\n                console.log(JSON.stringify($scope.data));\n                console.log(JSON.stringify($.param($scope.data)));\n                Billing.createSource($.param($scope.data), $rootScope.gateway).then(function (data) {\n                    console.log(\"Return source\");\n                    console.log(JSON.stringify(data));\n                    if (data.type == \"card\") {\n                        var card = data.card;\n                        card.type = \"card\";\n                        $scope.sources.push(card);\n                        $scope.editSource = false;\n                    }\n                    $scope.data = {};\n                    $scope.submitted = false;\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.getSources = function (gateway) {\n                Billing.getSources(gateway).then(function (data) {\n\n                    var sources = data.sources;\n                    for (item in sources) {\n                        if (sources[item].type == \"card\") {\n                            var card = sources[item].card;\n                            card.type = \"card\";\n                            card.id = sources[item].id;\n                            card.is_default = sources[item].is_default;\n                            $scope.sources.push(card);\n                        }\n                    }\n                    if (sources.length == 0) {\n                        $scope.editSource = true;\n                        $scope.hidedefault = true;\n                        $scope.data.default = true;\n                    } else {\n                        $scope.hidedefault = false;\n                    }\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteSource = function (source) {\n                Billing.deleteSource(source.id, $rootScope.gateway).then(function (data) {\n                    for (item in $scope.sources) {\n                        if ($scope.sources[item].id == source.id) {\n                            console.log(\"deleting source\", $scope.sources[item]);\n                            $scope.sources.splice(item, 1);\n                        }\n                    }\n                },\n                        function (data) {\n                        });\n            }\n            $scope.loadTestData = function (source) {\n\n                $scope.data.cvc = \"123\";\n                $scope.data.postal = \"33132\";\n                $scope.data.expYear = \"2020\";\n                $scope.data.expMonth = \"12\";\n\n            }\n            $scope.selectSource = function (source) {\n                $rootScope.$broadcast('SourceSelected', {source: source.id});\n            }\n            $rootScope.$on('GetSources', function (event, args) {\n                $scope.getSources(args.gateway);\n                $scope.buying = true;\n            });\n            $rootScope.$on('GatewaySelected', function (event, args) {\n                if ($rootScope.gateway == $scope.localGateway) {\n                    $scope.getSources($scope.localGateway);\n                    $scope.loadMonths();\n                    $scope.loadTestData();\n                }\n            });\n            $scope.clean = function () {\n                $scope.data = {};\n            }\n            $scope.setAsDefault = function (source) {\n                var data = {};\n                data.source = source.id\n                Billing.setAsDefault(data, $rootScope.gateway).then(function (data) {\n                    for (item in $scope.sources) {\n                        $scope.sources[item].is_default = false;\n                        if ($scope.sources[item].id == source.id) {\n                            $scope.sources[item].is_default = true;\n                        }\n                    }\n                },\n                        function (data) {\n                            window.location.reload();\n                        });\n            }\n\n\n        }]).controller('SourcesPayuCtrl',['$scope', 'Billing', '$rootScope', function ($scope, Billing, $rootScope) {\n    $scope.data = {};\n    $scope.months = [];\n    $scope.years = [];\n    $scope.branches = [\n        {\"name\": \"Visa\", \"value\": \"VISA\"},\n        {\"name\": \"Mastercard\", \"value\": \"MASTERCARD\"},\n        {\"name\": \"Visa Debito\", \"value\": \"VISA_DEBIT\"},\n        {\"name\": \"Diners\", \"value\": \"DINERS\"},\n        {\"name\": \"American Express\", \"value\": \"AMEX\"}\n    ];\n    $scope.sources = [];\n    $scope.buying = false;\n    $scope.showErrors = false;\n    $scope.editSource = false;\n    $scope.errors = [];\n    $scope.config = {};\n    angular.element(document).ready(function () {\n\n        $scope.localGateway = \"PayU\";\n\n    });\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        $scope.showErrors = false;\n        console.log(\"Saving: \" + isvalid);\n        if (isvalid) {\n            $scope.saveSource();\n        }\n    }\n    $scope.edit = function () {\n        if ($scope.editSource) {\n            $scope.editSource = false;\n        } else {\n            $scope.editSource = true;\n        }\n    }\n    $scope.loadMonths = function () {\n        console.log(\"Loading months\");\n        var date = new Date();\n        for (i = 0; i < 15; i++) {\n            $scope.years.push(date.getFullYear() + i);\n        }\n        for (i = 0; i < 12; i++) {\n            $scope.months.push(1 + i);\n        }\n    }\n    $scope.saveSource = function () {\n        console.log(\"Data sent\");\n        console.log(JSON.stringify($scope.data));\n        console.log(JSON.stringify($.param($scope.data)));\n        Billing.createSource($.param($scope.data), $scope.localGateway).then(function (result) {\n            console.log(\"Reply to create\");\n            console.log(JSON.stringify(result));\n            if (result.status == \"success\") {\n                $scope.getSources();\n                $scope.data = {};\n                $scope.data.country = \"CO\";\n                $scope.submitted = false;\n                $scope.editSource = false;\n            } else {\n                $scope.editSource = true;\n                $scope.errors = result;\n                $scope.showErrors = true;\n            }\n\n        },\n                function (data) {\n\n                });\n    }\n    $scope.getSources = function () {\n        Billing.getSources($scope.localGateway).then(function (data) {\n            console.log(\"Sources\");\n            $scope.sources = [];\n            var sources = data.sources;\n            console.log(JSON.stringify(sources));\n            for (item in sources) {\n                var card = sources[item];\n                card.type = \"card\";\n                $scope.sources.push(card);\n            }\n            if (sources.length == 0) {\n                $scope.editSource = true;\n            }\n        },\n                function (data) {\n\n                });\n    }\n    $scope.deleteSource = function (source) {\n        Billing.deleteSource(source.token, $scope.localGateway).then(function (data) {\n            for (item in $scope.sources) {\n                if ($scope.sources[item].token == source.token) {\n                    console.log(\"deleting source\", $scope.sources[item]);\n                    $scope.sources.splice(item, 1);\n                    if ($scope.sources.length == 0) {\n                        $scope.editSource = true;\n                    }\n                }\n            }\n        },\n                function (data) {\n                });\n    }\n    $scope.loadTestData = function () {\n        $scope.data.name = \"Hoovert Arredondo\";\n        $scope.data.line1 = \"Calle 73 # 0-24\";\n        $scope.data.line2 = \"Apto 202\";\n        $scope.data.line3 = \"\";\n        $scope.data.postalCode = \"\";\n        $scope.data.city = \"Bogota\";\n        $scope.data.state = \"Cundinamarca\";\n        $scope.data.country = \"CO\";\n        $scope.data.phone = \"3105507245\";\n        $scope.data.document = \"1020716535\";\n        $scope.data.number = \"4111111111111111\";\n        $scope.data.expMonth = \"10\";\n        $scope.data.expYear = \"2020\";\n        $scope.data.branch = \"VISA\";\n\n    }\n    $scope.selectSource = function (source) {\n        $rootScope.$broadcast('SourceSelected', {source: source.id});\n    }\n    $rootScope.$on('GetSources', function (event, args) {\n        $scope.getSources();\n        $scope.buying = true;\n    });\n    $rootScope.$on('GatewaySelected', function (event, args) {\n        if ($rootScope.gateway == $scope.localGateway) {\n            $scope.getSources();\n            $scope.loadTestData();\n        }\n    });\n    $scope.clean = function () {\n        $scope.data = {};\n    }\n    $scope.setAsDefault = function (source) {\n        var data = {};\n        data.source = source.token\n        Billing.setAsDefault(data, $scope.localGateway).then(function (data) {\n            for (item in $scope.sources) {\n                $scope.sources[item].is_default = false;\n                if ($scope.sources[item].token == source.token) {\n                    $scope.sources[item].is_default = true;\n                }\n            }\n        },\n                function (data) {\n                    window.location.reload();\n                });\n    }\n\n\n}]).controller('SubscriptionsCtrl',['$scope', 'Billing', function ($scope, Billing) {\n    $scope.data = {};\n    $scope.subscriptions = [];\n    $scope.plans = [];\n    $scope.showEdit = false;\n    $scope.localGateway = \"\";\n    angular.element(document).ready(function () {\n        $scope.getSubscriptions();\n    });\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            var data = {plan_id: $scope.data.plan_id};\n            Billing.editSubscription(data, $scope.data.subscription_id, $scope.localGateway).then(function (data) {\n                $scope.data.subscription_id = \"\" + $scope.data.subscription_id;\n                for (item in $scope.subscriptions) {\n                    if ($scope.subscriptions[item].source_id == $scope.data.subscription_id) {\n                        console.log(\"deleting subscription\", $scope.subscriptions[item]);\n                        $scope.subscriptions.splice(item, 1);\n\n                    }\n                }\n                $scope.subscriptions.push(data.subscription);\n            },\n                    function (data) {\n                    });\n        }\n    }\n    $scope.getSubscriptions = function () {\n        Billing.getSubscriptions().then(function (data) {\n            $scope.subscriptions = data.subscriptions;\n            for (x in $scope.subscriptions) {\n                var obj = $scope.subscriptions[x].object;\n                $scope.subscriptions[x].object_name = obj.name;\n                $scope.subscriptions[x].object_code = obj.code;\n                $scope.subscriptions[x].object_status = obj.status;\n                $scope.subscriptions[x].object_ends = obj.ends_at;\n            }\n        },\n                function (data) {\n\n                });\n    }\n    $scope.getPlans = function () {\n        Billing.getPlans().then(function (data) {\n            $scope.plans = data.plans;\n\n        },\n                function (data) {\n\n                });\n    }\n    $scope.deleteSubscription = function (subscription) {\n        Billing.deleteSubscription(subscription.source_id, subscription.gateway).then(function (data) {\n            var subscription_id = \"\" + subscription.source_id;\n            for (item in $scope.subscriptions) {\n                if ($scope.subscriptions[item].source_id == subscription_id) {\n                    $scope.subscriptions.splice(item, 1);\n                }\n            }\n        },\n                function (data) {\n                });\n    }\n    $scope.clean = function () {\n        $scope.data = {};\n    }\n    $scope.editSubscription = function (subscription) {\n        $scope.data.subscription_id = subscription.id;\n        $scope.getPlans();\n        $scope.showEdit = true;\n    }\n\n}]).controller('PlansCtrl',['$scope', '$rootScope', function ($scope, $rootScope) {\n\n    $scope.selectPlan = function (plan) {\n        $rootScope.$broadcast('PlanSelected', {plan: plan});\n    }\n}])\n        .controller('GatewaysCtrl', function ($scope, $rootScope) {\n\n            $scope.data = {};\n            $scope.objectSelected = false;\n\n\n            $scope.selectGateway = function (gateway) {\n                $rootScope.gateway = gateway;\n                $rootScope.$broadcast('GatewaySelected');\n            }\n            $rootScope.$on('ObjectSelected', function (event, args) {\n                $scope.objectSelected = true;\n            });\n        })\n        .controller('SubscriptionPlansStripeCtrl', function ($scope, Billing, $rootScope) {\n            $scope.data = {};\n            $scope.months = [];\n            $scope.years = [];\n            $scope.sources = [];\n            $scope.localGateway = \"\";\n            $scope.sourceSelected = false;\n            $scope.showSources = false;\n            $scope.buying = true;\n            $scope.data.object_id = 1;\n\n            angular.element(document).ready(function () {\n                $scope.localGateway = \"Stripe\";\n            });\n\n            $scope.saveSimple = function (isvalid) {\n                $scope.submitted = true;\n                if (isvalid) {\n                    $scope.createSubscription();\n                }\n            }\n\n            $scope.save = function (isvalid) {\n                $scope.submitted = true;\n                if (isvalid) {\n                    $scope.stripeCreateToken();\n                }\n            }\n            $scope.loadMonths = function () {\n                var date = new Date();\n                for (i = 0; i < 15; i++) {\n                    $scope.years.push(date.getFullYear() + i);\n                }\n                for (i = 0; i < 12; i++) {\n                    $scope.months.push(1 + i);\n                }\n            }\n            $scope.editSources = function () {\n                window.location.href = \"/sources\";\n            }\n            $scope.loadTestData = function () {\n                $scope.data.number = \"4242424242424242\";\n                $scope.data.cvc = \"123\";\n                $scope.data.postal = \"33132\";\n                $scope.data.expYear = \"2020\";\n                $scope.data.expMonth = \"12\";\n            }\n            $scope.createSubscription = function () {\n\n                $scope.data.default = true;\n                delete $scope.data['cvc'];\n                delete $scope.data['expMonth'];\n                delete $scope.data['expYear'];\n                delete $scope.data['number'];\n                delete $scope.data['postal'];\n                console.log(\"Data sent\");\n                console.log(JSON.stringify($scope.data));\n                console.log(JSON.stringify($.param($scope.data)));\n                Billing.createSubscription($.param($scope.data), $scope.localGateway).then(function (data) {\n                    if (\"status\" in data) {\n                        if (data.status == 'success') {\n                            console.log(\"Subscription created\");\n                            $scope.data = {};\n                            $scope.submitted = false;\n                            window.location.href = \"/subscriptions\";\n                        }\n                    }\n                    $scope.errors = data;\n                    $scope.showErrors = true;\n                },\n                        function (data) {\n\n                        });\n            }\n\n            $scope.stripeCreateToken = function () {\n                Stripe.source.create({\n                    type: 'card',\n                    card: {\n                        number: $scope.data.number,\n                        cvc: $scope.data.cvc,\n                        exp_month: $scope.data.expMonth,\n                        exp_year: $scope.data.expYear,\n                    },\n                    owner: {\n                        address: {\n                            postal_code: $scope.data.postal\n                        }\n                    }\n                }, stripeResponseHandler);\n            }\n            $rootScope.$on('PlanSelected', function (event, args) {\n                $scope.data.plan_id = args.plan;\n            });\n            $rootScope.$on('ObjectSelected', function (event, args) {\n                $scope.data.object_id = args.object_id;\n            });\n\n            function stripeResponseHandler(status, response) {\n\n\n                if (response.error) { // Problem!\n\n                    // Show the errors on the form\n                    //$form.find('.payment-errors').text(response.error.message);\n                    //$form.find('button').prop('disabled', false); // Re-enable submission\n\n                } else { // Source was created!\n                    // Get the source ID:\n                    $scope.data.source = response.id;\n                    $scope.createSubscription();\n\n                }\n            }\n            $rootScope.$on('GatewaySelected', function (event, args) {\n                if ($rootScope.gateway == $scope.localGateway) {\n                    console.log(JSON.stringify($scope.config));\n                    var sources = $scope.config.sources;\n                    console.log($scope.localGateway);\n                    for (item in sources) {\n                        console.log(JSON.stringify(sources[item]));\n                        if (sources[item].gateway == $scope.localGateway) {\n                            if (sources[item].has_default) {\n                                $scope.sourceSelected = true;\n                                console.log(\"Has default\");\n                            }\n                        }\n                    }\n                    $scope.loadMonths();\n                    $scope.loadTestData();\n                }\n            });\n        })\n        .controller('SubscriptionPlansPayuCtrl',['$scope', 'Billing', '$rootScope', function ($scope, Billing, $rootScope) {\n    $scope.data = {};\n    $scope.months = [];\n    $scope.years = [];\n    $scope.branches = [\n        {\"name\": \"Visa\", \"value\": \"VISA\"},\n        {\"name\": \"Mastercard\", \"value\": \"MASTERCARD\"},\n        {\"name\": \"Visa Debito\", \"value\": \"VISA_DEBIT\"},\n        {\"name\": \"Diners\", \"value\": \"DINERS\"},\n        {\"name\": \"American Express\", \"value\": \"AMEX\"}\n    ];\n    $scope.sources = [];\n    $scope.localGateway = \"\";\n    $scope.sourceSelected = false;\n    $scope.showSources = false;\n    $scope.buying = true;\n    $scope.hasDefault = false;\n    $scope.newCard = false;\n    $scope.data.object_id = 1;\n\n    angular.element(document).ready(function () {\n        $scope.localGateway = \"PayU\";\n    });\n\n    $scope.saveSimple = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            $scope.createSubscription();\n        }\n    }\n    $scope.selectSource = function (source) {\n        $scope.data.source = source.token;\n        $scope.submitted = true;\n        if ($scope.data.plan_id && $scope.data.object_id) {\n            $scope.sourceSelected = true;\n            $scope.createSubscription();\n        } \n    }\n    $scope.newCardTrigger = function () {\n        $scope.newCard = true;\n        $scope.sourceSelected = false;\n    }\n    $scope.getSources = function () {\n        $scope.sourceSelected = false;\n        $scope.newCard = false;\n        Billing.getSources($scope.localGateway).then(function (data) {\n            console.log(\"Sources\");\n            $scope.sources = [];\n            var sources = data.sources;\n            console.log(JSON.stringify(sources));\n            for (item in sources) {\n                var card = sources[item];\n                card.type = \"card\";\n                $scope.sources.push(card);\n            }\n            if (sources.length == 0) {\n                $scope.newCard = true;\n            }\n        },\n                function (data) {\n\n                });\n    }\n\n    $scope.save = function (isvalid) {\n        $scope.submitted = true;\n        if (isvalid) {\n            $scope.data.new = true;\n            $scope.createSubscription();\n        }\n    }\n\n    $scope.loadMonths = function () {\n        var date = new Date();\n        for (i = 0; i < 15; i++) {\n            $scope.years.push(date.getFullYear() + i);\n        }\n        for (i = 0; i < 12; i++) {\n            $scope.months.push( 1 + i);\n        }\n        console.log(JSON.stringify($scope.months));\n    }\n    $scope.loadTestData = function () {\n        console.log(\"Loading test data\");\n        $scope.data.name = \"Hoovert Arredondo\";\n        $scope.data.line1 = \"Calle 73 # 0-24\";\n        $scope.data.line2 = \"Apto 202\";\n        $scope.data.line3 = \"\";\n        $scope.data.postalCode = \"\";\n        $scope.data.city = \"Bogota\";\n        $scope.data.state = \"Cundinamarca\";\n        $scope.data.country = \"CO\";\n        $scope.data.phone = \"3105507245\";\n        $scope.data.document = \"1020716535\";\n        $scope.data.number = \"4111111111111111\";\n        $scope.data.expMonth = \"10\";\n        $scope.data.expYear = \"2020\";\n        $scope.data.branch = \"VISA\";\n    }\n    $scope.createSubscription = function () {\n        console.log(\"Data sent\");\n        console.log(JSON.stringify($scope.data));\n        console.log(JSON.stringify($.param($scope.data)));\n        Billing.createSubscription($.param($scope.data), $scope.localGateway).then(function (data) {\n            if (\"status\" in data) {\n                if (data.status == 'success') {\n                    console.log(\"Subscription created\");\n                    $scope.data = {};\n                    window.location.href = \"/subscriptions\";\n                    $scope.submitted = false;\n                    return true;\n                }\n            }\n            $scope.errors = data;\n            $scope.showErrors = true;\n        },\n                function (data) {\n\n                });\n    }\n    $rootScope.$on('PlanSelected', function (event, args) {\n        $scope.data.plan_id = args.plan;\n    });\n    $rootScope.$on('ObjectSelected', function (event, args) {\n        $scope.data.object_id = args.object_id;\n    });\n    $rootScope.$on('GatewaySelected', function (event, args) {\n        console.log($rootScope.gateway);\n        console.log($scope.localGateway);\n        console.log($rootScope.gateway == $scope.localGateway);\n        if ($rootScope.gateway == $scope.localGateway) {\n            console.log(JSON.stringify($scope.config));\n            var sources = $scope.config.sources;\n            console.log($scope.localGateway);\n            for (item in sources) {\n                console.log(JSON.stringify(sources[item]));\n                if (sources[item].gateway == $scope.localGateway) {\n                    if (sources[item].has_default) {\n                        $scope.sourceSelected = true;\n                        $scope.hasDefault = true;\n                        console.log(\"Has default\");\n                    } else {\n                        $scope.sourceSelected = false;\n                        $scope.hasDefault = false;\n                        $scope.getSources();\n                    }\n                } else {\n                    $scope.sourceSelected = false;\n                    $scope.hasDefault = false;\n                    $scope.getSources();\n                }\n\n            }\n            $scope.loadMonths();\n            $scope.loadTestData();\n        }\n    });\n}])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zb3VyY2VzY3RybC5qcz9hNDNmIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdTb3VyY2VzQ3RybCcsWyckc2NvcGUnLCAnQmlsbGluZycsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgQmlsbGluZywgJHJvb3RTY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5tb250aHMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS55ZWFycyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmJyYW5jaGVzID0gW1xuICAgICAgICAgICAgICAgIHtcIm5hbWVcIjogXCJWaXNhXCIsIFwidmFsdWVcIjogXCJWSVNBXCJ9LFxuICAgICAgICAgICAgICAgIHtcIm5hbWVcIjogXCJNYXN0ZXJjYXJkXCIsIFwidmFsdWVcIjogXCJNQVNURVJDQVJEXCJ9LFxuICAgICAgICAgICAgICAgIHtcIm5hbWVcIjogXCJWaXNhIERlYml0b1wiLCBcInZhbHVlXCI6IFwiVklTQV9ERUJJVFwifSxcbiAgICAgICAgICAgICAgICB7XCJuYW1lXCI6IFwiRGluZXJzXCIsIFwidmFsdWVcIjogXCJESU5FUlNcIn0sXG4gICAgICAgICAgICAgICAge1wibmFtZVwiOiBcIkFtZXJpY2FuIEV4cHJlc3NcIiwgXCJ2YWx1ZVwiOiBcIkFNRVhcIn1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmJ1eWluZyA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5zaG93U3RyaXBlID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuaGlkZURlZmF1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5jb25maWcgPSB7fTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2NhbEdhdGV3YXkgPSAkc2NvcGUuY29uZmlnLmdhdGV3YXk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNhdmluZzogXCIgKyBpc3ZhbGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1N0cmlwZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmVkaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5lZGl0U291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBFbGVtZW50c1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gc3RyaXBlLmVsZW1lbnRzKHtsb2NhbGU6ICR0cmFuc2xhdGUudXNlKCl9KTtcblxuICAgICAgICAgICAgLy8gQ3VzdG9tIHN0eWxpbmcgY2FuIGJlIHBhc3NlZCB0byBvcHRpb25zIHdoZW4gY3JlYXRpbmcgYW4gRWxlbWVudC5cbiAgICAgICAgICAgIC8vIChOb3RlIHRoYXQgdGhpcyBkZW1vIHVzZXMgYSB3aWRlciBzZXQgb2Ygc3R5bGVzIHRoYW4gdGhlIGd1aWRlIGJlbG93LilcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IHtcbiAgICAgICAgICAgICAgICBiYXNlOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnIzMyMzI1ZCcsXG4gICAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQ6ICcyNHB4JyxcbiAgICAgICAgICAgICAgICAgICAgZm9udEZhbWlseTogJ1wiSGVsdmV0aWNhIE5ldWVcIiwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICAgICAgICAgICAgZm9udFNtb290aGluZzogJ2FudGlhbGlhc2VkJyxcbiAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6ICcxNnB4JyxcbiAgICAgICAgICAgICAgICAgICAgJzo6cGxhY2Vob2xkZXInOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNhYWI3YzQnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGludmFsaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjZmE3NTVhJyxcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnI2ZhNzU1YSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgdGhlIGNhcmQgRWxlbWVudFxuICAgICAgICAgICAgdmFyIGNhcmQgPSBlbGVtZW50cy5jcmVhdGUoJ2NhcmQnLCB7c3R5bGU6IHN0eWxlfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBhbiBpbnN0YW5jZSBvZiB0aGUgY2FyZCBFbGVtZW50IGludG8gdGhlIGBjYXJkLWVsZW1lbnRgIDxkaXY+XG4gICAgICAgICAgICBjYXJkLm1vdW50KCcjY2FyZC1lbGVtZW50Jyk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSByZWFsLXRpbWUgdmFsaWRhdGlvbiBlcnJvcnMgZnJvbSB0aGUgY2FyZCBFbGVtZW50LlxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzcGxheUVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcmQtZXJyb3JzJyk7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlFcnJvci50ZXh0Q29udGVudCA9IGV2ZW50LmVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVycm9yLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBmb3JtIHN1Ym1pc3Npb25cbiAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtZm9ybScpO1xuICAgICAgICAgICAgdmFyIG93bmVySW5mbyA9IHtcbiAgICAgICAgICAgICAgICBvd25lcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAkc2NvcGUuZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lMTogJHNjb3BlLmRhdGEuYWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICRzY29wZS5kYXRhLmNpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3N0YWxfY29kZTogJHNjb3BlLmRhdGEucG9zdGFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeTogJHNjb3BlLmRhdGEuY291bnRyeSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6ICRzY29wZS5kYXRhLmVtYWlsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICBzdHJpcGUuY3JlYXRlU291cmNlKGNhcmQsIG93bmVySW5mbykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluZm9ybSB0aGUgdXNlciBpZiB0aGVyZSB3YXMgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyZC1lcnJvcnMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IHJlc3VsdC5lcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2VuZCB0aGUgc291cmNlIHRvIHlvdXIgc2VydmVyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpcGVTb3VyY2VIYW5kbGVyKHJlc3VsdC5zb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLnN0cmlwZUNyZWF0ZVRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzdHJpcGVTb3VyY2VIYW5kbGVyKHRva2VuKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc291cmNlID0gdG9rZW47XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmVTb3VyY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9udGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBtb250aHNcIik7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxNTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS55ZWFycy5wdXNoKGRhdGUuZ2V0RnVsbFllYXIoKSArIGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2goMSArIGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5zYXZlU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnY3ZjJ107XG4gICAgICAgICAgICAgICAgZGVsZXRlICRzY29wZS5kYXRhWydleHBNb250aCddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnZXhwWWVhciddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnbnVtYmVyJ107XG4gICAgICAgICAgICAgICAgZGVsZXRlICRzY29wZS5kYXRhWydwb3N0YWwnXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgc2VudFwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkc2NvcGUuZGF0YSkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCQucGFyYW0oJHNjb3BlLmRhdGEpKSk7XG4gICAgICAgICAgICAgICAgQmlsbGluZy5jcmVhdGVTb3VyY2UoJC5wYXJhbSgkc2NvcGUuZGF0YSksICRyb290U2NvcGUuZ2F0ZXdheSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHVybiBzb3VyY2VcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudHlwZSA9PSBcImNhcmRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmQgPSBkYXRhLmNhcmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VzLnB1c2goY2FyZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZ2V0U291cmNlcyA9IGZ1bmN0aW9uIChnYXRld2F5KSB7XG4gICAgICAgICAgICAgICAgQmlsbGluZy5nZXRTb3VyY2VzKGdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlcyA9IGRhdGEuc291cmNlcztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIHNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dLnR5cGUgPT0gXCJjYXJkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZCA9IHNvdXJjZXNbaXRlbV0uY2FyZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmlkID0gc291cmNlc1tpdGVtXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmlzX2RlZmF1bHQgPSBzb3VyY2VzW2l0ZW1dLmlzX2RlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZXMucHVzaChjYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVkZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmRlZmF1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGVkZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIEJpbGxpbmcuZGVsZXRlU291cmNlKHNvdXJjZS5pZCwgJHJvb3RTY29wZS5nYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zb3VyY2VzW2l0ZW1dLmlkID09IHNvdXJjZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGVsZXRpbmcgc291cmNlXCIsICRzY29wZS5zb3VyY2VzW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmxvYWRUZXN0RGF0YSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcblxuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmN2YyA9IFwiMTIzXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsID0gXCIzMzEzMlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmV4cFllYXIgPSBcIjIwMjBcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTJcIjtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ1NvdXJjZVNlbGVjdGVkJywge3NvdXJjZTogc291cmNlLmlkfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignR2V0U291cmNlcycsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRTb3VyY2VzKGFyZ3MuZ2F0ZXdheSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1eWluZyA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdHYXRld2F5U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFNvdXJjZXMoJHNjb3BlLmxvY2FsR2F0ZXdheSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9udGhzKCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkVGVzdERhdGEoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5jbGVhbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNldEFzRGVmYXVsdCA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIGRhdGEuc291cmNlID0gc291cmNlLmlkXG4gICAgICAgICAgICAgICAgQmlsbGluZy5zZXRBc0RlZmF1bHQoZGF0YSwgJHJvb3RTY29wZS5nYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZXNbaXRlbV0uaXNfZGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zb3VyY2VzW2l0ZW1dLmlkID09IHNvdXJjZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VzW2l0ZW1dLmlzX2RlZmF1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XSkuY29udHJvbGxlcignU291cmNlc1BheXVDdHJsJyxbJyRzY29wZScsICdCaWxsaW5nJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUubW9udGhzID0gW107XG4gICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgJHNjb3BlLmJyYW5jaGVzID0gW1xuICAgICAgICB7XCJuYW1lXCI6IFwiVmlzYVwiLCBcInZhbHVlXCI6IFwiVklTQVwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIk1hc3RlcmNhcmRcIiwgXCJ2YWx1ZVwiOiBcIk1BU1RFUkNBUkRcIn0sXG4gICAgICAgIHtcIm5hbWVcIjogXCJWaXNhIERlYml0b1wiLCBcInZhbHVlXCI6IFwiVklTQV9ERUJJVFwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIkRpbmVyc1wiLCBcInZhbHVlXCI6IFwiRElORVJTXCJ9LFxuICAgICAgICB7XCJuYW1lXCI6IFwiQW1lcmljYW4gRXhwcmVzc1wiLCBcInZhbHVlXCI6IFwiQU1FWFwifVxuICAgIF07XG4gICAgJHNjb3BlLnNvdXJjZXMgPSBbXTtcbiAgICAkc2NvcGUuYnV5aW5nID0gZmFsc2U7XG4gICAgJHNjb3BlLnNob3dFcnJvcnMgPSBmYWxzZTtcbiAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IGZhbHNlO1xuICAgICRzY29wZS5lcnJvcnMgPSBbXTtcbiAgICAkc2NvcGUuY29uZmlnID0ge307XG4gICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJHNjb3BlLmxvY2FsR2F0ZXdheSA9IFwiUGF5VVwiO1xuXG4gICAgfSk7XG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLnNob3dFcnJvcnMgPSBmYWxzZTtcbiAgICAgICAgY29uc29sZS5sb2coXCJTYXZpbmc6IFwiICsgaXN2YWxpZCk7XG4gICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2F2ZVNvdXJjZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5lZGl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJHNjb3BlLmVkaXRTb3VyY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgJHNjb3BlLmxvYWRNb250aHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBtb250aHNcIik7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDE1OyBpKyspIHtcbiAgICAgICAgICAgICRzY29wZS55ZWFycy5wdXNoKGRhdGUuZ2V0RnVsbFllYXIoKSArIGkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2goMSArIGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5zYXZlU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgc2VudFwiKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLmRhdGEpKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJC5wYXJhbSgkc2NvcGUuZGF0YSkpKTtcbiAgICAgICAgQmlsbGluZy5jcmVhdGVTb3VyY2UoJC5wYXJhbSgkc2NvcGUuZGF0YSksICRzY29wZS5sb2NhbEdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXBseSB0byBjcmVhdGVcIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXN1bHQpKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFNvdXJjZXMoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSBcIkNPXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0U291cmNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3JzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmdldFNvdXJjZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEJpbGxpbmcuZ2V0U291cmNlcygkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNvdXJjZXNcIik7XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHNvdXJjZXMgPSBkYXRhLnNvdXJjZXM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzb3VyY2VzKSk7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc291cmNlcykge1xuICAgICAgICAgICAgICAgIHZhciBjYXJkID0gc291cmNlc1tpdGVtXTtcbiAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5wdXNoKGNhcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZXMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICAkc2NvcGUuZGVsZXRlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBCaWxsaW5nLmRlbGV0ZVNvdXJjZShzb3VyY2UudG9rZW4sICRzY29wZS5sb2NhbEdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc291cmNlcykge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc291cmNlc1tpdGVtXS50b2tlbiA9PSBzb3VyY2UudG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkZWxldGluZyBzb3VyY2VcIiwgJHNjb3BlLnNvdXJjZXNbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5zcGxpY2UoaXRlbSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc291cmNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRTb3VyY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgICRzY29wZS5sb2FkVGVzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5kYXRhLm5hbWUgPSBcIkhvb3ZlcnQgQXJyZWRvbmRvXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUxID0gXCJDYWxsZSA3MyAjIDAtMjRcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEubGluZTIgPSBcIkFwdG8gMjAyXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUzID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsQ29kZSA9IFwiXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNpdHkgPSBcIkJvZ290YVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5zdGF0ZSA9IFwiQ3VuZGluYW1hcmNhXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSBcIkNPXCI7XG4gICAgICAgICRzY29wZS5kYXRhLnBob25lID0gXCIzMTA1NTA3MjQ1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLmRvY3VtZW50ID0gXCIxMDIwNzE2NTM1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLm51bWJlciA9IFwiNDExMTExMTExMTExMTExMVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTBcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEuZXhwWWVhciA9IFwiMjAyMFwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5icmFuY2ggPSBcIlZJU0FcIjtcblxuICAgIH1cbiAgICAkc2NvcGUuc2VsZWN0U291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ1NvdXJjZVNlbGVjdGVkJywge3NvdXJjZTogc291cmNlLmlkfSk7XG4gICAgfVxuICAgICRyb290U2NvcGUuJG9uKCdHZXRTb3VyY2VzJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XG4gICAgICAgICRzY29wZS5nZXRTb3VyY2VzKCk7XG4gICAgICAgICRzY29wZS5idXlpbmcgPSB0cnVlO1xuICAgIH0pO1xuICAgICRyb290U2NvcGUuJG9uKCdHYXRld2F5U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgaWYgKCRyb290U2NvcGUuZ2F0ZXdheSA9PSAkc2NvcGUubG9jYWxHYXRld2F5KSB7XG4gICAgICAgICAgICAkc2NvcGUuZ2V0U291cmNlcygpO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRUZXN0RGF0YSgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgIH1cbiAgICAkc2NvcGUuc2V0QXNEZWZhdWx0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICBkYXRhLnNvdXJjZSA9IHNvdXJjZS50b2tlblxuICAgICAgICBCaWxsaW5nLnNldEFzRGVmYXVsdChkYXRhLCAkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLnNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlc1tpdGVtXS5pc19kZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zb3VyY2VzW2l0ZW1dLnRva2VuID09IHNvdXJjZS50b2tlbikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlc1tpdGVtXS5pc19kZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cblxuXG59XSkuY29udHJvbGxlcignU3Vic2NyaXB0aW9uc0N0cmwnLFsnJHNjb3BlJywgJ0JpbGxpbmcnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nKSB7XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUuc3Vic2NyaXB0aW9ucyA9IFtdO1xuICAgICRzY29wZS5wbGFucyA9IFtdO1xuICAgICRzY29wZS5zaG93RWRpdCA9IGZhbHNlO1xuICAgICRzY29wZS5sb2NhbEdhdGV3YXkgPSBcIlwiO1xuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZ2V0U3Vic2NyaXB0aW9ucygpO1xuICAgIH0pO1xuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtwbGFuX2lkOiAkc2NvcGUuZGF0YS5wbGFuX2lkfTtcbiAgICAgICAgICAgIEJpbGxpbmcuZWRpdFN1YnNjcmlwdGlvbihkYXRhLCAkc2NvcGUuZGF0YS5zdWJzY3JpcHRpb25faWQsICRzY29wZS5sb2NhbEdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zdWJzY3JpcHRpb25faWQgPSBcIlwiICsgJHNjb3BlLmRhdGEuc3Vic2NyaXB0aW9uX2lkO1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnN1YnNjcmlwdGlvbnNbaXRlbV0uc291cmNlX2lkID09ICRzY29wZS5kYXRhLnN1YnNjcmlwdGlvbl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkZWxldGluZyBzdWJzY3JpcHRpb25cIiwgJHNjb3BlLnN1YnNjcmlwdGlvbnNbaXRlbV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnMuc3BsaWNlKGl0ZW0sIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnMucHVzaChkYXRhLnN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAkc2NvcGUuZ2V0U3Vic2NyaXB0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQmlsbGluZy5nZXRTdWJzY3JpcHRpb25zKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnMgPSBkYXRhLnN1YnNjcmlwdGlvbnM7XG4gICAgICAgICAgICBmb3IgKHggaW4gJHNjb3BlLnN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gJHNjb3BlLnN1YnNjcmlwdGlvbnNbeF0ub2JqZWN0O1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJzY3JpcHRpb25zW3hdLm9iamVjdF9uYW1lID0gb2JqLm5hbWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1YnNjcmlwdGlvbnNbeF0ub2JqZWN0X2NvZGUgPSBvYmouY29kZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3Vic2NyaXB0aW9uc1t4XS5vYmplY3Rfc3RhdHVzID0gb2JqLnN0YXR1cztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3Vic2NyaXB0aW9uc1t4XS5vYmplY3RfZW5kcyA9IG9iai5lbmRzX2F0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmdldFBsYW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBCaWxsaW5nLmdldFBsYW5zKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnBsYW5zID0gZGF0YS5wbGFucztcblxuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmRlbGV0ZVN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgQmlsbGluZy5kZWxldGVTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uLnNvdXJjZV9pZCwgc3Vic2NyaXB0aW9uLmdhdGV3YXkpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25faWQgPSBcIlwiICsgc3Vic2NyaXB0aW9uLnNvdXJjZV9pZDtcbiAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3Vic2NyaXB0aW9uc1tpdGVtXS5zb3VyY2VfaWQgPT0gc3Vic2NyaXB0aW9uX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJzY3JpcHRpb25zLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgJHNjb3BlLmNsZWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgIH1cbiAgICAkc2NvcGUuZWRpdFN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgJHNjb3BlLmRhdGEuc3Vic2NyaXB0aW9uX2lkID0gc3Vic2NyaXB0aW9uLmlkO1xuICAgICAgICAkc2NvcGUuZ2V0UGxhbnMoKTtcbiAgICAgICAgJHNjb3BlLnNob3dFZGl0ID0gdHJ1ZTtcbiAgICB9XG5cbn1dKS5jb250cm9sbGVyKCdQbGFuc0N0cmwnLFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAkc2NvcGUuc2VsZWN0UGxhbiA9IGZ1bmN0aW9uIChwbGFuKSB7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnUGxhblNlbGVjdGVkJywge3BsYW46IHBsYW59KTtcbiAgICB9XG59XSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0dhdGV3YXlzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAgICAgICAgICRzY29wZS5vYmplY3RTZWxlY3RlZCA9IGZhbHNlO1xuXG5cbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RHYXRld2F5ID0gZnVuY3Rpb24gKGdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdhdGV3YXkgPSBnYXRld2F5O1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnR2F0ZXdheVNlbGVjdGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignT2JqZWN0U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUub2JqZWN0U2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jb250cm9sbGVyKCdTdWJzY3JpcHRpb25QbGFuc1N0cmlwZUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmxvY2FsR2F0ZXdheSA9IFwiXCI7XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5zaG93U291cmNlcyA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmJ1eWluZyA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5vYmplY3RfaWQgPSAxO1xuXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9jYWxHYXRld2F5ID0gXCJTdHJpcGVcIjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuc2F2ZVNpbXBsZSA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdHJpcGVDcmVhdGVUb2tlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5sb2FkTW9udGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUueWVhcnMucHVzaChkYXRlLmdldEZ1bGxZZWFyKCkgKyBpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vbnRocy5wdXNoKDEgKyBpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZWRpdFNvdXJjZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9zb3VyY2VzXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUubG9hZFRlc3REYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLm51bWJlciA9IFwiNDI0MjQyNDI0MjQyNDI0MlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmN2YyA9IFwiMTIzXCI7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsID0gXCIzMzEzMlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLmV4cFllYXIgPSBcIjIwMjBcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5jcmVhdGVTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5kZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmRhdGFbJ2N2YyddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsnZXhwTW9udGgnXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmRhdGFbJ2V4cFllYXInXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmRhdGFbJ251bWJlciddO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuZGF0YVsncG9zdGFsJ107XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRhIHNlbnRcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLmRhdGEpKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkLnBhcmFtKCRzY29wZS5kYXRhKSkpO1xuICAgICAgICAgICAgICAgIEJpbGxpbmcuY3JlYXRlU3Vic2NyaXB0aW9uKCQucGFyYW0oJHNjb3BlLmRhdGEpLCAkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0YXR1c1wiIGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1YnNjcmlwdGlvbiBjcmVhdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvc3Vic2NyaXB0aW9uc1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0Vycm9ycyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc3RyaXBlQ3JlYXRlVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgU3RyaXBlLnNvdXJjZS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2FyZCcsXG4gICAgICAgICAgICAgICAgICAgIGNhcmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogJHNjb3BlLmRhdGEubnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3ZjOiAkc2NvcGUuZGF0YS5jdmMsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBfbW9udGg6ICRzY29wZS5kYXRhLmV4cE1vbnRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwX3llYXI6ICRzY29wZS5kYXRhLmV4cFllYXIsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG93bmVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdGFsX2NvZGU6ICRzY29wZS5kYXRhLnBvc3RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgc3RyaXBlUmVzcG9uc2VIYW5kbGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdQbGFuU2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5wbGFuX2lkID0gYXJncy5wbGFuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignT2JqZWN0U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5vYmplY3RfaWQgPSBhcmdzLm9iamVjdF9pZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBzdHJpcGVSZXNwb25zZUhhbmRsZXIoc3RhdHVzLCByZXNwb25zZSkge1xuXG5cbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHsgLy8gUHJvYmxlbSFcblxuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IHRoZSBlcnJvcnMgb24gdGhlIGZvcm1cbiAgICAgICAgICAgICAgICAgICAgLy8kZm9ybS5maW5kKCcucGF5bWVudC1lcnJvcnMnKS50ZXh0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAvLyRmb3JtLmZpbmQoJ2J1dHRvbicpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpOyAvLyBSZS1lbmFibGUgc3VibWlzc2lvblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gU291cmNlIHdhcyBjcmVhdGVkIVxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHNvdXJjZSBJRDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc291cmNlID0gcmVzcG9uc2UuaWQ7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVTdWJzY3JpcHRpb24oKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCdHYXRld2F5U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLmNvbmZpZykpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlcyA9ICRzY29wZS5jb25maWcuc291cmNlcztcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmxvY2FsR2F0ZXdheSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBzb3VyY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzb3VyY2VzW2l0ZW1dKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXS5oYXNfZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlU2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkhhcyBkZWZhdWx0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vbnRocygpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFRlc3REYXRhKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jb250cm9sbGVyKCdTdWJzY3JpcHRpb25QbGFuc1BheXVDdHJsJyxbJyRzY29wZScsICdCaWxsaW5nJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlLCBCaWxsaW5nLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUubW9udGhzID0gW107XG4gICAgJHNjb3BlLnllYXJzID0gW107XG4gICAgJHNjb3BlLmJyYW5jaGVzID0gW1xuICAgICAgICB7XCJuYW1lXCI6IFwiVmlzYVwiLCBcInZhbHVlXCI6IFwiVklTQVwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIk1hc3RlcmNhcmRcIiwgXCJ2YWx1ZVwiOiBcIk1BU1RFUkNBUkRcIn0sXG4gICAgICAgIHtcIm5hbWVcIjogXCJWaXNhIERlYml0b1wiLCBcInZhbHVlXCI6IFwiVklTQV9ERUJJVFwifSxcbiAgICAgICAge1wibmFtZVwiOiBcIkRpbmVyc1wiLCBcInZhbHVlXCI6IFwiRElORVJTXCJ9LFxuICAgICAgICB7XCJuYW1lXCI6IFwiQW1lcmljYW4gRXhwcmVzc1wiLCBcInZhbHVlXCI6IFwiQU1FWFwifVxuICAgIF07XG4gICAgJHNjb3BlLnNvdXJjZXMgPSBbXTtcbiAgICAkc2NvcGUubG9jYWxHYXRld2F5ID0gXCJcIjtcbiAgICAkc2NvcGUuc291cmNlU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAkc2NvcGUuc2hvd1NvdXJjZXMgPSBmYWxzZTtcbiAgICAkc2NvcGUuYnV5aW5nID0gdHJ1ZTtcbiAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICRzY29wZS5uZXdDYXJkID0gZmFsc2U7XG4gICAgJHNjb3BlLmRhdGEub2JqZWN0X2lkID0gMTtcblxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubG9jYWxHYXRld2F5ID0gXCJQYXlVXCI7XG4gICAgfSk7XG5cbiAgICAkc2NvcGUuc2F2ZVNpbXBsZSA9IGZ1bmN0aW9uIChpc3ZhbGlkKSB7XG4gICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS5zZWxlY3RTb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgICRzY29wZS5kYXRhLnNvdXJjZSA9IHNvdXJjZS50b2tlbjtcbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIGlmICgkc2NvcGUuZGF0YS5wbGFuX2lkICYmICRzY29wZS5kYXRhLm9iamVjdF9pZCkge1xuICAgICAgICAgICAgJHNjb3BlLnNvdXJjZVNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICRzY29wZS5jcmVhdGVTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgfSBcbiAgICB9XG4gICAgJHNjb3BlLm5ld0NhcmRUcmlnZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubmV3Q2FyZCA9IHRydWU7XG4gICAgICAgICRzY29wZS5zb3VyY2VTZWxlY3RlZCA9IGZhbHNlO1xuICAgIH1cbiAgICAkc2NvcGUuZ2V0U291cmNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLnNvdXJjZVNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5uZXdDYXJkID0gZmFsc2U7XG4gICAgICAgIEJpbGxpbmcuZ2V0U291cmNlcygkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNvdXJjZXNcIik7XG4gICAgICAgICAgICAkc2NvcGUuc291cmNlcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHNvdXJjZXMgPSBkYXRhLnNvdXJjZXM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzb3VyY2VzKSk7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc291cmNlcykge1xuICAgICAgICAgICAgICAgIHZhciBjYXJkID0gc291cmNlc1tpdGVtXTtcbiAgICAgICAgICAgICAgICBjYXJkLnR5cGUgPSBcImNhcmRcIjtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc291cmNlcy5wdXNoKGNhcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZXMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubmV3Q2FyZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIGlmIChpc3ZhbGlkKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5uZXcgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvYWRNb250aHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDE1OyBpKyspIHtcbiAgICAgICAgICAgICRzY29wZS55ZWFycy5wdXNoKGRhdGUuZ2V0RnVsbFllYXIoKSArIGkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzLnB1c2goIDEgKyBpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkc2NvcGUubW9udGhzKSk7XG4gICAgfVxuICAgICRzY29wZS5sb2FkVGVzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyB0ZXN0IGRhdGFcIik7XG4gICAgICAgICRzY29wZS5kYXRhLm5hbWUgPSBcIkhvb3ZlcnQgQXJyZWRvbmRvXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUxID0gXCJDYWxsZSA3MyAjIDAtMjRcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEubGluZTIgPSBcIkFwdG8gMjAyXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmxpbmUzID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEucG9zdGFsQ29kZSA9IFwiXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNpdHkgPSBcIkJvZ290YVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5zdGF0ZSA9IFwiQ3VuZGluYW1hcmNhXCI7XG4gICAgICAgICRzY29wZS5kYXRhLmNvdW50cnkgPSBcIkNPXCI7XG4gICAgICAgICRzY29wZS5kYXRhLnBob25lID0gXCIzMTA1NTA3MjQ1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLmRvY3VtZW50ID0gXCIxMDIwNzE2NTM1XCI7XG4gICAgICAgICRzY29wZS5kYXRhLm51bWJlciA9IFwiNDExMTExMTExMTExMTExMVwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5leHBNb250aCA9IFwiMTBcIjtcbiAgICAgICAgJHNjb3BlLmRhdGEuZXhwWWVhciA9IFwiMjAyMFwiO1xuICAgICAgICAkc2NvcGUuZGF0YS5icmFuY2ggPSBcIlZJU0FcIjtcbiAgICB9XG4gICAgJHNjb3BlLmNyZWF0ZVN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEYXRhIHNlbnRcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCRzY29wZS5kYXRhKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCQucGFyYW0oJHNjb3BlLmRhdGEpKSk7XG4gICAgICAgIEJpbGxpbmcuY3JlYXRlU3Vic2NyaXB0aW9uKCQucGFyYW0oJHNjb3BlLmRhdGEpLCAkc2NvcGUubG9jYWxHYXRld2F5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoXCJzdGF0dXNcIiBpbiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1YnNjcmlwdGlvbiBjcmVhdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3N1YnNjcmlwdGlvbnNcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5zaG93RXJyb3JzID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgICRyb290U2NvcGUuJG9uKCdQbGFuU2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgJHNjb3BlLmRhdGEucGxhbl9pZCA9IGFyZ3MucGxhbjtcbiAgICB9KTtcbiAgICAkcm9vdFNjb3BlLiRvbignT2JqZWN0U2VsZWN0ZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgJHNjb3BlLmRhdGEub2JqZWN0X2lkID0gYXJncy5vYmplY3RfaWQ7XG4gICAgfSk7XG4gICAgJHJvb3RTY29wZS4kb24oJ0dhdGV3YXlTZWxlY3RlZCcsIGZ1bmN0aW9uIChldmVudCwgYXJncykge1xuICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLmdhdGV3YXkpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUubG9jYWxHYXRld2F5KTtcbiAgICAgICAgY29uc29sZS5sb2coJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpO1xuICAgICAgICBpZiAoJHJvb3RTY29wZS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KCRzY29wZS5jb25maWcpKTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VzID0gJHNjb3BlLmNvbmZpZy5zb3VyY2VzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmxvY2FsR2F0ZXdheSk7XG4gICAgICAgICAgICBmb3IgKGl0ZW0gaW4gc291cmNlcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHNvdXJjZXNbaXRlbV0pKTtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXS5nYXRld2F5ID09ICRzY29wZS5sb2NhbEdhdGV3YXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaXRlbV0uaGFzX2RlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkhhcyBkZWZhdWx0XCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNvdXJjZVNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFNvdXJjZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3VyY2VTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGFzRGVmYXVsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0U291cmNlcygpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmxvYWRNb250aHMoKTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkVGVzdERhdGEoKTtcbiAgICAgICAgfVxuICAgIH0pO1xufV0pXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy9zb3VyY2VzY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 28 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('NotificationsCtrl', ['$scope', '$rootScope', 'Alerts', function ($scope, $rootScope, Alerts) {\n        // With the new view caching in Ionic, Controllers are only called\n        // when they are recreated or on app start, instead of every page change.             // To listen for when this page is active (for example, to refresh data),\n        // listen for the $ionicView.enter event:\n        //\n        $scope.notifications = [];\n        $rootScope.$broadcast('updateNotifList');\n        $scope.noavatar = API.avatar;\n        $scope.delete = function (notification) {\n            Alerts.deleteNotification(notification);\n        };\n        $scope.followNotification = function (id) {\n            Alerts.get(id).then(function (data) {\n                console.log(\"After Get:\");\n                console.log(JSON.stringify(data));\n                Alerts.followNotification(data);\n                console.log(\"After follow:\");\n                console.log(JSON.stringify(data));\n            },\n                    function (data) {\n                    });\n        };\n        $rootScope.$on('updateNotifList', function () {\n            $scope.notifications = [];\n            Alerts.loadNotificationsGlobal(\"50\").then(function (data) {\n                for (notif in data) {\n                    data[notif].created_at = new Date(data[notif].created_at);\n                    if (data[notif].type == \"location_first\") {\n                        data[notif].class = 'ion-android-pin';\n                    } else if (data[notif].type == \"location_last\") {\n                        data[notif].class = 'ion-android-pin';\n                    } else if (data[notif].type == \"notification_location\") {\n                        data[notif].class = 'ion-android-compass';\n                    } else if (data[notif].type == \"emergency\") {\n                        data[notif].class = 'ion-android-warning';\n                    } else if (data[notif].type == \"medical_emergency\") {\n                        data[notif].class = 'ion-ios-medkit';\n                    } else if (data[notif].type == \"emergency_end\") {\n                        data[notif].class = 'ion-flag';\n                    } else if (data[notif].type == \"user_message\") {\n                        data[notif].class = 'ion-email';\n                    } else if (data[notif].type == \"group_message\") {\n                        data[notif].class = 'ion-email';\n                    } else if (data[notif].type == \"new_contact\") {\n                        data[notif].class = 'ion-person-stalker';\n                    } else if (data[notif].type == \"new_group\") {\n                        data[notif].class = 'ion-person-stalker';\n                    } else if (data[notif].type == \"system\") {\n                        data[notif].class = 'ion-alert';\n                    }\n                    try {\n                        $scope.notifications.push(data[notif]);\n                    } catch (err) {\n                        console.log(\"Repetido\");\n                        console.log(JSON.stringify(data[notif]));\n                    }\n\n                }\n                $rootScope.notificationsChanged = false;\n            },\n                    function (data) {\n                    });\n        });\n        $rootScope.$on('receivedNotification', function (event, args) {\n            $rootScope.$broadcast('updateNotifList');\n        });\n        $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {\n            if (toState.name == 'tab.notifications') {\n                console.log(\"Entering notifications\");\n                if ($rootScope.notificationsChanged == true) {\n                    $rootScope.$broadcast('updateNotifList');\n                }\n            }\n        });\n    }]).controller('UserRegisterCtrl', ['$scope', 'LocationService', 'Users', function ($scope, LocationService, Users) {\n        $scope.data = {};\n        $scope.addresses;\n        $scope.regionVisible = false;\n        $scope.cityVisible = false;\n        LocationService.getCountries(\"\").then(function (data) {\n            $scope.countries = data.data;\n        },\n                function (data) {\n\n                });\n\n    }]).controller('UserProfileCtrl', ['$scope', '$rootScope', 'Users','Modals', function ($scope, $rootScope, Users,Modals) {\n        $scope.data = {};\n        angular.element(document).ready(function () {\n            $scope.data = $rootScope.user;\n        });\n        $rootScope.$on('user_loaded', function (event, args) {\n            console.log(\"Loading user\");\n            $scope.data = $rootScope.user;\n        });\n\n        $scope.save = function (isvalid) {\n            $scope.submitted = true;\n            if (isvalid) {\n                Modals.showLoader();\n                Users.saveUser($scope.data).then(function (data) {\n                    Modals.hideLoader();\n                    console.log(\"Resp\",data);\n                    $scope.submitted = false;\n                    if(data.status == \"success\"){\n                        Modals.showToast(\"Actualizacion exitosa\",$(\"#myaccountContent\"));\n                        $scope.data = data.user;\n                    } else {\n                        Modals.showToast(\"Hubo un error actualizando tus datos\",$(\"#myaccountContent\"));\n                    }\n                },\n                        function (data) {\n\n                        });\n            }\n        }\n\n    }]).controller('UserPasswordCtrl', ['$scope', '$rootScope', 'Users','Modals', function ($scope, $rootScope, Users,Modals) {\n        $scope.data = {};\n\n        $scope.save = function (isvalid) {\n            $scope.submitted = true;\n            if (isvalid) {\n                \n                if($scope.data.password != $scope.data.password_confirmation){\n                    return;\n                }\n                Modals.showLoader();\n                Users.updatePassword($scope.data).then(function (data) {\n                    Modals.hideLoader();\n                    console.log(\"Resp\",data);\n                    $scope.submitted = false;\n                    if(data.status == \"success\"){\n                        Modals.showToast(\"Actualizacion exitosa\",$(\"#myaccountContent\"));\n                        //$scope.data = data.user;\n                    }\n                },\n                        function (data) {\n                            Modals.hideLoader();\n                            Modals.showToast(\"Contraseña incorrecta\",$(\"#myaccountContent\"));\n                        });\n            }\n        }\n\n    }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy91c2VyY3RybC5qcz82OTM4Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdOb3RpZmljYXRpb25zQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnQWxlcnRzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgQWxlcnRzKSB7XG4gICAgICAgIC8vIFdpdGggdGhlIG5ldyB2aWV3IGNhY2hpbmcgaW4gSW9uaWMsIENvbnRyb2xsZXJzIGFyZSBvbmx5IGNhbGxlZFxuICAgICAgICAvLyB3aGVuIHRoZXkgYXJlIHJlY3JlYXRlZCBvciBvbiBhcHAgc3RhcnQsIGluc3RlYWQgb2YgZXZlcnkgcGFnZSBjaGFuZ2UuICAgICAgICAgICAgIC8vIFRvIGxpc3RlbiBmb3Igd2hlbiB0aGlzIHBhZ2UgaXMgYWN0aXZlIChmb3IgZXhhbXBsZSwgdG8gcmVmcmVzaCBkYXRhKSxcbiAgICAgICAgLy8gbGlzdGVuIGZvciB0aGUgJGlvbmljVmlldy5lbnRlciBldmVudDpcbiAgICAgICAgLy9cbiAgICAgICAgJHNjb3BlLm5vdGlmaWNhdGlvbnMgPSBbXTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVOb3RpZkxpc3QnKTtcbiAgICAgICAgJHNjb3BlLm5vYXZhdGFyID0gQVBJLmF2YXRhcjtcbiAgICAgICAgJHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgICAgIEFsZXJ0cy5kZWxldGVOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmZvbGxvd05vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgQWxlcnRzLmdldChpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWZ0ZXIgR2V0OlwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICAgICAgQWxlcnRzLmZvbGxvd05vdGlmaWNhdGlvbihkYXRhKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFmdGVyIGZvbGxvdzpcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRyb290U2NvcGUuJG9uKCd1cGRhdGVOb3RpZkxpc3QnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUubm90aWZpY2F0aW9ucyA9IFtdO1xuICAgICAgICAgICAgQWxlcnRzLmxvYWROb3RpZmljYXRpb25zR2xvYmFsKFwiNTBcIikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGZvciAobm90aWYgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jcmVhdGVkX2F0ID0gbmV3IERhdGUoZGF0YVtub3RpZl0uY3JlYXRlZF9hdCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibG9jYXRpb25fZmlyc3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWFuZHJvaWQtcGluJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibG9jYXRpb25fbGFzdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jbGFzcyA9ICdpb24tYW5kcm9pZC1waW4nO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbbm90aWZdLnR5cGUgPT0gXCJub3RpZmljYXRpb25fbG9jYXRpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWFuZHJvaWQtY29tcGFzcyc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtub3RpZl0udHlwZSA9PSBcImVtZXJnZW5jeVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jbGFzcyA9ICdpb24tYW5kcm9pZC13YXJuaW5nJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibWVkaWNhbF9lbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWlvcy1tZWRraXQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbbm90aWZdLnR5cGUgPT0gXCJlbWVyZ2VuY3lfZW5kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbm90aWZdLmNsYXNzID0gJ2lvbi1mbGFnJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwidXNlcl9tZXNzYWdlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbm90aWZdLmNsYXNzID0gJ2lvbi1lbWFpbCc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtub3RpZl0udHlwZSA9PSBcImdyb3VwX21lc3NhZ2VcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLWVtYWlsJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibmV3X2NvbnRhY3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtub3RpZl0uY2xhc3MgPSAnaW9uLXBlcnNvbi1zdGFsa2VyJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW25vdGlmXS50eXBlID09IFwibmV3X2dyb3VwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbm90aWZdLmNsYXNzID0gJ2lvbi1wZXJzb24tc3RhbGtlcic7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtub3RpZl0udHlwZSA9PSBcInN5c3RlbVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25vdGlmXS5jbGFzcyA9ICdpb24tYWxlcnQnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm90aWZpY2F0aW9ucy5wdXNoKGRhdGFbbm90aWZdKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlcGV0aWRvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YVtub3RpZl0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUubm90aWZpY2F0aW9uc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJ3JlY2VpdmVkTm90aWZpY2F0aW9uJywgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZU5vdGlmTGlzdCcpO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uIChldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHRvU3RhdGUubmFtZSA9PSAndGFiLm5vdGlmaWNhdGlvbnMnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbnRlcmluZyBub3RpZmljYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm5vdGlmaWNhdGlvbnNDaGFuZ2VkID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVOb3RpZkxpc3QnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1dKS5jb250cm9sbGVyKCdVc2VyUmVnaXN0ZXJDdHJsJywgWyckc2NvcGUnLCAnTG9jYXRpb25TZXJ2aWNlJywgJ1VzZXJzJywgZnVuY3Rpb24gKCRzY29wZSwgTG9jYXRpb25TZXJ2aWNlLCBVc2Vycykge1xuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAkc2NvcGUuYWRkcmVzc2VzO1xuICAgICAgICAkc2NvcGUucmVnaW9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuY2l0eVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldENvdW50cmllcyhcIlwiKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuY291bnRyaWVzID0gZGF0YS5kYXRhO1xuICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgIH1dKS5jb250cm9sbGVyKCdVc2VyUHJvZmlsZUN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1VzZXJzJywnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgVXNlcnMsTW9kYWxzKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSAkcm9vdFNjb3BlLnVzZXI7XG4gICAgICAgIH0pO1xuICAgICAgICAkcm9vdFNjb3BlLiRvbigndXNlcl9sb2FkZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyB1c2VyXCIpO1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSAkcm9vdFNjb3BlLnVzZXI7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24gKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGlzdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd0xvYWRlcigpO1xuICAgICAgICAgICAgICAgIFVzZXJzLnNhdmVVc2VyKCRzY29wZS5kYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzcFwiLGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJBY3R1YWxpemFjaW9uIGV4aXRvc2FcIiwkKFwiI215YWNjb3VudENvbnRlbnRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhLnVzZXI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiSHVibyB1biBlcnJvciBhY3R1YWxpemFuZG8gdHVzIGRhdG9zXCIsJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfV0pLmNvbnRyb2xsZXIoJ1VzZXJQYXNzd29yZEN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1VzZXJzJywnTW9kYWxzJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgVXNlcnMsTW9kYWxzKSB7XG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaXN2YWxpZCkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCRzY29wZS5kYXRhLnBhc3N3b3JkICE9ICRzY29wZS5kYXRhLnBhc3N3b3JkX2NvbmZpcm1hdGlvbil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgTW9kYWxzLnNob3dMb2FkZXIoKTtcbiAgICAgICAgICAgICAgICBVc2Vycy51cGRhdGVQYXNzd29yZCgkc2NvcGUuZGF0YSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3BcIixkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnN0YXR1cyA9PSBcInN1Y2Nlc3NcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KFwiQWN0dWFsaXphY2lvbiBleGl0b3NhXCIsJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmRhdGEgPSBkYXRhLnVzZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuaGlkZUxvYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5zaG93VG9hc3QoXCJDb250cmFzZcOxYSBpbmNvcnJlY3RhXCIsJChcIiNteWFjY291bnRDb250ZW50XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy91c2VyY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 29 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ZonesCtrl', ['$scope', '$rootScope', 'Zones', 'MapService', 'Merchants', function ($scope, $rootScope, Zones, MapService, Merchants) {\n                $scope.data = {};\n                $scope.items = [];\n                $scope.merchants = [];\n                $scope.providers = [{\"name\": \"Mi Paquete\", \"value\": \"MiPaquete\"}, {\"name\": \"Rapigo\", \"value\": \"Rapigo\"}, {\"name\": \"Propio\", \"value\": \"Propio\"}], {\"name\": \"Basilikum\", \"value\": \"Basilikum\"};\n                $scope.activeMerchant;\n                $scope.activeMerchantObject = {};\n                $scope.searchTerms = \"\";\n                $scope.changeMerchant = false;\n                $scope.createNewMerchant = false;\n                $scope.loadMore = true,\n                        $scope.page = 0;\n                angular.element(document).ready(function () {\n                    console.log(\"Getting merchants and zones\");\n                    $scope.getMerchants();\n                    MapService.createMap(4.685419, -74.064161);\n                });\n\n                $scope.getMerchants = function () {\n                    Merchants.getMerchantsUser().then(function (data) {\n                        if (data.status == \"success\") {\n                            $scope.merchants = data.data;\n                            $scope.activeMerchant = $scope.merchants[0].id;\n                            $scope.getItems();\n                        }\n\n                    },\n                            function (data) {\n\n                            });\n                }\n                $rootScope.$on(\"zone-updated\", function (evt, data) {\n                    for (item in $scope.items) {\n                        if ($scope.items[item].id == data.id) {\n                            $scope.items[item].isActive = true;\n                            $scope.$digest();\n                        }\n                    }\n                });\n\n                $scope.buildItemData = function (item) {\n                    item.isActive = false;\n                    //item.attributes = JSON.parse(item.attributes);\n                    return item;\n                }\n                $scope.changeActiveMerchant = function () {\n                    $scope.changeMerchant = true;\n                }\n                $scope.createItemStart = function () {\n                    $scope.createNewMerchant = true;\n                }\n                $scope.cancelChangeMerchant = function () {\n                    $scope.changeMerchant = false;\n                }\n                $scope.activateMap = function () {\n                    $scope.mapActive = true;\n                    console.log(\"Creating map data\")\n\n                    $scope.createMapData();\n                }\n                $scope.createMapData = function () {\n                    console.log(\"Creating map data\")\n                    for (item in $scope.items) {\n                        console.log(\"Creating map data item\")\n                        var color = MapService.getColor();\n                        $scope.items[item].polygon = MapService.createPolygon($scope.items[item], color);\n                    }\n                }\n                $scope.clearMap = function () {\n                    for (item in $scope.items) {\n                        console.log(\"Creating map data item\")\n                        $scope.items[item].polygon.setMap(null);\n                        $scope.items[item].isActive = false;\n                    }\n                }\n                $scope.changeScenario = function () {\n                    $scope.clearMap();\n                    $scope.items = [];\n                    $scope.page = 0;\n                    $scope.getItems();\n                }\n                $scope.getColor = function () {\n                    var routeColors = [\"#FF0000\", \"#800000\", \"#FFFF00\", \"#808000\", \"#00FF00\", \"#008000\", \"#00FFFF\", \"#008080\", \"#0000FF\", \"#000080\", \"#FF00FF\", \"#800080\"];\n                    var random = Math.round(Math.random() * (routeColors.length - 1));\n                    return routeColors[random];\n                }\n                $scope.selectItem = function (zone) {\n                    $scope.clearMap();\n                    zone.isActive = true;\n                    zone.polygon.setMap($rootScope.map);\n                }\n                $scope.createItem = function () {\n                    $scope.clearMap();\n                    var centerMap = $rootScope.map.getCenter();\n                    var center = {\"lat\": centerMap.lat(), \"lng\": centerMap.lng()};\n                    console.log(\"Center Map\", center.lat);\n                    var coverage = [{\"lat\": center.lat + 0.006, \"lng\": center.lng},\n                        {\"lat\": center.lat - 0.006, \"lng\": center.lng - 0.006}, {\"lat\": center.lat - 0.006, \"lng\": center.lng + 0.006}, {\"lat\": center.lat + 0.006, \"lng\": center.lng}];\n                    var item = {\n                        \"city_id\": 524,\n                        \"region_id\": 11,\n                        \"address_id\": 14,\n                        \"country_id\": 1,\n                        \"merchant_id\": $scope.activeMerchant,\n                        \"provider\": $scope.activeProvider,\n                        \"coverage\": JSON.stringify(coverage),\n                        \"lat\": 4.649824,\n                        \"long\": -74.058881\n                    };\n                    Zones.createZoneItem(item).then(function (data) {\n                        var color = MapService.getColor();\n                        var item = data.item;\n                        item.isActive = false;\n                        item.polygon = MapService.createPolygon(item, color);\n                        $scope.items.push(item);\n                    },\n                            function (data) {\n\n                            });\n                }\n\n                $scope.getItems = function () {\n                    $scope.page++;\n                    var url = \"order_by=id,desc&page=\" + $scope.page + \"&merchant_id=\" + $scope.activeMerchant;\n                    Zones.getZones(url).then(function (data) {\n                        if (data.page == data.last_page) {\n                            $scope.loadMore = false;\n                        }\n                        console.log(\"Items\", data.data);\n                        var itemsCont = data.data;\n                        for (item in itemsCont) {\n                            itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                        }\n                        $scope.items = $scope.items.concat(itemsCont);\n                        $scope.activateMap();\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.searchMerchants = function () {\n                    $scope.page++;\n                    Merchants.searchMerchants($scope.searchTerms).then(function (data) {\n                        console.log(\"Items\", data.data);\n                        $scope.merchants = data.data;\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.selectMerchant = function (item) {\n                    $scope.activeMerchantObject = item;\n                    $scope.clearMap();\n                    $scope.page = 0;\n                    $scope.items = [];\n                    $scope.activeMerchant = item.id + \"\";\n                    $scope.changeMerchant = false;\n                    $scope.getItems();\n                }\n                $scope.selectMerchantObject = function () {\n                    console.log(\"Selecting merchant: \", $scope.activeMerchant);\n                    $scope.clearMap();\n                    $scope.page = 0;\n                    $scope.items = [];\n                    $scope.getItems();\n                }\n                $scope.updateItem = function (data) {\n                    var item = data;\n                    var results = [];\n                    var last = null;\n                    item.polygon.getPaths().forEach(function (path, index) {\n                        console.log(\"path\", index);\n                        var vertices = path;\n                        for (var i = 0; i < vertices.getLength(); i++) {\n                            var xy = vertices.getAt(i);\n                            var point = {\"lat\": xy.lat(), \"lng\": xy.lng()};\n                            results.push(point);\n                            if (i == 0) {\n                                last = point;\n                            }\n                        }\n                    });\n                    results.push(last);\n                    var polygon = item.polygon;\n                    delete item.polygon;\n                    delete item.isActive;\n                    item.coverage = JSON.stringify(results);\n                    console.log(\"Zone\", item);\n                    console.log(\"Points\", results);\n                    Zones.updateZoneItem(item).then(function (data) {\n                        item.polygon = polygon;\n                        item.isActive = false;\n                        console.log(\"updateZoneItem\", data);\n                    },\n                            function (data) {\n\n                            });\n                }\n                $scope.deleteItem = function (item) {\n                    console.log(\"Zone\", item);\n                    Zones.deleteZoneItem(item).then(function (data) {\n                        for (item in $scope.items) {\n                            console.log(\"Creating map data item\")\n                            $scope.items[item].polygon.setMap(null);\n                            $scope.items[item].isActive = false;\n                            $scope.items.splice(item, 1);\n                        }\n\n                    },\n                            function (data) {\n\n                            });\n                }\n\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy96b25lc2N0cmwuanM/ODRiYyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignWm9uZXNDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdab25lcycsICdNYXBTZXJ2aWNlJywgJ01lcmNoYW50cycsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIFpvbmVzLCBNYXBTZXJ2aWNlLCBNZXJjaGFudHMpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvdmlkZXJzID0gW3tcIm5hbWVcIjogXCJNaSBQYXF1ZXRlXCIsIFwidmFsdWVcIjogXCJNaVBhcXVldGVcIn0sIHtcIm5hbWVcIjogXCJSYXBpZ29cIiwgXCJ2YWx1ZVwiOiBcIlJhcGlnb1wifSwge1wibmFtZVwiOiBcIlByb3Bpb1wiLCBcInZhbHVlXCI6IFwiUHJvcGlvXCJ9XSwge1wibmFtZVwiOiBcIkJhc2lsaWt1bVwiLCBcInZhbHVlXCI6IFwiQmFzaWxpa3VtXCJ9O1xuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNZXJjaGFudDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnRPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VhcmNoVGVybXMgPSBcIlwiO1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVOZXdNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkTW9yZSA9IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0dGluZyBtZXJjaGFudHMgYW5kIHpvbmVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgIE1hcFNlcnZpY2UuY3JlYXRlTWFwKDQuNjg1NDE5LCAtNzQuMDY0MTYxKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRNZXJjaGFudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5nZXRNZXJjaGFudHNVc2VyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgPSAkc2NvcGUubWVyY2hhbnRzWzBdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbihcInpvbmUtdXBkYXRlZFwiLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuaXRlbXNbaXRlbV0uaWQgPT0gZGF0YS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRkaWdlc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vaXRlbS5hdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShpdGVtLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUFjdGl2ZU1lcmNoYW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlTWVyY2hhbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlSXRlbVN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlTmV3TWVyY2hhbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsQ2hhbmdlTWVyY2hhbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VNZXJjaGFudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGVNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhXCIpXG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGFcIilcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS5pdGVtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSBpdGVtXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBNYXBTZXJ2aWNlLmdldENvbG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXNbaXRlbV0ucG9seWdvbiA9IE1hcFNlcnZpY2UuY3JlYXRlUG9seWdvbigkc2NvcGUuaXRlbXNbaXRlbV0sIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgaXRlbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLnBvbHlnb24uc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZVNjZW5hcmlvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJvdXRlQ29sb3JzID0gW1wiI0ZGMDAwMFwiLCBcIiM4MDAwMDBcIiwgXCIjRkZGRjAwXCIsIFwiIzgwODAwMFwiLCBcIiMwMEZGMDBcIiwgXCIjMDA4MDAwXCIsIFwiIzAwRkZGRlwiLCBcIiMwMDgwODBcIiwgXCIjMDAwMEZGXCIsIFwiIzAwMDA4MFwiLCBcIiNGRjAwRkZcIiwgXCIjODAwMDgwXCJdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKHJvdXRlQ29sb3JzLmxlbmd0aCAtIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlQ29sb3JzW3JhbmRvbV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RJdGVtID0gZnVuY3Rpb24gKHpvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgIHpvbmUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB6b25lLnBvbHlnb24uc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZUl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jbGVhck1hcCgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgY2VudGVyTWFwID0gJHJvb3RTY29wZS5tYXAuZ2V0Q2VudGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjZW50ZXIgPSB7XCJsYXRcIjogY2VudGVyTWFwLmxhdCgpLCBcImxuZ1wiOiBjZW50ZXJNYXAubG5nKCl9O1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNlbnRlciBNYXBcIiwgY2VudGVyLmxhdCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb3ZlcmFnZSA9IFt7XCJsYXRcIjogY2VudGVyLmxhdCArIDAuMDA2LCBcImxuZ1wiOiBjZW50ZXIubG5nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcImxhdFwiOiBjZW50ZXIubGF0IC0gMC4wMDYsIFwibG5nXCI6IGNlbnRlci5sbmcgLSAwLjAwNn0sIHtcImxhdFwiOiBjZW50ZXIubGF0IC0gMC4wMDYsIFwibG5nXCI6IGNlbnRlci5sbmcgKyAwLjAwNn0sIHtcImxhdFwiOiBjZW50ZXIubGF0ICsgMC4wMDYsIFwibG5nXCI6IGNlbnRlci5sbmd9XTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImNpdHlfaWRcIjogNTI0LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWdpb25faWRcIjogMTEsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NfaWRcIjogMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvdW50cnlfaWRcIjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVyY2hhbnRfaWRcIjogJHNjb3BlLmFjdGl2ZU1lcmNoYW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlclwiOiAkc2NvcGUuYWN0aXZlUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvdmVyYWdlXCI6IEpTT04uc3RyaW5naWZ5KGNvdmVyYWdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGF0XCI6IDQuNjQ5ODI0LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJsb25nXCI6IC03NC4wNTg4ODFcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMuY3JlYXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gTWFwU2VydmljZS5nZXRDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSBkYXRhLml0ZW07XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnBvbHlnb24gPSBNYXBTZXJ2aWNlLmNyZWF0ZVBvbHlnb24oaXRlbSwgY29sb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UrKztcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IFwib3JkZXJfYnk9aWQsZGVzYyZwYWdlPVwiICsgJHNjb3BlLnBhZ2UgKyBcIiZtZXJjaGFudF9pZD1cIiArICRzY29wZS5hY3RpdmVNZXJjaGFudDtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMuZ2V0Wm9uZXModXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRNb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250ID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluIGl0ZW1zQ29udCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQ29udFtpdGVtXSA9ICRzY29wZS5idWlsZEl0ZW1EYXRhKGl0ZW1zQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSAkc2NvcGUuaXRlbXMuY29uY2F0KGl0ZW1zQ29udCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2hNZXJjaGFudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlKys7XG4gICAgICAgICAgICAgICAgICAgIE1lcmNoYW50cy5zZWFyY2hNZXJjaGFudHMoJHNjb3BlLnNlYXJjaFRlcm1zKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVyY2hhbnRzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdE1lcmNoYW50ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZU1lcmNoYW50T2JqZWN0ID0gaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVNZXJjaGFudCA9IGl0ZW0uaWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2hhbmdlTWVyY2hhbnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RNZXJjaGFudE9iamVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3RpbmcgbWVyY2hhbnQ6IFwiLCAkc2NvcGUuYWN0aXZlTWVyY2hhbnQpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldEl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVJdGVtID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbGFzdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucG9seWdvbi5nZXRQYXRocygpLmZvckVhY2goZnVuY3Rpb24gKHBhdGgsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhdGhcIiwgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZlcnRpY2VzID0gcGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMuZ2V0TGVuZ3RoKCk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4eSA9IHZlcnRpY2VzLmdldEF0KGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2ludCA9IHtcImxhdFwiOiB4eS5sYXQoKSwgXCJsbmdcIjogeHkubG5nKCl9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0ID0gcG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGxhc3QpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9seWdvbiA9IGl0ZW0ucG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0ucG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0uaXNBY3RpdmU7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY292ZXJhZ2UgPSBKU09OLnN0cmluZ2lmeShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJab25lXCIsIGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvaW50c1wiLCByZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMudXBkYXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wb2x5Z29uID0gcG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlWm9uZUl0ZW1cIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiWm9uZVwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgWm9uZXMuZGVsZXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpdGVtIGluICRzY29wZS5pdGVtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbWFwIGRhdGEgaXRlbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5wb2x5Z29uLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXNbaXRlbV0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMuc3BsaWNlKGl0ZW0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvY29udHJvbGxlcnMvem9uZXNjdHJsLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 30 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .controller('ZonesPubCtrl',['$scope', '$rootScope', 'Food', 'MapService', function ($scope, $rootScope, Food, MapService) {\n            $scope.data = {};\n            $scope.items = [];\n            $scope.merchants = [{\"name\": \"Plan de almuerzos\", \"value\": 1299}, {\"name\": \"Para preparar en casa\", \"value\": 1300}, {\"name\": \"Catering\", \"value\": 1301}];\n            $scope.providers = [{\"name\": \"Basilikum\", \"value\": \"Basilikum\"}, {\"name\": \"Rapigo\", \"value\": \"Rapigo\"}];\n            $scope.activeMerchant = 1299 + \"\";\n            $scope.activeProvider = \"Basilikum\";\n            $scope.loadMore = true,\n                    $scope.page = 0;\n            angular.element(document).ready(function () {\n                $scope.getItems();\n                MapService.createMap(4.685419, -74.064161);\n            });\n\n            $scope.buildItemData = function (item) {\n                item.isActive = false;\n                //item.attributes = JSON.parse(item.attributes);\n                return item;\n            }\n            $scope.activateMap = function () {\n                $scope.mapActive = true;\n                console.log(\"Creating map data\")\n\n                $scope.createMapData();\n            }\n            $scope.createMapData = function () {\n                console.log(\"Creating map data\")\n                for (item in $scope.items) {\n                    console.log(\"Creating map data item\")\n                    var color = MapService.getColor();\n                    $scope.items[item].polygon = MapService.createPolygon($scope.items[item], color);\n                }\n            }\n            $scope.clearMap = function () {\n                for (item in $scope.items) {\n                    console.log(\"Creating map data item\")\n                    $scope.items[item].polygon.setMap(null);\n                    $scope.items[item].isActive = false;\n                }\n            }\n            $scope.changeScenario = function () {\n                $scope.clearMap();\n                $scope.items = [];\n                $scope.page = 0;\n                $scope.getItems();\n            }\n            $scope.getColor = function () {\n                var routeColors = [\"#FF0000\", \"#800000\", \"#FFFF00\", \"#808000\", \"#00FF00\", \"#008000\", \"#00FFFF\", \"#008080\", \"#0000FF\", \"#000080\", \"#FF00FF\", \"#800080\"];\n                var random = Math.round(Math.random() * (routeColors.length - 1));\n                return routeColors[random];\n            }\n            $scope.selectItem = function (zone) {\n                $scope.clearMap();\n                zone.isActive = true;\n                zone.polygon.setMap($rootScope.map);\n            }\n            $scope.createItem = function () {\n                $scope.clearMap();\n                var coverage = [{\"lat\": 4.661880, \"lng\": -74.056724},\n                    {\"lat\": 4.656747, \"lng\": -74.060458}, {\"lat\": 4.656277, \"lng\": -74.052304}];\n                var item = {\n                    \"city_id\": 524,\n                    \"region_id\": 11,\n                    \"address_id\": 14,\n                    \"country_id\": 1,\n                    \"merchant_id\": $scope.activeMerchant,\n                    \"provider\": $scope.activeProvider,\n                    \"coverage\": JSON.stringify(coverage),\n                    \"lat\": 4.649824,\n                    \"long\": -74.058881\n                };\n                Food.createZoneItem(item).then(function (data) {\n                    var color = MapService.getColor();\n                    var item = data.item;\n                    item.polygon = MapService.createPolygon(item, color);\n                    $scope.items.push(item);\n                },\n                        function (data) {\n\n                        });\n            }\n\n            $scope.getItems = function () {\n                $scope.page++;\n                var url = \"order_by=id,desc&page=\" + $scope.page + \"&merchant_id=\" + $scope.activeMerchant + \"&provider=\" + $scope.activeProvider;\n                Food.getZones(url).then(function (data) {\n                    if (data.page == data.last_page) {\n                        $scope.loadMore = false;\n                    }\n                    console.log(\"Items\", data.data);\n                    var itemsCont = data.data;\n                    for (item in itemsCont) {\n                        itemsCont[item] = $scope.buildItemData(itemsCont[item]);\n                    }\n                    $scope.items = $scope.items.concat(itemsCont);\n                    $scope.activateMap();\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.updateItem = function (data) {\n                var item = data;\n                var results = [];\n                var last = null;\n                item.polygon.getPaths().forEach(function (path, index) {\n                    console.log(\"path\", index);\n                    var vertices = path;\n                    for (var i = 0; i < vertices.getLength(); i++) {\n                        var xy = vertices.getAt(i);\n                        var point = {\"lat\": xy.lat(), \"lng\": xy.lng()};\n                        results.push(point);\n                        if (i == 0) {\n                            last = point;\n                        }\n                    }\n                });\n                results.push(last);\n                var polygon = item.polygon;\n                delete item.polygon;\n                delete item.isActive;\n                item.coverage = JSON.stringify(results);\n                console.log(\"Zone\", item);\n                console.log(\"Points\", results);\n                Food.updateZoneItem(item).then(function (data) {\n                    item.polygon = polygon;\n                    console.log(\"updateZoneItem\", data);\n                },\n                        function (data) {\n\n                        });\n            }\n            $scope.deleteItem = function (item) {\n                console.log(\"Zone\", item);\n                Food.deleteZoneItem(item).then(function (data) {\n                    for (item in $scope.items) {\n                        console.log(\"Creating map data item\")\n                        $scope.items[item].polygon.setMap(null);\n                        $scope.items[item].isActive = false;\n                        $scope.items.splice(item, 1);\n                    }\n\n                },\n                        function (data) {\n\n                        });\n            }\n\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9jb250cm9sbGVycy96b25lc3B1YmN0cmwuanM/ODYyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuY29udHJvbGxlcignWm9uZXNQdWJDdHJsJyxbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0Zvb2QnLCAnTWFwU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIEZvb2QsIE1hcFNlcnZpY2UpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0ge307XG4gICAgICAgICAgICAkc2NvcGUuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBbe1wibmFtZVwiOiBcIlBsYW4gZGUgYWxtdWVyem9zXCIsIFwidmFsdWVcIjogMTI5OX0sIHtcIm5hbWVcIjogXCJQYXJhIHByZXBhcmFyIGVuIGNhc2FcIiwgXCJ2YWx1ZVwiOiAxMzAwfSwge1wibmFtZVwiOiBcIkNhdGVyaW5nXCIsIFwidmFsdWVcIjogMTMwMX1dO1xuICAgICAgICAgICAgJHNjb3BlLnByb3ZpZGVycyA9IFt7XCJuYW1lXCI6IFwiQmFzaWxpa3VtXCIsIFwidmFsdWVcIjogXCJCYXNpbGlrdW1cIn0sIHtcIm5hbWVcIjogXCJSYXBpZ29cIiwgXCJ2YWx1ZVwiOiBcIlJhcGlnb1wifV07XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgPSAxMjk5ICsgXCJcIjtcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVQcm92aWRlciA9IFwiQmFzaWxpa3VtXCI7XG4gICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSA9IDA7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgICAgICBNYXBTZXJ2aWNlLmNyZWF0ZU1hcCg0LjY4NTQxOSwgLTc0LjA2NDE2MSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLmJ1aWxkSXRlbURhdGEgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGl0ZW0uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvL2l0ZW0uYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoaXRlbS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5hY3RpdmF0ZU1hcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWFwQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhXCIpXG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlTWFwRGF0YSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1hcERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YVwiKVxuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSBpdGVtXCIpXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb2xvciA9IE1hcFNlcnZpY2UuZ2V0Q29sb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLnBvbHlnb24gPSBNYXBTZXJ2aWNlLmNyZWF0ZVBvbHlnb24oJHNjb3BlLml0ZW1zW2l0ZW1dLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkc2NvcGUuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBtYXAgZGF0YSBpdGVtXCIpXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5wb2x5Z29uLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zW2l0ZW1dLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNoYW5nZVNjZW5hcmlvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jbGVhck1hcCgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICRzY29wZS5wYWdlID0gMDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5nZXRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsZXQgcm91dGVDb2xvcnMgPSBbXCIjRkYwMDAwXCIsIFwiIzgwMDAwMFwiLCBcIiNGRkZGMDBcIiwgXCIjODA4MDAwXCIsIFwiIzAwRkYwMFwiLCBcIiMwMDgwMDBcIiwgXCIjMDBGRkZGXCIsIFwiIzAwODA4MFwiLCBcIiMwMDAwRkZcIiwgXCIjMDAwMDgwXCIsIFwiI0ZGMDBGRlwiLCBcIiM4MDAwODBcIl07XG4gICAgICAgICAgICAgICAgbGV0IHJhbmRvbSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChyb3V0ZUNvbG9ycy5sZW5ndGggLSAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlQ29sb3JzW3JhbmRvbV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uICh6b25lKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyTWFwKCk7XG4gICAgICAgICAgICAgICAgem9uZS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgem9uZS5wb2x5Z29uLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuY3JlYXRlSXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2xlYXJNYXAoKTtcbiAgICAgICAgICAgICAgICBsZXQgY292ZXJhZ2UgPSBbe1wibGF0XCI6IDQuNjYxODgwLCBcImxuZ1wiOiAtNzQuMDU2NzI0fSxcbiAgICAgICAgICAgICAgICAgICAge1wibGF0XCI6IDQuNjU2NzQ3LCBcImxuZ1wiOiAtNzQuMDYwNDU4fSwge1wibGF0XCI6IDQuNjU2Mjc3LCBcImxuZ1wiOiAtNzQuMDUyMzA0fV07XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY2l0eV9pZFwiOiA1MjQsXG4gICAgICAgICAgICAgICAgICAgIFwicmVnaW9uX2lkXCI6IDExLFxuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NfaWRcIjogMTQsXG4gICAgICAgICAgICAgICAgICAgIFwiY291bnRyeV9pZFwiOiAxLFxuICAgICAgICAgICAgICAgICAgICBcIm1lcmNoYW50X2lkXCI6ICRzY29wZS5hY3RpdmVNZXJjaGFudCxcbiAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlclwiOiAkc2NvcGUuYWN0aXZlUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIFwiY292ZXJhZ2VcIjogSlNPTi5zdHJpbmdpZnkoY292ZXJhZ2UpLFxuICAgICAgICAgICAgICAgICAgICBcImxhdFwiOiA0LjY0OTgyNCxcbiAgICAgICAgICAgICAgICAgICAgXCJsb25nXCI6IC03NC4wNTg4ODFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIEZvb2QuY3JlYXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBNYXBTZXJ2aWNlLmdldENvbG9yKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpdGVtID0gZGF0YS5pdGVtO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnBvbHlnb24gPSBNYXBTZXJ2aWNlLmNyZWF0ZVBvbHlnb24oaXRlbSwgY29sb3IpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFnZSsrO1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSBcIm9yZGVyX2J5PWlkLGRlc2MmcGFnZT1cIiArICRzY29wZS5wYWdlICsgXCImbWVyY2hhbnRfaWQ9XCIgKyAkc2NvcGUuYWN0aXZlTWVyY2hhbnQgKyBcIiZwcm92aWRlcj1cIiArICRzY29wZS5hY3RpdmVQcm92aWRlcjtcbiAgICAgICAgICAgICAgICBGb29kLmdldFpvbmVzKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlID09IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZE1vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1zXCIsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpdGVtc0NvbnQgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiBpdGVtc0NvbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zQ29udFtpdGVtXSA9ICRzY29wZS5idWlsZEl0ZW1EYXRhKGl0ZW1zQ29udFtpdGVtXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gJHNjb3BlLml0ZW1zLmNvbmNhdChpdGVtc0NvbnQpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZhdGVNYXAoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlSXRlbSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICAgICAgICAgICAgbGV0IGxhc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgIGl0ZW0ucG9seWdvbi5nZXRQYXRocygpLmZvckVhY2goZnVuY3Rpb24gKHBhdGgsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGF0aFwiLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2ZXJ0aWNlcyA9IHBhdGg7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMuZ2V0TGVuZ3RoKCk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHh5ID0gdmVydGljZXMuZ2V0QXQoaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSB7XCJsYXRcIjogeHkubGF0KCksIFwibG5nXCI6IHh5LmxuZygpfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChwb2ludCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IHBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGxhc3QpO1xuICAgICAgICAgICAgICAgIHZhciBwb2x5Z29uID0gaXRlbS5wb2x5Z29uO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBpdGVtLnBvbHlnb247XG4gICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0uaXNBY3RpdmU7XG4gICAgICAgICAgICAgICAgaXRlbS5jb3ZlcmFnZSA9IEpTT04uc3RyaW5naWZ5KHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiWm9uZVwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvaW50c1wiLCByZXN1bHRzKTtcbiAgICAgICAgICAgICAgICBGb29kLnVwZGF0ZVpvbmVJdGVtKGl0ZW0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5wb2x5Z29uID0gcG9seWdvbjtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGVab25lSXRlbVwiLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJab25lXCIsIGl0ZW0pO1xuICAgICAgICAgICAgICAgIEZvb2QuZGVsZXRlWm9uZUl0ZW0oaXRlbSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGl0ZW0gaW4gJHNjb3BlLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG1hcCBkYXRhIGl0ZW1cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5wb2x5Z29uLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pdGVtc1tpdGVtXS5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1zLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL2NvbnRyb2xsZXJzL3pvbmVzcHViY3RybC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 31 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Addresses',['$q', '$http', function ($q, $http) {\n\n            var getAddresses = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/addresses' \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveAddress = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/addresses',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            var deleteAddress = function (address) {\n                var def = $q.defer();\n                $http({\n                    method: 'DELETE',\n                    url: '/api/addresses/' + address\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to Delete Address\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                getAddresses:getAddresses,\n                saveAddress:saveAddress,\n                deleteAddress:deleteAddress\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9hZGRyZXNzLmpzPzMyMDgiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIFxuICAgICAgICAuc2VydmljZSgnQWRkcmVzc2VzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMnIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzYXZlQWRkcmVzcyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkZHJlc3NlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGVsZXRlQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkZHJlc3Nlcy8nICsgYWRkcmVzc1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIERlbGV0ZSBBZGRyZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0QWRkcmVzc2VzOmdldEFkZHJlc3NlcyxcbiAgICAgICAgICAgICAgICBzYXZlQWRkcmVzczpzYXZlQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBkZWxldGVBZGRyZXNzOmRlbGV0ZUFkZHJlc3NcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL2FkZHJlc3MuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 32 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Billing',['$q', '$http', function ($q, $http) {\n\n            var payCreditCard = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_cc/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to payCreditCard\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var payInBank = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_in_bank/Local',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to payInBank\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var completePaidOrder = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/complete_paid/Food',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to completePaidOrder\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var retryPayment = function (payment) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/retry/'+payment,\n                        \n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to retryPayment\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            \n            var addTransactionCosts = function (payment) {\n                var def = $q.defer();\n                \n                $http({\n                        method: 'POST',\n                        url: '/api/billing/add_transaction_costs/'+payment,\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to addTransactionCosts\");\n                        });\n                return def.promise;\n            }\n\n            var payDebit = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_debit/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to payDebit\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var payCash = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/pay_cash/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to payCash\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getBanks = function (where) {\n                var url =\"/api/payu/banks\";\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: url,\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getBanks\");\n                        });\n                return def.promise;\n            }\n            return {\n                payCreditCard: payCreditCard,\n                payInBank:payInBank,\n                completePaidOrder: completePaidOrder,\n                retryPayment:retryPayment,\n                addTransactionCosts:addTransactionCosts,\n                payDebit: payDebit,\n                payCash:payCash,\n                getBanks:getBanks\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9iaWxsaW5nLmpzPzg2NGEiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIFxuICAgICAgICAuc2VydmljZSgnQmlsbGluZycsWyckcScsICckaHR0cCcsIGZ1bmN0aW9uICgkcSwgJGh0dHApIHtcblxuICAgICAgICAgICAgdmFyIHBheUNyZWRpdENhcmQgPSBmdW5jdGlvbiAoZGF0YSxwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL3BheV9jYy8nK3BsYXRmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHBheUNyZWRpdENhcmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwYXlJbkJhbmsgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL3BheV9pbl9iYW5rL0xvY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBwYXlJbkJhbmtcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb21wbGV0ZVBhaWRPcmRlciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvY29tcGxldGVfcGFpZC9Gb29kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjb21wbGV0ZVBhaWRPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJldHJ5UGF5bWVudCA9IGZ1bmN0aW9uIChwYXltZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvcmV0cnkvJytwYXltZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byByZXRyeVBheW1lbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGFkZFRyYW5zYWN0aW9uQ29zdHMgPSBmdW5jdGlvbiAocGF5bWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL2FkZF90cmFuc2FjdGlvbl9jb3N0cy8nK3BheW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhZGRUcmFuc2FjdGlvbkNvc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcGF5RGViaXQgPSBmdW5jdGlvbiAoZGF0YSxwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL3BheV9kZWJpdC8nK3BsYXRmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHBheURlYml0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGF5Q2FzaCA9IGZ1bmN0aW9uIChkYXRhLHBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvcGF5X2Nhc2gvJytwbGF0Zm9ybSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBwYXlDYXNoXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRCYW5rcyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPVwiL2FwaS9wYXl1L2JhbmtzXCI7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0QmFua3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBheUNyZWRpdENhcmQ6IHBheUNyZWRpdENhcmQsXG4gICAgICAgICAgICAgICAgcGF5SW5CYW5rOnBheUluQmFuayxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVBhaWRPcmRlcjogY29tcGxldGVQYWlkT3JkZXIsXG4gICAgICAgICAgICAgICAgcmV0cnlQYXltZW50OnJldHJ5UGF5bWVudCxcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2FjdGlvbkNvc3RzOmFkZFRyYW5zYWN0aW9uQ29zdHMsXG4gICAgICAgICAgICAgICAgcGF5RGViaXQ6IHBheURlYml0LFxuICAgICAgICAgICAgICAgIHBheUNhc2g6cGF5Q2FzaCxcbiAgICAgICAgICAgICAgICBnZXRCYW5rczpnZXRCYW5rc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvYmlsbGluZy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 33 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .service('Booking', ['$q', '$http', function ($q, $http) {\n\n                var getBookingsObject = function (objectB) {\n                    var url = '/api/bookings';\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url,\n                        params: objectB\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to getBookingsObject\");\n                            });\n\n                    return def.promise;\n                    /**/\n\n                }\n                var getBooking = function (objectB) {\n                    var url = '/api/bookings/' + objectB;\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to getBooking\");\n                            });\n\n                    return def.promise;\n                    /**/\n                }\n                var getObjectsWithBookingUser = function () {\n                    var url = '/bookings/user';\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to getObjectsWithBookingUser\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var checkExistingBooking = function (booking_id) {\n                    var url = '/api/bookings/' + booking_id + \"/check\";\n                    var def = $q.defer();\n                    $http({\n                        method: 'get',\n                        url: url\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to checkExistingBooking\");\n                            });\n\n                    return def.promise;\n                    /**/\n                }\n                var addBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: '/api/bookings',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to addBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n\n                var editBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: '/api/bookings/edit',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to editBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var immediateBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: '/api/bookings/now',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to immediateBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var getAvailabilitiesObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'GET',\n                        url: \"/api/availabilities\",\n                        params: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to getAvailabilitiesObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var changeStatusBookingObject = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'POST',\n                        url: \"/api/bookings/status\",\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to changeStatusBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var deleteBookingObject = function (objectId) {\n                    var def = $q.defer();\n                    $http({\n                        method: 'DELETE',\n                        url: \"/api/bookings/\" + objectId\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to deleteBookingObject\");\n                            });\n                    return def.promise;\n                    /**/\n                }\n                var getMonthName = function (month) {\n                    if (month == 0) {\n                        return \"Enero\"\n                    }\n                    if (month == 1) {\n                        return \"Febrero\"\n                    }\n                    if (month == 2) {\n                        return \"Marzo\"\n                    }\n                    if (month == 3) {\n                        return \"Abril\"\n                    }\n                    if (month == 4) {\n                        return \"Mayo\"\n                    }\n                    if (month == 5) {\n                        return \"Junio\"\n                    }\n                    if (month == 6) {\n                        return \"Julio\"\n                    }\n                    if (month == 7) {\n                        return \"Agosto\"\n                    }\n                    if (month == 8) {\n                        return \"Septiembre\"\n                    }\n                    if (month == 9) {\n                        return \"Octubre\"\n                    }\n                    if (month == 10) {\n                        return \"Noviembre\"\n                    }\n                    if (month == 11) {\n                        return \"Diciembre\"\n                    }\n                }\n\n                return {\n                    getBookingsObject: getBookingsObject,\n                    getBooking: getBooking,\n                    getObjectsWithBookingUser: getObjectsWithBookingUser,\n                    checkExistingBooking: checkExistingBooking,\n                    addBookingObject: addBookingObject,\n                    editBookingObject: editBookingObject,\n                    immediateBookingObject: immediateBookingObject,\n                    getAvailabilitiesObject: getAvailabilitiesObject,\n                    changeStatusBookingObject: changeStatusBookingObject,\n                    deleteBookingObject:deleteBookingObject,\n                    getMonthName:getMonthName\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9ib29raW5nLmpzPzM1MjciXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG5cbiAgICAgICAgLnNlcnZpY2UoJ0Jvb2tpbmcnLCBbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGdldEJvb2tpbmdzT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdEIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Jvb2tpbmdzJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogb2JqZWN0QlxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldEJvb2tpbmdzT2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRCb29raW5nID0gZnVuY3Rpb24gKG9iamVjdEIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Jvb2tpbmdzLycgKyBvYmplY3RCO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0Qm9va2luZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldE9iamVjdHNXaXRoQm9va2luZ1VzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2Jvb2tpbmdzL3VzZXInO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0T2JqZWN0c1dpdGhCb29raW5nVXNlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGVja0V4aXN0aW5nQm9va2luZyA9IGZ1bmN0aW9uIChib29raW5nX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9ib29raW5ncy8nICsgYm9va2luZ19pZCArIFwiL2NoZWNrXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjaGVja0V4aXN0aW5nQm9va2luZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGFkZEJvb2tpbmdPYmplY3QgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2Jvb2tpbmdzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkQm9va2luZ09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGVkaXRCb29raW5nT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9ib29raW5ncy9lZGl0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZWRpdEJvb2tpbmdPYmplY3RcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgaW1tZWRpYXRlQm9va2luZ09iamVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYm9va2luZ3Mvbm93JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gaW1tZWRpYXRlQm9va2luZ09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRBdmFpbGFiaWxpdGllc09iamVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvYXZhaWxhYmlsaXRpZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRBdmFpbGFiaWxpdGllc09iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VTdGF0dXNCb29raW5nT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvYm9va2luZ3Mvc3RhdHVzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGNoYW5nZVN0YXR1c0Jvb2tpbmdPYmplY3RcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlQm9va2luZ09iamVjdCA9IGZ1bmN0aW9uIChvYmplY3RJZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2Jvb2tpbmdzL1wiICsgb2JqZWN0SWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVCb29raW5nT2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldE1vbnRoTmFtZSA9IGZ1bmN0aW9uIChtb250aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiRW5lcm9cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJGZWJyZXJvXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiTWFyem9cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJBYnJpbFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIk1heW9cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSA1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJKdW5pb1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIkp1bGlvXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gNykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiQWdvc3RvXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiU2VwdGllbWJyZVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbnRoID09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIk9jdHVicmVcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAxMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiTm92aWVtYnJlXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPT0gMTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIkRpY2llbWJyZVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBnZXRCb29raW5nc09iamVjdDogZ2V0Qm9va2luZ3NPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGdldEJvb2tpbmc6IGdldEJvb2tpbmcsXG4gICAgICAgICAgICAgICAgICAgIGdldE9iamVjdHNXaXRoQm9va2luZ1VzZXI6IGdldE9iamVjdHNXaXRoQm9va2luZ1VzZXIsXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRXhpc3RpbmdCb29raW5nOiBjaGVja0V4aXN0aW5nQm9va2luZyxcbiAgICAgICAgICAgICAgICAgICAgYWRkQm9va2luZ09iamVjdDogYWRkQm9va2luZ09iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdEJvb2tpbmdPYmplY3Q6IGVkaXRCb29raW5nT2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBpbW1lZGlhdGVCb29raW5nT2JqZWN0OiBpbW1lZGlhdGVCb29raW5nT2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBnZXRBdmFpbGFiaWxpdGllc09iamVjdDogZ2V0QXZhaWxhYmlsaXRpZXNPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZVN0YXR1c0Jvb2tpbmdPYmplY3Q6IGNoYW5nZVN0YXR1c0Jvb2tpbmdPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZUJvb2tpbmdPYmplY3Q6ZGVsZXRlQm9va2luZ09iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0TW9udGhOYW1lOmdldE1vbnRoTmFtZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9ib29raW5nLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 34 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Cart', ['$q', '$http', '$mdDialog', 'Modals', '$cookies', '$rootScope', function ($q, $http, $mdDialog, Modals, $cookies, $rootScope) {\n\n                var showConfirm = function (url) {\n                    $mdDialog.show(Modals.getLocationPrompt()).then(function (answer) {\n                        if (answer == \"map\") {\n                            $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\n                            window.location.href = \"/location\";\n                        } else if (answer == 'address') {\n                            showAdvanced();\n                        }\n\n                    }, function () {\n\n                    });\n                };\n                var showQuestionaire = function (questions) {\n                    $mdDialog.show(Modals.getQuestionairePopup(questions)).then(function (answer) {\n                        console.log(\"questions\", answer)\n\n                    }, function () {\n\n                    });\n                };\n                var showConfirmExt = function (url) {\n                    $cookies.put(\"locationRefferrer\", url, {path: \"/\"});\n                    window.location.href = \"/location\";\n                };\n                var checkProduct = function (variant) {\n                    console.log(\"Checking: \", variant, $rootScope.user);\n                    if (variant.type == \"booking\" && $rootScope.user) {\n                        appointmentbook(variant.product);\n                        return false;\n                    } else {\n                        console.log(\"Check prod\", $rootScope.shippingAddress);\n                        if (variant.is_shippable) {\n                            if ($rootScope.shippingAddress) {\n                                return checkMerchant();\n                            }\n                            showConfirm(window.location.href);\n                            return false;\n                        } else {\n                            return checkMerchant();\n                        }\n                    }\n\n                };\n                appointmentbook = function (item) {\n                    var questions = [];\n                    var location = null;\n                    var duration = null;\n                    var container = null;\n                    console.log(\"variants\", item.variants)\n                    for (var i in item.variants) {\n                        if (item.variant_id == item.variants[i].id) {\n                            container = item.variants[i];\n                            break;\n                        }\n                    }\n                    console.log(\"Container\", container);\n                    if (container.attributes) {\n                        if (container.attributes.questions) {\n                            questions = container.attributes.questions;\n                        }\n                        if (container.attributes.location) {\n                            location = container.attributes.location;\n                        }\n                        if (container.attributes.duration) {\n                            duration = container.attributes.duration;\n                        }\n                    }\n                    var params = {\n                        \"availabilities\": null,\n                        \"type\": \"Merchant\",\n                        \"objectId\": item.merchant_id,\n                        \"objectName\": item.merchant_name,\n                        \"objectDescription\": item.merchant_description,\n                        \"objectIcon\": item.merchant_icon,\n                        \"expectedPrice\": item.activeVariant.price,\n                        \"questions\": questions,\n                        \"variant\": container,\n                        \"product_variant_id\": item.variant_id,\n                        \"quantity\": item.amount,\n                        \"purpose\": \"external_book\",\n                        \"alert\":\"#prod-cont-\" + item.id\n                    }\n                    if(location){\n                        params.location = location;\n                    }\n                    if(duration){\n                        params.duration = duration;\n                    }\n                    showBooking(params);\n                }\n                var getCategoryFromUrl = function () {\n                    var theUrl = window.location.href;\n                    var segments = theUrl.split(\"/\")\n                    var category = segments[(segments.length - 1)];\n                    if (category.includes(\"?\")) {\n                        category = category.split(\"?\")[0];\n                    }\n                    if (isNaN(category)) {\n                        return null;\n                    }\n                    return category;\n                };\n                var checkMerchant = function () {\n                    if ($rootScope.merchant_id) {\n                        return true;\n                    } else {\n                        var category = getCategoryFromUrl();\n                        console.log(\"Searching for merchants in cat:\", category);\n                        showMerchants(category);\n                    }\n                };\n                var changeMerchant = function () {\n                    var category = getCategoryFromUrl();\n                    console.log(\"Searching for merchants in cat:\", category);\n                    showMerchants(category);\n                };\n                var showBooking = function (params) {\n                    var def = $q.defer();\n                    $mdDialog.show(Modals.getBookingPrompt(params)).then(function (result) {\n                        console.log(\"Got result\", $rootScope.cartMessage);\n                        Modals.hideLoader();\n                        Modals.showToast($rootScope.cartMessage, $(params.alert));\n                        def.resolve($rootScope.cartMessage);\n                    }, function () {\n                        console.log(\"Got nothing\");\n                        Modals.hideLoader();\n                        def.resolve(null);\n                    });\n                    return def.promise;\n                };\n                var showAdvanced = function () {\n                    $mdDialog.show(Modals.getAddressesPopup()).then(function (address) {\n                        console.log(\"Got address\", address);\n                        $rootScope.shippingAddress = address;\n                        $rootScope.lat = address.lat;\n                        $cookies.put(\"shippingAddress\", JSON.stringify(address), {path: \"/\"});\n                    }, function () {\n                        console.log(\"Got nothing\");\n                    });\n                };\n                var checkVariant = function (variant) {\n                    console.log(\"Variant\", variant);\n                    if (variant.attributes.questions) {\n                        showQuestionaire(variant.attributes.questions)\n                    }\n                };\n                var showMerchants = function (category) {\n                    $mdDialog.show(Modals.getMerchantsPopup(category)).then(function (merchant) {\n                        console.log(\"Got merchant\", merchant);\n                        var params = Modals.getAllUrlParams();\n                        if (params) {\n\n                        } else {\n                            params = {};\n                        }\n                        var theUrl = window.location.href;\n                        if (theUrl.includes(\"?\")) {\n                            theUrl = theUrl.split(\"?\")[0];\n                        }\n                        params.merchant_id = merchant.id\n                        var first = true;\n                        for (var k in params) {\n                            if (params.hasOwnProperty(k)) {\n                                if (first) {\n                                    theUrl = \"?\" + k + \"=\" + params[k];\n                                } else {\n                                    theUrl = \"&\" + k + \"=\" + params[k];\n                                }\n                            }\n                        }\n\n                        window.location.href = theUrl;\n                    }, function () {\n                        console.log(\"Got nothing\");\n                    });\n                };\n                var postToServer = function (postData) {\n                    console.log(\"Post to server\", postData);\n                    var def = $q.defer();\n                    $http({\n                        method: \"post\",\n                        url: \"/api/cart/add\",\n                        data: postData\n                    })\n                            .then(function (data) {\n                                console.log(\"Return cart\",data);\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to get nearby\");\n                            });\n                    return def.promise;\n                };\n                var checkCart = function () {\n                    console.log(\"Post checkCart\");\n                    var def = $q.defer();\n                    $http({\n                        method: \"post\",\n                        url: \"/api/cart/check\",\n                        data: {}\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to checkCart\");\n                            });\n                    return def.promise;\n                };\n\n                var addCartItem = function (container, extras) {\n                    console.log(\"Check variant: \", container);\n                    var results = checkProduct(container);\n                    container.merchant_id = $rootScope.merchant_id;\n                    if (!container.item_id) {\n                        container.item_id = null;\n                    }\n                    var actvVariant = container.product.activeVariant;\n                    var def = $q.defer();\n                    if (!results) {\n                        def.resolve({status: \"pending_location\", message: \"msg\"});\n                    } else {\n                        if (actvVariant.attributes && actvVariant.attributes.questions && actvVariant.type == \"product\") {\n                            $mdDialog.show(Modals.getQuestionairePopup(actvVariant.attributes.questions)).then(function (results) {\n                                var data = [];\n                                for (var i in results) {\n                                    var container$1 = {\n                                        \"name\": results[i].name,\n                                        \"value\": results[i].value\n                                    }\n                                    data.push(container$1);\n                                }\n                                var postData = {\n                                    product_variant_id: container.id,\n                                    merchant_id: container.merchant_id,\n                                    quantity: container.quantity,\n                                    item_id: container.item_id,\n                                    extras: {data: data}\n                                };\n                                postToServer(postData).then(function (data) {\n                                    def.resolve(data);\n                                }, function () {\n                                    def.reject(\"Failed to get nearby\");\n                                });\n                            }, function () {\n                                def.resolve({status: \"pending_questions\", message: \"Debes completar estas preguntas para comprar este producto\"});\n                            });\n                        } else {\n                            var postData = {\n                                product_variant_id: container.id,\n                                merchant_id: container.merchant_id,\n                                quantity: container.quantity,\n                                item_id: container.item_id,\n                                extras: extras\n                            };\n                            postToServer(postData).then(function (data) {\n                                def.resolve(data);\n                            }, function () {\n                                def.reject(\"Failed to postToServer\");\n                            });\n                        }\n                    }\n                    return def.promise;\n                };\n                var updateCartItem = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"post\",\n                        url: \"/api/cart/update\",\n                        data: data\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                var getCart = function () {\n                    var def = $q.defer();\n                    $http({\n                        method: \"GET\",\n                        url: \"/api/cart/get\"\n                    })\n                            .then(function (data) {\n                                console.log(\"Return\",data.data)\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to get nearby\");\n                            });\n                    return def.promise;\n                };\n                var getCheckoutCart = function () {\n                    var def = $q.defer();\n                    $http({\n                        method: \"GET\",\n                        url: \"/api/cart/checkout\"\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to get nearby\");\n                            });\n                    return def.promise;\n                };\n\n                var clearCart = function () {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/cart/clear\",\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to get nearby\");\n                            });\n\n                    return def.promise;\n                };\n                return {\n                    getCheckoutCart: getCheckoutCart,\n                    getCart: getCart,\n                    addCartItem: addCartItem,\n                    postToServer: postToServer,\n                    updateCartItem: updateCartItem,\n                    showBooking: showBooking,\n                    checkCart:checkCart,\n                    showConfirm: showConfirm,\n                    showConfirmExt: showConfirmExt,\n                    clearCart: clearCart,\n                    changeMerchant: changeMerchant\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXJ0LmpzP2YyMjYiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5zZXJ2aWNlKCdDYXJ0JywgWyckcScsICckaHR0cCcsICckbWREaWFsb2cnLCAnTW9kYWxzJywgJyRjb29raWVzJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHEsICRodHRwLCAkbWREaWFsb2csIE1vZGFscywgJGNvb2tpZXMsICRyb290U2NvcGUpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzaG93Q29uZmlybSA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldExvY2F0aW9uUHJvbXB0KCkpLnRoZW4oZnVuY3Rpb24gKGFuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuc3dlciA9PSBcIm1hcFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgdXJsLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2xvY2F0aW9uXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuc3dlciA9PSAnYWRkcmVzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93QWR2YW5jZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgc2hvd1F1ZXN0aW9uYWlyZSA9IGZ1bmN0aW9uIChxdWVzdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldFF1ZXN0aW9uYWlyZVBvcHVwKHF1ZXN0aW9ucykpLnRoZW4oZnVuY3Rpb24gKGFuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJxdWVzdGlvbnNcIiwgYW5zd2VyKVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBzaG93Q29uZmlybUV4dCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgJGNvb2tpZXMucHV0KFwibG9jYXRpb25SZWZmZXJyZXJcIiwgdXJsLCB7cGF0aDogXCIvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9sb2NhdGlvblwiO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrUHJvZHVjdCA9IGZ1bmN0aW9uICh2YXJpYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2tpbmc6IFwiLCB2YXJpYW50LCAkcm9vdFNjb3BlLnVzZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFudC50eXBlID09IFwiYm9va2luZ1wiICYmICRyb290U2NvcGUudXNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBwb2ludG1lbnRib29rKHZhcmlhbnQucHJvZHVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNrIHByb2RcIiwgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhbnQuaXNfc2hpcHBhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja01lcmNoYW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja01lcmNoYW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYXBwb2ludG1lbnRib29rID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHF1ZXN0aW9ucyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbG9jYXRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZHVyYXRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2YXJpYW50c1wiLCBpdGVtLnZhcmlhbnRzKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIGl0ZW0udmFyaWFudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnZhcmlhbnRfaWQgPT0gaXRlbS52YXJpYW50c1tpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGl0ZW0udmFyaWFudHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb250YWluZXJcIiwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmF0dHJpYnV0ZXMucXVlc3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25zID0gY29udGFpbmVyLmF0dHJpYnV0ZXMucXVlc3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5hdHRyaWJ1dGVzLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24gPSBjb250YWluZXIuYXR0cmlidXRlcy5sb2NhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuYXR0cmlidXRlcy5kdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gY29udGFpbmVyLmF0dHJpYnV0ZXMuZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXZhaWxhYmlsaXRpZXNcIjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcIk1lcmNoYW50XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdElkXCI6IGl0ZW0ubWVyY2hhbnRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9iamVjdE5hbWVcIjogaXRlbS5tZXJjaGFudF9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3REZXNjcmlwdGlvblwiOiBpdGVtLm1lcmNoYW50X2Rlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvYmplY3RJY29uXCI6IGl0ZW0ubWVyY2hhbnRfaWNvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXhwZWN0ZWRQcmljZVwiOiBpdGVtLmFjdGl2ZVZhcmlhbnQucHJpY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInF1ZXN0aW9uc1wiOiBxdWVzdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZhcmlhbnRcIjogY29udGFpbmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9kdWN0X3ZhcmlhbnRfaWRcIjogaXRlbS52YXJpYW50X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJxdWFudGl0eVwiOiBpdGVtLmFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHVycG9zZVwiOiBcImV4dGVybmFsX2Jvb2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWxlcnRcIjpcIiNwcm9kLWNvbnQtXCIgKyBpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYobG9jYXRpb24pe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoZHVyYXRpb24pe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2hvd0Jvb2tpbmcocGFyYW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldENhdGVnb3J5RnJvbVVybCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRoZVVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2VnbWVudHMgPSB0aGVVcmwuc3BsaXQoXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIGxldCBjYXRlZ29yeSA9IHNlZ21lbnRzWyhzZWdtZW50cy5sZW5ndGggLSAxKV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYXRlZ29yeS5pbmNsdWRlcyhcIj9cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5ID0gY2F0ZWdvcnkuc3BsaXQoXCI/XCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihjYXRlZ29yeSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYXRlZ29yeTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBjaGVja01lcmNoYW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tZXJjaGFudF9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2F0ZWdvcnkgPSBnZXRDYXRlZ29yeUZyb21VcmwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VhcmNoaW5nIGZvciBtZXJjaGFudHMgaW4gY2F0OlwiLCBjYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93TWVyY2hhbnRzKGNhdGVnb3J5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZU1lcmNoYW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgY2F0ZWdvcnkgPSBnZXRDYXRlZ29yeUZyb21VcmwoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWFyY2hpbmcgZm9yIG1lcmNoYW50cyBpbiBjYXQ6XCIsIGNhdGVnb3J5KTtcbiAgICAgICAgICAgICAgICAgICAgc2hvd01lcmNoYW50cyhjYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgc2hvd0Jvb2tpbmcgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0Qm9va2luZ1Byb21wdChwYXJhbXMpKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IHJlc3VsdFwiLCAkcm9vdFNjb3BlLmNhcnRNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbHMuc2hvd1RvYXN0KCRyb290U2NvcGUuY2FydE1lc3NhZ2UsICQocGFyYW1zLmFsZXJ0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZSgkcm9vdFNjb3BlLmNhcnRNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3Qgbm90aGluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFscy5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBzaG93QWR2YW5jZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KE1vZGFscy5nZXRBZGRyZXNzZXNQb3B1cCgpKS50aGVuKGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBhZGRyZXNzXCIsIGFkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MgPSBhZGRyZXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5sYXQgPSBhZGRyZXNzLmxhdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcInNoaXBwaW5nQWRkcmVzc1wiLCBKU09OLnN0cmluZ2lmeShhZGRyZXNzKSwge3BhdGg6IFwiL1wifSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IG5vdGhpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrVmFyaWFudCA9IGZ1bmN0aW9uICh2YXJpYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVmFyaWFudFwiLCB2YXJpYW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhbnQuYXR0cmlidXRlcy5xdWVzdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dRdWVzdGlvbmFpcmUodmFyaWFudC5hdHRyaWJ1dGVzLnF1ZXN0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHNob3dNZXJjaGFudHMgPSBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coTW9kYWxzLmdldE1lcmNoYW50c1BvcHVwKGNhdGVnb3J5KSkudGhlbihmdW5jdGlvbiAobWVyY2hhbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IG1lcmNoYW50XCIsIG1lcmNoYW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSBNb2RhbHMuZ2V0QWxsVXJsUGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGhlVXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhlVXJsLmluY2x1ZGVzKFwiP1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVVybCA9IHRoZVVybC5zcGxpdChcIj9cIilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMubWVyY2hhbnRfaWQgPSBtZXJjaGFudC5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpcnN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgaW4gcGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVVybCA9IFwiP1wiICsgayArIFwiPVwiICsgcGFyYW1zW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlVXJsID0gXCImXCIgKyBrICsgXCI9XCIgKyBwYXJhbXNba107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGhlVXJsO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBub3RoaW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBwb3N0VG9TZXJ2ZXIgPSBmdW5jdGlvbiAocG9zdERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJQb3N0IHRvIHNlcnZlclwiLCBwb3N0RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvY2FydC9hZGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHBvc3REYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXR1cm4gY2FydFwiLGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tDYXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3QgY2hlY2tDYXJ0XCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NhcnQvY2hlY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gY2hlY2tDYXJ0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBhZGRDYXJ0SXRlbSA9IGZ1bmN0aW9uIChjb250YWluZXIsIGV4dHJhcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNrIHZhcmlhbnQ6IFwiLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGNoZWNrUHJvZHVjdChjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIubWVyY2hhbnRfaWQgPSAkcm9vdFNjb3BlLm1lcmNoYW50X2lkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRhaW5lci5pdGVtX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuaXRlbV9pZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdHZWYXJpYW50ID0gY29udGFpbmVyLnByb2R1Y3QuYWN0aXZlVmFyaWFudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoe3N0YXR1czogXCJwZW5kaW5nX2xvY2F0aW9uXCIsIG1lc3NhZ2U6IFwibXNnXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3R2VmFyaWFudC5hdHRyaWJ1dGVzICYmIGFjdHZWYXJpYW50LmF0dHJpYnV0ZXMucXVlc3Rpb25zICYmIGFjdHZWYXJpYW50LnR5cGUgPT0gXCJwcm9kdWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhNb2RhbHMuZ2V0UXVlc3Rpb25haXJlUG9wdXAoYWN0dlZhcmlhbnQuYXR0cmlidXRlcy5xdWVzdGlvbnMpKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gcmVzdWx0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogcmVzdWx0c1tpXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogcmVzdWx0c1tpXS52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3REYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF92YXJpYW50X2lkOiBjb250YWluZXIuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJjaGFudF9pZDogY29udGFpbmVyLm1lcmNoYW50X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IGNvbnRhaW5lci5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1faWQ6IGNvbnRhaW5lci5pdGVtX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFzOiB7ZGF0YTogZGF0YX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdFRvU2VydmVyKHBvc3REYXRhKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKHtzdGF0dXM6IFwicGVuZGluZ19xdWVzdGlvbnNcIiwgbWVzc2FnZTogXCJEZWJlcyBjb21wbGV0YXIgZXN0YXMgcHJlZ3VudGFzIHBhcmEgY29tcHJhciBlc3RlIHByb2R1Y3RvXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3REYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3ZhcmlhbnRfaWQ6IGNvbnRhaW5lci5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyY2hhbnRfaWQ6IGNvbnRhaW5lci5tZXJjaGFudF9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IGNvbnRhaW5lci5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9pZDogY29udGFpbmVyLml0ZW1faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhczogZXh0cmFzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0VG9TZXJ2ZXIocG9zdERhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHBvc3RUb1NlcnZlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlQ2FydEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NhcnQvdXBkYXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q2FydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NhcnQvZ2V0XCJcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHVyblwiLGRhdGEuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGdldENoZWNrb3V0Q2FydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2NhcnQvY2hlY2tvdXRcIlxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGNsZWFyQ2FydCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvY2FydC9jbGVhclwiLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2hlY2tvdXRDYXJ0OiBnZXRDaGVja291dENhcnQsXG4gICAgICAgICAgICAgICAgICAgIGdldENhcnQ6IGdldENhcnQsXG4gICAgICAgICAgICAgICAgICAgIGFkZENhcnRJdGVtOiBhZGRDYXJ0SXRlbSxcbiAgICAgICAgICAgICAgICAgICAgcG9zdFRvU2VydmVyOiBwb3N0VG9TZXJ2ZXIsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNhcnRJdGVtOiB1cGRhdGVDYXJ0SXRlbSxcbiAgICAgICAgICAgICAgICAgICAgc2hvd0Jvb2tpbmc6IHNob3dCb29raW5nLFxuICAgICAgICAgICAgICAgICAgICBjaGVja0NhcnQ6Y2hlY2tDYXJ0LFxuICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybTogc2hvd0NvbmZpcm0sXG4gICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtRXh0OiBzaG93Q29uZmlybUV4dCxcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJDYXJ0OiBjbGVhckNhcnQsXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lcmNoYW50OiBjaGFuZ2VNZXJjaGFudFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXJ0LmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 35 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Categories',['$q', '$http', function ($q, $http) {\n\n            var getCategories = function (typeCategory) {\n                var url = \"/api/categories/\"+typeCategory;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                getCategories:getCategories,\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9jYXRlZ29yaWVzLmpzP2RiZGMiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5zZXJ2aWNlKCdDYXRlZ29yaWVzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0Q2F0ZWdvcmllcyA9IGZ1bmN0aW9uICh0eXBlQ2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL2NhdGVnb3JpZXMvXCIrdHlwZUNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdldENhdGVnb3JpZXM6Z2V0Q2F0ZWdvcmllcyxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL2NhdGVnb3JpZXMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 36 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Food',['$q', '$http', function ($q, $http) {\n\n            var sendNewsletter = function () {\n                var url = '/api/food/newsletter' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to sendNewsletter\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getDeliveries = function (where) {\n                var url = '/api/food/deliveries' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getDeliveries\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getMenu = function (where) {\n                var url = '/api/food/menu' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getZones = function (where) {\n                var url = '/api/admin/zones' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getMessages = function (where) {\n                var url = '/api/food/messages' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getLargestAddresses = function () {\n                var url = '/api/food/largest_addresses' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getLargestAddresses\");\n                        });\n                return def.promise;\n            }\n            var delegateDeliveriesAddress = function (data) {\n                var url = '/api/food/delegate_deliveries' ;\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getLargestAddresses\");\n                        });\n                return def.promise;\n            }\n            \n            var updateDeliveryAddress = function (user,address) {\n                var url = '/api/food/user/'+user+\"/address/\"+address ;\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:{}\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateDeliveryAddress\");\n                        });\n                return def.promise;\n            }\n            var updateMissingDish = function (dish) {\n                var url = '/api/food/update_dish';\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:dish\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateDeliveryAddress\");\n                        });\n                return def.promise;\n            }\n            var buildScenarioRouteId = function (route_id) {\n                var url = '/api/food/build_route_id/'+route_id ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to buildScenarioRouteId\");\n                        });\n                return def.promise;\n            }\n            var buildScenarioPositive = function (scenario) {\n                var url = '/api/food/build_scenario_positive/'+scenario ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to buildScenarioPositive\");\n                        });\n                return def.promise;\n            }\n            var buildCompleteScenario = function (scenario) {\n                var url = '/api/food/build_complete_scenario/'+scenario ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to buildCompleteScenario\");\n                        });\n                return def.promise;\n            }\n            var getScenarioStructure = function (data) {\n                var url = '/api/food/get_scenario_structure';\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getScenarioStructure\");\n                        });\n                return def.promise;\n            }\n            var getSummaryShipping = function (status) {\n                var url = '/api/food/summary/'+status ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getSummaryShipping\");\n                        });\n                return def.promise;\n            }\n            var getScenarioOrganizationStructure = function (data) {\n                var url = '/api/food/route_organize' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getScenarioOrganizationStructure\");\n                        });\n                return def.promise;\n            }\n            var buildScenarioLogistics = function (data) {\n                var url = '/api/food/build_scenario_logistics' ;\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to buildScenarioLogistics\");\n                        });\n                return def.promise;\n            }\n            var getPurchaseOrder = function () {\n                var url = '/api/food/purchase_order' ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getPurchaseOrder\");\n                        });\n                return def.promise;\n            }\n            var regenerateScenarios = function () {\n                var url = '/api/food/regenerate_scenarios';\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to regenerateScenarios\");\n                        });\n                return def.promise;\n            }\n            var regenerateDeliveries = function () {\n                var url = '/api/food/regenerate_deliveries';\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to regenerateDeliveries\");\n                        });\n                return def.promise;\n            }\n            var updateMenuItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/food/menu/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateMenuItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var updateZoneItem = function (item) {\n                console.log(\"Updating zone item\",item);\n                var def = $q.defer();\n                $http({\n                        method: 'PATCH',\n                        url: '/api/admin/zones/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var createZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/admin/zones',\n                        data: item, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to createZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var updateMessageItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/food/messages/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateMessageItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var sendReminder = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/food/reminder',\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to sendReminder\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteMessageItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/food/messages/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteMessageItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/zones/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteMenuItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/food/content/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteMenuItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getArticlesByDate = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/articles?start_date='+item\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getArticlesByDate\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getMenu:getMenu,\n                getZones:getZones,\n                getPurchaseOrder:getPurchaseOrder,\n                delegateDeliveriesAddress:delegateDeliveriesAddress,\n                getMessages:getMessages,\n                getArticlesByDate:getArticlesByDate,\n                updateDeliveryAddress:updateDeliveryAddress,\n                buildScenarioLogistics:buildScenarioLogistics,\n                regenerateDeliveries:regenerateDeliveries,\n                getScenarioStructure:getScenarioStructure,\n                getSummaryShipping:getSummaryShipping,\n                buildScenarioRouteId:buildScenarioRouteId,\n                getDeliveries:getDeliveries,\n                sendReminder:sendReminder,\n                buildCompleteScenario:buildCompleteScenario,\n                regenerateScenarios:regenerateScenarios,\n                buildScenarioPositive:buildScenarioPositive,\n                updateZoneItem:updateZoneItem,\n                createZoneItem:createZoneItem,\n                updateMenuItem:updateMenuItem,\n                getScenarioOrganizationStructure:getScenarioOrganizationStructure, \n                updateMessageItem:updateMessageItem,\n                sendNewsletter:sendNewsletter,\n                deleteZoneItem:deleteZoneItem,\n                updateMissingDish:updateMissingDish,\n                deleteMenuItem:deleteMenuItem,\n                deleteMessageItem:deleteMessageItem,\n                getLargestAddresses:getLargestAddresses\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9mb29kLmpzPzNjODQiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIFxuICAgICAgICAuc2VydmljZSgnRm9vZCcsWyckcScsICckaHR0cCcsIGZ1bmN0aW9uICgkcSwgJGh0dHApIHtcblxuICAgICAgICAgICAgdmFyIHNlbmROZXdzbGV0dGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL25ld3NsZXR0ZXInIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2VuZE5ld3NsZXR0ZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldERlbGl2ZXJpZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9kZWxpdmVyaWVzJyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IGdldERlbGl2ZXJpZXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldE1lbnUgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9tZW51JyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IGdldEFydGljbGVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRab25lcyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi96b25lcycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBnZXRBcnRpY2xlc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TWVzc2FnZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9tZXNzYWdlcycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBnZXRBcnRpY2xlc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TGFyZ2VzdEFkZHJlc3NlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9sYXJnZXN0X2FkZHJlc3NlcycgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgZ2V0TGFyZ2VzdEFkZHJlc3Nlc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZURlbGl2ZXJpZXNBZGRyZXNzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9kZWxlZ2F0ZV9kZWxpdmVyaWVzJyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6ZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBnZXRMYXJnZXN0QWRkcmVzc2VzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdXBkYXRlRGVsaXZlcnlBZGRyZXNzID0gZnVuY3Rpb24gKHVzZXIsYWRkcmVzcykge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL3VzZXIvJyt1c2VyK1wiL2FkZHJlc3MvXCIrYWRkcmVzcyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6e31cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byB1cGRhdGVEZWxpdmVyeUFkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlTWlzc2luZ0Rpc2ggPSBmdW5jdGlvbiAoZGlzaCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL3VwZGF0ZV9kaXNoJztcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTpkaXNoXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlRGVsaXZlcnlBZGRyZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJ1aWxkU2NlbmFyaW9Sb3V0ZUlkID0gZnVuY3Rpb24gKHJvdXRlX2lkKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvYnVpbGRfcm91dGVfaWQvJytyb3V0ZV9pZCA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGJ1aWxkU2NlbmFyaW9Sb3V0ZUlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJ1aWxkU2NlbmFyaW9Qb3NpdGl2ZSA9IGZ1bmN0aW9uIChzY2VuYXJpbykge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL2J1aWxkX3NjZW5hcmlvX3Bvc2l0aXZlLycrc2NlbmFyaW8gO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBidWlsZFNjZW5hcmlvUG9zaXRpdmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYnVpbGRDb21wbGV0ZVNjZW5hcmlvID0gZnVuY3Rpb24gKHNjZW5hcmlvKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvYnVpbGRfY29tcGxldGVfc2NlbmFyaW8vJytzY2VuYXJpbyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGJ1aWxkQ29tcGxldGVTY2VuYXJpb1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTY2VuYXJpb1N0cnVjdHVyZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvZ2V0X3NjZW5hcmlvX3N0cnVjdHVyZSc7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRTY2VuYXJpb1N0cnVjdHVyZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTdW1tYXJ5U2hpcHBpbmcgPSBmdW5jdGlvbiAoc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2Qvc3VtbWFyeS8nK3N0YXR1cyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFN1bW1hcnlTaGlwcGluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTY2VuYXJpb09yZ2FuaXphdGlvblN0cnVjdHVyZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2Qvcm91dGVfb3JnYW5pemUnIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6ZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFNjZW5hcmlvT3JnYW5pemF0aW9uU3RydWN0dXJlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJ1aWxkU2NlbmFyaW9Mb2dpc3RpY3MgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL2J1aWxkX3NjZW5hcmlvX2xvZ2lzdGljcycgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBidWlsZFNjZW5hcmlvTG9naXN0aWNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFB1cmNoYXNlT3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2Zvb2QvcHVyY2hhc2Vfb3JkZXInIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0UHVyY2hhc2VPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWdlbmVyYXRlU2NlbmFyaW9zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9mb29kL3JlZ2VuZXJhdGVfc2NlbmFyaW9zJztcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gcmVnZW5lcmF0ZVNjZW5hcmlvc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWdlbmVyYXRlRGVsaXZlcmllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvZm9vZC9yZWdlbmVyYXRlX2RlbGl2ZXJpZXMnO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byByZWdlbmVyYXRlRGVsaXZlcmllc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGRhdGVNZW51SXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2Zvb2QvbWVudS8nK2l0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlTWVudUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHVwZGF0ZVpvbmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIHpvbmUgaXRlbVwiLGl0ZW0pO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vem9uZXMvJytpdGVtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZVpvbmVJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjcmVhdGVab25lSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3pvbmVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGl0ZW0sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjcmVhdGVab25lSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlTWVzc2FnZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9mb29kL21lc3NhZ2VzLycraXRlbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGl0ZW0sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byB1cGRhdGVNZXNzYWdlSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2VuZFJlbWluZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9mb29kL3JlbWluZGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2VuZFJlbWluZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVNZXNzYWdlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvZm9vZC9tZXNzYWdlcy8nK2l0ZW0uaWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZU1lc3NhZ2VJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVab25lSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vem9uZXMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVab25lSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlTWVudUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2Zvb2QvY29udGVudC8nK2l0ZW0uaWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZU1lbnVJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRBcnRpY2xlc0J5RGF0ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYXJ0aWNsZXM/c3RhcnRfZGF0ZT0nK2l0ZW1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldEFydGljbGVzQnlEYXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnZXRNZW51OmdldE1lbnUsXG4gICAgICAgICAgICAgICAgZ2V0Wm9uZXM6Z2V0Wm9uZXMsXG4gICAgICAgICAgICAgICAgZ2V0UHVyY2hhc2VPcmRlcjpnZXRQdXJjaGFzZU9yZGVyLFxuICAgICAgICAgICAgICAgIGRlbGVnYXRlRGVsaXZlcmllc0FkZHJlc3M6ZGVsZWdhdGVEZWxpdmVyaWVzQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBnZXRNZXNzYWdlczpnZXRNZXNzYWdlcyxcbiAgICAgICAgICAgICAgICBnZXRBcnRpY2xlc0J5RGF0ZTpnZXRBcnRpY2xlc0J5RGF0ZSxcbiAgICAgICAgICAgICAgICB1cGRhdGVEZWxpdmVyeUFkZHJlc3M6dXBkYXRlRGVsaXZlcnlBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGJ1aWxkU2NlbmFyaW9Mb2dpc3RpY3M6YnVpbGRTY2VuYXJpb0xvZ2lzdGljcyxcbiAgICAgICAgICAgICAgICByZWdlbmVyYXRlRGVsaXZlcmllczpyZWdlbmVyYXRlRGVsaXZlcmllcyxcbiAgICAgICAgICAgICAgICBnZXRTY2VuYXJpb1N0cnVjdHVyZTpnZXRTY2VuYXJpb1N0cnVjdHVyZSxcbiAgICAgICAgICAgICAgICBnZXRTdW1tYXJ5U2hpcHBpbmc6Z2V0U3VtbWFyeVNoaXBwaW5nLFxuICAgICAgICAgICAgICAgIGJ1aWxkU2NlbmFyaW9Sb3V0ZUlkOmJ1aWxkU2NlbmFyaW9Sb3V0ZUlkLFxuICAgICAgICAgICAgICAgIGdldERlbGl2ZXJpZXM6Z2V0RGVsaXZlcmllcyxcbiAgICAgICAgICAgICAgICBzZW5kUmVtaW5kZXI6c2VuZFJlbWluZGVyLFxuICAgICAgICAgICAgICAgIGJ1aWxkQ29tcGxldGVTY2VuYXJpbzpidWlsZENvbXBsZXRlU2NlbmFyaW8sXG4gICAgICAgICAgICAgICAgcmVnZW5lcmF0ZVNjZW5hcmlvczpyZWdlbmVyYXRlU2NlbmFyaW9zLFxuICAgICAgICAgICAgICAgIGJ1aWxkU2NlbmFyaW9Qb3NpdGl2ZTpidWlsZFNjZW5hcmlvUG9zaXRpdmUsXG4gICAgICAgICAgICAgICAgdXBkYXRlWm9uZUl0ZW06dXBkYXRlWm9uZUl0ZW0sXG4gICAgICAgICAgICAgICAgY3JlYXRlWm9uZUl0ZW06Y3JlYXRlWm9uZUl0ZW0sXG4gICAgICAgICAgICAgICAgdXBkYXRlTWVudUl0ZW06dXBkYXRlTWVudUl0ZW0sXG4gICAgICAgICAgICAgICAgZ2V0U2NlbmFyaW9Pcmdhbml6YXRpb25TdHJ1Y3R1cmU6Z2V0U2NlbmFyaW9Pcmdhbml6YXRpb25TdHJ1Y3R1cmUsIFxuICAgICAgICAgICAgICAgIHVwZGF0ZU1lc3NhZ2VJdGVtOnVwZGF0ZU1lc3NhZ2VJdGVtLFxuICAgICAgICAgICAgICAgIHNlbmROZXdzbGV0dGVyOnNlbmROZXdzbGV0dGVyLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVpvbmVJdGVtOmRlbGV0ZVpvbmVJdGVtLFxuICAgICAgICAgICAgICAgIHVwZGF0ZU1pc3NpbmdEaXNoOnVwZGF0ZU1pc3NpbmdEaXNoLFxuICAgICAgICAgICAgICAgIGRlbGV0ZU1lbnVJdGVtOmRlbGV0ZU1lbnVJdGVtLFxuICAgICAgICAgICAgICAgIGRlbGV0ZU1lc3NhZ2VJdGVtOmRlbGV0ZU1lc3NhZ2VJdGVtLFxuICAgICAgICAgICAgICAgIGdldExhcmdlc3RBZGRyZXNzZXM6Z2V0TGFyZ2VzdEFkZHJlc3Nlc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvZm9vZC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 37 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Groups',['$q', '$http', function ($q, $http) {\n\n            var getGroups = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/groups' \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveGroup = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/groups',\n                        data: data, // pass in data as strings\n                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            return {\n                saveGroup: saveGroup,\n                getGroups:getGroups\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9ncm91cHMuanM/OGVhMiJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgXG4gICAgICAgIC5zZXJ2aWNlKCdHcm91cHMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRHcm91cHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2dyb3VwcycgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNhdmVHcm91cCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2dyb3VwcycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ30gIC8vIHNldCB0aGUgaGVhZGVycyBzbyBhbmd1bGFyIHBhc3NpbmcgaW5mbyBhcyBmb3JtIGRhdGEgKG5vdCByZXF1ZXN0IHBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNhdmVHcm91cDogc2F2ZUdyb3VwLFxuICAgICAgICAgICAgICAgIGdldEdyb3VwczpnZXRHcm91cHNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL2dyb3Vwcy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 38 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Leads',['$q', '$http', function ($q, $http) {\n\n            var sendLead = function (data) {\n                var url = \"/api/leads\";\n                var def = $q.defer();\n                $http({\n                    method: 'post',\n                    url: url,\n                    data:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to sendLead\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                sendLead:sendLead,\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9sZWFkcy5qcz84ZGQyIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuc2VydmljZSgnTGVhZHMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBzZW5kTGVhZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9sZWFkc1wiO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzZW5kTGVhZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNlbmRMZWFkOnNlbmRMZWFkLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvbGVhZHMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 39 */
/***/ function(module, exports) {

eval("angular.module('besafe')\r\n        .service('LocationService', ['$q', '$http', '$rootScope', function ($q, $http, $rootScope) {\r\n\r\n                var shared = function (where) {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/locations\" + where,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCityFromLat = function (lat, longit) {\r\n\r\n                    var def = $q.defer();\r\n\r\n                    $http({\r\n                        method: \"get\",\r\n                        headers: {\r\n                            'Content-Type': \"application/json\",\r\n                            'X-Auth-Token': undefined,\r\n                            'Authorization': undefined\r\n                        },\r\n                        url: \"http://maps.googleapis.com/maps/api/geocode/json?latlng=\" + lat + \",\" + longit + \"&sensor=true\",\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var merchants = function (data) {\r\n\r\n                    var def = $q.defer();\r\n                    console.log(\"Getting merchants\")\r\n                    console.log(JSON.stringify(data));\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/merchants/nearby\",\r\n                        params: data\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                console.log(JSON.stringify(data));\r\n                                def.reject(\"Failed to get nearby merchants\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getLocationsTrip = function (data) {\r\n                    console.log(\"Get locations trip: /historic_locations?target_id=\" + data.user_id + \"&trip_id=\" + data.trip);\r\n                    var def = $q.defer();\r\n                    var url = \"/historic_locations?target_id=\" + data.user_id + \"&trip_id=\" + data.trip;\r\n                    if (data.page) {\r\n                        url = url + \"&page=\" + data.page;\r\n                    }\r\n                    if (data.perpage) {\r\n                        url = url + \"&per_page=\" + data.perpage;\r\n                    }\r\n                    $http.get(url)\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getUserHash = function (  ) {\r\n\r\n                    var def = $q.defer();\r\n\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/locations/hash\",\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                console.log(JSON.stringify(data));\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCitiesRegion = function (regionId) {\r\n\r\n                    var def = $q.defer();\r\n\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/cities?limit=50&region_id=\" + regionId,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCities = function (where) {\r\n                    var url = '/api/cities';\r\n                    if (where) {\r\n                        url = url + \"?\" + where;\r\n                    }\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: url,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n                    return def.promise;\r\n                };\r\n                var getRegionFromCity = function (city) {\r\n                    var def = $q.defer();\r\n                    $http.post(\"/api/cities/from\", city\r\n                            )\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(response);\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getRegionsCountry = function (countryID) {\r\n\r\n                    var def = $q.defer();\r\n\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/regions?limit=40&country_id=\" + countryID,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCountry = function (id) {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/countries?id=\" + id,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCity = function (id) {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/cities?id=\" + id,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getRegion = function (id) {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/regions?id=\" + id,\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n                var getCountries = function () {\r\n                    var def = $q.defer();\r\n                    $http({\r\n                        method: \"get\",\r\n                        url: \"/api/countries?limit=50&order_by=name,asc\",\r\n                    })\r\n                            .then(function (data) {\r\n                                def.resolve(data.data);\r\n                            },function(response) {\r\n                                def.reject(\"Failed to get nearby\");\r\n                            });\r\n\r\n                    return def.promise;\r\n                };\r\n\r\n                return {\r\n                    shared: shared,\r\n                    merchants: merchants,\r\n                    getCountries: getCountries,\r\n                    getCities:getCities,\r\n                    getUserHash: getUserHash,\r\n                    getCityFromLat: getCityFromLat,\r\n                    getCity:getCity,\r\n                    getRegion:getRegion,\r\n                    getRegionFromCity: getRegionFromCity,\r\n                    getLocationsTrip: getLocationsTrip,\r\n                    getCitiesRegion: getCitiesRegion,\r\n                    getRegionsCountry: getRegionsCountry,\r\n                    getCountry: getCountry,\r\n                    getRegionName: function (region_id) {\r\n                        for (region in $rootScope.regions) {\r\n                            var container = $rootScope.regions[region];\r\n                            if (container.id == parseInt(region_id)) {\r\n                                return container.name;\r\n                            }\r\n                        }\r\n                        return null;\r\n                    },\r\n                    isRegionsLoaded: function () {\r\n                        if ($rootScope.regions) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    },\r\n                    isCountriesLoaded: function () {\r\n                        if ($rootScope.countries) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    },\r\n                    getRegions: function () {\r\n                        return $rootScope.regions;\r\n                    }\r\n                };\r\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9sb2NhdGlvbi5qcz9mOGMwIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxyXG4gICAgICAgIC5zZXJ2aWNlKCdMb2NhdGlvblNlcnZpY2UnLCBbJyRxJywgJyRodHRwJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHEsICRodHRwLCAkcm9vdFNjb3BlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZCA9IGZ1bmN0aW9uICh3aGVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9sb2NhdGlvbnNcIiArIHdoZXJlLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q2l0eUZyb21MYXQgPSBmdW5jdGlvbiAobGF0LCBsb25naXQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnWC1BdXRoLVRva2VuJzogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9sYXRsbmc9XCIgKyBsYXQgKyBcIixcIiArIGxvbmdpdCArIFwiJnNlbnNvcj10cnVlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBtZXJjaGFudHMgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldHRpbmcgbWVyY2hhbnRzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9tZXJjaGFudHMvbmVhcmJ5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieSBtZXJjaGFudHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBnZXRMb2NhdGlvbnNUcmlwID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBsb2NhdGlvbnMgdHJpcDogL2hpc3RvcmljX2xvY2F0aW9ucz90YXJnZXRfaWQ9XCIgKyBkYXRhLnVzZXJfaWQgKyBcIiZ0cmlwX2lkPVwiICsgZGF0YS50cmlwKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCIvaGlzdG9yaWNfbG9jYXRpb25zP3RhcmdldF9pZD1cIiArIGRhdGEudXNlcl9pZCArIFwiJnRyaXBfaWQ9XCIgKyBkYXRhLnRyaXA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIiZwYWdlPVwiICsgZGF0YS5wYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wZXJwYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCArIFwiJnBlcl9wYWdlPVwiICsgZGF0YS5wZXJwYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGdldFVzZXJIYXNoID0gZnVuY3Rpb24gKCAgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvbG9jYXRpb25zL2hhc2hcIixcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBnZXRDaXRpZXNSZWdpb24gPSBmdW5jdGlvbiAocmVnaW9uSWQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9jaXRpZXM/bGltaXQ9NTAmcmVnaW9uX2lkPVwiICsgcmVnaW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBnZXRDaXRpZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvY2l0aWVzJztcclxuICAgICAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/XCIgKyB3aGVyZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiZ2V0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBnZXRSZWdpb25Gcm9tQ2l0eSA9IGZ1bmN0aW9uIChjaXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAucG9zdChcIi9hcGkvY2l0aWVzL2Zyb21cIiwgY2l0eVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVnaW9uc0NvdW50cnkgPSBmdW5jdGlvbiAoY291bnRyeUlEKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvcmVnaW9ucz9saW1pdD00MCZjb3VudHJ5X2lkPVwiICsgY291bnRyeUlELFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q291bnRyeSA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9jb3VudHJpZXM/aWQ9XCIgKyBpZCxcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGdldENpdHkgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvY2l0aWVzP2lkPVwiICsgaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBnZXRSZWdpb24gPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJnZXRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvcmVnaW9ucz9pZD1cIiArIGlkLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0Q291bnRyaWVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9jb3VudHJpZXM/bGltaXQ9NTAmb3JkZXJfYnk9bmFtZSxhc2NcIixcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBzaGFyZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVyY2hhbnRzOiBtZXJjaGFudHMsXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q291bnRyaWVzOiBnZXRDb3VudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0aWVzOmdldENpdGllcyxcclxuICAgICAgICAgICAgICAgICAgICBnZXRVc2VySGFzaDogZ2V0VXNlckhhc2gsXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eUZyb21MYXQ6IGdldENpdHlGcm9tTGF0LFxyXG4gICAgICAgICAgICAgICAgICAgIGdldENpdHk6Z2V0Q2l0eSxcclxuICAgICAgICAgICAgICAgICAgICBnZXRSZWdpb246Z2V0UmVnaW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldFJlZ2lvbkZyb21DaXR5OiBnZXRSZWdpb25Gcm9tQ2l0eSxcclxuICAgICAgICAgICAgICAgICAgICBnZXRMb2NhdGlvbnNUcmlwOiBnZXRMb2NhdGlvbnNUcmlwLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldENpdGllc1JlZ2lvbjogZ2V0Q2l0aWVzUmVnaW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldFJlZ2lvbnNDb3VudHJ5OiBnZXRSZWdpb25zQ291bnRyeSxcclxuICAgICAgICAgICAgICAgICAgICBnZXRDb3VudHJ5OiBnZXRDb3VudHJ5LFxyXG4gICAgICAgICAgICAgICAgICAgIGdldFJlZ2lvbk5hbWU6IGZ1bmN0aW9uIChyZWdpb25faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChyZWdpb24gaW4gJHJvb3RTY29wZS5yZWdpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gJHJvb3RTY29wZS5yZWdpb25zW3JlZ2lvbl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmlkID09IHBhcnNlSW50KHJlZ2lvbl9pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGFpbmVyLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBpc1JlZ2lvbnNMb2FkZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUucmVnaW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGlzQ291bnRyaWVzTG9hZGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmNvdW50cmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdldFJlZ2lvbnM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUucmVnaW9ucztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9sb2NhdGlvbi5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 40 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .factory('MapService', ['$q', '$rootScope', 'LocationService', function ($q, $rootScope, LocationService) {\n                var myLatlng;\n                var mapOptions;\n                $rootScope.map;\n                $rootScope.iconpath = \"http://hoovert.com/images/icons\";\n                $rootScope.markers = [];\n                $rootScope.polylines = [];\n                var infoWindow;\n\n                var createMap = function (latitude, longitude) {\n\n                    var myLatlng = new google.maps.LatLng(latitude, longitude);\n                    mapOptions = {\n                        center: myLatlng,\n                        zoom: 12,\n                        mapTypeId: google.maps.MapTypeId.ROADMAP,\n                        gestureHandling: \"cooperative\"\n                    };\n                    if (document.getElementById(\"map\")) {\n                        $rootScope.map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n                        infoWindow = new google.maps.InfoWindow();\n                        $rootScope.geocoder = new google.maps.Geocoder();\n                        $rootScope.mapActive = true;\n                        $rootScope.mapLoaded = true;\n                        $rootScope.tracking = true;\n                        $rootScope.mapSemaphore = true;\n                    }\n                }\n                var createMarker = function (info) {\n                    damap = $rootScope.map;\n                    console.log(\"info received in marker\");\n                    console.log(JSON.stringify(info));\n                    var pinclass = \"\";\n                    if (info.activity == \"still\") {\n                        pinclass = \"masculine-avatar.svg\";\n                        console.log(\"entro still\");\n                    } else if (info.activity == \"on_foot\") {\n                        console.log(\"entro on foot\");\n                        pinclass = \"pedestrian-walking.svg\";\n                    } else if (info.activity == \"in_vehicle\") {\n                        pinclass = \"car-front.svg\";\n                    } else if (info.activity == \"on_bicycle\") {\n                        pinclass = \"cycling.svg\";\n                    } else if (info.activity == \"running\") {\n                        pinclass = \"running.svg\";\n                    } else if (info.activity == \"\") {\n                        console.log(\"entro blank\");\n                        pinclass = \"map-pin.svg\";\n                    }\n                    var marker = new google.maps.Marker({\n                        id: info.id,\n                        user_id: info.user_id,\n                        position: new google.maps.LatLng(info.lat, info.long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        report_time: info.report_time,\n                        speed: info.speed,\n                        activity: info.activity,\n                        battery: info.battery,\n                        name: info.name,\n                        status: info.status,\n                        islast: info.islast,\n                        icon: {\n                            fillColor: '#ffffff',\n                            url: $rootScope.iconpath + \"/\" + pinclass,\n                            fillOpacity: 1,\n                            strokeColor: '#ffffff',\n                            strokeWeight: 0,\n                            scaledSize: new google.maps.Size(35, 35)\n                        }\n                    });\n                    marker.content = '<div class=\"infoWindowContent\">' + info.id + ' ' + info.name + '</div>';\n                    google.maps.event.addListener(marker, 'click', function () {\n                        infoWindow.setContent('<h2>' + marker.report_time + '</h2>' + marker.content);\n                        infoWindow.open($rootScope.map, marker);\n                    });\n                    return marker;\n                }\n                var createLocationMarker = function (lat, long, trigger) {\n                    damap = $rootScope.map;\n                    console.log(\"info received in marker\");\n                    var marker = new google.maps.Marker({\n                        position: new google.maps.LatLng(lat, long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        draggable: true,\n                    });\n                    google.maps.event.addListener(marker, 'dragend', function () {\n                        $rootScope.loader = true;\n                        var location = marker.getPosition();\n                        setCenterMap(location.lat(), location.lng());\n                        getAddressAndPostal(location.lat(), location.lng(), 1);\n                    });\n                    if (trigger) {\n                        google.maps.event.trigger(marker, 'dragend');\n                    }\n                    $rootScope.locationMarker = marker;\n                    return marker;\n                }\n                var createReport = function (info) {\n                    damap = $rootScope.map;\n\n                    var marker = new google.maps.Marker({\n                        id: info.id,\n                        position: new google.maps.LatLng(info.lat, info.long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        created_at: info.created_at,\n                        name: info.name\n                    });\n                    marker.content = '<div class=\"infoWindowContent\">' + info.id + ' ' + info.name + '</div>';\n                    google.maps.event.addListener(marker, 'click', function () {\n                        infoWindow.setContent('<h2>' + marker.created_at + '</h2>' + marker.content);\n                        infoWindow.open($rootScope.map, marker);\n                    });\n                    return marker;\n                }\n                var createStop = function (stop) {\n                    damap = $rootScope.map;\n                    console.log(\"creating stop\", stop)\n                    var marker = new google.maps.Marker({\n                        id: stop.id,\n                        icon: stop.icon,\n                        position: new google.maps.LatLng(stop.lat, stop.long),\n                        map: damap,\n                        animation: google.maps.Animation.DROP,\n                        name: stop.name\n                    });\n                    marker.content = '<div class=\"infoWindowContent\">' + stop.id + ' ' + stop.name + '</div>';\n                    google.maps.event.addListener(marker, 'click', function () {\n                        infoWindow.setContent('<h2>' + marker.created_at + '</h2>' + marker.content);\n                        infoWindow.open($rootScope.map, marker);\n                    });\n                    return marker;\n                }\n                var createRoute = function (route, color) {\n                    damap = $rootScope.map;\n                    console.log(\"createRoute\", route)\n                    var flightPlanCoordinates = route.stopsLat;\n                    var flightPath = new google.maps.Polyline({\n                        path: flightPlanCoordinates,\n                        geodesic: true,\n                        strokeColor: color,\n                        strokeOpacity: 1.0,\n                        strokeWeight: 2\n                    });\n                    flightPath.setMap(damap);\n                    return flightPath;\n                }\n                var getColor = function () {\n                    var routeColors = [\"#FF0000\", \"#800000\", \"#FFFF00\", \"#808000\", \"#00FF00\", \"#008000\", \"#00FFFF\", \"#008080\", \"#0000FF\", \"#000080\", \"#FF00FF\", \"#800080\"];\n                    var random = Math.round(Math.random() * (routeColors.length - 1));\n                    return routeColors[random];\n                }\n                var createPolygon = function (zone, color) {\n                    damap = $rootScope.map;\n                    console.log(\"createRoute\", zone)\n                    var triangleCoords = JSON.parse(zone.coverage);\n\n                    // Construct the polygon.\n                    var bermudaTriangle = new google.maps.Polygon({\n                        id: zone.id,\n                        paths: triangleCoords,\n                        strokeColor: color,\n                        strokeOpacity: 0.8,\n                        editable: true,\n                        strokeWeight: 2,\n                        fillColor: '#FF0000',\n                        fillOpacity: 0.35,\n                        draggable: true,\n                        geodesic: true\n                    });\n                    bermudaTriangle.setMap(damap);\n                    bermudaTriangle.getPaths().forEach(function (path, index) {\n                        google.maps.event.addListener(path, 'insert_at', function () {\n                            console.log('zzinsert_at', zone.id);\n                            $rootScope.$broadcast(\"zone-updated\", zone);\n                            zone.isActive = true;\n                        });\n                        google.maps.event.addListener(path, 'remove_at', function () {\n                            console.log('zzinsert_at', zone.id);\n                            $rootScope.$broadcast(\"zone-updated\", zone);\n                            zone.isActive = true;\n                        });\n                        google.maps.event.addListener(path, 'set_at', function () {\n                            console.log('zzinsert_at', zone.id);\n                            $rootScope.$broadcast(\"zone-updated\", zone);\n                        });\n                    });\n\n                    google.maps.event.addListener(bermudaTriangle, 'dragend', function () {\n                        console.log('set_at.', bermudaTriangle.id);\n                    });\n                    return bermudaTriangle;\n                }\n\n                var consoleLogMarkers = function (damarkers) {\n                    for (marker in damarkers) {\n                        if (damarkers[marker]) {\n                            console.log(\"id: \" + damarkers[marker].id);\n                            console.log(\"speed: \" + damarkers[marker].speed);\n                            console.log(\"activity: \" + damarkers[marker].activity);\n                            console.log(\"battery: \" + damarkers[marker].battery);\n                            console.log(\"lat: \" + damarkers[marker].lat);\n                            console.log(\"long: \" + damarkers[marker].long);\n                            console.log(\"name: \" + damarkers[marker].name);\n                            console.log(\"type: \" + damarkers[marker].type);\n                            console.log(\"user_id: \" + damarkers[marker].user_id);\n                            console.log(\"report_time: \" + damarkers[marker].report_time);\n                        } else {\n                            console.log(\"Marker is null: \" + marker);\n                            console.log(damarkers[marker]);\n                        }\n\n                    }\n                }\n                var updateLocations = function (hash, page) {\n                    console.log(\"Updating locations\");\n                    if ($rootScope.mapActive) {\n                        console.log(\"Map Active\");\n                        if ($rootScope.mapSemaphore) {\n                            console.log(\"rootscope mapsemaphore true\");\n                            $rootScope.mapSemaphore = false;\n                            var where = \"?page=\" + page + \"&hash_id=\" + hash;\n                            getServerLocations(where, hash);\n                        }\n                    }\n                }\n                var deleteUserMarkers = function (dauser_id) {\n                    for (marker in $rootScope.markers) {\n                        if ($rootScope.markers[marker]) {\n                            if ($rootScope.markers[marker].user_id == dauser_id) {\n                                $rootScope.markers[marker].setMap(null);\n                                $rootScope.markers.splice(marker, 1);\n                            }\n                        } else {\n                            $rootScope.markers.splice(marker, 1);\n                        }\n                    }\n                }\n                var findUserInPolyline = function (dauser_id) {\n                    for (polyline in $rootScope.polylines) {\n                        if ($rootScope.polylines[polyline].user_id == dauser_id) {\n                            return $rootScope.polylines[polyline];\n                        }\n                    }\n                    return null;\n                };\n                var addToUserPolyline = function (info) {\n                    console.log(\"add user to polyline\");\n                    if (!$rootScope.mapLoaded) {\n                        $rootScope.mapLoaded = true;\n                        createMap(info.lat, info.long);\n                    }\n                    var coords = new google.maps.LatLng(info.lat, info.long);\n                    var poly = findUserInPolyline(info.user_id);\n                    if (poly) {\n                        deleteUserMarkers(info.user_id);\n                        console.log(\"pos added to existing poly\");\n                        var path = poly.getPath();\n                        path.push(coords);\n                        if (info.status == \"emergency\") {\n                            poly.status = \"emergency\";\n                        }\n                    } else {\n                        poly = new google.maps.Polyline({\n                            strokeColor: '#000000',\n                            strokeOpacity: 1.0,\n                            strokeWeight: 3,\n                            user_id: info.user_id,\n                            name: info.name,\n                            status: info.status,\n                            visible: true,\n                            isActive: false,\n                        });\n                        var path = poly.getPath();\n                        path.push(coords);\n                        poly.setMap($rootScope.map);\n                        console.log(\"new poly created and pos added: \" + poly.user_id);\n                        $rootScope.polylines.push(poly);\n                    }\n                    info.owner_type = \"user\";\n                    setCenterMap(info.lat, info.long);\n                    // Add a new marker at the new plotted point on the polyline.\n                    var marker = createMarker(info);\n                    $rootScope.activeMarker = marker;\n                    $rootScope.markers.push(marker);\n                };\n                var setCenterMap = function (lat, long) {\n                    console.log(\"Setting map center\");\n                    myLatlng = new google.maps.LatLng(lat, long);\n                    if ($rootScope.map) {\n                        $rootScope.map.setZoom(15);\n                        $rootScope.map.setCenter(myLatlng);\n                    }\n                }\n                var checkMarkers = function (info) {\n                    var i = 0;\n                    for (target in info) {\n                        if (info[target].id) {\n                            checkLocationExists(info[target]);\n                        }\n                    }\n                }\n                var checkLocationExists = function (location) {\n                    console.log(\"Checking database for location: \" + location.id);\n                    if ($rootScope.activeMarker) {\n                        if (location.id > $rootScope.activeMarker.id) {\n                            location.status = true;\n                            console.log(\"Location exists: \");\n                            addToUserPolyline(location);\n                        }\n                    } else {\n                        addToUserPolyline(location);\n                    }\n\n                };\n                var postMapLocation = function () {\n                    $rootScope.map.addListener('dblclick', function (e) {\n                        console.log(\"Map double click\");\n                        var location = e.latLng;\n                        $rootScope.locationMarker.setPosition(location);\n                        google.maps.event.trigger($rootScope.locationMarker, 'dragend');\n                        setCenterMap(location.lat(), location.lng());\n                        getAddressAndPostal(location.lat(), location.lng(), 1);\n                    });\n                    /*$rootScope.map.addListener('click', function (e) {\n                        var location = e.latLng;\n                        $rootScope.locationMarker.setPosition(location);\n                        google.maps.event.trigger($rootScope.locationMarker, 'dragend');\n                        setCenterMap(location.lat(), location.lng());\n                        getAddressAndPostal(location.lat(), location.lng(), 1);\n                    });*/\n                };\n\n                var decodeAddressFromLatResult = function (results) {\n\n                    var container = \"\";\n                    try {\n                        container = results[0].formatted_address;\n                    } catch (err) {\n\n                    }\n                    return container;\n                }\n                /**\n                 * prepares report data for creating a marker\n                 */\n                var decodePostalFromLatResult = function (results) {\n                    if (results.length > 0) {\n                        var container;\n                        var address = results[0]\n                        var found = false\n                        var i = 0;\n                        var components = address.address_components\n                        var postal = \"\";\n                        do {\n                            container = components[i]\n                            for (var item in container.types) {\n                                if (container.types[item] == \"postal_code\") {\n                                    postal = container.long_name;\n                                    found = true;\n                                }\n                            }\n                            i++;\n                            if (i >= results.length) {\n                                found = true;\n                            }\n                        } while (found == false);\n                        console.log(\"decodePostalFromLatResult\", postal);\n                        return postal;\n                    }\n\n                }\n                var decodeCityFromLatResult = function (results) {\n                    if (results.length > 0) {\n                        var container;\n                        var address = results[0]\n                        var found = false\n                        var i = 0;\n                        var components = address.address_components\n                        var city = \"\";\n                        do {\n                            container = components[i]\n                            for (var item in container.types) {\n                                if (container.types[item] == \"administrative_area_level_1\") {\n                                    city = container.long_name;\n                                    found = true;\n                                }\n                            }\n                            i++;\n                            if (i >= results.length) {\n                                found = true;\n                            }\n                        } while (found == false);\n                        console.log(\"decodeCityFromLatResult\", city);\n                        return city;\n                    }\n\n                }\n                var getAddressAndPostal = function (lat, long, attempts) {\n                    var this$1 = this;\n\n\n                    getAddressFromLat(lat, long).then(function (resp) {\n                        console.log(\"Address from lat\", resp);\n                        if (resp) {\n                            var city = decodeCityFromLatResult(resp);\n                            var where = \"name=\" + city;\n                            console.log(\"Address where\", where);\n                            LocationService.getCities(where).then(function (data) {\n                                console.log(\"Address data\", data);\n                                if (data.total > 0) {\n                                    var results = data.data;\n                                    var city = results[0];\n                                    $rootScope.isActive = false;\n                                    var container = {\n                                        address: decodeAddressFromLatResult(resp),\n                                        postal: decodePostalFromLatResult(resp),\n                                        lat: lat,\n                                        long: long,\n                                        city_id: city.id,\n                                        region_id: city.region_id,\n                                        country_id:1,\n                                        countryCode:\"CO\"\n                                    }\n                                    if($rootScope.shippingAddress){\n                                        $rootScope.shippingAddress.address = decodeAddressFromLatResult(resp);\n                                        $rootScope.shippingAddress.postal = decodePostalFromLatResult(resp);\n                                        $rootScope.shippingAddress.lat = lat;\n                                        $rootScope.shippingAddress.long = long;\n                                        $rootScope.shippingAddress.city_id = city.id;\n                                        $rootScope.shippingAddress.region_id = city.region_id;\n                                        $rootScope.shippingAddress.country_id = 1;\n                                    } else {\n                                        $rootScope.shippingAddress = container;\n                                    }\n                                    $rootScope.loader = false;\n                                } else {\n                                    $rootScope.loader = false;\n                                    var container$1 = {\n                                        address: decodeAddressFromLatResult(resp),\n                                        postal: decodePostalFromLatResult(resp),\n                                        lat: lat,\n                                        long: long,\n                                        country_id:1\n                                    }\n                                    if($rootScope.shippingAddress){\n                                        $rootScope.shippingAddress.address = decodeAddressFromLatResult(resp);\n                                        $rootScope.shippingAddress.postal = decodePostalFromLatResult(resp);\n                                        $rootScope.shippingAddress.lat = lat;\n                                        $rootScope.shippingAddress.long = long;\n                                        $rootScope.shippingAddress.country_id = 1;\n                                    } else {\n                                        $rootScope.shippingAddress = container$1;\n                                    }\n                                }\n                            },\n                                    function (data) {\n                                        console.log(data);\n                                        var container = {\n                                            address: decodeAddressFromLatResult(resp),\n                                            postal: decodePostalFromLatResult(resp),\n                                            lat: lat,\n                                            long: long,\n                                            country_id:1\n                                        }\n                                        $rootScope.shippingAddress = container;\n                                    });\n                        } else {\n                            $rootScope.loader = false;\n                            console.log(\"Attempts\", attempts);\n                            if (attempts < 8) {\n                                attempts++;\n                                var vm = this$1;\n                                setTimeout(function () {\n                                    vm.getAddressAndPostal(lat, long, attempts)\n                                }, 1000);\n                            }\n                        }\n\n                    }).catch(function (error) {\n                        console.log('Error getting location', error);\n                    });\n                }\n                var getAddressFromLat = function (lat, long) {\n                    var deferred = $q.defer();\n                    var latlng = {\n                        lat: parseFloat(lat),\n                        lng: parseFloat(long),\n                    };\n                    $rootScope.geocoder.geocode({location: latlng}, function (results, status) {\n                        if (status === \"OK\") {\n                            if (results[0]) {\n                                deferred.resolve(results);\n                            } else {\n                                deferred.resolve([]);\n                            }\n                        } else {\n                            window.alert(\"Geocoder failed due to: \" + status);\n                        }\n                    });\n                    return deferred.promise;\n                }\n                var getServerLocations = function (where, hash) {\n                    LocationService.shared(where).then(function (data) {\n                        if (data.total == 0) {\n                            $rootScope.isActive = false;\n                            alert(\"User has no active locations\");\n                        } else {\n                            var pins = data.data;\n                            checkMarkers(pins);\n                            if (data.page < data.last_page) {\n                                var dapage = data.page + 1;\n                                var where = \"?page=\" + dapage + \"&hash_id=\" + hash;\n                                getServerLocations(where, hash);\n                            } else {\n                                $rootScope.mapSemaphore = true;\n                                setTimeout(function () {\n                                    console.log(\"Timeout Triggered\");\n                                    updateLocations(hash, data.page);\n                                }, $rootScope.sharedTimeout);\n                            }\n                        }\n                    },\n                            function (data) {\n                                console.log(data);\n                            });\n                }\n                return {\n                    updateLocations: updateLocations,\n                    createMap: createMap,\n                    postMapLocation: postMapLocation,\n                    createStop: createStop,\n                    createRoute: createRoute,\n                    createLocationMarker: createLocationMarker,\n                    getColor: getColor,\n                    getAddressAndPostal: getAddressAndPostal,\n                    createPolygon: createPolygon,\n                    createReport: createReport\n                };\n            }])\n        //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tYXAuanM/MmFiOCJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgLmZhY3RvcnkoJ01hcFNlcnZpY2UnLCBbJyRxJywgJyRyb290U2NvcGUnLCAnTG9jYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkcm9vdFNjb3BlLCBMb2NhdGlvblNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXlMYXRsbmc7XG4gICAgICAgICAgICAgICAgdmFyIG1hcE9wdGlvbnM7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pY29ucGF0aCA9IFwiaHR0cDovL2hvb3ZlcnQuY29tL2ltYWdlcy9pY29uc1wiO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFya2VycyA9IFtdO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3c7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlTWFwID0gZnVuY3Rpb24gKGxhdGl0dWRlLCBsb25naXR1ZGUpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbXlMYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdGl0dWRlLCBsb25naXR1ZGUpO1xuICAgICAgICAgICAgICAgICAgICBtYXBPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyOiBteUxhdGxuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IDEyLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlc3R1cmVIYW5kbGluZzogXCJjb29wZXJhdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwXCIpLCBtYXBPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50cmFja2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZU1hcmtlciA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaW5mbyByZWNlaXZlZCBpbiBtYXJrZXJcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGluZm8pKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBpbmNsYXNzID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJzdGlsbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwibWFzY3VsaW5lLWF2YXRhci5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZW50cm8gc3RpbGxcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5hY3Rpdml0eSA9PSBcIm9uX2Zvb3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBvbiBmb290XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcInBlZGVzdHJpYW4td2Fsa2luZy5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmFjdGl2aXR5ID09IFwiaW5fdmVoaWNsZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwiY2FyLWZyb250LnN2Z1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJvbl9iaWN5Y2xlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJjeWNsaW5nLnN2Z1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJydW5uaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJydW5uaW5nLnN2Z1wiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBibGFua1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJtYXAtcGluLnN2Z1wiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpbmZvLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogaW5mby51c2VyX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoaW5mby5sYXQsIGluZm8ubG9uZyksXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IGRhbWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydF90aW1lOiBpbmZvLnJlcG9ydF90aW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3BlZWQ6IGluZm8uc3BlZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eTogaW5mby5hY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhdHRlcnk6IGluZm8uYmF0dGVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogaW5mby5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc2xhc3Q6IGluZm8uaXNsYXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogJyNmZmZmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJHJvb3RTY29wZS5pY29ucGF0aCArIFwiL1wiICsgcGluY2xhc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMzUsIDM1KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLmNvbnRlbnQgPSAnPGRpdiBjbGFzcz1cImluZm9XaW5kb3dDb250ZW50XCI+JyArIGluZm8uaWQgKyAnICcgKyBpbmZvLm5hbWUgKyAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoJzxoMj4nICsgbWFya2VyLnJlcG9ydF90aW1lICsgJzwvaDI+JyArIG1hcmtlci5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3Blbigkcm9vdFNjb3BlLm1hcCwgbWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXJrZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVMb2NhdGlvbk1hcmtlciA9IGZ1bmN0aW9uIChsYXQsIGxvbmcsIHRyaWdnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSAkcm9vdFNjb3BlLm1hcDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbmZvIHJlY2VpdmVkIGluIG1hcmtlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0LCBsb25nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogZGFtYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubG9hZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2NhdGlvbiA9IG1hcmtlci5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGxvY2F0aW9uLmxhdCgpLCBsb2NhdGlvbi5sbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzQW5kUG9zdGFsKGxvY2F0aW9uLmxhdCgpLCBsb2NhdGlvbi5sbmcoKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJpZ2dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcihtYXJrZXIsICdkcmFnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5sb2NhdGlvbk1hcmtlciA9IG1hcmtlcjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZVJlcG9ydCA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGluZm8uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhpbmZvLmxhdCwgaW5mby5sb25nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogZGFtYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogaW5mby5jcmVhdGVkX2F0LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaW5mby5uYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXIuY29udGVudCA9ICc8ZGl2IGNsYXNzPVwiaW5mb1dpbmRvd0NvbnRlbnRcIj4nICsgaW5mby5pZCArICcgJyArIGluZm8ubmFtZSArICc8L2Rpdj4nO1xuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudCgnPGgyPicgKyBtYXJrZXIuY3JlYXRlZF9hdCArICc8L2gyPicgKyBtYXJrZXIuY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4oJHJvb3RTY29wZS5tYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFya2VyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlU3RvcCA9IGZ1bmN0aW9uIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRpbmcgc3RvcFwiLCBzdG9wKVxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogc3RvcC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb246IHN0b3AuaWNvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHN0b3AubGF0LCBzdG9wLmxvbmcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBkYW1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBzdG9wLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci5jb250ZW50ID0gJzxkaXYgY2xhc3M9XCJpbmZvV2luZG93Q29udGVudFwiPicgKyBzdG9wLmlkICsgJyAnICsgc3RvcC5uYW1lICsgJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCc8aDI+JyArIG1hcmtlci5jcmVhdGVkX2F0ICsgJzwvaDI+JyArIG1hcmtlci5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3Blbigkcm9vdFNjb3BlLm1hcCwgbWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXJrZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVSb3V0ZSA9IGZ1bmN0aW9uIChyb3V0ZSwgY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSAkcm9vdFNjb3BlLm1hcDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGVSb3V0ZVwiLCByb3V0ZSlcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZsaWdodFBsYW5Db29yZGluYXRlcyA9IHJvdXRlLnN0b3BzTGF0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmxpZ2h0UGF0aCA9IG5ldyBnb29nbGUubWFwcy5Qb2x5bGluZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBmbGlnaHRQbGFuQ29vcmRpbmF0ZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW9kZXNpYzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZU9wYWNpdHk6IDEuMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZmxpZ2h0UGF0aC5zZXRNYXAoZGFtYXApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmxpZ2h0UGF0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldENvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgcm91dGVDb2xvcnMgPSBbXCIjRkYwMDAwXCIsIFwiIzgwMDAwMFwiLCBcIiNGRkZGMDBcIiwgXCIjODA4MDAwXCIsIFwiIzAwRkYwMFwiLCBcIiMwMDgwMDBcIiwgXCIjMDBGRkZGXCIsIFwiIzAwODA4MFwiLCBcIiMwMDAwRkZcIiwgXCIjMDAwMDgwXCIsIFwiI0ZGMDBGRlwiLCBcIiM4MDAwODBcIl07XG4gICAgICAgICAgICAgICAgICAgIGxldCByYW5kb20gPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAocm91dGVDb2xvcnMubGVuZ3RoIC0gMSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm91dGVDb2xvcnNbcmFuZG9tXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZVBvbHlnb24gPSBmdW5jdGlvbiAoem9uZSwgY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSAkcm9vdFNjb3BlLm1hcDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGVSb3V0ZVwiLCB6b25lKVxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJpYW5nbGVDb29yZHMgPSBKU09OLnBhcnNlKHpvbmUuY292ZXJhZ2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENvbnN0cnVjdCB0aGUgcG9seWdvbi5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGJlcm11ZGFUcmlhbmdsZSA9IG5ldyBnb29nbGUubWFwcy5Qb2x5Z29uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB6b25lLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHM6IHRyaWFuZ2xlQ29vcmRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlT3BhY2l0eTogMC44LFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6IDIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjRkYwMDAwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjM1LFxuICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2VvZGVzaWM6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJlcm11ZGFUcmlhbmdsZS5zZXRNYXAoZGFtYXApO1xuICAgICAgICAgICAgICAgICAgICBiZXJtdWRhVHJpYW5nbGUuZ2V0UGF0aHMoKS5mb3JFYWNoKGZ1bmN0aW9uIChwYXRoLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIocGF0aCwgJ2luc2VydF9hdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnenppbnNlcnRfYXQnLCB6b25lLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoXCJ6b25lLXVwZGF0ZWRcIiwgem9uZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgem9uZS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHBhdGgsICdyZW1vdmVfYXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3p6aW5zZXJ0X2F0Jywgem9uZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KFwiem9uZS11cGRhdGVkXCIsIHpvbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvbmUuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihwYXRoLCAnc2V0X2F0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd6emluc2VydF9hdCcsIHpvbmUuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChcInpvbmUtdXBkYXRlZFwiLCB6b25lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihiZXJtdWRhVHJpYW5nbGUsICdkcmFnZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NldF9hdC4nLCBiZXJtdWRhVHJpYW5nbGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJlcm11ZGFUcmlhbmdsZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY29uc29sZUxvZ01hcmtlcnMgPSBmdW5jdGlvbiAoZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluIGRhbWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhbWFya2Vyc1ttYXJrZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzcGVlZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5zcGVlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJhY3Rpdml0eTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5hY3Rpdml0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJiYXR0ZXJ5OiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLmJhdHRlcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibGF0OiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLmxhdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJsb25nOiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLmxvbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmFtZTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInR5cGU6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0udHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyX2lkOiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVwb3J0X3RpbWU6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0ucmVwb3J0X3RpbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1hcmtlciBpcyBudWxsOiBcIiArIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGFtYXJrZXJzW21hcmtlcl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZUxvY2F0aW9ucyA9IGZ1bmN0aW9uIChoYXNoLCBwYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRpbmcgbG9jYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTWFwIEFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicm9vdHNjb3BlIG1hcHNlbWFwaG9yZSB0cnVlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2VtYXBob3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdoZXJlID0gXCI/cGFnZT1cIiArIHBhZ2UgKyBcIiZoYXNoX2lkPVwiICsgaGFzaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2ZXJMb2NhdGlvbnMod2hlcmUsIGhhc2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWxldGVVc2VyTWFya2VycyA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gJHJvb3RTY29wZS5tYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl0udXNlcl9pZCA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl0uc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMuc3BsaWNlKG1hcmtlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMuc3BsaWNlKG1hcmtlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGZpbmRVc2VySW5Qb2x5bGluZSA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChwb2x5bGluZSBpbiAkcm9vdFNjb3BlLnBvbHlsaW5lcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUucG9seWxpbmVzW3BvbHlsaW5lXS51c2VyX2lkID09IGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkVG9Vc2VyUG9seWxpbmUgPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFkZCB1c2VyIHRvIHBvbHlsaW5lXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRyb290U2NvcGUubWFwTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcExvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVNYXAoaW5mby5sYXQsIGluZm8ubG9uZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvb3JkcyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoaW5mby5sYXQsIGluZm8ubG9uZyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwb2x5ID0gZmluZFVzZXJJblBvbHlsaW5lKGluZm8udXNlcl9pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2x5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVVc2VyTWFya2VycyhpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwb3MgYWRkZWQgdG8gZXhpc3RpbmcgcG9seVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gcG9seS5nZXRQYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goY29vcmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLnN0YXR1cyA9PSBcImVtZXJnZW5jeVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9seS5zdGF0dXMgPSBcImVtZXJnZW5jeVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9seSA9IG5ldyBnb29nbGUubWFwcy5Qb2x5bGluZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjMDAwMDAwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IGluZm8udXNlcl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBpbmZvLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBwb2x5LmdldFBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChjb29yZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9seS5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJuZXcgcG9seSBjcmVhdGVkIGFuZCBwb3MgYWRkZWQ6IFwiICsgcG9seS51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzLnB1c2gocG9seSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5mby5vd25lcl90eXBlID0gXCJ1c2VyXCI7XG4gICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChpbmZvLmxhdCwgaW5mby5sb25nKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGEgbmV3IG1hcmtlciBhdCB0aGUgbmV3IHBsb3R0ZWQgcG9pbnQgb24gdGhlIHBvbHlsaW5lLlxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gY3JlYXRlTWFya2VyKGluZm8pO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU1hcmtlciA9IG1hcmtlcjtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnB1c2gobWFya2VyKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBzZXRDZW50ZXJNYXAgPSBmdW5jdGlvbiAobGF0LCBsb25nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBtYXAgY2VudGVyXCIpO1xuICAgICAgICAgICAgICAgICAgICBteUxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0LCBsb25nKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcC5zZXRab29tKDE1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwLnNldENlbnRlcihteUxhdGxuZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrTWFya2VycyA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh0YXJnZXQgaW4gaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm9bdGFyZ2V0XS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrTG9jYXRpb25FeGlzdHMoaW5mb1t0YXJnZXRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tMb2NhdGlvbkV4aXN0cyA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNraW5nIGRhdGFiYXNlIGZvciBsb2NhdGlvbjogXCIgKyBsb2NhdGlvbi5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmFjdGl2ZU1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uLmlkID4gJHJvb3RTY29wZS5hY3RpdmVNYXJrZXIuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5zdGF0dXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9jYXRpb24gZXhpc3RzOiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9Vc2VyUG9seWxpbmUobG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9Vc2VyUG9seWxpbmUobG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBwb3N0TWFwTG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwLmFkZExpc3RlbmVyKCdkYmxjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1hcCBkb3VibGUgY2xpY2tcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBlLmxhdExuZztcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubG9jYXRpb25NYXJrZXIuc2V0UG9zaXRpb24obG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkcm9vdFNjb3BlLmxvY2F0aW9uTWFya2VyLCAnZHJhZ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGxvY2F0aW9uLmxhdCgpLCBsb2NhdGlvbi5sbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzQW5kUG9zdGFsKGxvY2F0aW9uLmxhdCgpLCBsb2NhdGlvbi5sbmcoKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvKiRyb290U2NvcGUubWFwLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBlLmxhdExuZztcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubG9jYXRpb25NYXJrZXIuc2V0UG9zaXRpb24obG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkcm9vdFNjb3BlLmxvY2F0aW9uTWFya2VyLCAnZHJhZ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGxvY2F0aW9uLmxhdCgpLCBsb2NhdGlvbi5sbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzQW5kUG9zdGFsKGxvY2F0aW9uLmxhdCgpLCBsb2NhdGlvbi5sbmcoKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH0pOyovXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBkZWNvZGVBZGRyZXNzRnJvbUxhdFJlc3VsdCA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSByZXN1bHRzWzBdLmZvcm1hdHRlZF9hZGRyZXNzO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIHByZXBhcmVzIHJlcG9ydCBkYXRhIGZvciBjcmVhdGluZyBhIG1hcmtlclxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHZhciBkZWNvZGVQb3N0YWxGcm9tTGF0UmVzdWx0ID0gZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhZGRyZXNzID0gcmVzdWx0c1swXVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb21wb25lbnRzID0gYWRkcmVzcy5hZGRyZXNzX2NvbXBvbmVudHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb3N0YWwgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbXBvbmVudHNbaV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIGluIGNvbnRhaW5lci50eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnR5cGVzW2l0ZW1dID09IFwicG9zdGFsX2NvZGVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdGFsID0gY29udGFpbmVyLmxvbmdfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPj0gcmVzdWx0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKGZvdW5kID09IGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdFwiLCBwb3N0YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvc3RhbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWNvZGVDaXR5RnJvbUxhdFJlc3VsdCA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWRkcmVzcyA9IHJlc3VsdHNbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29tcG9uZW50cyA9IGFkZHJlc3MuYWRkcmVzc19jb21wb25lbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2l0eSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gY29tcG9uZW50c1tpXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gaW4gY29udGFpbmVyLnR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIudHlwZXNbaXRlbV0gPT0gXCJhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2l0eSA9IGNvbnRhaW5lci5sb25nX25hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID49IHJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IHdoaWxlIChmb3VuZCA9PSBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlY29kZUNpdHlGcm9tTGF0UmVzdWx0XCIsIGNpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNpdHk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0QWRkcmVzc0FuZFBvc3RhbCA9IGZ1bmN0aW9uIChsYXQsIGxvbmcsIGF0dGVtcHRzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzc0Zyb21MYXQobGF0LCBsb25nKS50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZHJlc3MgZnJvbSBsYXRcIiwgcmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaXR5ID0gZGVjb2RlQ2l0eUZyb21MYXRSZXN1bHQocmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdoZXJlID0gXCJuYW1lPVwiICsgY2l0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZHJlc3Mgd2hlcmVcIiwgd2hlcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5nZXRDaXRpZXMod2hlcmUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZGRyZXNzIGRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRvdGFsID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2l0eSA9IHJlc3VsdHNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3M6IGRlY29kZUFkZHJlc3NGcm9tTGF0UmVzdWx0KHJlc3ApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RhbDogZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdChyZXNwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXQ6IGxhdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb25nOiBsb25nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHlfaWQ6IGNpdHkuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uX2lkOiBjaXR5LnJlZ2lvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2lkOjEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeUNvZGU6XCJDT1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MuYWRkcmVzcyA9IGRlY29kZUFkZHJlc3NGcm9tTGF0UmVzdWx0KHJlc3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLnBvc3RhbCA9IGRlY29kZVBvc3RhbEZyb21MYXRSZXN1bHQocmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubGF0ID0gbGF0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcgPSBsb25nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmNpdHlfaWQgPSBjaXR5LmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLnJlZ2lvbl9pZCA9IGNpdHkucmVnaW9uX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmNvdW50cnlfaWQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubG9hZGVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmxvYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiBkZWNvZGVBZGRyZXNzRnJvbUxhdFJlc3VsdChyZXNwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0YWw6IGRlY29kZVBvc3RhbEZyb21MYXRSZXN1bHQocmVzcCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBsYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9uZzogbG9uZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2lkOjFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5hZGRyZXNzID0gZGVjb2RlQWRkcmVzc0Zyb21MYXRSZXN1bHQocmVzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MucG9zdGFsID0gZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdChyZXNwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQgPSBsYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZyA9IGxvbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeV9pZCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzID0gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogZGVjb2RlQWRkcmVzc0Zyb21MYXRSZXN1bHQocmVzcCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RhbDogZGVjb2RlUG9zdGFsRnJvbUxhdFJlc3VsdChyZXNwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBsYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvbmc6IGxvbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cnlfaWQ6MVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcyA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmxvYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQXR0ZW1wdHNcIiwgYXR0ZW1wdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0cyA8IDgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdHMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZtID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bS5nZXRBZGRyZXNzQW5kUG9zdGFsKGxhdCwgbG9uZywgYXR0ZW1wdHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBnZXR0aW5nIGxvY2F0aW9uJywgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldEFkZHJlc3NGcm9tTGF0ID0gZnVuY3Rpb24gKGxhdCwgbG9uZykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXRsbmcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXQ6IHBhcnNlRmxvYXQobGF0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxuZzogcGFyc2VGbG9hdChsb25nKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nZW9jb2Rlci5nZW9jb2RlKHtsb2NhdGlvbjogbGF0bG5nfSwgKHJlc3VsdHMsIHN0YXR1cykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gXCJPS1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGVydChcIkdlb2NvZGVyIGZhaWxlZCBkdWUgdG86IFwiICsgc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0U2VydmVyTG9jYXRpb25zID0gZnVuY3Rpb24gKHdoZXJlLCBoYXNoKSB7XG4gICAgICAgICAgICAgICAgICAgIExvY2F0aW9uU2VydmljZS5zaGFyZWQod2hlcmUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRvdGFsID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJVc2VyIGhhcyBubyBhY3RpdmUgbG9jYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGlucyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja01hcmtlcnMocGlucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA8IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXBhZ2UgPSBkYXRhLnBhZ2UgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBcIj9wYWdlPVwiICsgZGFwYWdlICsgXCImaGFzaF9pZD1cIiArIGhhc2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFNlcnZlckxvY2F0aW9ucyh3aGVyZSwgaGFzaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBTZW1hcGhvcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGltZW91dCBUcmlnZ2VyZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVMb2NhdGlvbnMoaGFzaCwgZGF0YS5wYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJHJvb3RTY29wZS5zaGFyZWRUaW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUxvY2F0aW9uczogdXBkYXRlTG9jYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVNYXA6IGNyZWF0ZU1hcCxcbiAgICAgICAgICAgICAgICAgICAgcG9zdE1hcExvY2F0aW9uOiBwb3N0TWFwTG9jYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVN0b3A6IGNyZWF0ZVN0b3AsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVJvdXRlOiBjcmVhdGVSb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTG9jYXRpb25NYXJrZXI6IGNyZWF0ZUxvY2F0aW9uTWFya2VyLFxuICAgICAgICAgICAgICAgICAgICBnZXRDb2xvcjogZ2V0Q29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGdldEFkZHJlc3NBbmRQb3N0YWw6IGdldEFkZHJlc3NBbmRQb3N0YWwsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVBvbHlnb246IGNyZWF0ZVBvbHlnb24sXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVJlcG9ydDogY3JlYXRlUmVwb3J0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1dKVxuICAgICAgICBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tYXAuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 41 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .factory('MapDashService',['$q', '$rootScope', 'LocationService', function ($q, $rootScope, LocationService) {\n            var myLatlng;\n            var mapOptions;\n            $rootScope.map;\n            $rootScope.iconpath = \"http://hoovert.com/images/icons\";\n            $rootScope.meicon = \"wasp.svg\";\n            $rootScope.markers = [];\n            $rootScope.polylines = [];\n            var infoWindow;\n\n            var createMap = function (element) {\n                var dalength = $rootScope.markers.length;\n                var zoom = 12;\n                var myLatlng = new google.maps.LatLng(4.704296, -74.073775);\n\n                mapOptions = {\n                    center: myLatlng,\n                    zoom: zoom,\n                    mapTypeId: google.maps.MapTypeId.ROADMAP,\n                };\n\n                var map = new google.maps.Map(document.getElementById(element), mapOptions);\n                infoWindow = new google.maps.InfoWindow();\n                if (element == \"map\") {\n                    $rootScope.mapActive = true;\n                    $rootScope.mapLoaded = true;\n                    $rootScope.mapSemaphore = true;\n                }\n\n\n                return map;\n            }\n            var setCenterMap = function (lat, long) {\n                console.log(\"Setting map center\");\n                myLatlng = new google.maps.LatLng(lat, long);\n                if ($rootScope.map) {\n                    $rootScope.map.setZoom(15);\n                    $rootScope.map.setCenter(myLatlng);\n                }\n            }\n            var getMarkers = function () {\n                return $rootScope.markers;\n            };\n            var getUserMarker = function (dauser_id) {\n                for (marker in $rootScope.markers) {\n                    var container = $rootScope.markers[marker];\n                    if (container.user_id == parseInt(dauser_id)) {\n                        return container;\n                    }\n                }\n                return null;\n            };\n\n            var findUserInPolyline = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline].user_id == dauser_id) {\n                        return $rootScope.polylines[polyline];\n                    }\n                }\n                return null;\n            };\n            var getUserPolyline = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline].user_id == dauser_id) {\n                        return $rootScope.polylines[polyline];\n                    }\n                }\n                return null;\n            };\n            var addToUserPolyline = function (info) {\n                console.log(\"add user to polyline\");\n                removeFromUnknowns(info.user_id);\n                if (info.islast == \"1\") {\n                    deleteUserObjects(info.user_id);\n                } else {\n                    var coords = new google.maps.LatLng(info.lat, info.long);\n                    var poly = findUserInPolyline(info.user_id);\n                    if (poly) {\n                        deleteUserMarkers(info.user_id);\n                        console.log(\"pos added to existing poly\");\n                        var path = poly.getPath();\n                        path.push(coords);\n                        if (info.status == \"emergency\") {\n                            poly.status = \"emergency\";\n                        }\n                    } else {\n\n                        poly = new google.maps.Polyline({\n                            strokeColor: '#000000',\n                            strokeOpacity: 1.0,\n                            strokeWeight: 3,\n                            user_id: info.user_id,\n                            name: info.name,\n                            status: info.status,\n                            visible: $rootScope.rootMapMarkers,\n                            isActive: false,\n                        });\n                        var path = poly.getPath();\n                        path.push(coords);\n                        if ($rootScope.rootMapMarkers) {\n                            poly.setMap($rootScope.map);\n                        } else {\n                            poly.setMap(null);\n                        }\n                        console.log(\"new poly created and pos added: \" + poly.user_id);\n                        $rootScope.polylines.push(poly);\n\n                    }\n                    info.owner_type = \"user\";\n                    checkActive(info);\n                    // Add a new marker at the new plotted point on the polyline.\n                    var marker = createMarker(info, $rootScope.rootMapMarkers);\n                    $rootScope.markers.push(marker);\n                }\n\n            };\n            var showAllPolylines = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    $rootScope.polylines[polyline].setMap($rootScope.map);\n                }\n            };\n            var showAllMerchants = function () {\n                for (marker in $rootScope.merchants) {\n                    $rootScope.merchants[marker].setMap($rootScope.map);\n                }\n            };\n            var showAllReports = function () {\n                for (marker in $rootScope.reports) {\n                    $rootScope.reports[marker].setMap($rootScope.map);\n                }\n                console.log(\"Done showing reports\");\n            };\n\n            var checkActive = function (info) {\n                console.log(\"Check active: \" + info.owner_type);\n                console.log(JSON.stringify(info));\n                console.log(\"Active type: \" + $rootScope.mapActiveType + \" id: \" + $rootScope.mapId);\n                if ($rootScope.mapActiveType) {\n\n                } else {\n                    $rootScope.mapActiveType = info.owner_type;\n                }\n                if ($rootScope.mapId) {\n\n                } else {\n                    $rootScope.mapId = info.user_id;\n                }\n                if ($rootScope.mapActiveType == info.owner_type) {\n                    console.log(\"type the same mapid: \" + $rootScope.mapId + \" user: \" + info.user_id);\n                    if ($rootScope.mapActiveType == \"me\") {\n                        setActive(\"me\", -1, null);\n                    }\n                    if ($rootScope.mapId == info.user_id) {\n                        console.log(\"Set center map, id the same\");\n                        setCenterMap(info.lat, info.long)\n                    }\n                }\n            };\n            var getNearbyMerchants = function (lat, lng) {\n                var location = {lat: lat, long: lng, radius: $rootScope.radius};\n                LocationService.merchants(location).then(function (data) {\n                    var pins = data.merchants;\n                    console.log(JSON.stringify(data));\n                    console.log(\"merchants received from server: \" + pins.length);\n                    if (pins.length == 0) {\n                        alert('No tenemos informacion de puntos de seguridad en ese punto');\n                    } else {\n                        cleanMerchants(data);\n                    }\n                },\n                        function (data) {\n                            console.log(data);\n                        });\n            };\n            var loadUserTrip = function (user_id, trip) {\n                $rootScope.rootMapMarkers = false;\n                contactTripLocations(user_id, trip).then(function (res) {\n                    console.log(\"locations in trip: \" + trip + \" count: \" + res.length);\n                    console.log(JSON.stringify(res));\n                    if (res.length > 0) {\n                        displayTrip(res);\n                    } else {\n                        alert('No encuentro ese viaje');\n                    }\n                },\n                        function (data) {\n                        });\n            };\n            var postMap = function () {\n                $rootScope.map.addListener('dblclick', function (e) {\n                    var location = e.latLng;\n                    setCenterMap(location.lat(), location.lng());\n                    getNearbyMerchants(location.lat(), location.lng());\n                });\n                if ($rootScope.memarkerpending) {\n                    console.log(\"me marker was created before map so loading now\");\n                    $rootScope.memarkerpending = false;\n                    $rootScope.memarker.setMap($rootScope.map);\n                }\n                if ($rootScope.merchantspending) {\n                    console.log(\"merchants were created before map so loading now\");\n                    showAllMerchants();\n                    showAllReports();\n                    $rootScope.merchantspending = false;\n                }\n                setActive($rootScope.mapActiveType, $rootScope.mapId, null);\n                alert('doble click para encontrar puntos de seguridad');\n            };\n            var setActive = function (type, id, latLng) {\n                console.log(\"Setting as active: \" + id + \" type: \" + type);\n                $rootScope.mapActiveType = type;\n                $rootScope.mapId = id;\n                window.localStorage.setItem(\"MAP_ACTIVE_TYPE\", type);\n                window.localStorage.setItem(\"MAP_ACTIVE_ID\", id);\n                if (latLng) {\n                    setCenterMap(latLng.lat(), latLng.lng());\n                } else {\n                    var centered = false;\n                    if (type == \"emergency\" || type == \"user\" || type == \"medical_emergency\" || type == \"me\") {\n                        $rootScope.tracking = true;\n                        $rootScope.rootMapMarkers = true;\n                        if (setVisibleUser($rootScope.mapId)) {\n                            centered = true\n                        }\n                    } else if (type == \"trip\") {\n                        var trip_id = $rootScope.contactTrip;\n                        var contact_id = $rootScope.contactIdTrip;\n                        loadUserTrip(contact_id, trip_id)\n                        centered = true;\n                    }\n                    if (!centered) {\n                        var markerslength = $rootScope.markers.length;\n                        if (markerslength > 0) {\n                            var marker = $rootScope.markers[markerslength - 1];\n                            if (marker) {\n                                var e = marker.getPosition();\n                                var location = e.latLng;\n                                if (location) {\n                                    setActive(\"user\", marker.user_id);\n                                    return true;\n                                }\n\n                            }\n                        }\n                    }\n                    if (!centered) {\n                        if ($rootScope.trackingActive) {\n                            if (type != \"me\") {\n                                setActive(\"me\", -1);\n                            }\n                            return true;\n                        }\n\n                    }\n                }\n            };\n\n            var cleanMerchants = function (data) {\n                var newmerchants = data.merchants;\n                for (merchant in newmerchants) {\n                    var found = false;\n                    for (marker in $rootScope.merchants) {\n                        if (newmerchants[merchant].id == $rootScope.merchants[marker].id) {\n                            found = true;\n                            break;\n                        }\n                    }\n                    if (found == false) {\n                        $rootScope.merchants.push(createMerchant(newmerchants[merchant]));\n                    }\n                }\n                var newreports = data.reports;\n                for (report in newreports) {\n                    var found = false;\n                    for (marker in $rootScope.reports) {\n                        if (newreports[report].id == $rootScope.reports[marker].id) {\n                            found = true;\n                            break;\n                        }\n                    }\n                    if (found == false) {\n                        newreports[report].type = \"Report\";\n                        $rootScope.reports.push(createMerchant(newreports[report]));\n                    }\n                }\n                return null;\n            }\n            var deleteUserObjects = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline]) {\n                        if ($rootScope.polylines[polyline].user_id = dauser_id) {\n                            deleteUserMarkers($rootScope.polylines[polyline].user_id);\n                            $rootScope.polylines[polyline].setMap(null);\n                            $rootScope.polylines.splice(polyline, 1);\n                        }\n                    }\n                }\n            };\n            var setVisibleUser = function (dauser_id) {\n                if (dauser_id > 0) {\n                    for (marker in $rootScope.markers) {\n                        if ($rootScope.markers[marker].user_id = dauser_id) {\n                            var latLng = $rootScope.markers[marker].getPosition();\n                            setCenterMap(latLng.lat(), latLng.lng());\n                            $rootScope.markers[marker].setMap($rootScope.map);\n                            return true;\n                        }\n                    }\n                } else {\n                    if ($rootScope.memarker) {\n                        var latLng = $rootScope.memarker.getPosition();\n                        setCenterMap(latLng.lat(), latLng.lng());\n                        return true;\n                    }\n\n                }\n                return false;\n\n            };\n            var hideAllPolylines = function (dauser_id) {\n                for (polyline in $rootScope.polylines) {\n                    if ($rootScope.polylines[polyline]) {\n                        $rootScope.polylines[polyline].setMap(null);\n                    }\n                }\n            };\n            var addToUnknowns = function (dauser_id) {\n                var found = false;\n                for (unknown in $rootScope.followingUnknown) {\n                    if ($rootScope.followingUnknown[unknown] == dauser_id) {\n                        found = true;\n                    }\n                }\n                if (found == false) {\n                    $rootScope.followingUnknown.push(dauser_id);\n                }\n            };\n            var removeFromUnknowns = function (dauser_id) {\n                for (unknown in $rootScope.followingUnknown) {\n                    if ($rootScope.followingUnknown[unknown] == dauser_id) {\n                        console.log(\"Removing user: \" + dauser_id + \" from unknowns\");\n                        $rootScope.followingUnknown.splice(unknown, 1);\n\n                        return true;\n                    }\n                }\n                return false;\n            };\n            var checkUnknownsMarker = function () {\n                if ($rootScope.followingUnknown.length > 0) {\n                    $rootScope.tracking = true;\n                    $rootScope.mapSemaphore = true;\n                    console.log(\"Unknown markers\");\n                    console.log(JSON.stringify($rootScope.followingUnknown));\n                    setTimeout(function () {\n                        console.log(\"Timeout Triggered unknowns\");\n                        updateLocations();\n                    }, $rootScope.sharedTimeout);\n                } else {\n                    window.localStorage.setItem(\"USER_TRACKING\", false);\n                    console.log(\"No one is sharing location with user\");\n                    $rootScope.$broadcast('NoSharers');\n                }\n            };\n            var createMarker = function (info, active) {\n                if (active && $rootScope.map) {\n                    damap = $rootScope.map;\n                } else {\n                    damap = null;\n                }\n                console.log(\"info received in marker\");\n                console.log(JSON.stringify(info));\n                var pinclass = \"\";\n                if (info.activity == \"still\") {\n                    pinclass = \"masculine-avatar.svg\";\n                    console.log(\"entro still\");\n                } else if (info.activity == \"on_foot\") {\n                    console.log(\"entro on foot\");\n                    pinclass = \"pedestrian-walking.svg\";\n                } else if (info.activity == \"in_vehicle\") {\n                    pinclass = \"car-front.svg\";\n                } else if (info.activity == \"on_bicycle\") {\n                    pinclass = \"cycling.svg\";\n                } else if (info.activity == \"running\") {\n                    pinclass = \"running.svg\";\n                } else if (info.activity == \"\") {\n                    console.log(\"entro blank\");\n                    pinclass = \"map-pin.svg\";\n                }\n                console.log(\"Icon path marker\");\n                console.log($rootScope.iconpath + \"/\" + pinclass);\n                var marker = new google.maps.Marker({\n                    id: info.id,\n                    user_id: info.user_id,\n                    position: new google.maps.LatLng(info.lat, info.long),\n                    map: damap,\n                    animation: google.maps.Animation.DROP,\n                    report_time: info.report_time,\n                    speed: info.speed,\n                    activity: info.activity,\n                    battery: info.battery,\n                    name: info.name,\n                    status: info.status,\n                    islast: info.islast,\n                    icon: {\n                        fillColor: '#ffffff',\n                        url: $rootScope.iconpath + \"/\" + pinclass,\n                        fillOpacity: 1,\n                        strokeColor: '#ffffff',\n                        strokeWeight: 0,\n                        scaledSize: new google.maps.Size(35, 35)\n                    }\n                });\n                marker.content = '<div class=\"infoWindowContent\">' + info.id + ' ' + info.name + '<br/><a onClick=\"window.open(\\'http://waze.to/?ll=' + info.lat + ',' + info.long\n                        + '&navigate=yes' + '\\',\\'_system\\',\\'location=yes\\');return false;\">Waze</a><br/><a href=\"tel:' + info.phone + '\">' + info.phone + '</a></div>';\n                google.maps.event.addListener(marker, 'click', function () {\n                    infoWindow.setContent('<h2>' + marker.report_time + '</h2>' + marker.content);\n                    infoWindow.open($rootScope.map, marker);\n                    var latlong = marker.getPosition();\n                    setActive(\"user\", marker.user_id, latlong);\n                });\n                if (info.status == \"emergency\") {\n                    var latLng = marker.getPosition();\n                    setActive(\"emergency\", info.user_id, latLng);\n                }\n\n                return marker;\n            }\n            var createMerchant = function (info) {\n                if ($rootScope.map) {\n                    damap = $rootScope.map;\n                } else {\n                    damap = null;\n                    $rootScope.merchantspending = true;\n                    console.log(\"Merchant pending from adding to map\");\n                }\n                var pinclass = \"\";\n                if (info.type == \"police\") {\n                    pinclass = \"police-shield.svg\";\n                } else if (info.type == \"medical\") {\n                    pinclass = \"medic-suitcase.svg\";\n                } else if (info.type == \"Report\") {\n                    pinclass = \"pin.svg\";\n                }\n                console.log(\"icon: \" + $rootScope.iconpath + \"/\" + pinclass + \" for type: \" + info.type);\n                var marker = new google.maps.Marker({\n                    id: info.id,\n                    position: new google.maps.LatLng(info.lat, info.long),\n                    map: damap,\n                    animation: google.maps.Animation.DROP,\n                    icon: {\n                        fillColor: '#ffffff',\n                        url: $rootScope.iconpath + \"/\" + pinclass,\n                        fillOpacity: 1,\n                        strokeColor: '#ffffff',\n                        strokeWeight: 0,\n                        scaledSize: new google.maps.Size(25, 25)\n                    }\n                });\n                marker.content = '<div class=\"infoWindowContent\">' + info.type + '<br/><a class=\"button icon-left ion-ios7-telephone button-calm button-outline\" href=\"tel:+ ' + info.telephone + '\">' + info.telephone + '</a><br/>' + info.address + '<br/><a onClick=\"window.open(\\'http://waze.to/?ll=' + info.lat + ',' + info.long + '&navigate=yes' + '\\',\\'_system\\',\\'location=yes\\');return false;\">Waze</a></div>';\n                var pinclass = \"\";\n                if (info.type == \"police\") {\n                    pinclass = \"map-icon-police\";\n                } else if (info.type == \"medical\") {\n                    pinclass = \"map-icon-health\";\n                } else if (info.type == \"Report\") {\n                    pinclass = \"map-icon-report\";\n                    marker.content = '<div class=\"infoWindowContent\">' + info.type + '<br/>' + info.address + '<br/><a onClick=\"window.open(\\'http://waze.to/?ll=' + info.lat + ',' + info.long + '&navigate=yes' + '\\',\\'_system\\',\\'location=yes\\');return false;\">Waze</a></div>';\n                }\n                console.log(\"creating merchant\");\n                var infoWindow = new google.maps.InfoWindow();\n\n                google.maps.event.addListener(marker, 'click', function () {\n                    infoWindow.setContent('<h2>' + info.name + '</h2>' + marker.content);\n                    infoWindow.open($rootScope.map, marker);\n                });\n                return marker;\n            }\n            var checkMarkers = function (info) {\n                var def = $q.defer();\n                var i = 0;\n                for (target in info) {\n                    if (info[target].id) {\n                        i++;\n                        if ($rootScope.lastLocation < info[target].id) {\n                            $rootScope.lastLocation = info[target].id;\n                        }\n                        checkLocationExists(info[target]).then(function (res) {\n                            i--;\n                            if (i == 0) {\n                                def.resolve(\"done\");\n                            }\n                        }, function (err) {\n                            console.log(\"Error in checking locations\");\n                            console.error(JSON.stringify(err));\n                            i--;\n                            if (i == 0) {\n                                def.resolve(\"done\");\n                            }\n                        });\n                    }\n                }\n                return def.promise;\n            }\n            var deleteUserMarkers = function (dauser_id) {\n                for (marker in $rootScope.markers) {\n                    if ($rootScope.markers[marker]) {\n                        if ($rootScope.markers[marker].user_id == dauser_id) {\n                            $rootScope.markers[marker].setMap(null);\n                            $rootScope.markers.splice(marker, 1);\n                        }\n                    } else {\n                        $rootScope.markers.splice(marker, 1);\n                    }\n                }\n            }\n            var hideAllActiveMarkers = function () {\n                hideMarkers($rootScope.markers);\n                hideAllPolylines();\n            }\n            var hideMarkers = function (damarkers) {\n                for (marker in damarkers) {\n                    if (damarkers[marker]) {\n                        damarkers[marker].setMap(null);\n                    }\n                }\n            }\n            var clearTemps = function () {\n                if ($rootScope.tempMarkers) {\n                    for (marker in $rootScope.tempMarkers) {\n                        if ($rootScope.tempMarkers[marker]) {\n                            $rootScope.tempMarkers[marker].setMap(null);\n                        }\n                    }\n                    $rootScope.tempMarkers = [];\n                }\n                if ($rootScope.tempPolyline) {\n                    $rootScope.tempPolyline.setMap(null);\n                    $rootScope.tempPolyline = null;\n                }\n            }\n            var showAllActiveMarkers = function () {\n                showMarkers($rootScope.markers);\n                showAllPolylines();\n            }\n            var showMarkers = function (damarkers) {\n                for (marker in damarkers) {\n                    if (damarkers[marker]) {\n                        damarkers[marker].setMap($rootScope.map);\n                    }\n                }\n            }\n            var consoleLogMarkers = function (damarkers) {\n                for (marker in damarkers) {\n                    if (damarkers[marker]) {\n                        console.log(\"id: \" + damarkers[marker].id);\n                        console.log(\"speed: \" + damarkers[marker].speed);\n                        console.log(\"activity: \" + damarkers[marker].activity);\n                        console.log(\"battery: \" + damarkers[marker].battery);\n                        console.log(\"lat: \" + damarkers[marker].lat);\n                        console.log(\"long: \" + damarkers[marker].long);\n                        console.log(\"name: \" + damarkers[marker].name);\n                        console.log(\"trip: \" + damarkers[marker].trip);\n                        console.log(\"type: \" + damarkers[marker].type);\n                        console.log(\"user_id: \" + damarkers[marker].user_id);\n                        console.log(\"report_time: \" + damarkers[marker].report_time);\n                    } else {\n                        console.log(\"Marker is null: \" + marker);\n                        console.log(damarkers[marker]);\n                    }\n\n                }\n            }\n            var getMarker = function (daid) {\n                console.log($rootScope.markers.length);\n                for (marker in $rootScope.markers) {\n                    console.log(\"Comparing markers\");\n                    if ($rootScope.markers[marker]) {\n                        console.log($rootScope.markers[marker].id);\n                        console.log(daid);\n                        if ($rootScope.markers[marker].id == daid) {\n                            console.log(\"Marker found, returning now\");\n                            return $rootScope.markers[marker];\n                        }\n                    } else {\n                        $rootScope.markers.splice(marker, 1);\n                    }\n\n                }\n                return null;\n            }\n\n            var checkLocationExists = function (location) {\n                var def = $q.defer();\n                console.log(\"Checking database for location: \" + location.id);\n                var found = false;\n                for (item in $rootScope.markers) {\n                    if ($rootScope.markers[item].id == location.id) {\n                        found = true;\n                    }\n                }\n                if (found) {\n                    location.status = true;\n                    console.log(\"Location exists: \");\n                    var marker = getUserMarker(location.user_id);\n                    if (marker) {\n                        console.log(\"User Marker Found\");\n                        if (marker.id >= location.id) {\n                            console.log(\"User Marker older\");\n                        } else {\n                            console.log(\"User Marker newer\");\n                            addToUserPolyline(location);\n                        }\n                    } else {\n                        console.log(\"Marker does not exist\");\n                        addToUserPolyline(location);\n                    }\n                    def.resolve(location);\n                } else {\n                    location.status = true;\n\n                    console.log(\"Location does not exists\");\n                    addToUserPolyline(location);\n                }\n                return def.promise;\n            };\n            var contactTrips = function (user_id, page, per_page) {\n                var offset = (page - 1) * per_page;\n                console.log(\"Trying sql contactTrips not implemented yet\");\n\n            };\n            var contactTripsCount = function (user_id) {\n                console.log(\"Trying sql user trips not implemented yet\");\n                var query = \"SELECT COUNT(id) as total FROM locations where user_id = ?  group by trip\";\n            };\n            var displayTrip = function (res) {\n                var flightPlanCoordinates = [\n                ];\n                var container;\n                if ($rootScope.tempMarkers) {\n                    hideMarkers($rootScope.tempMarkers);\n\n                }\n                $rootScope.tempMarkers = [];\n                console.log(\"Showing markers: \" + res.length);\n                console.log(JSON.stringify(res));\n                var coords;\n                var trip;\n                var user;\n                for (i = 0; i < res.length; i++) {\n                    if (res[i]) {\n                        coords = new google.maps.LatLng(res[i].lat, res[i].long);\n                        console.log(\"Showing marker: \");\n                        trip = res[i].trip;\n                        user = res[i].user_id;\n                        marker = createMarker(res[i], true);\n                        $rootScope.tempMarkers.push(marker);\n                        flightPlanCoordinates.push(coords);\n                        container = res[i];\n                    }\n                }\n                $rootScope.contactIdTrip = user;\n                $rootScope.contactTrip = trip;\n                setCenterMap(coords.lat(), coords.lng());\n                var flightPath = new google.maps.Polyline({\n                    path: flightPlanCoordinates,\n                    geodesic: true,\n                    strokeColor: '#FF0000',\n                    strokeOpacity: 1.0,\n                    strokeWeight: 2,\n                    user_id: container.user_id,\n                    name: container.name,\n                    status: \"closed\",\n                });\n                if ($rootScope.tempPolyline) {\n                    $rootScope.tempPolyline.setMap(null);\n                    $rootScope.tempPolyline = null;\n                }\n                flightPath.setMap($rootScope.map);\n                $rootScope.tempPolyline = flightPath;\n            };\n\n            var contactTripLocations = function (user_id, trip_id) {\n                console.log(\"contact trip locations not implemented at present: \" + user_id + \" trip: \" + trip_id);\n\n            };\n            var updateLocations = function () {\n                console.log(\"Updating locations\");\n                if ($rootScope.tracking) {\n                    console.log(\"rootscope tracking true\");\n                    if ($rootScope.mapSemaphore) {\n                        console.log(\"rootscope mapsemaphore true\");\n                        $rootScope.mapSemaphore = false;\n                        var lastLocation = $rootScope.lastLocation;\n                        var dapage = 1;\n                        var where = \"?page=\" + dapage + \"&id_after=\" + lastLocation;\n                        getServerLocations(where, lastLocation);\n                    } else {\n                        checkUnknownsMarker();\n                    }\n                } else {\n                    checkUnknownsMarker();\n                }\n\n            }\n            var saveTrip = function (trip) {\n                console.log(\"saveTrip: \");\n                console.log(JSON.stringify(trip));\n                LocationService.getLocationsTrip(trip)\n                        .then(function (data) {\n                            var pins = data.data;\n                            console.log(\"Locations received from server: \" + pins.length);\n                            console.log(JSON.stringify(pins));\n                            checkMarkers(pins);\n                            if (data.page < data.last_page) {\n                                if (data.page == 4) {\n                                    $rootScope.$broadcast('receivedTripDetail', {trigger_id: trip.user_id});\n                                    return;\n                                } else {\n                                    trip.page = data.page + 1;\n                                    saveTrip(trip);\n                                }\n\n                            } else {\n                                $rootScope.$broadcast('receivedTripDetail', {trigger_id: trip.user_id});\n                            }\n\n                        },\n                                function (data) {\n                                    console.log(data);\n                                });\n            }\n            var getServerLocations = function (where, idafter) {\n                LocationService.shared(where).then(function (data) {\n                    if (data.total == 0) {\n                        checkUnknownsMarker();\n                    } else {\n                        var pins = data.data;\n                        pins.reverse();\n                        checkMarkers(pins).then(function (data) {\n                            $rootScope.mapSharedLoaded = true;\n                        },\n                                function (data) {\n                                    console.log(data);\n                                });\n                        if (data.page < data.last_page) {\n                            var dapage = data.page + 1;\n                            var where = \"?page=\" + dapage + \"&id_after=\" + idafter;\n                            getServerLocations(where, idafter);\n                        } else {\n                            $rootScope.mapSemaphore = true;\n                            setTimeout(function () {\n                                console.log(\"Timeout Triggered\");\n                                updateLocations();\n                            }, $rootScope.sharedTimeout);\n                        }\n                    }\n                },\n                        function (data) {\n                            console.log(data);\n                        });\n            }\n            return {\n                createMarker: createMarker,\n                clearTemps: clearTemps,\n                createMap: createMap,\n                getNearbyMerchants: getNearbyMerchants,\n                contactTripsCount: contactTripsCount,\n                deleteUserObjects: deleteUserObjects,\n                deleteUserMarkers: deleteUserMarkers,\n                getUserPolyline: getUserPolyline,\n                saveTrip: saveTrip,\n                checkMarkers: checkMarkers,\n                contactTripLocations: contactTripLocations,\n                contactTrips: contactTrips,\n                consoleLogMarkers: consoleLogMarkers,\n                getMarker: getMarker,\n                hideAllActiveMarkers: hideAllActiveMarkers,\n                hideMarkers: hideMarkers,\n                showAllActiveMarkers: showAllActiveMarkers,\n                showMarkers: showMarkers,\n                updateLocations: updateLocations,\n                getMarkers: getMarkers,\n                getUserMarker: getUserMarker,\n                displayTrip: displayTrip,\n                addToUnknowns: addToUnknowns,\n                removeFromUnknowns: removeFromUnknowns,\n                setActive: setActive,\n                checkActive: checkActive,\n                postMap: postMap\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tYXBEYXNoLmpzP2RhYmUiXSwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2Jlc2FmZScpXG4gICAgICAgIC5mYWN0b3J5KCdNYXBEYXNoU2VydmljZScsWyckcScsICckcm9vdFNjb3BlJywgJ0xvY2F0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJHJvb3RTY29wZSwgTG9jYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgICAgICB2YXIgbXlMYXRsbmc7XG4gICAgICAgICAgICB2YXIgbWFwT3B0aW9ucztcbiAgICAgICAgICAgICRyb290U2NvcGUubWFwO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5pY29ucGF0aCA9IFwiaHR0cDovL2hvb3ZlcnQuY29tL2ltYWdlcy9pY29uc1wiO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5tZWljb24gPSBcIndhc3Auc3ZnXCI7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzID0gW107XG4gICAgICAgICAgICB2YXIgaW5mb1dpbmRvdztcblxuICAgICAgICAgICAgdmFyIGNyZWF0ZU1hcCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhbGVuZ3RoID0gJHJvb3RTY29wZS5tYXJrZXJzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgem9vbSA9IDEyO1xuICAgICAgICAgICAgICAgIHZhciBteUxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoNC43MDQyOTYsIC03NC4wNzM3NzUpO1xuXG4gICAgICAgICAgICAgICAgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyOiBteUxhdGxuZyxcbiAgICAgICAgICAgICAgICAgICAgem9vbTogem9vbSxcbiAgICAgICAgICAgICAgICAgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudCksIG1hcE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ID09IFwibWFwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcExvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2VtYXBob3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHJldHVybiBtYXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2V0Q2VudGVyTWFwID0gZnVuY3Rpb24gKGxhdCwgbG9uZykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBtYXAgY2VudGVyXCIpO1xuICAgICAgICAgICAgICAgIG15TGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXQsIGxvbmcpO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcCkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcC5zZXRab29tKDE1KTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAuc2V0Q2VudGVyKG15TGF0bG5nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TWFya2VycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5tYXJrZXJzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBnZXRVc2VyTWFya2VyID0gZnVuY3Rpb24gKGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIudXNlcl9pZCA9PSBwYXJzZUludChkYXVzZXJfaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGZpbmRVc2VySW5Qb2x5bGluZSA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGdldFVzZXJQb2x5bGluZSA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGFkZFRvVXNlclBvbHlsaW5lID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImFkZCB1c2VyIHRvIHBvbHlsaW5lXCIpO1xuICAgICAgICAgICAgICAgIHJlbW92ZUZyb21Vbmtub3ducyhpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgIGlmIChpbmZvLmlzbGFzdCA9PSBcIjFcIikge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVVc2VyT2JqZWN0cyhpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb29yZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGluZm8ubGF0LCBpbmZvLmxvbmcpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9seSA9IGZpbmRVc2VySW5Qb2x5bGluZShpbmZvLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9seSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlVXNlck1hcmtlcnMoaW5mby51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicG9zIGFkZGVkIHRvIGV4aXN0aW5nIHBvbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHBvbHkuZ2V0UGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoKGNvb3Jkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5zdGF0dXMgPT0gXCJlbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkuc3RhdHVzID0gXCJlbWVyZ2VuY3lcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcG9seSA9IG5ldyBnb29nbGUubWFwcy5Qb2x5bGluZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjMDAwMDAwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IGluZm8udXNlcl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBpbmZvLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBwb2x5LmdldFBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChjb29yZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUucm9vdE1hcE1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2x5LnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbHkuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJuZXcgcG9seSBjcmVhdGVkIGFuZCBwb3MgYWRkZWQ6IFwiICsgcG9seS51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzLnB1c2gocG9seSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmZvLm93bmVyX3R5cGUgPSBcInVzZXJcIjtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tBY3RpdmUoaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBhIG5ldyBtYXJrZXIgYXQgdGhlIG5ldyBwbG90dGVkIHBvaW50IG9uIHRoZSBwb2x5bGluZS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IGNyZWF0ZU1hcmtlcihpbmZvLCAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnB1c2gobWFya2VyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2hvd0FsbFBvbHlsaW5lcyA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzW3BvbHlsaW5lXS5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2hvd0FsbE1lcmNoYW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLm1lcmNoYW50cykge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1lcmNoYW50c1ttYXJrZXJdLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBzaG93QWxsUmVwb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLnJlcG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5yZXBvcnRzW21hcmtlcl0uc2V0TWFwKCRyb290U2NvcGUubWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEb25lIHNob3dpbmcgcmVwb3J0c1wiKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBjaGVja0FjdGl2ZSA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVjayBhY3RpdmU6IFwiICsgaW5mby5vd25lcl90eXBlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShpbmZvKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJBY3RpdmUgdHlwZTogXCIgKyAkcm9vdFNjb3BlLm1hcEFjdGl2ZVR5cGUgKyBcIiBpZDogXCIgKyAkcm9vdFNjb3BlLm1hcElkKTtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBBY3RpdmVUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcEFjdGl2ZVR5cGUgPSBpbmZvLm93bmVyX3R5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcElkKSB7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcElkID0gaW5mby51c2VyX2lkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBBY3RpdmVUeXBlID09IGluZm8ub3duZXJfdHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInR5cGUgdGhlIHNhbWUgbWFwaWQ6IFwiICsgJHJvb3RTY29wZS5tYXBJZCArIFwiIHVzZXI6IFwiICsgaW5mby51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFwQWN0aXZlVHlwZSA9PSBcIm1lXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEFjdGl2ZShcIm1lXCIsIC0xLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXBJZCA9PSBpbmZvLnVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0IGNlbnRlciBtYXAsIGlkIHRoZSBzYW1lXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGluZm8ubGF0LCBpbmZvLmxvbmcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGdldE5lYXJieU1lcmNoYW50cyA9IGZ1bmN0aW9uIChsYXQsIGxuZykge1xuICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHtsYXQ6IGxhdCwgbG9uZzogbG5nLCByYWRpdXM6ICRyb290U2NvcGUucmFkaXVzfTtcbiAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2UubWVyY2hhbnRzKGxvY2F0aW9uKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwaW5zID0gZGF0YS5tZXJjaGFudHM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXJjaGFudHMgcmVjZWl2ZWQgZnJvbSBzZXJ2ZXI6IFwiICsgcGlucy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGlucy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ05vIHRlbmVtb3MgaW5mb3JtYWNpb24gZGUgcHVudG9zIGRlIHNlZ3VyaWRhZCBlbiBlc2UgcHVudG8nKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuTWVyY2hhbnRzKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgbG9hZFVzZXJUcmlwID0gZnVuY3Rpb24gKHVzZXJfaWQsIHRyaXApIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY29udGFjdFRyaXBMb2NhdGlvbnModXNlcl9pZCwgdHJpcCkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9jYXRpb25zIGluIHRyaXA6IFwiICsgdHJpcCArIFwiIGNvdW50OiBcIiArIHJlcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXMpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VHJpcChyZXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ05vIGVuY3VlbnRybyBlc2UgdmlhamUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHBvc3RNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXAuYWRkTGlzdGVuZXIoJ2RibGNsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gZS5sYXRMbmc7XG4gICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChsb2NhdGlvbi5sYXQoKSwgbG9jYXRpb24ubG5nKCkpO1xuICAgICAgICAgICAgICAgICAgICBnZXROZWFyYnlNZXJjaGFudHMobG9jYXRpb24ubGF0KCksIGxvY2F0aW9uLmxuZygpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tZW1hcmtlcnBlbmRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZSBtYXJrZXIgd2FzIGNyZWF0ZWQgYmVmb3JlIG1hcCBzbyBsb2FkaW5nIG5vd1wiKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZW1hcmtlcnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZW1hcmtlci5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tZXJjaGFudHNwZW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibWVyY2hhbnRzIHdlcmUgY3JlYXRlZCBiZWZvcmUgbWFwIHNvIGxvYWRpbmcgbm93XCIpO1xuICAgICAgICAgICAgICAgICAgICBzaG93QWxsTWVyY2hhbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgIHNob3dBbGxSZXBvcnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWVyY2hhbnRzcGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRBY3RpdmUoJHJvb3RTY29wZS5tYXBBY3RpdmVUeXBlLCAkcm9vdFNjb3BlLm1hcElkLCBudWxsKTtcbiAgICAgICAgICAgICAgICBhbGVydCgnZG9ibGUgY2xpY2sgcGFyYSBlbmNvbnRyYXIgcHVudG9zIGRlIHNlZ3VyaWRhZCcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBzZXRBY3RpdmUgPSBmdW5jdGlvbiAodHlwZSwgaWQsIGxhdExuZykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBhcyBhY3RpdmU6IFwiICsgaWQgKyBcIiB0eXBlOiBcIiArIHR5cGUpO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwQWN0aXZlVHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBJZCA9IGlkO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIk1BUF9BQ1RJVkVfVFlQRVwiLCB0eXBlKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJNQVBfQUNUSVZFX0lEXCIsIGlkKTtcbiAgICAgICAgICAgICAgICBpZiAobGF0TG5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChsYXRMbmcubGF0KCksIGxhdExuZy5sbmcoKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlcmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IFwiZW1lcmdlbmN5XCIgfHwgdHlwZSA9PSBcInVzZXJcIiB8fCB0eXBlID09IFwibWVkaWNhbF9lbWVyZ2VuY3lcIiB8fCB0eXBlID09IFwibWVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50cmFja2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnJvb3RNYXBNYXJrZXJzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXRWaXNpYmxlVXNlcigkcm9vdFNjb3BlLm1hcElkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcmVkID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJ0cmlwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmlwX2lkID0gJHJvb3RTY29wZS5jb250YWN0VHJpcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWN0X2lkID0gJHJvb3RTY29wZS5jb250YWN0SWRUcmlwO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFVzZXJUcmlwKGNvbnRhY3RfaWQsIHRyaXBfaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjZW50ZXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlcnNsZW5ndGggPSAkcm9vdFNjb3BlLm1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlcnNsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9ICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJzbGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IG1hcmtlci5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBlLmxhdExuZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRBY3RpdmUoXCJ1c2VyXCIsIG1hcmtlci51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjZW50ZXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudHJhY2tpbmdBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSAhPSBcIm1lXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QWN0aXZlKFwibWVcIiwgLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGNsZWFuTWVyY2hhbnRzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3bWVyY2hhbnRzID0gZGF0YS5tZXJjaGFudHM7XG4gICAgICAgICAgICAgICAgZm9yIChtZXJjaGFudCBpbiBuZXdtZXJjaGFudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWVyY2hhbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3bWVyY2hhbnRzW21lcmNoYW50XS5pZCA9PSAkcm9vdFNjb3BlLm1lcmNoYW50c1ttYXJrZXJdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tZXJjaGFudHMucHVzaChjcmVhdGVNZXJjaGFudChuZXdtZXJjaGFudHNbbWVyY2hhbnRdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld3JlcG9ydHMgPSBkYXRhLnJlcG9ydHM7XG4gICAgICAgICAgICAgICAgZm9yIChyZXBvcnQgaW4gbmV3cmVwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gJHJvb3RTY29wZS5yZXBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3cmVwb3J0c1tyZXBvcnRdLmlkID09ICRyb290U2NvcGUucmVwb3J0c1ttYXJrZXJdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3cmVwb3J0c1tyZXBvcnRdLnR5cGUgPSBcIlJlcG9ydFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5yZXBvcnRzLnB1c2goY3JlYXRlTWVyY2hhbnQobmV3cmVwb3J0c1tyZXBvcnRdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlVXNlck9iamVjdHMgPSBmdW5jdGlvbiAoZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgZm9yIChwb2x5bGluZSBpbiAkcm9vdFNjb3BlLnBvbHlsaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdLnVzZXJfaWQgPSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVVc2VyTWFya2Vycygkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0udXNlcl9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5wb2x5bGluZXNbcG9seWxpbmVdLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnBvbHlsaW5lcy5zcGxpY2UocG9seWxpbmUsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBzZXRWaXNpYmxlVXNlciA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF1c2VyX2lkID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS51c2VyX2lkID0gZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhdExuZyA9ICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2VudGVyTWFwKGxhdExuZy5sYXQoKSwgbGF0TG5nLmxuZygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS5zZXRNYXAoJHJvb3RTY29wZS5tYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWVtYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXRMbmcgPSAkcm9vdFNjb3BlLm1lbWFya2VyLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRDZW50ZXJNYXAobGF0TG5nLmxhdCgpLCBsYXRMbmcubG5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgaGlkZUFsbFBvbHlsaW5lcyA9IGZ1bmN0aW9uIChkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHBvbHlsaW5lIGluICRyb290U2NvcGUucG9seWxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnBvbHlsaW5lc1twb2x5bGluZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUucG9seWxpbmVzW3BvbHlsaW5lXS5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGFkZFRvVW5rbm93bnMgPSBmdW5jdGlvbiAoZGF1c2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yICh1bmtub3duIGluICRyb290U2NvcGUuZm9sbG93aW5nVW5rbm93bikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5mb2xsb3dpbmdVbmtub3duW3Vua25vd25dID09IGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmZvbGxvd2luZ1Vua25vd24ucHVzaChkYXVzZXJfaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmVtb3ZlRnJvbVVua25vd25zID0gZnVuY3Rpb24gKGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGZvciAodW5rbm93biBpbiAkcm9vdFNjb3BlLmZvbGxvd2luZ1Vua25vd24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuZm9sbG93aW5nVW5rbm93blt1bmtub3duXSA9PSBkYXVzZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZpbmcgdXNlcjogXCIgKyBkYXVzZXJfaWQgKyBcIiBmcm9tIHVua25vd25zXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5mb2xsb3dpbmdVbmtub3duLnNwbGljZSh1bmtub3duLCAxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjaGVja1Vua25vd25zTWFya2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmZvbGxvd2luZ1Vua25vd24ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRyYWNraW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXBTZW1hcGhvcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVua25vd24gbWFya2Vyc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHJvb3RTY29wZS5mb2xsb3dpbmdVbmtub3duKSk7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lb3V0IFRyaWdnZXJlZCB1bmtub3duc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUxvY2F0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB9LCAkcm9vdFNjb3BlLnNoYXJlZFRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIlVTRVJfVFJBQ0tJTkdcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vIG9uZSBpcyBzaGFyaW5nIGxvY2F0aW9uIHdpdGggdXNlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdOb1NoYXJlcnMnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGNyZWF0ZU1hcmtlciA9IGZ1bmN0aW9uIChpbmZvLCBhY3RpdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlICYmICRyb290U2NvcGUubWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImluZm8gcmVjZWl2ZWQgaW4gbWFya2VyXCIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGluZm8pKTtcbiAgICAgICAgICAgICAgICB2YXIgcGluY2xhc3MgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChpbmZvLmFjdGl2aXR5ID09IFwic3RpbGxcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwibWFzY3VsaW5lLWF2YXRhci5zdmdcIjtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBzdGlsbFwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJvbl9mb290XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBvbiBmb290XCIpO1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicGVkZXN0cmlhbi13YWxraW5nLnN2Z1wiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5hY3Rpdml0eSA9PSBcImluX3ZlaGljbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwiY2FyLWZyb250LnN2Z1wiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5hY3Rpdml0eSA9PSBcIm9uX2JpY3ljbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwiY3ljbGluZy5zdmdcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8uYWN0aXZpdHkgPT0gXCJydW5uaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcInJ1bm5pbmcuc3ZnXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmFjdGl2aXR5ID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbnRybyBibGFua1wiKTtcbiAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcIm1hcC1waW4uc3ZnXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSWNvbiBwYXRoIG1hcmtlclwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLmljb25wYXRoICsgXCIvXCIgKyBwaW5jbGFzcyk7XG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICBpZDogaW5mby5pZCxcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogaW5mby51c2VyX2lkLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhpbmZvLmxhdCwgaW5mby5sb25nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBkYW1hcCxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgICAgICAgICAgcmVwb3J0X3RpbWU6IGluZm8ucmVwb3J0X3RpbWUsXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiBpbmZvLnNwZWVkLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eTogaW5mby5hY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgICAgYmF0dGVyeTogaW5mby5iYXR0ZXJ5LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogaW5mby5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIGlzbGFzdDogaW5mby5pc2xhc3QsXG4gICAgICAgICAgICAgICAgICAgIGljb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogJyNmZmZmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAkcm9vdFNjb3BlLmljb25wYXRoICsgXCIvXCIgKyBwaW5jbGFzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDM1LCAzNSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG1hcmtlci5jb250ZW50ID0gJzxkaXYgY2xhc3M9XCJpbmZvV2luZG93Q29udGVudFwiPicgKyBpbmZvLmlkICsgJyAnICsgaW5mby5uYW1lICsgJzxici8+PGEgb25DbGljaz1cIndpbmRvdy5vcGVuKFxcJ2h0dHA6Ly93YXplLnRvLz9sbD0nICsgaW5mby5sYXQgKyAnLCcgKyBpbmZvLmxvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICsgJyZuYXZpZ2F0ZT15ZXMnICsgJ1xcJyxcXCdfc3lzdGVtXFwnLFxcJ2xvY2F0aW9uPXllc1xcJyk7cmV0dXJuIGZhbHNlO1wiPldhemU8L2E+PGJyLz48YSBocmVmPVwidGVsOicgKyBpbmZvLnBob25lICsgJ1wiPicgKyBpbmZvLnBob25lICsgJzwvYT48L2Rpdj4nO1xuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoJzxoMj4nICsgbWFya2VyLnJlcG9ydF90aW1lICsgJzwvaDI+JyArIG1hcmtlci5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKCRyb290U2NvcGUubWFwLCBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF0bG9uZyA9IG1hcmtlci5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBzZXRBY3RpdmUoXCJ1c2VyXCIsIG1hcmtlci51c2VyX2lkLCBsYXRsb25nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoaW5mby5zdGF0dXMgPT0gXCJlbWVyZ2VuY3lcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF0TG5nID0gbWFya2VyLmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHNldEFjdGl2ZShcImVtZXJnZW5jeVwiLCBpbmZvLnVzZXJfaWQsIGxhdExuZyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjcmVhdGVNZXJjaGFudCA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFwID0gJHJvb3RTY29wZS5tYXA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYXAgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1lcmNoYW50c3BlbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1lcmNoYW50IHBlbmRpbmcgZnJvbSBhZGRpbmcgdG8gbWFwXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGluY2xhc3MgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChpbmZvLnR5cGUgPT0gXCJwb2xpY2VcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicG9saWNlLXNoaWVsZC5zdmdcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8udHlwZSA9PSBcIm1lZGljYWxcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwibWVkaWMtc3VpdGNhc2Uuc3ZnXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLnR5cGUgPT0gXCJSZXBvcnRcIikge1xuICAgICAgICAgICAgICAgICAgICBwaW5jbGFzcyA9IFwicGluLnN2Z1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImljb246IFwiICsgJHJvb3RTY29wZS5pY29ucGF0aCArIFwiL1wiICsgcGluY2xhc3MgKyBcIiBmb3IgdHlwZTogXCIgKyBpbmZvLnR5cGUpO1xuICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZm8uaWQsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGluZm8ubGF0LCBpbmZvLmxvbmcpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IGRhbWFwLFxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJHJvb3RTY29wZS5pY29ucGF0aCArIFwiL1wiICsgcGluY2xhc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsT3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtYXJrZXIuY29udGVudCA9ICc8ZGl2IGNsYXNzPVwiaW5mb1dpbmRvd0NvbnRlbnRcIj4nICsgaW5mby50eXBlICsgJzxici8+PGEgY2xhc3M9XCJidXR0b24gaWNvbi1sZWZ0IGlvbi1pb3M3LXRlbGVwaG9uZSBidXR0b24tY2FsbSBidXR0b24tb3V0bGluZVwiIGhyZWY9XCJ0ZWw6KyAnICsgaW5mby50ZWxlcGhvbmUgKyAnXCI+JyArIGluZm8udGVsZXBob25lICsgJzwvYT48YnIvPicgKyBpbmZvLmFkZHJlc3MgKyAnPGJyLz48YSBvbkNsaWNrPVwid2luZG93Lm9wZW4oXFwnaHR0cDovL3dhemUudG8vP2xsPScgKyBpbmZvLmxhdCArICcsJyArIGluZm8ubG9uZyArICcmbmF2aWdhdGU9eWVzJyArICdcXCcsXFwnX3N5c3RlbVxcJyxcXCdsb2NhdGlvbj15ZXNcXCcpO3JldHVybiBmYWxzZTtcIj5XYXplPC9hPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgdmFyIHBpbmNsYXNzID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoaW5mby50eXBlID09IFwicG9saWNlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGluY2xhc3MgPSBcIm1hcC1pY29uLXBvbGljZVwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09IFwibWVkaWNhbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJtYXAtaWNvbi1oZWFsdGhcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8udHlwZSA9PSBcIlJlcG9ydFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpbmNsYXNzID0gXCJtYXAtaWNvbi1yZXBvcnRcIjtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLmNvbnRlbnQgPSAnPGRpdiBjbGFzcz1cImluZm9XaW5kb3dDb250ZW50XCI+JyArIGluZm8udHlwZSArICc8YnIvPicgKyBpbmZvLmFkZHJlc3MgKyAnPGJyLz48YSBvbkNsaWNrPVwid2luZG93Lm9wZW4oXFwnaHR0cDovL3dhemUudG8vP2xsPScgKyBpbmZvLmxhdCArICcsJyArIGluZm8ubG9uZyArICcmbmF2aWdhdGU9eWVzJyArICdcXCcsXFwnX3N5c3RlbVxcJyxcXCdsb2NhdGlvbj15ZXNcXCcpO3JldHVybiBmYWxzZTtcIj5XYXplPC9hPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRpbmcgbWVyY2hhbnRcIik7XG4gICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuXG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudCgnPGgyPicgKyBpbmZvLm5hbWUgKyAnPC9oMj4nICsgbWFya2VyLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4oJHJvb3RTY29wZS5tYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGVja01hcmtlcnMgPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKHRhcmdldCBpbiBpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvW3RhcmdldF0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmxhc3RMb2NhdGlvbiA8IGluZm9bdGFyZ2V0XS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubGFzdExvY2F0aW9uID0gaW5mb1t0YXJnZXRdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tMb2NhdGlvbkV4aXN0cyhpbmZvW3RhcmdldF0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKFwiZG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBpbiBjaGVja2luZyBsb2NhdGlvbnNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihKU09OLnN0cmluZ2lmeShlcnIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShcImRvbmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZVVzZXJNYXJrZXJzID0gZnVuY3Rpb24gKGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluICRyb290U2NvcGUubWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5tYXJrZXJzW21hcmtlcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS51c2VyX2lkID09IGRhdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMuc3BsaWNlKG1hcmtlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcmtlcnMuc3BsaWNlKG1hcmtlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGlkZUFsbEFjdGl2ZU1hcmtlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaGlkZU1hcmtlcnMoJHJvb3RTY29wZS5tYXJrZXJzKTtcbiAgICAgICAgICAgICAgICBoaWRlQWxsUG9seWxpbmVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGlkZU1hcmtlcnMgPSBmdW5jdGlvbiAoZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYW1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYXJrZXJzW21hcmtlcl0uc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNsZWFyVGVtcHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudGVtcE1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gJHJvb3RTY29wZS50ZW1wTWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudGVtcE1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcE1hcmtlcnNbbWFya2VyXS5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS50ZW1wUG9seWxpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wUG9seWxpbmUuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRlbXBQb2x5bGluZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNob3dBbGxBY3RpdmVNYXJrZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNob3dNYXJrZXJzKCRyb290U2NvcGUubWFya2Vycyk7XG4gICAgICAgICAgICAgICAgc2hvd0FsbFBvbHlsaW5lcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNob3dNYXJrZXJzID0gZnVuY3Rpb24gKGRhbWFya2Vycykge1xuICAgICAgICAgICAgICAgIGZvciAobWFya2VyIGluIGRhbWFya2Vycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGFtYXJrZXJzW21hcmtlcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFya2Vyc1ttYXJrZXJdLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29uc29sZUxvZ01hcmtlcnMgPSBmdW5jdGlvbiAoZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChtYXJrZXIgaW4gZGFtYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYW1hcmtlcnNbbWFya2VyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNwZWVkOiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLnNwZWVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWN0aXZpdHk6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0uYWN0aXZpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJiYXR0ZXJ5OiBcIiArIGRhbWFya2Vyc1ttYXJrZXJdLmJhdHRlcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJsYXQ6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0ubGF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9uZzogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5sb25nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibmFtZTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHJpcDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS50cmlwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHlwZTogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS50eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlcl9pZDogXCIgKyBkYW1hcmtlcnNbbWFya2VyXS51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVwb3J0X3RpbWU6IFwiICsgZGFtYXJrZXJzW21hcmtlcl0ucmVwb3J0X3RpbWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXJrZXIgaXMgbnVsbDogXCIgKyBtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGFtYXJrZXJzW21hcmtlcl0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0TWFya2VyID0gZnVuY3Rpb24gKGRhaWQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLm1hcmtlcnMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBmb3IgKG1hcmtlciBpbiAkcm9vdFNjb3BlLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb21wYXJpbmcgbWFya2Vyc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcmtlcnNbbWFya2VyXS5pZCA9PSBkYWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXJrZXIgZm91bmQsIHJldHVybmluZyBub3dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUubWFya2Vyc1ttYXJrZXJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5tYXJrZXJzLnNwbGljZShtYXJrZXIsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjaGVja0xvY2F0aW9uRXhpc3RzID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVja2luZyBkYXRhYmFzZSBmb3IgbG9jYXRpb246IFwiICsgbG9jYXRpb24uaWQpO1xuICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvciAoaXRlbSBpbiAkcm9vdFNjb3BlLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUubWFya2Vyc1tpdGVtXS5pZCA9PSBsb2NhdGlvbi5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5zdGF0dXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkxvY2F0aW9uIGV4aXN0czogXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gZ2V0VXNlck1hcmtlcihsb2NhdGlvbi51c2VyX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIE1hcmtlciBGb3VuZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXIuaWQgPj0gbG9jYXRpb24uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgTWFya2VyIG9sZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgTWFya2VyIG5ld2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFRvVXNlclBvbHlsaW5lKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTWFya2VyIGRvZXMgbm90IGV4aXN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9Vc2VyUG9seWxpbmUobG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5zdGF0dXMgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9jYXRpb24gZG9lcyBub3QgZXhpc3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICBhZGRUb1VzZXJQb2x5bGluZShsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY29udGFjdFRyaXBzID0gZnVuY3Rpb24gKHVzZXJfaWQsIHBhZ2UsIHBlcl9wYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IChwYWdlIC0gMSkgKiBwZXJfcGFnZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRyeWluZyBzcWwgY29udGFjdFRyaXBzIG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY29udGFjdFRyaXBzQ291bnQgPSBmdW5jdGlvbiAodXNlcl9pZCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHJ5aW5nIHNxbCB1c2VyIHRyaXBzIG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCJTRUxFQ1QgQ09VTlQoaWQpIGFzIHRvdGFsIEZST00gbG9jYXRpb25zIHdoZXJlIHVzZXJfaWQgPSA/ICBncm91cCBieSB0cmlwXCI7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGRpc3BsYXlUcmlwID0gZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIHZhciBmbGlnaHRQbGFuQ29vcmRpbmF0ZXMgPSBbXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnRlbXBNYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGhpZGVNYXJrZXJzKCRyb290U2NvcGUudGVtcE1hcmtlcnMpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcE1hcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgbWFya2VyczogXCIgKyByZXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXMpKTtcbiAgICAgICAgICAgICAgICB2YXIgY29vcmRzO1xuICAgICAgICAgICAgICAgIHZhciB0cmlwO1xuICAgICAgICAgICAgICAgIHZhciB1c2VyO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc1tpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29vcmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhyZXNbaV0ubGF0LCByZXNbaV0ubG9uZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgbWFya2VyOiBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmlwID0gcmVzW2ldLnRyaXA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gcmVzW2ldLnVzZXJfaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIgPSBjcmVhdGVNYXJrZXIocmVzW2ldLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcE1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmxpZ2h0UGxhbkNvb3JkaW5hdGVzLnB1c2goY29vcmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHJlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNvbnRhY3RJZFRyaXAgPSB1c2VyO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuY29udGFjdFRyaXAgPSB0cmlwO1xuICAgICAgICAgICAgICAgIHNldENlbnRlck1hcChjb29yZHMubGF0KCksIGNvb3Jkcy5sbmcoKSk7XG4gICAgICAgICAgICAgICAgdmFyIGZsaWdodFBhdGggPSBuZXcgZ29vZ2xlLm1hcHMuUG9seWxpbmUoe1xuICAgICAgICAgICAgICAgICAgICBwYXRoOiBmbGlnaHRQbGFuQ29vcmRpbmF0ZXMsXG4gICAgICAgICAgICAgICAgICAgIGdlb2Rlc2ljOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2VDb2xvcjogJyNGRjAwMDAnLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLjAsXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMixcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogY29udGFpbmVyLnVzZXJfaWQsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGNvbnRhaW5lci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFwiY2xvc2VkXCIsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUudGVtcFBvbHlsaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGVtcFBvbHlsaW5lLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wUG9seWxpbmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmbGlnaHRQYXRoLnNldE1hcCgkcm9vdFNjb3BlLm1hcCk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS50ZW1wUG9seWxpbmUgPSBmbGlnaHRQYXRoO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGNvbnRhY3RUcmlwTG9jYXRpb25zID0gZnVuY3Rpb24gKHVzZXJfaWQsIHRyaXBfaWQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbnRhY3QgdHJpcCBsb2NhdGlvbnMgbm90IGltcGxlbWVudGVkIGF0IHByZXNlbnQ6IFwiICsgdXNlcl9pZCArIFwiIHRyaXA6IFwiICsgdHJpcF9pZCk7XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdXBkYXRlTG9jYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRpbmcgbG9jYXRpb25zXCIpO1xuICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnRyYWNraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicm9vdHNjb3BlIHRyYWNraW5nIHRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyb290c2NvcGUgbWFwc2VtYXBob3JlIHRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm1hcFNlbWFwaG9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RMb2NhdGlvbiA9ICRyb290U2NvcGUubGFzdExvY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhcGFnZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBcIj9wYWdlPVwiICsgZGFwYWdlICsgXCImaWRfYWZ0ZXI9XCIgKyBsYXN0TG9jYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2ZXJMb2NhdGlvbnMod2hlcmUsIGxhc3RMb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja1Vua25vd25zTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjaGVja1Vua25vd25zTWFya2VyKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2F2ZVRyaXAgPSBmdW5jdGlvbiAodHJpcCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2F2ZVRyaXA6IFwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh0cmlwKSk7XG4gICAgICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldExvY2F0aW9uc1RyaXAodHJpcClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpbnMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2NhdGlvbnMgcmVjZWl2ZWQgZnJvbSBzZXJ2ZXI6IFwiICsgcGlucy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHBpbnMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja01hcmtlcnMocGlucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGFnZSA8IGRhdGEubGFzdF9wYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhZ2UgPT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdyZWNlaXZlZFRyaXBEZXRhaWwnLCB7dHJpZ2dlcl9pZDogdHJpcC51c2VyX2lkfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlwLnBhZ2UgPSBkYXRhLnBhZ2UgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZVRyaXAodHJpcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgncmVjZWl2ZWRUcmlwRGV0YWlsJywge3RyaWdnZXJfaWQ6IHRyaXAudXNlcl9pZH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTZXJ2ZXJMb2NhdGlvbnMgPSBmdW5jdGlvbiAod2hlcmUsIGlkYWZ0ZXIpIHtcbiAgICAgICAgICAgICAgICBMb2NhdGlvblNlcnZpY2Uuc2hhcmVkKHdoZXJlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRvdGFsID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrVW5rbm93bnNNYXJrZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaW5zID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGlucy5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja01hcmtlcnMocGlucykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2hhcmVkTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYWdlIDwgZGF0YS5sYXN0X3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGFwYWdlID0gZGF0YS5wYWdlICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBcIj9wYWdlPVwiICsgZGFwYWdlICsgXCImaWRfYWZ0ZXI9XCIgKyBpZGFmdGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFNlcnZlckxvY2F0aW9ucyh3aGVyZSwgaWRhZnRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUubWFwU2VtYXBob3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lb3V0IFRyaWdnZXJlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlTG9jYXRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJHJvb3RTY29wZS5zaGFyZWRUaW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNyZWF0ZU1hcmtlcjogY3JlYXRlTWFya2VyLFxuICAgICAgICAgICAgICAgIGNsZWFyVGVtcHM6IGNsZWFyVGVtcHMsXG4gICAgICAgICAgICAgICAgY3JlYXRlTWFwOiBjcmVhdGVNYXAsXG4gICAgICAgICAgICAgICAgZ2V0TmVhcmJ5TWVyY2hhbnRzOiBnZXROZWFyYnlNZXJjaGFudHMsXG4gICAgICAgICAgICAgICAgY29udGFjdFRyaXBzQ291bnQ6IGNvbnRhY3RUcmlwc0NvdW50LFxuICAgICAgICAgICAgICAgIGRlbGV0ZVVzZXJPYmplY3RzOiBkZWxldGVVc2VyT2JqZWN0cyxcbiAgICAgICAgICAgICAgICBkZWxldGVVc2VyTWFya2VyczogZGVsZXRlVXNlck1hcmtlcnMsXG4gICAgICAgICAgICAgICAgZ2V0VXNlclBvbHlsaW5lOiBnZXRVc2VyUG9seWxpbmUsXG4gICAgICAgICAgICAgICAgc2F2ZVRyaXA6IHNhdmVUcmlwLFxuICAgICAgICAgICAgICAgIGNoZWNrTWFya2VyczogY2hlY2tNYXJrZXJzLFxuICAgICAgICAgICAgICAgIGNvbnRhY3RUcmlwTG9jYXRpb25zOiBjb250YWN0VHJpcExvY2F0aW9ucyxcbiAgICAgICAgICAgICAgICBjb250YWN0VHJpcHM6IGNvbnRhY3RUcmlwcyxcbiAgICAgICAgICAgICAgICBjb25zb2xlTG9nTWFya2VyczogY29uc29sZUxvZ01hcmtlcnMsXG4gICAgICAgICAgICAgICAgZ2V0TWFya2VyOiBnZXRNYXJrZXIsXG4gICAgICAgICAgICAgICAgaGlkZUFsbEFjdGl2ZU1hcmtlcnM6IGhpZGVBbGxBY3RpdmVNYXJrZXJzLFxuICAgICAgICAgICAgICAgIGhpZGVNYXJrZXJzOiBoaWRlTWFya2VycyxcbiAgICAgICAgICAgICAgICBzaG93QWxsQWN0aXZlTWFya2Vyczogc2hvd0FsbEFjdGl2ZU1hcmtlcnMsXG4gICAgICAgICAgICAgICAgc2hvd01hcmtlcnM6IHNob3dNYXJrZXJzLFxuICAgICAgICAgICAgICAgIHVwZGF0ZUxvY2F0aW9uczogdXBkYXRlTG9jYXRpb25zLFxuICAgICAgICAgICAgICAgIGdldE1hcmtlcnM6IGdldE1hcmtlcnMsXG4gICAgICAgICAgICAgICAgZ2V0VXNlck1hcmtlcjogZ2V0VXNlck1hcmtlcixcbiAgICAgICAgICAgICAgICBkaXNwbGF5VHJpcDogZGlzcGxheVRyaXAsXG4gICAgICAgICAgICAgICAgYWRkVG9Vbmtub3duczogYWRkVG9Vbmtub3ducyxcbiAgICAgICAgICAgICAgICByZW1vdmVGcm9tVW5rbm93bnM6IHJlbW92ZUZyb21Vbmtub3ducyxcbiAgICAgICAgICAgICAgICBzZXRBY3RpdmU6IHNldEFjdGl2ZSxcbiAgICAgICAgICAgICAgICBjaGVja0FjdGl2ZTogY2hlY2tBY3RpdmUsXG4gICAgICAgICAgICAgICAgcG9zdE1hcDogcG9zdE1hcFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvbWFwRGFzaC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 42 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n\n        .service('Merchants',['$q', '$http', function ($q, $http) {\n\n            var getMerchants = function (where) {\n                var url = \"/api/merchants\";\n                if (where) {\n                    url = url + \"?\" + where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n            var getMerchantsUser = function (where) {\n                var url = \"/api/user/merchants\";\n                if (where) {\n                    url = url + \"?\" + where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n            var getReports = function (where) {\n                var url = \"/api/reports\";\n                if (where) {\n                    url = url + \"?\" + where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n            var getMerchantsCoverage = function (data) {\n                var url = \"/api/private/merchants/coverage\";\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n            var getMerchantsNearby = function (data) {\n                var url = \"/api/private/merchants/nearby\";\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n            var getReportsNearby = function (data) {\n                var url = \"/api/private/reports/nearby\";\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url,\n                    params:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n            var getMerchantsPrivate = function (where) {\n                var url = \"/api/merchants\";\n                if (where) {\n                    url = url + \"?\" + where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n            }\n            var getStoreExport = function (data) {\n                var url = '/api/admin/merchant/orders' ;\n                var def = $q.defer();\n                $http({\n                    method: 'POST',\n                    url: url,\n                    data:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getStoreExport\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getStoreContent = function (data) {\n                var url = '/api/admin/merchant/content' ;\n                var def = $q.defer();\n                $http({\n                    method: 'POST',\n                    url: url,\n                    data:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getStoreExport\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            var searchMerchants = function (where) {\n                var url = \"/api/merchants/search\";\n                if (where) {\n                    url = url + \"?search=\" + where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get merchants\");\n                        });\n                return def.promise;\n\n            }\n\n            var saveMerchant = function (data) {\n                var def = $q.defer();\n                var url = \"/api/merchants\";\n                var method = \"POST\";\n                if (data.id) {\n                    var url = \"/api/merchants/\" + data.id;\n                    var method = \"PATCH\";\n                }\n                $http({\n                    method: method,\n                    url: url,\n                    data: data, // pass in data as strings\n                    headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to save/create merchant\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            var deleteMerchant = function (merchant_id) {\n                var def = $q.defer();\n                $http({\n                    method: 'DELETE',\n                    url: '/api/merchants/' + merchant_id\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to Delete Merchant\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n\n            return {\n                getMerchants: getMerchants,\n                getMerchantsNearby:getMerchantsNearby,\n                getReportsNearby:getReportsNearby,\n                getMerchantsUser:getMerchantsUser,\n                getReports:getReports,\n                getMerchantsCoverage: getMerchantsCoverage,\n                getMerchantsPrivate: getMerchantsPrivate,\n                saveMerchant: saveMerchant,\n                getStoreContent:getStoreContent,\n                getStoreExport:getStoreExport,\n                searchMerchants: searchMerchants,\n                deleteMerchant: deleteMerchant\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tZXJjaGFudHMuanM/OThlNCJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcblxuICAgICAgICAuc2VydmljZSgnTWVyY2hhbnRzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0TWVyY2hhbnRzID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9tZXJjaGFudHNcIjtcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/XCIgKyB3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRNZXJjaGFudHNVc2VyID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS91c2VyL21lcmNoYW50c1wiO1xuICAgICAgICAgICAgICAgIGlmICh3aGVyZSkge1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyBcIj9cIiArIHdoZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG1lcmNoYW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFJlcG9ydHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL3JlcG9ydHNcIjtcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/XCIgKyB3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRNZXJjaGFudHNDb3ZlcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9wcml2YXRlL21lcmNoYW50cy9jb3ZlcmFnZVwiO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczpkYXRhXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG1lcmNoYW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldE1lcmNoYW50c05lYXJieSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9wcml2YXRlL21lcmNoYW50cy9uZWFyYnlcIjtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6ZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRSZXBvcnRzTmVhcmJ5ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL3ByaXZhdGUvcmVwb3J0cy9uZWFyYnlcIjtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6ZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRNZXJjaGFudHNQcml2YXRlID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9IFwiL2FwaS9tZXJjaGFudHNcIjtcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/XCIgKyB3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBtZXJjaGFudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0U3RvcmVFeHBvcnQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9tZXJjaGFudC9vcmRlcnMnIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTpkYXRhXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0U3RvcmVFeHBvcnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTdG9yZUNvbnRlbnQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9tZXJjaGFudC9jb250ZW50JyA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6ZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFN0b3JlRXhwb3J0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hNZXJjaGFudHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gXCIvYXBpL21lcmNoYW50cy9zZWFyY2hcIjtcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsICsgXCI/c2VhcmNoPVwiICsgd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbWVyY2hhbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYXZlTWVyY2hhbnQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcIi9hcGkvbWVyY2hhbnRzXCI7XG4gICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IFwiUE9TVFwiO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcIi9hcGkvbWVyY2hhbnRzL1wiICsgZGF0YS5pZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IFwiUEFUQ0hcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9ICAvLyBzZXQgdGhlIGhlYWRlcnMgc28gYW5ndWxhciBwYXNzaW5nIGluZm8gYXMgZm9ybSBkYXRhIChub3QgcmVxdWVzdCBwYXlsb2FkKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNhdmUvY3JlYXRlIG1lcmNoYW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkZWxldGVNZXJjaGFudCA9IGZ1bmN0aW9uIChtZXJjaGFudF9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9tZXJjaGFudHMvJyArIG1lcmNoYW50X2lkXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gRGVsZXRlIE1lcmNoYW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0TWVyY2hhbnRzOiBnZXRNZXJjaGFudHMsXG4gICAgICAgICAgICAgICAgZ2V0TWVyY2hhbnRzTmVhcmJ5OmdldE1lcmNoYW50c05lYXJieSxcbiAgICAgICAgICAgICAgICBnZXRSZXBvcnRzTmVhcmJ5OmdldFJlcG9ydHNOZWFyYnksXG4gICAgICAgICAgICAgICAgZ2V0TWVyY2hhbnRzVXNlcjpnZXRNZXJjaGFudHNVc2VyLFxuICAgICAgICAgICAgICAgIGdldFJlcG9ydHM6Z2V0UmVwb3J0cyxcbiAgICAgICAgICAgICAgICBnZXRNZXJjaGFudHNDb3ZlcmFnZTogZ2V0TWVyY2hhbnRzQ292ZXJhZ2UsXG4gICAgICAgICAgICAgICAgZ2V0TWVyY2hhbnRzUHJpdmF0ZTogZ2V0TWVyY2hhbnRzUHJpdmF0ZSxcbiAgICAgICAgICAgICAgICBzYXZlTWVyY2hhbnQ6IHNhdmVNZXJjaGFudCxcbiAgICAgICAgICAgICAgICBnZXRTdG9yZUNvbnRlbnQ6Z2V0U3RvcmVDb250ZW50LFxuICAgICAgICAgICAgICAgIGdldFN0b3JlRXhwb3J0OmdldFN0b3JlRXhwb3J0LFxuICAgICAgICAgICAgICAgIHNlYXJjaE1lcmNoYW50czogc2VhcmNoTWVyY2hhbnRzLFxuICAgICAgICAgICAgICAgIGRlbGV0ZU1lcmNoYW50OiBkZWxldGVNZXJjaGFudFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvbWVyY2hhbnRzLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 43 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Modals', ['$mdToast', '$mdDialog', function ($mdToast, $mdDialog) {\n\n                var getAddressesPopup = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Addresses', '$rootScope', function ($scope, $mdDialog, Addresses, $rootScope) {\n                                $scope.addresses = [];\n\n                                $scope.getAddresses = function () {\n                                    if ($rootScope.addresses && $rootScope.addresses.length > 0) {\n                                        $scope.addresses = $rootScope.addresses;\n                                    } else {\n                                        Addresses.getAddresses().then(function (data) {\n                                            $scope.addresses = data.addresses;\n\n                                        },\n                                                function (data) {\n\n                                                });\n                                    }\n\n                                }\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n\n                                $scope.selectAddress = function (address) {\n                                    $mdDialog.hide(address);\n                                };\n                                $scope.getAddresses();\n                            }],\n                        templateUrl: '/templates/addressList.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getExportPopup = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.enviar = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/exportConfirmation.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getAppPopup = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Addresses', '$rootScope', function ($scope, $mdDialog, Addresses, $rootScope) {\n                                $scope.addresses = [];\n\n                                $scope.selectPlatform = function (platform) {\n                                    $mdDialog.hide(platform);\n\n\n                                }\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                            }],\n                        templateUrl: '/templates/mobileApp.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getMerchantsPopup = function (category) {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Merchants', '$rootScope', function ($scope, $mdDialog, Merchants, $rootScope) {\n                                $scope.merchants = [];\n\n                                $scope.getMerchants = function () {\n                                    var container = null;\n                                    if (category) {\n                                        container = {lat: $rootScope.shippingAddress.lat, long: $rootScope.shippingAddress.long, category: category};\n                                    } else {\n                                        container = {lat: $rootScope.shippingAddress.lat, long: $rootScope.shippingAddress.long};\n                                    }\n                                    Merchants.getMerchantsCoverage(container).then(function (data) {\n                                        $scope.merchants = data.data;\n                                    },\n                                            function (data) {\n                                            });\n                                }\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n\n                                $scope.selectMerchant = function (merchant) {\n                                    $mdDialog.hide(merchant);\n                                };\n                                $scope.getMerchants();\n                            }],\n                        templateUrl: '/templates/merchantsList.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getQuestionairePopup = function (questions) {\n                    return {\n                        controller: ['$scope', '$mdDialog', 'Merchants', '$rootScope', function ($scope, $mdDialog) {\n                                $scope.questions = questions;\n\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.checkValue = function (item) {\n                                    console.log(\"Checking: \", item);\n                                };\n\n                                $scope.save = function () {\n                                    $mdDialog.hide($scope.questions);\n                                };\n                            }],\n                        templateUrl: '/templates/questionaire.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n\n                var getLocationPrompt = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.answer = function (answer) {\n                                    $mdDialog.hide(answer);\n                                };\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/locationPrompt.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getCoveragePrompt = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.answer = function (answer) {\n                                    $mdDialog.hide(answer);\n                                };\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/outOfCoverage.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: false,\n                    }\n                }\n                var getLocationExtPrompt = function () {\n                    return {\n                        controller: ['$scope', '$mdDialog', function ($scope, $mdDialog) {\n                                $scope.answer = function (answer) {\n                                    $mdDialog.hide(answer);\n                                };\n                                $scope.cancel = function () {\n                                    $mdDialog.cancel();\n                                };\n                                $scope.hide = function () {\n                                    $mdDialog.hide();\n                                };\n                            }],\n                        templateUrl: '/templates/locationExtPrompt.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                    }\n                }\n                var getBookingPrompt = function (params) {\n                    return {\n                        controller: 'BookingCtrl',\n                        resolve: {\n                            getParams: function () {\n                                return params;\n                            }\n                        },\n                        templateUrl: '/templates/booking.html',\n                        // Appending dialog to document.body to cover sidenav in docs app\n                        // Modal dialogs should fully cover application to prevent interaction outside of dialog\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                        backdrop  : 'static',\n                        keyboard  : false\n                    }\n                }\n                var showToast = function (message, parent) {\n                    if (message == \"CLEAR_CART\") {\n                        message = \"Debes vaciar tu carro para esa compra\";\n                    }\n                    var pinTo = getToastPosition();\n                    var toast = $mdToast.simple()\n                            .textContent(message)\n                            .position(pinTo)\n                            .hideDelay(3000)\n                    if (parent) {\n                        toast = $mdToast.simple()\n                                .textContent(message)\n                                .position(pinTo)\n                                .parent(parent)\n                                .hideDelay(3000)\n                    }\n\n                    $mdToast.show(toast);\n                }\n                var last = {\n                    bottom: false,\n                    top: true,\n                    left: false,\n                    right: true\n                };\n\n                var toastPosition = angular.extend({}, last);\n\n                var getToastPosition = function () {\n                    sanitizePosition();\n\n                    return Object.keys(toastPosition)\n                            .filter(function (pos) {\n                                return toastPosition[pos];\n                            }).join(' ');\n                };\n                function sanitizePosition() {\n                    var current = toastPosition;\n\n                    if (current.bottom && last.top) {\n                        current.top = false;\n                    }\n                    if (current.top && last.bottom) {\n                        current.bottom = false;\n                    }\n                    if (current.right && last.left) {\n                        current.left = false;\n                    }\n                    if (current.left && last.right) {\n                        current.right = false;\n                    }\n\n                    last = angular.extend({}, current);\n                }\n                var showLoader = function () {\n                    $mdDialog.show({\n                        controller: function () {\n\n                        },\n                        template: '<md-dialog style=\"background-color:transparent;box-shadow:none\">' +\n                                '<div layout=\"row\" layout-sm=\"column\" layout-align=\"center center\" aria-label=\"wait\" style=\"overflow:hidden\">' +\n                                '<md-progress-circular md-mode=\"indeterminate\" ></md-progress-circular>' +\n                                '</div>' +\n                                '</md-dialog>',\n                        parent: angular.element(document.body),\n                        clickOutsideToClose: true,\n                        fullscreen: false\n                    })\n                            .then(function (answer) {\n\n                            });\n                }\n                var hideLoader = function () {\n                    $mdDialog.hide()\n                            .then(function (answer) {\n\n                            });\n                }\n                var turnObjectToUrl = function (params, theUrl) {\n                    if (theUrl.includes(\"?\")) {\n                        theUrl = theUrl.split(\"?\")[0];\n                    }\n                    var first = true;\n                    for (var k in params) {\n                        if (params.hasOwnProperty(k)) {\n                            if (first) {\n                                theUrl += \"?\" + k + \"=\" + params[k];\n                                first = false;\n                            } else {\n                                theUrl += \"&\" + k + \"=\" + params[k];\n                            }\n                        }\n                    }\n                    return theUrl;\n                }\n                getAllUrlParams = function (url) {\n                    // get query string from url (optional) or window\n                    var queryString = url ? url.split('?')[1] : window.location.search.slice(1);\n                    console.log(\"Query string\",queryString);\n                    // we'll store the parameters here\n                    var obj = null;\n\n                    // if query string exists\n                    if (queryString) {\n                        obj = {};\n                        // stuff after # is not part of query string, so get rid of it\n                        queryString = queryString.split('#')[0];\n\n                        // split our query string into its component parts\n                        var arr = queryString.split('&');\n\n                        for (var i = 0; i < arr.length; i++) {\n                            // separate the keys and the values\n                            var a = arr[i].split('=');\n\n                            // set parameter name and value (use 'true' if empty)\n                            var paramName = a[0];\n                            var paramValue = typeof (a[1]) === 'undefined' ? true : a[1];\n\n                            // (optional) keep case consistent\n                            paramName = paramName.toLowerCase();\n                            if (typeof paramValue === 'string')\n                                paramValue = paramValue.toLowerCase();\n\n                            // if the paramName ends with square brackets, e.g. colors[] or colors[2]\n                            if (paramName.match(/\\[(\\d+)?\\]$/)) {\n\n                                // create key if it doesn't exist\n                                var key = paramName.replace(/\\[(\\d+)?\\]/, '');\n                                if (!obj[key])\n                                    obj[key] = [];\n\n                                // if it's an indexed array e.g. colors[2]\n                                if (paramName.match(/\\[\\d+\\]$/)) {\n                                    // get the index value and add the entry at the appropriate position\n                                    var index = /\\[(\\d+)\\]/.exec(paramName)[1];\n                                    obj[key][index] = paramValue;\n                                } else {\n                                    // otherwise add the value to the end of the array\n                                    obj[key].push(paramValue);\n                                }\n                            } else {\n                                // we're dealing with a string\n                                if (!obj[paramName]) {\n                                    // if it doesn't exist, create property\n                                    obj[paramName] = paramValue;\n                                } else if (obj[paramName] && typeof obj[paramName] === 'string') {\n                                    // if property does exist and it's a string, convert it to an array\n                                    obj[paramName] = [obj[paramName]];\n                                    obj[paramName].push(paramValue);\n                                } else {\n                                    // otherwise add the property\n                                    obj[paramName].push(paramValue);\n                                }\n                            }\n                        }\n                    }\n                    return obj;\n                }\n\n\n                return {\n                    getAddressesPopup: getAddressesPopup,\n                    getExportPopup: getExportPopup,\n                    getBookingPrompt:getBookingPrompt,\n                    getLocationPrompt: getLocationPrompt,\n                    getLocationExtPrompt: getLocationExtPrompt,\n                    getMerchantsPopup: getMerchantsPopup,\n                    getQuestionairePopup: getQuestionairePopup,\n                    showToast: showToast,\n                    getAppPopup: getAppPopup,\n                    getCoveragePrompt:getCoveragePrompt,\n                    showLoader: showLoader,\n                    turnObjectToUrl: turnObjectToUrl,\n                    hideLoader: hideLoader,\n                    getAllUrlParams: getAllUrlParams\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9tb2RhbHMuanM/MzUwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgLnNlcnZpY2UoJ01vZGFscycsIFsnJG1kVG9hc3QnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24gKCRtZFRvYXN0LCAkbWREaWFsb2cpIHtcblxuICAgICAgICAgICAgICAgIHZhciBnZXRBZGRyZXNzZXNQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdBZGRyZXNzZXMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZywgQWRkcmVzc2VzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuYWRkcmVzc2VzICYmICRyb290U2NvcGUuYWRkcmVzc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkcmVzc2VzID0gJHJvb3RTY29wZS5hZGRyZXNzZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFkZHJlc3Nlcy5nZXRBZGRyZXNzZXMoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBkYXRhLmFkZHJlc3NlcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RBZGRyZXNzID0gZnVuY3Rpb24gKGFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGFkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QWRkcmVzc2VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvYWRkcmVzc0xpc3QuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgZGlhbG9ncyBzaG91bGQgZnVsbHkgY292ZXIgYXBwbGljYXRpb24gdG8gcHJldmVudCBpbnRlcmFjdGlvbiBvdXRzaWRlIG9mIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRFeHBvcnRQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZW52aWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9leHBvcnRDb25maXJtYXRpb24uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgZGlhbG9ncyBzaG91bGQgZnVsbHkgY292ZXIgYXBwbGljYXRpb24gdG8gcHJldmVudCBpbnRlcmFjdGlvbiBvdXRzaWRlIG9mIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRBcHBQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdBZGRyZXNzZXMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZywgQWRkcmVzc2VzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRyZXNzZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0UGxhdGZvcm0gPSBmdW5jdGlvbiAocGxhdGZvcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKHBsYXRmb3JtKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbW9iaWxlQXBwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vZGFsIGRpYWxvZ3Mgc2hvdWxkIGZ1bGx5IGNvdmVyIGFwcGxpY2F0aW9uIHRvIHByZXZlbnQgaW50ZXJhY3Rpb24gb3V0c2lkZSBvZiBkaWFsb2dcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0TWVyY2hhbnRzUG9wdXAgPSBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdNZXJjaGFudHMnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZywgTWVyY2hhbnRzLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXJjaGFudHMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSB7bGF0OiAkcm9vdFNjb3BlLnNoaXBwaW5nQWRkcmVzcy5sYXQsIGxvbmc6ICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxvbmcsIGNhdGVnb3J5OiBjYXRlZ29yeX07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHtsYXQ6ICRyb290U2NvcGUuc2hpcHBpbmdBZGRyZXNzLmxhdCwgbG9uZzogJHJvb3RTY29wZS5zaGlwcGluZ0FkZHJlc3MubG9uZ307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXJjaGFudHMuZ2V0TWVyY2hhbnRzQ292ZXJhZ2UoY29udGFpbmVyKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lcmNoYW50cyA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RNZXJjaGFudCA9IGZ1bmN0aW9uIChtZXJjaGFudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUobWVyY2hhbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TWVyY2hhbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbWVyY2hhbnRzTGlzdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldFF1ZXN0aW9uYWlyZVBvcHVwID0gZnVuY3Rpb24gKHF1ZXN0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ01lcmNoYW50cycsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbnMgPSBxdWVzdGlvbnM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGVja1ZhbHVlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2tpbmc6IFwiLCBpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCRzY29wZS5xdWVzdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3F1ZXN0aW9uYWlyZS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0TG9jYXRpb25Qcm9tcHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckbWREaWFsb2cnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbWREaWFsb2cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlciA9IGZ1bmN0aW9uIChhbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGFuc3dlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9sb2NhdGlvblByb21wdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldENvdmVyYWdlUHJvbXB0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24gKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbiAoYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShhbnN3ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvb3V0T2ZDb3ZlcmFnZS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb2RhbCBkaWFsb2dzIHNob3VsZCBmdWxseSBjb3ZlciBhcHBsaWNhdGlvbiB0byBwcmV2ZW50IGludGVyYWN0aW9uIG91dHNpZGUgb2YgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRMb2NhdGlvbkV4dFByb21wdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uICgkc2NvcGUsICRtZERpYWxvZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24gKGFuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2xvY2F0aW9uRXh0UHJvbXB0Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vZGFsIGRpYWxvZ3Mgc2hvdWxkIGZ1bGx5IGNvdmVyIGFwcGxpY2F0aW9uIHRvIHByZXZlbnQgaW50ZXJhY3Rpb24gb3V0c2lkZSBvZiBkaWFsb2dcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZ2V0Qm9va2luZ1Byb21wdCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCb29raW5nQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9ib29raW5nLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vZGFsIGRpYWxvZ3Mgc2hvdWxkIGZ1bGx5IGNvdmVyIGFwcGxpY2F0aW9uIHRvIHByZXZlbnQgaW50ZXJhY3Rpb24gb3V0c2lkZSBvZiBkaWFsb2dcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tkcm9wICA6ICdzdGF0aWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5Ym9hcmQgIDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hvd1RvYXN0ID0gZnVuY3Rpb24gKG1lc3NhZ2UsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZSA9PSBcIkNMRUFSX0NBUlRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IFwiRGViZXMgdmFjaWFyIHR1IGNhcnJvIHBhcmEgZXNhIGNvbXByYVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBwaW5UbyA9IGdldFRvYXN0UG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvYXN0ID0gJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQobWVzc2FnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24ocGluVG8pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdCA9ICRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChtZXNzYWdlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24ocGluVG8pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wYXJlbnQocGFyZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KHRvYXN0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSB7XG4gICAgICAgICAgICAgICAgICAgIGJvdHRvbTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiB0cnVlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciB0b2FzdFBvc2l0aW9uID0gYW5ndWxhci5leHRlbmQoe30sIGxhc3QpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdldFRvYXN0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNhbml0aXplUG9zaXRpb24oKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModG9hc3RQb3NpdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwb3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvYXN0UG9zaXRpb25bcG9zXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCcgJyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzYW5pdGl6ZVBvc2l0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudCA9IHRvYXN0UG9zaXRpb247XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQuYm90dG9tICYmIGxhc3QudG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnRvcCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LnRvcCAmJiBsYXN0LmJvdHRvbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5ib3R0b20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5yaWdodCAmJiBsYXN0LmxlZnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQubGVmdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LmxlZnQgJiYgbGFzdC5yaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5yaWdodCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgbGFzdCA9IGFuZ3VsYXIuZXh0ZW5kKHt9LCBjdXJyZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNob3dMb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPG1kLWRpYWxvZyBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym94LXNoYWRvdzpub25lXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGxheW91dD1cInJvd1wiIGxheW91dC1zbT1cImNvbHVtblwiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIiBhcmlhLWxhYmVsPVwid2FpdFwiIHN0eWxlPVwib3ZlcmZsb3c6aGlkZGVuXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8bWQtcHJvZ3Jlc3MtY2lyY3VsYXIgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIiA+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9tZC1kaWFsb2c+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW46IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGFuc3dlcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBoaWRlTG9hZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGFuc3dlcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB0dXJuT2JqZWN0VG9VcmwgPSBmdW5jdGlvbiAocGFyYW1zLCB0aGVVcmwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoZVVybC5pbmNsdWRlcyhcIj9cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoZVVybCA9IHRoZVVybC5zcGxpdChcIj9cIilbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IGZpcnN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayBpbiBwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlVXJsICs9IFwiP1wiICsgayArIFwiPVwiICsgcGFyYW1zW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVVybCArPSBcIiZcIiArIGsgKyBcIj1cIiArIHBhcmFtc1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoZVVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2V0QWxsVXJsUGFyYW1zID0gZnVuY3Rpb24gKHVybCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgcXVlcnkgc3RyaW5nIGZyb20gdXJsIChvcHRpb25hbCkgb3Igd2luZG93XG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZyA9IHVybCA/IHVybC5zcGxpdCgnPycpWzFdIDogd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJRdWVyeSBzdHJpbmdcIixxdWVyeVN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdlJ2xsIHN0b3JlIHRoZSBwYXJhbWV0ZXJzIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgcXVlcnkgc3RyaW5nIGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3R1ZmYgYWZ0ZXIgIyBpcyBub3QgcGFydCBvZiBxdWVyeSBzdHJpbmcsIHNvIGdldCByaWQgb2YgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nID0gcXVlcnlTdHJpbmcuc3BsaXQoJyMnKVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3BsaXQgb3VyIHF1ZXJ5IHN0cmluZyBpbnRvIGl0cyBjb21wb25lbnQgcGFydHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcnIgPSBxdWVyeVN0cmluZy5zcGxpdCgnJicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlcGFyYXRlIHRoZSBrZXlzIGFuZCB0aGUgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBhcnJbaV0uc3BsaXQoJz0nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBwYXJhbWV0ZXIgbmFtZSBhbmQgdmFsdWUgKHVzZSAndHJ1ZScgaWYgZW1wdHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtTmFtZSA9IGFbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtVmFsdWUgPSB0eXBlb2YgKGFbMV0pID09PSAndW5kZWZpbmVkJyA/IHRydWUgOiBhWzFdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gKG9wdGlvbmFsKSBrZWVwIGNhc2UgY29uc2lzdGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtTmFtZSA9IHBhcmFtTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyYW1WYWx1ZSA9PT0gJ3N0cmluZycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtVmFsdWUgPSBwYXJhbVZhbHVlLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcGFyYW1OYW1lIGVuZHMgd2l0aCBzcXVhcmUgYnJhY2tldHMsIGUuZy4gY29sb3JzW10gb3IgY29sb3JzWzJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtTmFtZS5tYXRjaCgvXFxbKFxcZCspP1xcXSQvKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBrZXkgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gcGFyYW1OYW1lLnJlcGxhY2UoL1xcWyhcXGQrKT9cXF0vLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb2JqW2tleV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba2V5XSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3MgYW4gaW5kZXhlZCBhcnJheSBlLmcuIGNvbG9yc1syXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1OYW1lLm1hdGNoKC9cXFtcXGQrXFxdJC8pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIGluZGV4IHZhbHVlIGFuZCBhZGQgdGhlIGVudHJ5IGF0IHRoZSBhcHByb3ByaWF0ZSBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gL1xcWyhcXGQrKVxcXS8uZXhlYyhwYXJhbU5hbWUpWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW2tleV1baW5kZXhdID0gcGFyYW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBhZGQgdGhlIHZhbHVlIHRvIHRoZSBlbmQgb2YgdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba2V5XS5wdXNoKHBhcmFtVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgZGVhbGluZyB3aXRoIGEgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb2JqW3BhcmFtTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0IGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZSBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW3BhcmFtTmFtZV0gPSBwYXJhbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9ialtwYXJhbU5hbWVdICYmIHR5cGVvZiBvYmpbcGFyYW1OYW1lXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHByb3BlcnR5IGRvZXMgZXhpc3QgYW5kIGl0J3MgYSBzdHJpbmcsIGNvbnZlcnQgaXQgdG8gYW4gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtwYXJhbU5hbWVdID0gW29ialtwYXJhbU5hbWVdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtwYXJhbU5hbWVdLnB1c2gocGFyYW1WYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgYWRkIHRoZSBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW3BhcmFtTmFtZV0ucHVzaChwYXJhbVZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzc2VzUG9wdXA6IGdldEFkZHJlc3Nlc1BvcHVwLFxuICAgICAgICAgICAgICAgICAgICBnZXRFeHBvcnRQb3B1cDogZ2V0RXhwb3J0UG9wdXAsXG4gICAgICAgICAgICAgICAgICAgIGdldEJvb2tpbmdQcm9tcHQ6Z2V0Qm9va2luZ1Byb21wdCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0TG9jYXRpb25Qcm9tcHQ6IGdldExvY2F0aW9uUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICBnZXRMb2NhdGlvbkV4dFByb21wdDogZ2V0TG9jYXRpb25FeHRQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIGdldE1lcmNoYW50c1BvcHVwOiBnZXRNZXJjaGFudHNQb3B1cCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0UXVlc3Rpb25haXJlUG9wdXA6IGdldFF1ZXN0aW9uYWlyZVBvcHVwLFxuICAgICAgICAgICAgICAgICAgICBzaG93VG9hc3Q6IHNob3dUb2FzdCxcbiAgICAgICAgICAgICAgICAgICAgZ2V0QXBwUG9wdXA6IGdldEFwcFBvcHVwLFxuICAgICAgICAgICAgICAgICAgICBnZXRDb3ZlcmFnZVByb21wdDpnZXRDb3ZlcmFnZVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgc2hvd0xvYWRlcjogc2hvd0xvYWRlcixcbiAgICAgICAgICAgICAgICAgICAgdHVybk9iamVjdFRvVXJsOiB0dXJuT2JqZWN0VG9VcmwsXG4gICAgICAgICAgICAgICAgICAgIGhpZGVMb2FkZXI6IGhpZGVMb2FkZXIsXG4gICAgICAgICAgICAgICAgICAgIGdldEFsbFVybFBhcmFtczogZ2V0QWxsVXJsUGFyYW1zXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL21vZGFscy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 44 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Orders',['$q', '$http', function ($q, $http) {\n\n            var getOrders = function (where) {\n                var url = '/api/orders' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get orders\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getStoreExport = function (from,to) {\n                var url = '/api/store/reports' ;\n                var def = $q.defer();\n                console.log(\"getStoreExport\",from,to);\n                $http({\n                    method: 'POST',\n                    url: url,\n                    data:{from:from,to:to}\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getStoreExport\");\n                        });\n                return def.promise;\n            }\n            var fullfillOrder = function (data) {\n                var url = '/api/items/status' ;\n                var def = $q.defer();\n                console.log(\"fullfillOrder\",data);\n                $http({\n                    method: 'POST',\n                    url: url,\n                    data:data\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to fullfillOrder\");\n                        });\n                return def.promise;\n            }\n            var approveOrder = function (order_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/'+order_id+\"/approve\",\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to approveOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            var updateOrderStatus = function (status,order_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/'+order_id+\"/build\",\n                        data: {\"status\":status}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateOrderStatus\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setShippingAddress = function (data) {\n                console.log(\"Setting order address: \",data)\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/shipping',\n                        data: data // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to setShippingAddress\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setPlatformShippingCondition = function (order,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/platform/shipping/'+order,\n                        data: platform, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to setPlatformShippingCondition\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getPlatformShippingPrice = function (order,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/orders/platform/shipping/'+order,\n                        params: platform, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateOrderStatus\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var prepareOrder = function (data,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/prepare/'+platform,\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to prepareOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setDiscounts = function (order,platform) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/discounts/'+platform+\"/\"+order,\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to setDiscounts\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var setCoupon = function (coupon) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/coupon',\n                        data: {\"coupon\":coupon}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to setCoupon\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var checkOrder = function (order,data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/orders/check/'+order,\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to checkOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getOrder = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/orders/active',\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getOrder\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getOrders:getOrders,\n                getOrder:getOrder,\n                checkOrder:checkOrder,\n                approveOrder:approveOrder,\n                fullfillOrder:fullfillOrder,\n                setShippingAddress:setShippingAddress,\n                prepareOrder:prepareOrder,\n                setPlatformShippingCondition:setPlatformShippingCondition,\n                getPlatformShippingPrice:getPlatformShippingPrice,\n                setDiscounts:setDiscounts,\n                setCoupon:setCoupon,\n                getStoreExport:getStoreExport,\n                updateOrderStatus:updateOrderStatus\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9vcmRlcnMuanM/ODg1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgXG4gICAgICAgIC5zZXJ2aWNlKCdPcmRlcnMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRPcmRlcnMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvb3JkZXJzJyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG9yZGVyc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFN0b3JlRXhwb3J0ID0gZnVuY3Rpb24gKGZyb20sdG8pIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvc3RvcmUvcmVwb3J0cycgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0U3RvcmVFeHBvcnRcIixmcm9tLHRvKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTp7ZnJvbTpmcm9tLHRvOnRvfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFN0b3JlRXhwb3J0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZ1bGxmaWxsT3JkZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9pdGVtcy9zdGF0dXMnIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZ1bGxmaWxsT3JkZXJcIixkYXRhKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTpkYXRhXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZnVsbGZpbGxPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcHByb3ZlT3JkZXIgPSBmdW5jdGlvbiAob3JkZXJfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXJzLycrb3JkZXJfaWQrXCIvYXBwcm92ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBhcHByb3ZlT3JkZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdXBkYXRlT3JkZXJTdGF0dXMgPSBmdW5jdGlvbiAoc3RhdHVzLG9yZGVyX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy8nK29yZGVyX2lkK1wiL2J1aWxkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XCJzdGF0dXNcIjpzdGF0dXN9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlT3JkZXJTdGF0dXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNldFNoaXBwaW5nQWRkcmVzcyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZXR0aW5nIG9yZGVyIGFkZHJlc3M6IFwiLGRhdGEpXG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9zaGlwcGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzZXRTaGlwcGluZ0FkZHJlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb24gPSBmdW5jdGlvbiAob3JkZXIscGxhdGZvcm0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXJzL3BsYXRmb3JtL3NoaXBwaW5nLycrb3JkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBwbGF0Zm9ybSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb25cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldFBsYXRmb3JtU2hpcHBpbmdQcmljZSA9IGZ1bmN0aW9uIChvcmRlcixwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9wbGF0Zm9ybS9zaGlwcGluZy8nK29yZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwbGF0Zm9ybSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZU9yZGVyU3RhdHVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwcmVwYXJlT3JkZXIgPSBmdW5jdGlvbiAoZGF0YSxwbGF0Zm9ybSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlcnMvcHJlcGFyZS8nK3BsYXRmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHByZXBhcmVPcmRlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2V0RGlzY291bnRzID0gZnVuY3Rpb24gKG9yZGVyLHBsYXRmb3JtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9kaXNjb3VudHMvJytwbGF0Zm9ybStcIi9cIitvcmRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gc2V0RGlzY291bnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzZXRDb3Vwb24gPSBmdW5jdGlvbiAoY291cG9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9jb3Vwb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1wiY291cG9uXCI6Y291cG9ufSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNldENvdXBvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hlY2tPcmRlciA9IGZ1bmN0aW9uIChvcmRlcixkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9jaGVjay8nK29yZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGNoZWNrT3JkZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldE9yZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVycy9hY3RpdmUnLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0T3JkZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdldE9yZGVyczpnZXRPcmRlcnMsXG4gICAgICAgICAgICAgICAgZ2V0T3JkZXI6Z2V0T3JkZXIsXG4gICAgICAgICAgICAgICAgY2hlY2tPcmRlcjpjaGVja09yZGVyLFxuICAgICAgICAgICAgICAgIGFwcHJvdmVPcmRlcjphcHByb3ZlT3JkZXIsXG4gICAgICAgICAgICAgICAgZnVsbGZpbGxPcmRlcjpmdWxsZmlsbE9yZGVyLFxuICAgICAgICAgICAgICAgIHNldFNoaXBwaW5nQWRkcmVzczpzZXRTaGlwcGluZ0FkZHJlc3MsXG4gICAgICAgICAgICAgICAgcHJlcGFyZU9yZGVyOnByZXBhcmVPcmRlcixcbiAgICAgICAgICAgICAgICBzZXRQbGF0Zm9ybVNoaXBwaW5nQ29uZGl0aW9uOnNldFBsYXRmb3JtU2hpcHBpbmdDb25kaXRpb24sXG4gICAgICAgICAgICAgICAgZ2V0UGxhdGZvcm1TaGlwcGluZ1ByaWNlOmdldFBsYXRmb3JtU2hpcHBpbmdQcmljZSxcbiAgICAgICAgICAgICAgICBzZXREaXNjb3VudHM6c2V0RGlzY291bnRzLFxuICAgICAgICAgICAgICAgIHNldENvdXBvbjpzZXRDb3Vwb24sXG4gICAgICAgICAgICAgICAgZ2V0U3RvcmVFeHBvcnQ6Z2V0U3RvcmVFeHBvcnQsXG4gICAgICAgICAgICAgICAgdXBkYXRlT3JkZXJTdGF0dXM6dXBkYXRlT3JkZXJTdGF0dXNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1dKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyByZXNvdXJjZXMvYXNzZXRzL2pzL3NlcnZpY2VzL29yZGVycy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 45 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Passport',['$q', '$http', function ($q, $http) {\n\n            var getOauthClients = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/oauth/clients'\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get clients\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var createOauthClient = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/oauth/clients',\n                        data: data // pass in data as strings\n                        //headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to create client\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var updateOauthClient = function (data,id) {\n                var def = $q.defer();\n                $http({\n                        method: 'PUT',\n                        url: '/oauth/clients/'+id,\n                        data: data, // pass in data as strings\n                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to update client\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deleteOauthClient = function (client) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/oauth/clients/'+client\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to delete client\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getScopes = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/oauth/scopes' \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getPersonalAccessTokens = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/oauth/personal-access-tokens' \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var createPersonalAccessToken = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/oauth/personal-access-tokens',\n                        data: data, // pass in data as strings\n                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to create client\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deletePersonalAccessTokens = function (client) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/oauth/personal-access-tokens/'+client\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to delete client\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getTokens = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/user/authtokens' \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deleteTokens = function (token) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/oauth/tokens/'+token\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to delete client\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            \n            return {\n                getOauthClients: getOauthClients,\n                createOauthClient:createOauthClient,\n                updateOauthClient:updateOauthClient,\n                deleteOauthClient:deleteOauthClient,\n                getScopes:getScopes,\n                getPersonalAccessTokens:getPersonalAccessTokens,\n                deletePersonalAccessTokens:deletePersonalAccessTokens,\n                getTokens:getTokens,\n                deleteTokens:deleteTokens,\n                createPersonalAccessToken:createPersonalAccessToken,\n\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXNzcG9ydC5qcz80MjU3Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1Bhc3Nwb3J0JyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0T2F1dGhDbGllbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvY2xpZW50cydcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBjbGllbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNyZWF0ZU9hdXRoQ2xpZW50ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9vYXV0aC9jbGllbnRzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaGVhZGVyczogeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ30gIC8vIHNldCB0aGUgaGVhZGVycyBzbyBhbmd1bGFyIHBhc3NpbmcgaW5mbyBhcyBmb3JtIGRhdGEgKG5vdCByZXF1ZXN0IHBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBjcmVhdGUgY2xpZW50XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlT2F1dGhDbGllbnQgPSBmdW5jdGlvbiAoZGF0YSxpZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvY2xpZW50cy8nK2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9ICAvLyBzZXQgdGhlIGhlYWRlcnMgc28gYW5ndWxhciBwYXNzaW5nIGluZm8gYXMgZm9ybSBkYXRhIChub3QgcmVxdWVzdCBwYXlsb2FkKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZU9hdXRoQ2xpZW50ID0gZnVuY3Rpb24gKGNsaWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvY2xpZW50cy8nK2NsaWVudFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRTY29wZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvc2NvcGVzJyBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgbmVhcmJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0UGVyc29uYWxBY2Nlc3NUb2tlbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvcGVyc29uYWwtYWNjZXNzLXRva2VucycgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNyZWF0ZVBlcnNvbmFsQWNjZXNzVG9rZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL29hdXRoL3BlcnNvbmFsLWFjY2Vzcy10b2tlbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9ICAvLyBzZXQgdGhlIGhlYWRlcnMgc28gYW5ndWxhciBwYXNzaW5nIGluZm8gYXMgZm9ybSBkYXRhIChub3QgcmVxdWVzdCBwYXlsb2FkKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gY3JlYXRlIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZVBlcnNvbmFsQWNjZXNzVG9rZW5zID0gZnVuY3Rpb24gKGNsaWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvcGVyc29uYWwtYWNjZXNzLXRva2Vucy8nK2NsaWVudFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZGVsZXRlIGNsaWVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRUb2tlbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL3VzZXIvYXV0aHRva2VucycgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZVRva2VucyA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvb2F1dGgvdG9rZW5zLycrdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZSBjbGllbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0T2F1dGhDbGllbnRzOiBnZXRPYXV0aENsaWVudHMsXG4gICAgICAgICAgICAgICAgY3JlYXRlT2F1dGhDbGllbnQ6Y3JlYXRlT2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgICAgdXBkYXRlT2F1dGhDbGllbnQ6dXBkYXRlT2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgICAgZGVsZXRlT2F1dGhDbGllbnQ6ZGVsZXRlT2F1dGhDbGllbnQsXG4gICAgICAgICAgICAgICAgZ2V0U2NvcGVzOmdldFNjb3BlcyxcbiAgICAgICAgICAgICAgICBnZXRQZXJzb25hbEFjY2Vzc1Rva2VuczpnZXRQZXJzb25hbEFjY2Vzc1Rva2VucyxcbiAgICAgICAgICAgICAgICBkZWxldGVQZXJzb25hbEFjY2Vzc1Rva2VuczpkZWxldGVQZXJzb25hbEFjY2Vzc1Rva2VucyxcbiAgICAgICAgICAgICAgICBnZXRUb2tlbnM6Z2V0VG9rZW5zLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVRva2VuczpkZWxldGVUb2tlbnMsXG4gICAgICAgICAgICAgICAgY3JlYXRlUGVyc29uYWxBY2Nlc3NUb2tlbjpjcmVhdGVQZXJzb25hbEFjY2Vzc1Rva2VuLFxuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXNzcG9ydC5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 46 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Payments',['$q', '$http', function ($q, $http) {\n\n            var getPayments = function (where) {\n                var url = '/api/payments' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get payments\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getPaymentsUser = function (where) {\n                var url = '/api/billing/payments' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get payments\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var approvePayment = function (payment_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/payments/'+payment_id+\"/approve\",\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to approvePayment\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var retryPayment = function (payment_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/retry/'+payment_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to retryPayment\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var addTransactionCosts = function (payment_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/billing/add_transaction_costs/'+payment_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to addTransactionCosts\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n\n            return {\n                getPayments:getPayments,\n                getPaymentsUser:getPaymentsUser,\n                retryPayment:retryPayment,\n                addTransactionCosts:addTransactionCosts,\n                approvePayment:approvePayment\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wYXltZW50cy5qcz9kMTI2Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1BheW1lbnRzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0UGF5bWVudHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvcGF5bWVudHMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgcGF5bWVudHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRQYXltZW50c1VzZXIgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYmlsbGluZy9wYXltZW50cycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBwYXltZW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFwcHJvdmVQYXltZW50ID0gZnVuY3Rpb24gKHBheW1lbnRfaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvcGF5bWVudHMvJytwYXltZW50X2lkK1wiL2FwcHJvdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYXBwcm92ZVBheW1lbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJldHJ5UGF5bWVudCA9IGZ1bmN0aW9uIChwYXltZW50X2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2JpbGxpbmcvcmV0cnkvJytwYXltZW50X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byByZXRyeVBheW1lbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFkZFRyYW5zYWN0aW9uQ29zdHMgPSBmdW5jdGlvbiAocGF5bWVudF9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9iaWxsaW5nL2FkZF90cmFuc2FjdGlvbl9jb3N0cy8nK3BheW1lbnRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGFkZFRyYW5zYWN0aW9uQ29zdHNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0UGF5bWVudHM6Z2V0UGF5bWVudHMsXG4gICAgICAgICAgICAgICAgZ2V0UGF5bWVudHNVc2VyOmdldFBheW1lbnRzVXNlcixcbiAgICAgICAgICAgICAgICByZXRyeVBheW1lbnQ6cmV0cnlQYXltZW50LFxuICAgICAgICAgICAgICAgIGFkZFRyYW5zYWN0aW9uQ29zdHM6YWRkVHJhbnNhY3Rpb25Db3N0cyxcbiAgICAgICAgICAgICAgICBhcHByb3ZlUGF5bWVudDphcHByb3ZlUGF5bWVudFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvcGF5bWVudHMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 47 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('ProductImport',['$q', '$http', function ($q, $http) {\n\n            var getProducts = function (where) {\n                var url = '/api/admin/store/products' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getProducts\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getVariants = function (where) {\n                var url = '/api/admin/store/variants' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getVariants\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getMerchants = function (where) {\n                var url = '/api/admin/store/merchants' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getMerchants\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var getCategories = function (where) {\n                var url = '/api/admin/store/categories' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getCategories\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteProductItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/products/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteProductItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteMerchantItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/merchants/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteMerchantItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteVariantItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/variants/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteVariantItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteCategoryItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/store/categories/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteCategoryItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getProducts:getProducts,\n                getVariants:getVariants,\n                getMerchants:getMerchants,\n                getCategories:getCategories,\n                deleteProductItem:deleteProductItem,\n                deleteMerchantItem:deleteMerchantItem,\n                deleteVariantItem:deleteVariantItem,\n                deleteCategoryItem:deleteCategoryItem\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wcm9kdWN0LWltcG9ydC5qcz8zM2M0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1Byb2R1Y3RJbXBvcnQnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRQcm9kdWN0cyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9zdG9yZS9wcm9kdWN0cycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFByb2R1Y3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRWYXJpYW50cyA9IGZ1bmN0aW9uICh3aGVyZSkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9hZG1pbi9zdG9yZS92YXJpYW50cycgO1xuICAgICAgICAgICAgICAgIGlmKHdoZXJlKXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsKyc/Jyt3aGVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFZhcmlhbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRNZXJjaGFudHMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYWRtaW4vc3RvcmUvbWVyY2hhbnRzJyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0TWVyY2hhbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRDYXRlZ29yaWVzID0gZnVuY3Rpb24gKHdoZXJlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL2FkbWluL3N0b3JlL2NhdGVnb3JpZXMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXRDYXRlZ29yaWVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVQcm9kdWN0SXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vc3RvcmUvcHJvZHVjdHMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVQcm9kdWN0SXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlTWVyY2hhbnRJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZG1pbi9zdG9yZS9tZXJjaGFudHMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVNZXJjaGFudEl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlbGV0ZVZhcmlhbnRJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZG1pbi9zdG9yZS92YXJpYW50cy8nK2l0ZW0uaWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZVZhcmlhbnRJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVDYXRlZ29yeUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkbWluL3N0b3JlL2NhdGVnb3JpZXMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVDYXRlZ29yeUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdldFByb2R1Y3RzOmdldFByb2R1Y3RzLFxuICAgICAgICAgICAgICAgIGdldFZhcmlhbnRzOmdldFZhcmlhbnRzLFxuICAgICAgICAgICAgICAgIGdldE1lcmNoYW50czpnZXRNZXJjaGFudHMsXG4gICAgICAgICAgICAgICAgZ2V0Q2F0ZWdvcmllczpnZXRDYXRlZ29yaWVzLFxuICAgICAgICAgICAgICAgIGRlbGV0ZVByb2R1Y3RJdGVtOmRlbGV0ZVByb2R1Y3RJdGVtLFxuICAgICAgICAgICAgICAgIGRlbGV0ZU1lcmNoYW50SXRlbTpkZWxldGVNZXJjaGFudEl0ZW0sXG4gICAgICAgICAgICAgICAgZGVsZXRlVmFyaWFudEl0ZW06ZGVsZXRlVmFyaWFudEl0ZW0sXG4gICAgICAgICAgICAgICAgZGVsZXRlQ2F0ZWdvcnlJdGVtOmRlbGV0ZUNhdGVnb3J5SXRlbVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvcHJvZHVjdC1pbXBvcnQuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 48 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        .service('Products', ['$q', '$http', function ($q, $http) {\n\n                var addRating = function (rating) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/ratings\",\n                        data: rating\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var addFavorite = function (data) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/favorites\",\n                        data: data\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var deleteFavorite = function (data) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/favorites/delete\",\n                        data: data\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var checkFavorite = function (rating) {\n\n                    var def = $q.defer();\n\n                    $http({\n                        method: \"post\",\n                        url: \"/api/products/favorites\",\n                        data: rating\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to addRating\");\n                            });\n\n                    return def.promise;\n                };\n                var getProductsMerchant = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"GET\",\n                        url: \"/api/merchants/products\",\n                        params: data\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to getProductsMerchant\");\n                            });\n                    return def.promise;\n                };\n                var searchProducts = function (data) {\n                    var def = $q.defer();\n                    $http({\n                        method: \"GET\",\n                        url: \"/api/products/search\",\n                        params: data\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                                def.reject(\"Failed to searchProducts\");\n                            });\n                    return def.promise;\n                };\n                var buildProduct = function (container, merchant) {\n                    var productInfo = {};\n\n                    productInfo.id = container.product_id;\n                    productInfo.name = container.prod_name;\n                    productInfo.description = container.prod_desc;\n                    productInfo.isActive = container.isActive;\n                    productInfo.slug = container.slug;\n                    productInfo.description_more = false;\n                    productInfo.more = false;\n                    productInfo.type = container.type;\n                    productInfo.merchant_description_more = false;\n                    if (merchant) {\n                        productInfo.merchant_name = merchant.merchant_name;\n                        productInfo.merchant_id = merchant.merchant_id;\n                        productInfo.merchant_description = merchant.merchant_description;\n                        productInfo.merchant_attributes = merchant.merchant_attributes;\n                        productInfo.src = merchant.merchant_icon;\n\n                        productInfo.merchant_type = merchant.merchant_type;\n                    }\n\n                    productInfo.inCart = false;\n                    if (container.is_on_sale) {\n\n                        productInfo.onsale = true;\n                        productInfo.subtotal = productInfo.price;\n                        productInfo.exsubtotal = productInfo.exprice;\n                    } else {\n                        productInfo.subtotal = productInfo.price;\n                        productInfo.onsale = false;\n                    }\n                    productInfo = updateProductVisual(container, productInfo);\n                    productInfo.item_id = null;\n                    productInfo.amount = container.min_quantity;\n                    productInfo.imgs = [];\n                    productInfo.variants = [];\n                    return productInfo;\n                };\n                var createVariant = function (container) {\n                    var variant = {};\n                            console.log(\"Variant\", container);\n                    //        console.log(\"Variant\", container.id)\n                    variant.id = container.id;\n                    variant.description = container.description;\n                    variant.type = container.type;\n                    if (container.attributes.length > 0) {\n                        variant.attributes = JSON.parse(container.attributes);\n                        if (variant.attributes.buyers) {\n                            variant.unitPrice = variant.price / variant.attributes.buyers;\n                        } else {\n                            variant.unitPrice = variant.price;\n                        }\n                    } else {\n                        variant.attributes = \"\";\n                    }\n                    if (container.is_on_sale) {\n                        variant.exprice = container.price;\n                        variant.price = container.sale;\n                    } else {\n                        variant.price = container.price;\n                    }\n                    variant.is_on_sale = container.is_on_sale;\n                    variant.min_quantity = container.min_quantity;\n                    return variant;\n                }\n                var getCategory = function (variant, arrayCategories) {\n                    for (var i in arrayCategories) {\n                        if (arrayCategories[i].id == variant['category_id']) {\n                            return arrayCategories[i];\n                        }\n                    }\n                    var activeCategory = {\n                        \"name\": variant['category_name'],\n                        \"id\": variant['category_id'],\n                        \"description\": variant['category_description'],\n                        \"products\": [],\n                        \"more\": false\n                    }\n                    arrayCategories.push(activeCategory);\n                    return activeCategory\n                }\n                var getProduct = function (variant, arrayCategories, merchant) {\n                    for (var i in arrayCategories) {\n                        for (var j in arrayCategories[i].products) {\n                            if (arrayCategories[i].products[j].id == variant['product_id']) {\n                                return arrayCategories[i].products[j];\n                            }\n                        }\n                    }\n                    var productInfo = buildProduct(variant, merchant);\n                    return productInfo;\n                }\n\n                var buildProductInformation = function (items) {\n                    if (items['products_variants'].length > 0) {\n                        var resultsCategory = [];\n                        var processedVariants = [];\n                        for (var i = 0; i < items['products_variants'].length; i++) {\n                            if (processedVariants.includes(items['products_variants'][i].id)) {\n                                continue;\n                            } else {\n                                processedVariants.push(items['products_variants'][i].id);\n                            }\n\n                            var category = getCategory(items['products_variants'][i], resultsCategory);\n                            console.log(\"Category found\", category);\n                            var product = getProduct(items['products_variants'][i], resultsCategory, items['merchant_products'][0]);\n                            console.log(\"product found\", product);\n                            if (!containsObject(product, category.products)) {\n                                category.products.push(product);\n                            }\n                            var variant = createVariant(items['products_variants'][i]);\n                            if (variant.price < product.price) {\n                                product = updateProductVisual(variant, product);\n                            }\n                            if (!containsObject(variant, product.variants)) {\n                                product.variants.push(variant);\n                            }\n                        }\n                        for (var j in items['products_files']) {\n                            for (var i$1 = 0; i$1 < resultsCategory.length; i$1++) {\n                                for (var k in resultsCategory[i$1].products) {\n                                    var imgInfo = {};\n                                    if (items['products_files'][j].trigger_id == resultsCategory[i$1].products[k].id) {\n                                        imgInfo.file = items['products_files'][j].file;\n                                        if(resultsCategory[i$1].products[k].imgs.length == 0){\n                                            resultsCategory[i$1].products[k].src = imgInfo.file;\n                                        }\n                                        resultsCategory[i$1].products[k].imgs.push(imgInfo);\n                                        break;\n                                    }\n                                }\n\n                            }\n                        }\n                        console.log('resultbuildCat', resultsCategory);\n                        return resultsCategory;\n                    }\n                    return null;\n                }\n                var containsObject = function (obj, list) {\n                    var x;\n                    for (x in list) {\n                        if (list[x].id == obj.id) {\n                            return true;\n                        }\n                    }\n                    return false;\n                }\n\n                var updateProductVisual = function (container, productInfo) {\n                    if (container.is_on_sale) {\n                        productInfo.price = container.price;\n                        productInfo.onsale = true;\n                        productInfo.exprice = container.exprice;\n                    } else {\n                        productInfo.price = container.price;\n                        productInfo.onsale = false;\n                    }\n\n                    productInfo.variant_id = container.id;\n                    if (container.attributes) {\n                        var attributes = container.attributes;\n                        if (attributes.buyers) {\n                            productInfo.unitPrice = productInfo.price / attributes.buyers;\n                            productInfo.unitLunches = attributes.buyers;\n                        } else {\n                            productInfo.unitPrice = productInfo.price;\n                            productInfo.unitLunches = 1;\n                        }\n\n                    } else {\n                        productInfo.unitPrice = productInfo.price;\n                        productInfo.unitLunches = 1;\n                    }\n                    //        console.log(\"Update Prod Vis3\", productInfo);\n                    return productInfo;\n                }\n\n                return {\n                    addRating:addRating,\n                    deleteFavorite:deleteFavorite,\n                    checkFavorite:checkFavorite,\n                    addFavorite:addFavorite,\n                    searchProducts:searchProducts,\n                    getProductsMerchant: getProductsMerchant,\n                    buildProductInformation: buildProductInformation\n                };\n            }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9wcm9kdWN0cy5qcz9kMjQ5Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICAuc2VydmljZSgnUHJvZHVjdHMnLCBbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGFkZFJhdGluZyA9IGZ1bmN0aW9uIChyYXRpbmcpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvcmF0aW5nc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogcmF0aW5nXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkUmF0aW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBhZGRGYXZvcml0ZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL2Zhdm9yaXRlc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGFkZFJhdGluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlRmF2b3JpdGUgPSBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9mYXZvcml0ZXMvZGVsZXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gYWRkUmF0aW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBjaGVja0Zhdm9yaXRlID0gZnVuY3Rpb24gKHJhdGluZykge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9wcm9kdWN0cy9mYXZvcml0ZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJhdGluZ1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGFkZFJhdGluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0UHJvZHVjdHNNZXJjaGFudCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9tZXJjaGFudHMvcHJvZHVjdHNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldFByb2R1Y3RzTWVyY2hhbnRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBzZWFyY2hQcm9kdWN0cyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9wcm9kdWN0cy9zZWFyY2hcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHNlYXJjaFByb2R1Y3RzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgYnVpbGRQcm9kdWN0ID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgbWVyY2hhbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHByb2R1Y3RJbmZvID0ge307XG5cbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uaWQgPSBjb250YWluZXIucHJvZHVjdF9pZDtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ubmFtZSA9IGNvbnRhaW5lci5wcm9kX25hbWU7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmRlc2NyaXB0aW9uID0gY29udGFpbmVyLnByb2RfZGVzYztcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uaXNBY3RpdmUgPSBjb250YWluZXIuaXNBY3RpdmU7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnNsdWcgPSBjb250YWluZXIuc2x1ZztcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uZGVzY3JpcHRpb25fbW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5tb3JlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnR5cGUgPSBjb250YWluZXIudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ubWVyY2hhbnRfZGVzY3JpcHRpb25fbW9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWVyY2hhbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm1lcmNoYW50X25hbWUgPSBtZXJjaGFudC5tZXJjaGFudF9uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8ubWVyY2hhbnRfaWQgPSBtZXJjaGFudC5tZXJjaGFudF9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm1lcmNoYW50X2Rlc2NyaXB0aW9uID0gbWVyY2hhbnQubWVyY2hhbnRfZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5tZXJjaGFudF9hdHRyaWJ1dGVzID0gbWVyY2hhbnQubWVyY2hhbnRfYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnNyYyA9IG1lcmNoYW50Lm1lcmNoYW50X2ljb247XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm1lcmNoYW50X3R5cGUgPSBtZXJjaGFudC5tZXJjaGFudF90eXBlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uaW5DYXJ0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuaXNfb25fc2FsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5vbnNhbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uc3VidG90YWwgPSBwcm9kdWN0SW5mby5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmV4c3VidG90YWwgPSBwcm9kdWN0SW5mby5leHByaWNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uc3VidG90YWwgPSBwcm9kdWN0SW5mby5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm9uc2FsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvID0gdXBkYXRlUHJvZHVjdFZpc3VhbChjb250YWluZXIsIHByb2R1Y3RJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8uaXRlbV9pZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmFtb3VudCA9IGNvbnRhaW5lci5taW5fcXVhbnRpdHk7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLmltZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udmFyaWFudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2R1Y3RJbmZvO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZVZhcmlhbnQgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YXJpYW50ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJWYXJpYW50XCIsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICBjb25zb2xlLmxvZyhcIlZhcmlhbnRcIiwgY29udGFpbmVyLmlkKVxuICAgICAgICAgICAgICAgICAgICB2YXJpYW50LmlkID0gY29udGFpbmVyLmlkO1xuICAgICAgICAgICAgICAgICAgICB2YXJpYW50LmRlc2NyaXB0aW9uID0gY29udGFpbmVyLmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICB2YXJpYW50LnR5cGUgPSBjb250YWluZXIudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5hdHRyaWJ1dGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQuYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoY29udGFpbmVyLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhbnQuYXR0cmlidXRlcy5idXllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50LnVuaXRQcmljZSA9IHZhcmlhbnQucHJpY2UgLyB2YXJpYW50LmF0dHJpYnV0ZXMuYnV5ZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50LnVuaXRQcmljZSA9IHZhcmlhbnQucHJpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50LmF0dHJpYnV0ZXMgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuaXNfb25fc2FsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5leHByaWNlID0gY29udGFpbmVyLnByaWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5wcmljZSA9IGNvbnRhaW5lci5zYWxlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5wcmljZSA9IGNvbnRhaW5lci5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXJpYW50LmlzX29uX3NhbGUgPSBjb250YWluZXIuaXNfb25fc2FsZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudC5taW5fcXVhbnRpdHkgPSBjb250YWluZXIubWluX3F1YW50aXR5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFyaWFudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdldENhdGVnb3J5ID0gZnVuY3Rpb24gKHZhcmlhbnQsIGFycmF5Q2F0ZWdvcmllcykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIGFycmF5Q2F0ZWdvcmllcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFycmF5Q2F0ZWdvcmllc1tpXS5pZCA9PSB2YXJpYW50WydjYXRlZ29yeV9pZCddKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5Q2F0ZWdvcmllc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlQ2F0ZWdvcnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogdmFyaWFudFsnY2F0ZWdvcnlfbmFtZSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiB2YXJpYW50WydjYXRlZ29yeV9pZCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiB2YXJpYW50WydjYXRlZ29yeV9kZXNjcmlwdGlvbiddLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9kdWN0c1wiOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibW9yZVwiOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGFycmF5Q2F0ZWdvcmllcy5wdXNoKGFjdGl2ZUNhdGVnb3J5KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZUNhdGVnb3J5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBnZXRQcm9kdWN0ID0gZnVuY3Rpb24gKHZhcmlhbnQsIGFycmF5Q2F0ZWdvcmllcywgbWVyY2hhbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiBhcnJheUNhdGVnb3JpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogaW4gYXJyYXlDYXRlZ29yaWVzW2ldLnByb2R1Y3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFycmF5Q2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXS5pZCA9PSB2YXJpYW50Wydwcm9kdWN0X2lkJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5Q2F0ZWdvcmllc1tpXS5wcm9kdWN0c1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IHByb2R1Y3RJbmZvID0gYnVpbGRQcm9kdWN0KHZhcmlhbnQsIG1lcmNoYW50KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2R1Y3RJbmZvO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBidWlsZFByb2R1Y3RJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNbJ3Byb2R1Y3RzX3ZhcmlhbnRzJ10ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdHNDYXRlZ29yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHByb2Nlc3NlZFZhcmlhbnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zWydwcm9kdWN0c192YXJpYW50cyddLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NlZFZhcmlhbnRzLmluY2x1ZGVzKGl0ZW1zWydwcm9kdWN0c192YXJpYW50cyddW2ldLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRWYXJpYW50cy5wdXNoKGl0ZW1zWydwcm9kdWN0c192YXJpYW50cyddW2ldLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2F0ZWdvcnkgPSBnZXRDYXRlZ29yeShpdGVtc1sncHJvZHVjdHNfdmFyaWFudHMnXVtpXSwgcmVzdWx0c0NhdGVnb3J5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhdGVnb3J5IGZvdW5kXCIsIGNhdGVnb3J5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHJvZHVjdCA9IGdldFByb2R1Y3QoaXRlbXNbJ3Byb2R1Y3RzX3ZhcmlhbnRzJ11baV0sIHJlc3VsdHNDYXRlZ29yeSwgaXRlbXNbJ21lcmNoYW50X3Byb2R1Y3RzJ11bMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicHJvZHVjdCBmb3VuZFwiLCBwcm9kdWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRhaW5zT2JqZWN0KHByb2R1Y3QsIGNhdGVnb3J5LnByb2R1Y3RzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeS5wcm9kdWN0cy5wdXNoKHByb2R1Y3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFyaWFudCA9IGNyZWF0ZVZhcmlhbnQoaXRlbXNbJ3Byb2R1Y3RzX3ZhcmlhbnRzJ11baV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYW50LnByaWNlIDwgcHJvZHVjdC5wcmljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0ID0gdXBkYXRlUHJvZHVjdFZpc3VhbCh2YXJpYW50LCBwcm9kdWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250YWluc09iamVjdCh2YXJpYW50LCBwcm9kdWN0LnZhcmlhbnRzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0LnZhcmlhbnRzLnB1c2godmFyaWFudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiBpdGVtc1sncHJvZHVjdHNfZmlsZXMnXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0c0NhdGVnb3J5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gcmVzdWx0c0NhdGVnb3J5W2ldLnByb2R1Y3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1nSW5mbyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zWydwcm9kdWN0c19maWxlcyddW2pdLnRyaWdnZXJfaWQgPT0gcmVzdWx0c0NhdGVnb3J5W2ldLnByb2R1Y3RzW2tdLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nSW5mby5maWxlID0gaXRlbXNbJ3Byb2R1Y3RzX2ZpbGVzJ11bal0uZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHRzQ2F0ZWdvcnlbaV0ucHJvZHVjdHNba10uaW1ncy5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNDYXRlZ29yeVtpXS5wcm9kdWN0c1trXS5zcmMgPSBpbWdJbmZvLmZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNDYXRlZ29yeVtpXS5wcm9kdWN0c1trXS5pbWdzLnB1c2goaW1nSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXN1bHRidWlsZENhdCcsIHJlc3VsdHNDYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0c0NhdGVnb3J5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbnNPYmplY3QgPSBmdW5jdGlvbiAob2JqLCBsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4O1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHggaW4gbGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RbeF0uaWQgPT0gb2JqLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB1cGRhdGVQcm9kdWN0VmlzdWFsID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcHJvZHVjdEluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5pc19vbl9zYWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5wcmljZSA9IGNvbnRhaW5lci5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm9uc2FsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5leHByaWNlID0gY29udGFpbmVyLmV4cHJpY2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby5wcmljZSA9IGNvbnRhaW5lci5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLm9uc2FsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udmFyaWFudF9pZCA9IGNvbnRhaW5lci5pZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXR0cmlidXRlcyA9IGNvbnRhaW5lci5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuYnV5ZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udW5pdFByaWNlID0gcHJvZHVjdEluZm8ucHJpY2UgLyBhdHRyaWJ1dGVzLmJ1eWVycztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby51bml0THVuY2hlcyA9IGF0dHJpYnV0ZXMuYnV5ZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby51bml0UHJpY2UgPSBwcm9kdWN0SW5mby5wcmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SW5mby51bml0THVuY2hlcyA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJbmZvLnVuaXRQcmljZSA9IHByb2R1Y3RJbmZvLnByaWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEluZm8udW5pdEx1bmNoZXMgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0ZSBQcm9kIFZpczNcIiwgcHJvZHVjdEluZm8pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZHVjdEluZm87XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkUmF0aW5nOmFkZFJhdGluZyxcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlRmF2b3JpdGU6ZGVsZXRlRmF2b3JpdGUsXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRmF2b3JpdGU6Y2hlY2tGYXZvcml0ZSxcbiAgICAgICAgICAgICAgICAgICAgYWRkRmF2b3JpdGU6YWRkRmF2b3JpdGUsXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFByb2R1Y3RzOnNlYXJjaFByb2R1Y3RzLFxuICAgICAgICAgICAgICAgICAgICBnZXRQcm9kdWN0c01lcmNoYW50OiBnZXRQcm9kdWN0c01lcmNoYW50LFxuICAgICAgICAgICAgICAgICAgICBidWlsZFByb2R1Y3RJbmZvcm1hdGlvbjogYnVpbGRQcm9kdWN0SW5mb3JtYXRpb25cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvcHJvZHVjdHMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 49 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Routes',['$q', '$http', function ($q, $http) {\n\n            var getRoutes = function (where) {\n                var url = '/api/routes' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get routes\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var deleteRoute = function (route_id) {\n                var url = '/api/routes/'+route_id ;\n                var def = $q.defer();\n                $http({\n                    method: 'delete',\n                    url: url \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteRoute\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getKeyStatus = function (key) {\n                var url = '/api/rapigo/status/'+key ;\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to getKeyStatus\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteStop = function (stop_id) {\n                var url = '/api/stops/'+stop_id ;\n                var def = $q.defer();\n                $http({\n                    method: 'delete',\n                    url: url \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteStop\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var buildRoute = function (route_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/routes/'+route_id+\"/build\",\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to buildRoute\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            var updateRouteStop = function (route_id,stop_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/routes/'+route_id+\"/stop/\"+stop_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateRouteStops\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var updateRouteDelivery = function (route_id,delivery_id,stop_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/routes/add_delivery',\n                        data: {\n                            \"route_id\":route_id,\n                            \"delivery_id\":delivery_id,\n                            \"stop_id\":stop_id\n                        }, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateRouteDelivery\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var sendStopToNewRoute = function (stop_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: \"/api/routes/stop/\"+stop_id,\n                        data: {}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to sendStopToNewRoute\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var addReturnStop = function (route_id,address_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: \"/api/routes/\"+route_id+\"/return\",\n                        data: {address_id:address_id}, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to sendStopToNewRoute\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getRoutes:getRoutes,\n                deleteStop:deleteStop,\n                getKeyStatus:getKeyStatus,\n                deleteRoute:deleteRoute,\n                sendStopToNewRoute:sendStopToNewRoute,\n                buildRoute:buildRoute,\n                addReturnStop:addReturnStop,\n                updateRouteStop:updateRouteStop,\n                updateRouteDelivery:updateRouteDelivery\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9yb3V0ZXMuanM/MDAwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYmVzYWZlJylcbiAgICAgICAgXG4gICAgICAgIC5zZXJ2aWNlKCdSb3V0ZXMnLFsnJHEnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG5cbiAgICAgICAgICAgIHZhciBnZXRSb3V0ZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvcm91dGVzJyA7XG4gICAgICAgICAgICAgICAgaWYod2hlcmUpe1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwrJz8nK3doZXJlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCByb3V0ZXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVSb3V0ZSA9IGZ1bmN0aW9uIChyb3V0ZV9pZCkge1xuICAgICAgICAgICAgICAgIGxldCB1cmwgPSAnL2FwaS9yb3V0ZXMvJytyb3V0ZV9pZCA7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVSb3V0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRLZXlTdGF0dXMgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgbGV0IHVybCA9ICcvYXBpL3JhcGlnby9zdGF0dXMvJytrZXkgO1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0S2V5U3RhdHVzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVTdG9wID0gZnVuY3Rpb24gKHN0b3BfaWQpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvc3RvcHMvJytzdG9wX2lkIDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGRlbGV0ZVN0b3BcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYnVpbGRSb3V0ZSA9IGZ1bmN0aW9uIChyb3V0ZV9pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9yb3V0ZXMvJytyb3V0ZV9pZCtcIi9idWlsZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBidWlsZFJvdXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHVwZGF0ZVJvdXRlU3RvcCA9IGZ1bmN0aW9uIChyb3V0ZV9pZCxzdG9wX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL3JvdXRlcy8nK3JvdXRlX2lkK1wiL3N0b3AvXCIrc3RvcF9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlUm91dGVTdG9wc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlUm91dGVEZWxpdmVyeSA9IGZ1bmN0aW9uIChyb3V0ZV9pZCxkZWxpdmVyeV9pZCxzdG9wX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL3JvdXRlcy9hZGRfZGVsaXZlcnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm91dGVfaWRcIjpyb3V0ZV9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRlbGl2ZXJ5X2lkXCI6ZGVsaXZlcnlfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdG9wX2lkXCI6c3RvcF9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIHVwZGF0ZVJvdXRlRGVsaXZlcnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbmRTdG9wVG9OZXdSb3V0ZSA9IGZ1bmN0aW9uIChzdG9wX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS9yb3V0ZXMvc3RvcC9cIitzdG9wX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzZW5kU3RvcFRvTmV3Um91dGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFkZFJldHVyblN0b3AgPSBmdW5jdGlvbiAocm91dGVfaWQsYWRkcmVzc19pZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvcm91dGVzL1wiK3JvdXRlX2lkK1wiL3JldHVyblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge2FkZHJlc3NfaWQ6YWRkcmVzc19pZH0sIC8vIHBhc3MgaW4gZGF0YSBhcyBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBzZW5kU3RvcFRvTmV3Um91dGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdldFJvdXRlczpnZXRSb3V0ZXMsXG4gICAgICAgICAgICAgICAgZGVsZXRlU3RvcDpkZWxldGVTdG9wLFxuICAgICAgICAgICAgICAgIGdldEtleVN0YXR1czpnZXRLZXlTdGF0dXMsXG4gICAgICAgICAgICAgICAgZGVsZXRlUm91dGU6ZGVsZXRlUm91dGUsXG4gICAgICAgICAgICAgICAgc2VuZFN0b3BUb05ld1JvdXRlOnNlbmRTdG9wVG9OZXdSb3V0ZSxcbiAgICAgICAgICAgICAgICBidWlsZFJvdXRlOmJ1aWxkUm91dGUsXG4gICAgICAgICAgICAgICAgYWRkUmV0dXJuU3RvcDphZGRSZXR1cm5TdG9wLFxuICAgICAgICAgICAgICAgIHVwZGF0ZVJvdXRlU3RvcDp1cGRhdGVSb3V0ZVN0b3AsXG4gICAgICAgICAgICAgICAgdXBkYXRlUm91dGVEZWxpdmVyeTp1cGRhdGVSb3V0ZURlbGl2ZXJ5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy9yb3V0ZXMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 50 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Users',['$q', '$http', function ($q, $http) {\n\n            var setAsBillingAddress = function (address_id) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/user/billingAddress/'+address_id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n            }\n            var getAddresses = function () {\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/addresses' \n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveAddress = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/addresses',\n                        data: data, // pass in data as strings  // set the headers so angular passing info as form data (not request payload)\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var saveUser = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/user',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to create user\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var updatePassword = function (data) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/user/change_password',\n                        data: data, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updatePassword\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getUser = function () {\n                var def = $q.defer();\n                $http({\n                        method: 'GET',\n                        url: '/api/user',\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get user\");\n                        });\n                return def.promise;\n            }\n            var deleteAddress = function (address) {\n                var def = $q.defer();\n                $http({\n                    method: 'DELETE',\n                    url: '/api/addresses/' + address\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to Delete Address\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            var getContacts = function (text) {\n                var where = \"\";\n                if(text.length>0){\n                    where = \"?name=\\*\"+text+\"\\*\";\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: '/api/contacts' +where\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get nearby\");\n                        });\n\n                return def.promise;\n                /**/\n\n            }\n            return {\n                setAsBillingAddress: setAsBillingAddress,\n                getAddresses:getAddresses,\n                saveAddress:saveAddress,\n                deleteAddress:deleteAddress,\n                updatePassword:updatePassword,\n                saveUser:saveUser,\n                getContacts:getContacts,\n                getUser:getUser\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy91c2Vycy5qcz83MjdjIl0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1VzZXJzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgc2V0QXNCaWxsaW5nQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzX2lkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvdXNlci9iaWxsaW5nQWRkcmVzcy8nK2FkZHJlc3NfaWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0QWRkcmVzc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZGRyZXNzZXMnIFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzYXZlQWRkcmVzcyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkZHJlc3NlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5ncyAgLy8gc2V0IHRoZSBoZWFkZXJzIHNvIGFuZ3VsYXIgcGFzc2luZyBpbmZvIGFzIGZvcm0gZGF0YSAobm90IHJlcXVlc3QgcGF5bG9hZClcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBuZWFyYnlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzYXZlVXNlciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL3VzZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGNyZWF0ZSB1c2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlUGFzc3dvcmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS91c2VyL2NoYW5nZV9wYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlUGFzc3dvcmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL3VzZXInLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IHVzZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsZXRlQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FkZHJlc3Nlcy8nICsgYWRkcmVzc1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIERlbGV0ZSBBZGRyZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZ2V0Q29udGFjdHMgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciB3aGVyZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYodGV4dC5sZW5ndGg+MCl7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlID0gXCI/bmFtZT1cXCpcIit0ZXh0K1wiXFwqXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9jb250YWN0cycgK3doZXJlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gZ2V0IG5lYXJieVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzZXRBc0JpbGxpbmdBZGRyZXNzOiBzZXRBc0JpbGxpbmdBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGdldEFkZHJlc3NlczpnZXRBZGRyZXNzZXMsXG4gICAgICAgICAgICAgICAgc2F2ZUFkZHJlc3M6c2F2ZUFkZHJlc3MsXG4gICAgICAgICAgICAgICAgZGVsZXRlQWRkcmVzczpkZWxldGVBZGRyZXNzLFxuICAgICAgICAgICAgICAgIHVwZGF0ZVBhc3N3b3JkOnVwZGF0ZVBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHNhdmVVc2VyOnNhdmVVc2VyLFxuICAgICAgICAgICAgICAgIGdldENvbnRhY3RzOmdldENvbnRhY3RzLFxuICAgICAgICAgICAgICAgIGdldFVzZXI6Z2V0VXNlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvc2VydmljZXMvdXNlcnMuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 51 */
/***/ function(module, exports) {

eval("angular.module('besafe')\n        \n        .service('Zones',['$q', '$http', function ($q, $http) {\n\n            var getZones = function (where) {\n                var url = '/api/admin/zones' ;\n                if(where){\n                    url = url+'?'+where;\n                }\n                var def = $q.defer();\n                $http({\n                    method: 'get',\n                    url: url\n                })\n                        .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to get getArticles\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            var updateZoneItem = function (item) {\n                console.log(\"Updating zone item\",item);\n                var def = $q.defer();\n                $http({\n                        method: 'PATCH',\n                        url: '/api/admin/zones/'+item.id,\n                        data: item, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to updateZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var createZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'POST',\n                        url: '/api/admin/zones',\n                        data: item, // pass in data as strings\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to createZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n            var deleteZoneItem = function (item) {\n                var def = $q.defer();\n                $http({\n                        method: 'DELETE',\n                        url: '/api/admin/zones/'+item.id\n                    })\n                            .then(function (data) {\n                                def.resolve(data.data);\n                            },function(response) {\n                            def.reject(\"Failed to deleteZoneItem\");\n                        });\n                return def.promise;\n                /**/\n            }\n\n            return {\n                getZones:getZones,\n                updateZoneItem:updateZoneItem,\n                createZoneItem:createZoneItem,\n                deleteZoneItem:deleteZoneItem,\n            };\n        }])//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy96b25lcy5qcz8zMjc0Il0sInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdiZXNhZmUnKVxuICAgICAgICBcbiAgICAgICAgLnNlcnZpY2UoJ1pvbmVzJyxbJyRxJywgJyRodHRwJywgZnVuY3Rpb24gKCRxLCAkaHR0cCkge1xuXG4gICAgICAgICAgICB2YXIgZ2V0Wm9uZXMgPSBmdW5jdGlvbiAod2hlcmUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gJy9hcGkvYWRtaW4vem9uZXMnIDtcbiAgICAgICAgICAgICAgICBpZih3aGVyZSl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHVybCsnPycrd2hlcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkZWYgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBnZXQgZ2V0QXJ0aWNsZXNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdXBkYXRlWm9uZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRpbmcgem9uZSBpdGVtXCIsaXRlbSk7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hZG1pbi96b25lcy8nK2l0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtLCAvLyBwYXNzIGluIGRhdGEgYXMgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoXCJGYWlsZWQgdG8gdXBkYXRlWm9uZUl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgLyoqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNyZWF0ZVpvbmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vem9uZXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbSwgLy8gcGFzcyBpbiBkYXRhIGFzIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KFwiRmFpbGVkIHRvIGNyZWF0ZVpvbmVJdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICAgICAgICAgIC8qKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWxldGVab25lSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWRtaW4vem9uZXMvJytpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChcIkZhaWxlZCB0byBkZWxldGVab25lSXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAvKiovXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0Wm9uZXM6Z2V0Wm9uZXMsXG4gICAgICAgICAgICAgICAgdXBkYXRlWm9uZUl0ZW06dXBkYXRlWm9uZUl0ZW0sXG4gICAgICAgICAgICAgICAgY3JlYXRlWm9uZUl0ZW06Y3JlYXRlWm9uZUl0ZW0sXG4gICAgICAgICAgICAgICAgZGVsZXRlWm9uZUl0ZW06ZGVsZXRlWm9uZUl0ZW0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9zZXJ2aWNlcy96b25lcy5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 52 */
/***/ function(module, exports, __webpack_require__) {

__webpack_require__(0);
__webpack_require__(1);
__webpack_require__(28);
__webpack_require__(18);
__webpack_require__(23);
__webpack_require__(9);
__webpack_require__(10);
__webpack_require__(2);
__webpack_require__(8);
__webpack_require__(27);
__webpack_require__(26);
__webpack_require__(3);
__webpack_require__(25);
__webpack_require__(21);
__webpack_require__(12);
__webpack_require__(22);
__webpack_require__(17);
__webpack_require__(15);
__webpack_require__(19);
__webpack_require__(20);
__webpack_require__(24);
__webpack_require__(16);
__webpack_require__(11);
__webpack_require__(6);
__webpack_require__(7);
__webpack_require__(5);
__webpack_require__(4);
__webpack_require__(13);
__webpack_require__(14);
__webpack_require__(29);
__webpack_require__(30);
__webpack_require__(40);
__webpack_require__(33);
__webpack_require__(42);
__webpack_require__(35);
__webpack_require__(34);
__webpack_require__(43);
__webpack_require__(41);
__webpack_require__(50);
__webpack_require__(39);
__webpack_require__(48);
__webpack_require__(32);
__webpack_require__(45);
__webpack_require__(37);
__webpack_require__(31);
__webpack_require__(49);
__webpack_require__(46);
__webpack_require__(44);
__webpack_require__(47);
__webpack_require__(36);
__webpack_require__(51);
module.exports = __webpack_require__(38);


/***/ }
/******/ ]);